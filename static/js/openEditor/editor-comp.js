/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
var COMPILED=false;var goog=goog||{};goog.global=this||self;goog.global.CLOSURE_UNCOMPILED_DEFINES;goog.global.CLOSURE_DEFINES;
goog.exportPath_=function(name,object,overwriteImplicit,objectToExportTo){var parts=name.split(".");var cur=objectToExportTo||goog.global;if(!(parts[0]in cur)&&typeof cur.execScript!="undefined")cur.execScript("var "+parts[0]);for(var part;parts.length&&(part=parts.shift());)if(!parts.length&&object!==undefined)if(!overwriteImplicit&&goog.isObject(object)&&goog.isObject(cur[part]))for(var prop in object){if(object.hasOwnProperty(prop))cur[part][prop]=object[prop]}else cur[part]=object;else if(cur[part]&&
cur[part]!==Object.prototype[part])cur=cur[part];else cur=cur[part]={}};
goog.define=function(name,defaultValue){var value=defaultValue;if(!COMPILED){var uncompiledDefines=goog.global.CLOSURE_UNCOMPILED_DEFINES;var defines=goog.global.CLOSURE_DEFINES;if(uncompiledDefines&&uncompiledDefines.nodeType===undefined&&Object.prototype.hasOwnProperty.call(uncompiledDefines,name))value=uncompiledDefines[name];else if(defines&&defines.nodeType===undefined&&Object.prototype.hasOwnProperty.call(defines,name))value=defines[name]}return value};
goog.FEATURESET_YEAR=goog.define("goog.FEATURESET_YEAR",2012);goog.DEBUG=goog.define("goog.DEBUG",true);goog.LOCALE=goog.define("goog.LOCALE","en");goog.TRUSTED_SITE=goog.define("goog.TRUSTED_SITE",true);goog.DISALLOW_TEST_ONLY_CODE=goog.define("goog.DISALLOW_TEST_ONLY_CODE",COMPILED&&!goog.DEBUG);goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=goog.define("goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING",false);
goog.provide=function(name){if(goog.isInModuleLoader_())throw new Error("goog.provide cannot be used within a module.");if(!COMPILED)if(goog.isProvided_(name))throw new Error('Namespace "'+name+'" already declared.');goog.constructNamespace_(name)};
goog.constructNamespace_=function(name,object,overwriteImplicit){if(!COMPILED){delete goog.implicitNamespaces_[name];var namespace=name;while(namespace=namespace.substring(0,namespace.lastIndexOf("."))){if(goog.getObjectByName(namespace))break;goog.implicitNamespaces_[namespace]=true}}goog.exportPath_(name,object,overwriteImplicit)};goog.NONCE_PATTERN_=/^[\w+/_-]+[=]{0,2}$/;
goog.getScriptNonce_=function(opt_window){var doc=(opt_window||goog.global).document;var script=doc.querySelector&&doc.querySelector("script[nonce]");if(script){var nonce=script["nonce"]||script.getAttribute("nonce");if(nonce&&goog.NONCE_PATTERN_.test(nonce))return nonce}return""};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;
goog.module=function(name){if(typeof name!=="string"||!name||name.search(goog.VALID_MODULE_RE_)==-1)throw new Error("Invalid module identifier");if(!goog.isInGoogModuleLoader_())throw new Error("Module "+name+" has been loaded incorrectly. Note, "+"modules cannot be loaded as normal scripts. They require some kind of "+"pre-processing step. You're likely trying to load a module via a "+"script tag or as a part of a concatenated bundle without rewriting the "+"module. For more info see: "+"https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");
if(goog.moduleLoaderState_.moduleName)throw new Error("goog.module may only be called once per module.");goog.moduleLoaderState_.moduleName=name;if(!COMPILED){if(goog.isProvided_(name))throw new Error('Namespace "'+name+'" already declared.');delete goog.implicitNamespaces_[name]}};goog.module.get=function(name){return goog.module.getInternal_(name)};
goog.module.getInternal_=function(name){if(!COMPILED)if(name in goog.loadedModules_)return goog.loadedModules_[name].exports;else if(!goog.implicitNamespaces_[name]){var ns=goog.getObjectByName(name);return ns!=null?ns:null}return null};goog.ModuleType={ES6:"es6",GOOG:"goog"};goog.moduleLoaderState_=null;goog.isInModuleLoader_=function(){return goog.isInGoogModuleLoader_()||goog.isInEs6ModuleLoader_()};
goog.isInGoogModuleLoader_=function(){return!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.GOOG};goog.isInEs6ModuleLoader_=function(){var inLoader=!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.ES6;if(inLoader)return true;var jscomp=goog.global["$jscomp"];if(jscomp){if(typeof jscomp.getCurrentModulePath!="function")return false;return!!jscomp.getCurrentModulePath()}return false};
goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInGoogModuleLoader_())throw new Error("goog.module.declareLegacyNamespace must be called from "+"within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw new Error("goog.module must be called prior to "+"goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=true};
goog.declareModuleId=function(namespace){if(!COMPILED){if(!goog.isInEs6ModuleLoader_())throw new Error("goog.declareModuleId may only be called from "+"within an ES6 module");if(goog.moduleLoaderState_&&goog.moduleLoaderState_.moduleName)throw new Error("goog.declareModuleId may only be called once per module.");if(namespace in goog.loadedModules_)throw new Error('Module with namespace "'+namespace+'" already exists.');}if(goog.moduleLoaderState_)goog.moduleLoaderState_.moduleName=namespace;else{var jscomp=
goog.global["$jscomp"];if(!jscomp||typeof jscomp.getCurrentModulePath!="function")throw new Error('Module with namespace "'+namespace+'" has been loaded incorrectly.');var exports=jscomp.require(jscomp.getCurrentModulePath());goog.loadedModules_[namespace]={exports:exports,type:goog.ModuleType.ES6,moduleId:namespace}}};
goog.setTestOnly=function(opt_message){if(goog.DISALLOW_TEST_ONLY_CODE){opt_message=opt_message||"";throw new Error("Importing test-only code into non-debug environment"+(opt_message?": "+opt_message:"."));}};goog.forwardDeclare=function(name){};goog.forwardDeclare("Document");goog.forwardDeclare("HTMLScriptElement");goog.forwardDeclare("XMLHttpRequest");
if(!COMPILED){goog.isProvided_=function(name){return name in goog.loadedModules_||!goog.implicitNamespaces_[name]&&goog.getObjectByName(name)!=null};goog.implicitNamespaces_={"goog.module":true}}goog.getObjectByName=function(name,opt_obj){var parts=name.split(".");var cur=opt_obj||goog.global;for(var i=0;i<parts.length;i++){cur=cur[parts[i]];if(cur==null)return null}return cur};
goog.addDependency=function(relPath,provides,requires,opt_loadFlags){if(!COMPILED&&goog.DEPENDENCIES_ENABLED)goog.debugLoader_.addDependency(relPath,provides,requires,opt_loadFlags)};goog.ENABLE_DEBUG_LOADER=goog.define("goog.ENABLE_DEBUG_LOADER",false);goog.logToConsole_=function(msg){if(goog.global.console)goog.global.console["error"](msg)};
goog.require=function(namespace){if(!COMPILED){if(goog.ENABLE_DEBUG_LOADER)goog.debugLoader_.requested(namespace);if(goog.isProvided_(namespace)){if(goog.isInModuleLoader_())return goog.module.getInternal_(namespace)}else if(goog.ENABLE_DEBUG_LOADER){var moduleLoaderState=goog.moduleLoaderState_;goog.moduleLoaderState_=null;try{goog.debugLoader_.load_(namespace)}finally{goog.moduleLoaderState_=moduleLoaderState}}return null}};goog.requireType=function(namespace){return{}};goog.basePath="";goog.global.CLOSURE_BASE_PATH;
goog.global.CLOSURE_NO_DEPS;goog.global.CLOSURE_IMPORT_SCRIPT;goog.abstractMethod=function(){throw new Error("unimplemented abstract method");};goog.addSingletonGetter=function(ctor){ctor.instance_=undefined;ctor.getInstance=function(){if(ctor.instance_)return ctor.instance_;if(goog.DEBUG)goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=ctor;return ctor.instance_=new ctor}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=goog.define("goog.LOAD_MODULE_USING_EVAL",true);
goog.SEAL_MODULE_EXPORTS=goog.define("goog.SEAL_MODULE_EXPORTS",goog.DEBUG);goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;goog.TRANSPILE=goog.define("goog.TRANSPILE","detect");goog.ASSUME_ES_MODULES_TRANSPILED=goog.define("goog.ASSUME_ES_MODULES_TRANSPILED",false);goog.TRUSTED_TYPES_POLICY_NAME=goog.define("goog.TRUSTED_TYPES_POLICY_NAME","goog");goog.hasBadLetScoping=null;
goog.loadModule=function(moduleDef){var previousState=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:false,type:goog.ModuleType.GOOG};var origExports={};var exports=origExports;if(typeof moduleDef==="function")exports=moduleDef.call(undefined,exports);else if(typeof moduleDef==="string")exports=goog.loadModuleFromSource_.call(undefined,exports,moduleDef);else throw new Error("Invalid module definition");var moduleName=goog.moduleLoaderState_.moduleName;if(typeof moduleName===
"string"&&moduleName){if(goog.moduleLoaderState_.declareLegacyNamespace){var isDefaultExport=origExports!==exports;goog.constructNamespace_(moduleName,exports,isDefaultExport)}else if(goog.SEAL_MODULE_EXPORTS&&Object.seal&&typeof exports=="object"&&exports!=null)Object.seal(exports);var data={exports:exports,type:goog.ModuleType.GOOG,moduleId:goog.moduleLoaderState_.moduleName};goog.loadedModules_[moduleName]=data}else throw new Error('Invalid module name "'+moduleName+'"');}finally{goog.moduleLoaderState_=
previousState}};goog.loadModuleFromSource_=function(exports){eval(goog.CLOSURE_EVAL_PREFILTER_.createScript(arguments[1]));return exports};goog.normalizePath_=function(path){var components=path.split("/");var i=0;while(i<components.length)if(components[i]==".")components.splice(i,1);else if(i&&components[i]==".."&&components[i-1]&&components[i-1]!="..")components.splice(--i,2);else i++;return components.join("/")};goog.global.CLOSURE_LOAD_FILE_SYNC;
goog.loadFileSync_=function(src){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(src);else try{var xhr=new goog.global["XMLHttpRequest"];xhr.open("get",src,false);xhr.send();return xhr.status==0||xhr.status==200?xhr.responseText:null}catch(err){return null}};goog.typeOf=function(value){var s=typeof value;if(s!="object")return s;if(!value)return"null";if(Array.isArray(value))return"array";return s};
goog.isArrayLike=function(val){var type=goog.typeOf(val);return type=="array"||type=="object"&&typeof val.length=="number"};goog.isDateLike=function(val){return goog.isObject(val)&&typeof val.getFullYear=="function"};goog.isObject=function(val){var type=typeof val;return type=="object"&&val!=null||type=="function"};goog.getUid=function(obj){return Object.prototype.hasOwnProperty.call(obj,goog.UID_PROPERTY_)&&obj[goog.UID_PROPERTY_]||(obj[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(obj){return!!obj[goog.UID_PROPERTY_]};
goog.removeUid=function(obj){if(obj!==null&&"removeAttribute"in obj)obj.removeAttribute(goog.UID_PROPERTY_);try{delete obj[goog.UID_PROPERTY_]}catch(ex){}};goog.UID_PROPERTY_="closure_uid_"+(Math.random()*1E9>>>0);goog.uidCounter_=0;
goog.cloneObject=function(obj){var type=goog.typeOf(obj);if(type=="object"||type=="array"){if(typeof obj.clone==="function")return obj.clone();if(typeof Map!=="undefined"&&obj instanceof Map)return new Map(obj);else if(typeof Set!=="undefined"&&obj instanceof Set)return new Set(obj);var clone=type=="array"?[]:{};for(var key in obj)clone[key]=goog.cloneObject(obj[key]);return clone}return obj};goog.bindNative_=function(fn,selfObj,var_args){return fn.call.apply(fn.bind,arguments)};
goog.bindJs_=function(fn,selfObj,var_args){if(!fn)throw new Error;if(arguments.length>2){var boundArgs=Array.prototype.slice.call(arguments,2);return function(){var newArgs=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(newArgs,boundArgs);return fn.apply(selfObj,newArgs)}}else return function(){return fn.apply(selfObj,arguments)}};
goog.bind=function(fn,selfObj,var_args){if(Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1)goog.bind=goog.bindNative_;else goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};goog.partial=function(fn,var_args){var args=Array.prototype.slice.call(arguments,1);return function(){var newArgs=args.slice();newArgs.push.apply(newArgs,arguments);return fn.apply(this,newArgs)}};goog.now=function(){return Date.now()};goog.globalEval=function(script){(0,eval)(script)};
goog.cssNameMapping_;goog.cssNameMappingStyle_;goog.global.CLOSURE_CSS_NAME_MAP_FN;
goog.getCssName=function(className,opt_modifier){if(String(className).charAt(0)==".")throw new Error('className passed in goog.getCssName must not start with ".".'+" You passed: "+className);var getMapping=function(cssName){return goog.cssNameMapping_[cssName]||cssName};var renameByParts=function(cssName){var parts=cssName.split("-");var mapped=[];for(var i=0;i<parts.length;i++)mapped.push(getMapping(parts[i]));return mapped.join("-")};var rename;if(goog.cssNameMapping_)rename=goog.cssNameMappingStyle_==
"BY_WHOLE"?getMapping:renameByParts;else rename=function(a){return a};var result=opt_modifier?className+"-"+rename(opt_modifier):rename(className);if(goog.global.CLOSURE_CSS_NAME_MAP_FN)return goog.global.CLOSURE_CSS_NAME_MAP_FN(result);return result};goog.setCssNameMapping=function(mapping,opt_style){goog.cssNameMapping_=mapping;goog.cssNameMappingStyle_=opt_style};goog.global.CLOSURE_CSS_NAME_MAPPING;if(!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING)goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING;
goog.GetMsgOptions=function(){};goog.GetMsgOptions.prototype.html;goog.GetMsgOptions.prototype.unescapeHtmlEntities;goog.GetMsgOptions.prototype.original_code;goog.GetMsgOptions.prototype.example;
goog.getMsg=function(str,opt_values,opt_options){if(opt_options&&opt_options.html)str=str.replace(/</g,"&lt;");if(opt_options&&opt_options.unescapeHtmlEntities)str=str.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&amp;/g,"&");if(opt_values)str=str.replace(/\{\$([^}]+)}/g,function(match,key){return opt_values!=null&&key in opt_values?opt_values[key]:match});return str};goog.getMsgWithFallback=function(a,b){return a};
goog.exportSymbol=function(publicPath,object,objectToExportTo){goog.exportPath_(publicPath,object,true,objectToExportTo)};goog.exportProperty=function(object,publicName,symbol){object[publicName]=symbol};
goog.inherits=function(childCtor,parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;childCtor.superClass_=parentCtor.prototype;childCtor.prototype=new tempCtor;childCtor.prototype.constructor=childCtor;childCtor.base=function(me,methodName,var_args){var args=new Array(arguments.length-2);for(var i=2;i<arguments.length;i++)args[i-2]=arguments[i];return parentCtor.prototype[methodName].apply(me,args)}};
goog.scope=function(fn){if(goog.isInModuleLoader_())throw new Error("goog.scope is not supported within a module.");fn.call(goog.global)};if(!COMPILED)goog.global["COMPILED"]=COMPILED;
goog.defineClass=function(superClass,def){var constructor=def.constructor;var statics=def.statics;if(!constructor||constructor==Object.prototype.constructor)constructor=function(){throw new Error("cannot instantiate an interface (no constructor defined).");};var cls=goog.defineClass.createSealingConstructor_(constructor,superClass);if(superClass)goog.inherits(cls,superClass);delete def.constructor;delete def.statics;goog.defineClass.applyProperties_(cls.prototype,def);if(statics!=null)if(statics instanceof
Function)statics(cls);else goog.defineClass.applyProperties_(cls,statics);return cls};goog.defineClass.ClassDescriptor;goog.defineClass.SEAL_CLASS_INSTANCES=goog.define("goog.defineClass.SEAL_CLASS_INSTANCES",goog.DEBUG);goog.defineClass.createSealingConstructor_=function(ctr,superClass){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return ctr;var wrappedCtr=function(){var instance=ctr.apply(this,arguments)||this;instance[goog.UID_PROPERTY_]=instance[goog.UID_PROPERTY_];return instance};return wrappedCtr};
goog.defineClass.OBJECT_PROTOTYPE_FIELDS_=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];goog.defineClass.applyProperties_=function(target,source){var key;for(key in source)if(Object.prototype.hasOwnProperty.call(source,key))target[key]=source[key];for(var i=0;i<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;i++){key=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[i];if(Object.prototype.hasOwnProperty.call(source,key))target[key]=source[key]}};
goog.identity_=function(s){return s};goog.createTrustedTypesPolicy=function(name){var policy=null;var policyFactory=goog.global.trustedTypes;if(!policyFactory||!policyFactory.createPolicy)return policy;try{policy=policyFactory.createPolicy(name,{createHTML:goog.identity_,createScript:goog.identity_,createScriptURL:goog.identity_})}catch(e){goog.logToConsole_(e.message)}return policy};
if(!COMPILED&&goog.DEPENDENCIES_ENABLED){goog.isEdge_=function(){var userAgent=goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"";var edgeRe=/Edge\/(\d+)(\.\d)*/i;return!!userAgent.match(edgeRe)};goog.inHtmlDocument_=function(){var doc=goog.global.document;return doc!=null&&"write"in doc};goog.isDocumentLoading_=function(){var doc=goog.global.document;return doc.attachEvent?doc.readyState!="complete":doc.readyState=="loading"};goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH!=
undefined&&typeof goog.global.CLOSURE_BASE_PATH==="string"){goog.basePath=goog.global.CLOSURE_BASE_PATH;return}else if(!goog.inHtmlDocument_())return;var doc=goog.global.document;var currentScript=doc.currentScript;if(currentScript)var scripts=[currentScript];else var scripts=doc.getElementsByTagName("SCRIPT");for(var i=scripts.length-1;i>=0;--i){var script=scripts[i];var src=script.src;var qmark=src.lastIndexOf("?");var l=qmark==-1?src.length:qmark;if(src.slice(l-7,l)=="base.js"){goog.basePath=src.slice(0,
l-7);return}}};goog.findBasePath_();goog.protectScriptTag_=function(str){return str.replace(/<\/(SCRIPT)/ig,"\\x3c/$1")};goog.DebugLoader_=function(){this.dependencies_={};this.idToPath_={};this.written_={};this.loadingDeps_=[];this.depsToLoad_=[];this.paused_=false;this.factory_=new goog.DependencyFactory;this.deferredCallbacks_={};this.deferredQueue_=[]};goog.DebugLoader_.prototype.bootstrap=function(namespaces,callback){var cb=callback;function resolve(){if(cb){goog.global.setTimeout(cb,0);cb=
null}}if(!namespaces.length){resolve();return}var deps=[];for(var i=0;i<namespaces.length;i++){var path=this.getPathFromDeps_(namespaces[i]);if(!path)throw new Error("Unregonized namespace: "+namespaces[i]);deps.push(this.dependencies_[path])}var require=goog.require;var loaded=0;for(var i=0;i<namespaces.length;i++){require(namespaces[i]);deps[i].onLoad(function(){if(++loaded==namespaces.length)resolve()})}};goog.DebugLoader_.prototype.loadClosureDeps=function(){var relPath="deps.js";this.depsToLoad_.push(this.factory_.createDependency(goog.normalizePath_(goog.basePath+
relPath),relPath,[],[],{}));this.loadDeps_()};goog.DebugLoader_.prototype.requested=function(absPathOrId,opt_force){var path=this.getPathFromDeps_(absPathOrId);if(path&&(opt_force||this.areDepsLoaded_(this.dependencies_[path].requires))){var callback=this.deferredCallbacks_[path];if(callback){delete this.deferredCallbacks_[path];callback()}}};goog.DebugLoader_.prototype.setDependencyFactory=function(factory){this.factory_=factory};goog.DebugLoader_.prototype.load_=function(namespace){if(!this.getPathFromDeps_(namespace)){var errorMessage=
"goog.require could not find: "+namespace;goog.logToConsole_(errorMessage)}else{var loader=this;var deps=[];var visit=function(namespace){var path=loader.getPathFromDeps_(namespace);if(!path)throw new Error("Bad dependency path or symbol: "+namespace);if(loader.written_[path])return;loader.written_[path]=true;var dep=loader.dependencies_[path];for(var i=0;i<dep.requires.length;i++)if(!goog.isProvided_(dep.requires[i]))visit(dep.requires[i]);deps.push(dep)};visit(namespace);var wasLoading=!!this.depsToLoad_.length;
this.depsToLoad_=this.depsToLoad_.concat(deps);if(!this.paused_&&!wasLoading)this.loadDeps_()}};goog.DebugLoader_.prototype.loadDeps_=function(){var loader=this;var paused=this.paused_;while(this.depsToLoad_.length&&!paused)(function(){var loadCallDone=false;var dep=loader.depsToLoad_.shift();var loaded=false;loader.loading_(dep);var controller={pause:function(){if(loadCallDone)throw new Error("Cannot call pause after the call to load.");else paused=true},resume:function(){if(loadCallDone)loader.resume_();
else paused=false},loaded:function(){if(loaded)throw new Error("Double call to loaded.");loaded=true;loader.loaded_(dep)},pending:function(){var pending=[];for(var i=0;i<loader.loadingDeps_.length;i++)pending.push(loader.loadingDeps_[i]);return pending},setModuleState:function(type){goog.moduleLoaderState_={type:type,moduleName:"",declareLegacyNamespace:false}},registerEs6ModuleExports:function(path,exports,opt_closureNamespace){if(opt_closureNamespace)goog.loadedModules_[opt_closureNamespace]={exports:exports,
type:goog.ModuleType.ES6,moduleId:opt_closureNamespace||""}},registerGoogModuleExports:function(moduleId,exports){goog.loadedModules_[moduleId]={exports:exports,type:goog.ModuleType.GOOG,moduleId:moduleId}},clearModuleState:function(){goog.moduleLoaderState_=null},defer:function(callback){if(loadCallDone)throw new Error("Cannot register with defer after the call to load.");loader.defer_(dep,callback)},areDepsLoaded:function(){return loader.areDepsLoaded_(dep.requires)}};try{dep.load(controller)}finally{loadCallDone=
true}})();if(paused)this.pause_()};goog.DebugLoader_.prototype.pause_=function(){this.paused_=true};goog.DebugLoader_.prototype.resume_=function(){if(this.paused_){this.paused_=false;this.loadDeps_()}};goog.DebugLoader_.prototype.loading_=function(dep){this.loadingDeps_.push(dep)};goog.DebugLoader_.prototype.loaded_=function(dep){for(var i=0;i<this.loadingDeps_.length;i++)if(this.loadingDeps_[i]==dep){this.loadingDeps_.splice(i,1);break}for(var i=0;i<this.deferredQueue_.length;i++)if(this.deferredQueue_[i]==
dep.path){this.deferredQueue_.splice(i,1);break}if(this.loadingDeps_.length==this.deferredQueue_.length&&!this.depsToLoad_.length)while(this.deferredQueue_.length)this.requested(this.deferredQueue_.shift(),true);dep.loaded()};goog.DebugLoader_.prototype.areDepsLoaded_=function(pathsOrIds){for(var i=0;i<pathsOrIds.length;i++){var path=this.getPathFromDeps_(pathsOrIds[i]);if(!path||!(path in this.deferredCallbacks_)&&!goog.isProvided_(pathsOrIds[i]))return false}return true};goog.DebugLoader_.prototype.getPathFromDeps_=
function(absPathOrId){if(absPathOrId in this.idToPath_)return this.idToPath_[absPathOrId];else if(absPathOrId in this.dependencies_)return absPathOrId;else return null};goog.DebugLoader_.prototype.defer_=function(dependency,callback){this.deferredCallbacks_[dependency.path]=callback;this.deferredQueue_.push(dependency.path)};goog.LoadController=function(){};goog.LoadController.prototype.pause=function(){};goog.LoadController.prototype.resume=function(){};goog.LoadController.prototype.loaded=function(){};
goog.LoadController.prototype.pending=function(){};goog.LoadController.prototype.registerEs6ModuleExports=function(path,exports,opt_closureNamespace){};goog.LoadController.prototype.setModuleState=function(type){};goog.LoadController.prototype.clearModuleState=function(){};goog.LoadController.prototype.defer=function(callback){};goog.LoadController.prototype.areDepsLoaded=function(){};goog.Dependency=function(path,relativePath,provides,requires,loadFlags){this.path=path;this.relativePath=relativePath;
this.provides=provides;this.requires=requires;this.loadFlags=loadFlags;this.loaded_=false;this.loadCallbacks_=[]};goog.Dependency.prototype.getPathName=function(){var pathName=this.path;var protocolIndex=pathName.indexOf("://");if(protocolIndex>=0){pathName=pathName.substring(protocolIndex+3);var slashIndex=pathName.indexOf("/");if(slashIndex>=0)pathName=pathName.substring(slashIndex+1)}return pathName};goog.Dependency.prototype.onLoad=function(callback){if(this.loaded_)callback();else this.loadCallbacks_.push(callback)};
goog.Dependency.prototype.loaded=function(){this.loaded_=true;var callbacks=this.loadCallbacks_;this.loadCallbacks_=[];for(var i=0;i<callbacks.length;i++)callbacks[i]()};goog.Dependency.defer_=false;goog.Dependency.callbackMap_={};goog.Dependency.registerCallback_=function(callback){var key=Math.random().toString(32);goog.Dependency.callbackMap_[key]=callback;return key};goog.Dependency.unregisterCallback_=function(key){delete goog.Dependency.callbackMap_[key]};goog.Dependency.callback_=function(key,
var_args){if(key in goog.Dependency.callbackMap_){var callback=goog.Dependency.callbackMap_[key];var args=[];for(var i=1;i<arguments.length;i++)args.push(arguments[i]);callback.apply(undefined,args)}else{var errorMessage="Callback key "+key+" does not exist (was base.js loaded more than once?).";throw Error(errorMessage);}};goog.Dependency.prototype.load=function(controller){if(goog.global.CLOSURE_IMPORT_SCRIPT){if(goog.global.CLOSURE_IMPORT_SCRIPT(this.path))controller.loaded();else controller.pause();
return}if(!goog.inHtmlDocument_()){goog.logToConsole_("Cannot use default debug loader outside of HTML documents.");if(this.relativePath=="deps.js"){goog.logToConsole_("Consider setting CLOSURE_IMPORT_SCRIPT before loading base.js, "+"or setting CLOSURE_NO_DEPS to true.");controller.loaded()}else controller.pause();return}var doc=goog.global.document;if(doc.readyState=="complete"&&!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING){var isDeps=/\bdeps.js$/.test(this.path);if(isDeps){controller.loaded();return}else throw Error('Cannot write "'+
this.path+'" after document load');}var nonce=goog.getScriptNonce_();if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&goog.isDocumentLoading_()){var key;var callback=function(script){if(script.readyState&&script.readyState!="complete"){script.onload=callback;return}goog.Dependency.unregisterCallback_(key);controller.loaded()};key=goog.Dependency.registerCallback_(callback);var defer=goog.Dependency.defer_?" defer":"";var nonceAttr=nonce?' nonce="'+nonce+'"':"";var script='<script src="'+this.path+
'"'+nonceAttr+defer+' id="script-'+key+'">\x3c/script>';script+="<script"+nonceAttr+">";if(goog.Dependency.defer_)script+="document.getElementById('script-"+key+"').onload = function() {\n"+"  goog.Dependency.callback_('"+key+"', this);\n"+"};\n";else script+="goog.Dependency.callback_('"+key+"', document.getElementById('script-"+key+"'));";script+="\x3c/script>";doc.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(script):script)}else{var scriptEl=doc.createElement("script");
scriptEl.defer=goog.Dependency.defer_;scriptEl.async=false;if(nonce)scriptEl.nonce=nonce;scriptEl.onload=function(){scriptEl.onload=null;controller.loaded()};scriptEl.src=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScriptURL(this.path):this.path;doc.head.appendChild(scriptEl)}};goog.Es6ModuleDependency=function(path,relativePath,provides,requires,loadFlags){goog.Es6ModuleDependency.base(this,"constructor",path,relativePath,provides,requires,loadFlags)};goog.inherits(goog.Es6ModuleDependency,
goog.Dependency);goog.Es6ModuleDependency.prototype.load=function(controller){if(goog.global.CLOSURE_IMPORT_SCRIPT){if(goog.global.CLOSURE_IMPORT_SCRIPT(this.path))controller.loaded();else controller.pause();return}if(!goog.inHtmlDocument_()){goog.logToConsole_("Cannot use default debug loader outside of HTML documents.");controller.pause();return}var doc=goog.global.document;var dep=this;function write(src,contents){var nonceAttr="";var nonce=goog.getScriptNonce_();if(nonce)nonceAttr=' nonce="'+
nonce+'"';if(contents){var script='<script type="module" crossorigin'+nonceAttr+">"+contents+"</"+"script>";doc.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(script):script)}else{var script='<script type="module" crossorigin src="'+src+'"'+nonceAttr+"></"+"script>";doc.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(script):script)}}function append(src,contents){var scriptEl=doc.createElement("script");scriptEl.defer=true;scriptEl.async=false;scriptEl.type=
"module";scriptEl.setAttribute("crossorigin",true);var nonce=goog.getScriptNonce_();if(nonce)scriptEl.nonce=nonce;if(contents)scriptEl.text=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScript(contents):contents;else scriptEl.src=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScriptURL(src):src;doc.head.appendChild(scriptEl)}var create;if(goog.isDocumentLoading_()){create=write;goog.Dependency.defer_=true}else create=append;var beforeKey=goog.Dependency.registerCallback_(function(){goog.Dependency.unregisterCallback_(beforeKey);
controller.setModuleState(goog.ModuleType.ES6)});create(undefined,'goog.Dependency.callback_("'+beforeKey+'")');create(this.path,undefined);var registerKey=goog.Dependency.registerCallback_(function(exports){goog.Dependency.unregisterCallback_(registerKey);controller.registerEs6ModuleExports(dep.path,exports,goog.moduleLoaderState_.moduleName)});create(undefined,'import * as m from "'+this.path+'"; goog.Dependency.callback_("'+registerKey+'", m)');var afterKey=goog.Dependency.registerCallback_(function(){goog.Dependency.unregisterCallback_(afterKey);
controller.clearModuleState();controller.loaded()});create(undefined,'goog.Dependency.callback_("'+afterKey+'")')};goog.TransformedDependency=function(path,relativePath,provides,requires,loadFlags){goog.TransformedDependency.base(this,"constructor",path,relativePath,provides,requires,loadFlags);this.contents_=null;this.lazyFetch_=!goog.inHtmlDocument_()||!("noModule"in goog.global.document.createElement("script"))};goog.inherits(goog.TransformedDependency,goog.Dependency);goog.TransformedDependency.prototype.load=
function(controller){var dep=this;function fetch(){dep.contents_=goog.loadFileSync_(dep.path);if(dep.contents_){dep.contents_=dep.transform(dep.contents_);if(dep.contents_)dep.contents_+="\n//# sourceURL="+dep.path}}if(goog.global.CLOSURE_IMPORT_SCRIPT){fetch();if(this.contents_&&goog.global.CLOSURE_IMPORT_SCRIPT("",this.contents_)){this.contents_=null;controller.loaded()}else controller.pause();return}var isEs6=this.loadFlags["module"]==goog.ModuleType.ES6;if(!this.lazyFetch_)fetch();function load(){if(dep.lazyFetch_)fetch();
if(!dep.contents_)return;if(isEs6)controller.setModuleState(goog.ModuleType.ES6);var namespace;try{var contents=dep.contents_;dep.contents_=null;goog.globalEval(goog.CLOSURE_EVAL_PREFILTER_.createScript(contents));if(isEs6)namespace=goog.moduleLoaderState_.moduleName}finally{if(isEs6)controller.clearModuleState()}if(isEs6)goog.global["$jscomp"]["require"]["ensure"]([dep.getPathName()],function(){controller.registerEs6ModuleExports(dep.path,goog.global["$jscomp"]["require"](dep.getPathName()),namespace)});
controller.loaded()}function fetchInOwnScriptThenLoad(){var doc=goog.global.document;var key=goog.Dependency.registerCallback_(function(){goog.Dependency.unregisterCallback_(key);load()});var nonce=goog.getScriptNonce_();var nonceAttr=nonce?' nonce="'+nonce+'"':"";var script="<script"+nonceAttr+">"+goog.protectScriptTag_('goog.Dependency.callback_("'+key+'");')+"</"+"script>";doc.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(script):script)}var anythingElsePending=controller.pending().length>
1;var needsAsyncLoading=goog.Dependency.defer_&&(anythingElsePending||goog.isDocumentLoading_());if(needsAsyncLoading){controller.defer(function(){load()});return}var doc=goog.global.document;var isInternetExplorerOrEdge=goog.inHtmlDocument_()&&("ActiveXObject"in goog.global||goog.isEdge_());if(isEs6&&goog.inHtmlDocument_()&&goog.isDocumentLoading_()&&!isInternetExplorerOrEdge){goog.Dependency.defer_=true;controller.pause();var oldCallback=doc.onreadystatechange;doc.onreadystatechange=function(){if(doc.readyState==
"interactive"){doc.onreadystatechange=oldCallback;load();controller.resume()}if(typeof oldCallback==="function")oldCallback.apply(undefined,arguments)}}else if(!goog.inHtmlDocument_()||!goog.isDocumentLoading_())load();else fetchInOwnScriptThenLoad()};goog.TransformedDependency.prototype.transform=function(contents){};goog.PreTranspiledEs6ModuleDependency=function(path,relativePath,provides,requires,loadFlags){goog.PreTranspiledEs6ModuleDependency.base(this,"constructor",path,relativePath,provides,
requires,loadFlags)};goog.inherits(goog.PreTranspiledEs6ModuleDependency,goog.TransformedDependency);goog.PreTranspiledEs6ModuleDependency.prototype.transform=function(contents){return contents};goog.GoogModuleDependency=function(path,relativePath,provides,requires,loadFlags){goog.GoogModuleDependency.base(this,"constructor",path,relativePath,provides,requires,loadFlags)};goog.inherits(goog.GoogModuleDependency,goog.TransformedDependency);goog.GoogModuleDependency.prototype.transform=function(contents){if(!goog.LOAD_MODULE_USING_EVAL||
goog.global.JSON===undefined)return""+"goog.loadModule(function(exports) {"+'"use strict";'+contents+"\n"+";return exports"+"});"+"\n//# sourceURL="+this.path+"\n";else return""+"goog.loadModule("+goog.global.JSON.stringify(contents+"\n//# sourceURL="+this.path+"\n")+");"};goog.DebugLoader_.prototype.addDependency=function(relPath,provides,requires,opt_loadFlags){provides=provides||[];relPath=relPath.replace(/\\/g,"/");var path=goog.normalizePath_(goog.basePath+relPath);if(!opt_loadFlags||typeof opt_loadFlags===
"boolean")opt_loadFlags=opt_loadFlags?{"module":goog.ModuleType.GOOG}:{};var dep=this.factory_.createDependency(path,relPath,provides,requires,opt_loadFlags);this.dependencies_[path]=dep;for(var i=0;i<provides.length;i++)this.idToPath_[provides[i]]=path;this.idToPath_[relPath]=path};goog.DependencyFactory=function(){};goog.DependencyFactory.prototype.createDependency=function(path,relativePath,provides,requires,loadFlags){if(loadFlags["module"]==goog.ModuleType.GOOG)return new goog.GoogModuleDependency(path,
relativePath,provides,requires,loadFlags);else if(loadFlags["module"]==goog.ModuleType.ES6)if(goog.ASSUME_ES_MODULES_TRANSPILED)return new goog.PreTranspiledEs6ModuleDependency(path,relativePath,provides,requires,loadFlags);else return new goog.Es6ModuleDependency(path,relativePath,provides,requires,loadFlags);else return new goog.Dependency(path,relativePath,provides,requires,loadFlags)};goog.debugLoader_=new goog.DebugLoader_;goog.loadClosureDeps=function(){goog.debugLoader_.loadClosureDeps()};
goog.setDependencyFactory=function(factory){goog.debugLoader_.setDependencyFactory(factory)};goog.TRUSTED_TYPES_POLICY_=goog.TRUSTED_TYPES_POLICY_NAME?goog.createTrustedTypesPolicy(goog.TRUSTED_TYPES_POLICY_NAME+"#base"):null;if(!goog.global.CLOSURE_NO_DEPS)goog.debugLoader_.loadClosureDeps();goog.bootstrap=function(namespaces,callback){goog.debugLoader_.bootstrap(namespaces,callback)}}
if(!COMPILED){var isChrome87=false;try{isChrome87=eval(goog.global.trustedTypes.emptyScript)!==goog.global.trustedTypes.emptyScript}catch(err){}goog.CLOSURE_EVAL_PREFILTER_=goog.global.trustedTypes&&isChrome87&&goog.createTrustedTypesPolicy("goog#base#devonly#eval")||{createScript:goog.identity_}};goog.provide("plt.wescheme.SharedAs");plt.wescheme.SharedAs=function(entries){this.entries=entries};plt.wescheme.SharedAs.fromDom=function(dom){var entries=[];jQuery(dom).children("Entry").each(function(){var publicId=jQuery(this).children("publicId").text();var title=jQuery(this).children("title").text();var modified=parseInt(jQuery(this).children("modified").text());entries.push({publicId:publicId,title:title,modified:modified})});return new plt.wescheme.SharedAs(entries)};
plt.wescheme.SharedAs.prototype.getEntries=function(){return this.entries};goog.provide("plt.wescheme.WeSchemeProperties");plt.wescheme.WeSchemeProperties.wescheme_server_base="http://www.wescheme.org";goog.provide("plt.wescheme.base64");
(function(){plt.wescheme.base64.encode=function(data){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,enc="",tmp_arr=[];if(!data)return data;do{o1=data.charCodeAt(i++);o2=data.charCodeAt(i++);o3=data.charCodeAt(i++);bits=o1<<16|o2<<8|o3;h1=bits>>18&63;h2=bits>>12&63;h3=bits>>6&63;h4=bits&63;tmp_arr[ac++]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4)}while(i<data.length);enc=tmp_arr.join("");var r=data.length%3;return(r?
enc.slice(0,r-3):enc)+"===".slice(r||3)};plt.wescheme.base64.decode=function(data){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,dec="",tmp_arr=[];if(!data)return data;data+="";do{h1=b64.indexOf(data.charAt(i++));h2=b64.indexOf(data.charAt(i++));h3=b64.indexOf(data.charAt(i++));h4=b64.indexOf(data.charAt(i++));bits=h1<<18|h2<<12|h3<<6|h4;o1=bits>>16&255;o2=bits>>8&255;o3=bits&255;if(h3==64)tmp_arr[ac++]=String.fromCharCode(o1);else if(h4==
64)tmp_arr[ac++]=String.fromCharCode(o1,o2);else tmp_arr[ac++]=String.fromCharCode(o1,o2,o3)}while(i<data.length);dec=tmp_arr.join("");return dec}})();goog.provide("plt.wescheme.Program");goog.require("plt.wescheme.SharedAs");goog.require("plt.wescheme.WeSchemeProperties");goog.require("plt.wescheme.base64");
(function(){plt.wescheme.Program=function(json){this.json=json};plt.wescheme.Program.prototype.getId=function(){return this.json.id};plt.wescheme.Program.prototype.hasSharingUrls=function(){return this.getSharedAsEntries().length>0};plt.wescheme.Program.prototype.getSharedAsEntries=function(){return new plt.wescheme.SharedAs(this.json.sharedAs)};plt.wescheme.Program.prototype.isPublished=function(){return this.json.published};plt.wescheme.Program.prototype.getTitle=function(){return this.json.title};
plt.wescheme.Program.prototype.getOwner=function(){return this.json.owner};plt.wescheme.Program.prototype.getPublicId=function(){return this.json.publicId};plt.wescheme.Program.prototype.getNotes=function(){return this.json.notes};plt.wescheme.Program.prototype.getSourceCode=function(){return this.json.source.src};plt.wescheme.Program.prototype.getPermissions=function(){return this.json.permissions};plt.wescheme.Program.prototype.getProvides=function(){return this.json.provides};plt.wescheme.Program.prototype.isSourcePublic=
function(){return this.json.isSourcePublic};plt.wescheme.Program.prototype.getObjectCode=function(){return this.json.object.obj};plt.wescheme.Program.prototype.isAndroidPackageBuilt=function(){return false};plt.wescheme.Program.prototype.getAndroidPackageUrl=function(){return""};plt.wescheme.Program.prototype.getPublicEditingUrl=function(){return plt.wescheme.WeSchemeProperties.wescheme_server_base+"/openEditor?publicId="+encodeURIComponent(this.getPublicId())}})();goog.provide("plt.wescheme.AjaxActions");goog.require("plt.wescheme.Program");
(function(){plt.wescheme.AjaxActions=function(){};plt.wescheme.AjaxActions.prototype.loadProject=function(pid,publicId,onSuccess,onFailure){var pid;if(pid)data={pid:pid};else data={publicId:publicId};data.gensym=Math.random();jQuery.ajax({cache:false,data:data,dataType:"json",type:"GET",url:"/loadProject",success:function(json){onSuccess(new plt.wescheme.Program(json))},error:function(xhr){onFailure(xhr.statusText)},xhr:function(settings){return new XMLHttpRequest(settings)}})};plt.wescheme.AjaxActions.prototype.listProjects=
function(onSuccess,onFailure){var callback=function(data){var dom=jQuery(data);onSuccess(dom)};var data={};data.gensym=Math.random();jQuery.ajax({cache:false,data:data,dataType:"xml",type:"GET",url:"/listProjects",success:callback,error:function(xhr){onFailure(xhr.statusText)},xhr:function(settings){return new XMLHttpRequest(settings)}})};plt.wescheme.AjaxActions.prototype.makeAClone=function(pid,code,onSuccess,onFailure){jQuery.ajax({cache:false,data:code===null?{pid:pid}:{pid:pid,code:code},dataType:"text",
type:"POST",url:"/cloneProject",success:function(data){var newPid=parseInt(data);onSuccess(newPid)},error:function(xhr){onFailure(xhr.statusText)},xhr:function(settings){return new XMLHttpRequest(settings)}})};plt.wescheme.AjaxActions.prototype.share=function(pid,isPublic,onSuccess,onFailure){jQuery.ajax({cache:false,data:{pid:pid,isPublic:isPublic},dataType:"xml",type:"POST",url:"/shareProject",success:function(data){onSuccess(jQuery(data))},error:function(xhr){onFailure(xhr.statusText)},xhr:function(settings){return new XMLHttpRequest(settings)}})};
plt.wescheme.AjaxActions.prototype.deleteProject=function(pid,onSuccess,onFailure){jQuery.ajax({cache:false,data:{pid:pid},dataType:"xml",type:"POST",url:"/deleteProject",success:function(data){onSuccess(jQuery(data))},error:function(xhr){onFailure(xhr.statusText)},xhr:function(settings){return new XMLHttpRequest(settings)}})};plt.wescheme.AjaxActions.prototype.save=function(attrs,onSuccess,onFailure){var i;var data={};var attrNames=["title","code","notes"];if(attrs.pid)data.pid=attrs.pid;for(i=0;i<
attrNames.length;i++)if(Object.hasOwnProperty.call(attrs,attrNames[i]))data[attrNames[i]]=attrs[attrNames[i]];jQuery.ajax({cache:false,data:data,dataType:"text",type:"POST",url:"/saveProject",success:function(data){var newPid=parseInt(data);onSuccess(newPid)},error:function(xhr){onFailure(xhr.statusText)},xhr:function(settings){return new XMLHttpRequest(settings)}})};plt.wescheme.AjaxActions.prototype.sendFeedback=function(author,type,feedbackText,onSuccess){jQuery.ajax({cache:false,data:{author:author,
type:type,feedbackText:feedbackText},datatype:"text",type:"POST",url:"/addFeedback",success:function(data){onSuccess()},error:function(xhr){onSuccess()},xhr:function(settings){return new XMLHttpRequest(settings)}})}})();goog.provide("plt.config");plt.config={};plt.config.APP_ID=injected_app_id;plt.config.CLIENT_ID=injected_client_id;plt.config.API_KEY=injected_api_key;goog.provide("plt.wescheme.WeSchemeIntentBus");if(typeof plt==="undefined")this.plt={};if(typeof plt.wescheme==="undefined")this.plt.wescheme={};
var WeSchemeIntentBus=function(){function WeSchemeIntentBus(){this.listeners=[]}WeSchemeIntentBus.prototype.addNotifyListener=function(l){this.listeners.push(l)};WeSchemeIntentBus.prototype.removeNotifyListener=function(l){var i=this.listeners.indexOf(l);if(i!=-1)this.listeners.splice(i,1)};WeSchemeIntentBus.prototype.notify=function(category,data){for(var i=0;i<this.listeners.length;i++)try{this.listeners[i].apply(this,["notify",category,data])}catch(e){}};return new WeSchemeIntentBus}();
plt.wescheme.WeSchemeIntentBus=WeSchemeIntentBus;goog.loadModule(function(exports){"use strict";goog.module("goog.debug.Error");goog.module.declareLegacyNamespace();function DebugError(msg=undefined,cause=undefined){if(Error.captureStackTrace)Error.captureStackTrace(this,DebugError);else{const stack=(new Error).stack;if(stack)this.stack=stack}if(msg)this.message=String(msg);if(cause!==undefined)this.cause=cause;this.reportErrorToServer=true}goog.inherits(DebugError,Error);DebugError.prototype.name="CustomError";exports=DebugError;return exports});goog.provide("goog.dom.NodeType");goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12};goog.loadModule(function(exports){"use strict";goog.module("goog.asserts");goog.module.declareLegacyNamespace();const DebugError=goog.require("goog.debug.Error");const NodeType=goog.require("goog.dom.NodeType");exports.ENABLE_ASSERTS=goog.define("goog.asserts.ENABLE_ASSERTS",goog.DEBUG);function AssertionError(messagePattern,messageArgs){DebugError.call(this,subs(messagePattern,messageArgs));this.messagePattern=messagePattern}goog.inherits(AssertionError,DebugError);exports.AssertionError=AssertionError;
AssertionError.prototype.name="AssertionError";exports.DEFAULT_ERROR_HANDLER=function(e){throw e;};let errorHandler_=exports.DEFAULT_ERROR_HANDLER;function subs(pattern,subs){const splitParts=pattern.split("%s");let returnString="";const subLast=splitParts.length-1;for(let i=0;i<subLast;i++){const sub=i<subs.length?subs[i]:"%s";returnString+=splitParts[i]+sub}return returnString+splitParts[subLast]}function doAssertFailure(defaultMessage,defaultArgs,givenMessage,givenArgs){let message="Assertion failed";
let args;if(givenMessage){message+=": "+givenMessage;args=givenArgs}else if(defaultMessage){message+=": "+defaultMessage;args=defaultArgs}const e=new AssertionError(""+message,args||[]);errorHandler_(e)}exports.setErrorHandler=function(errorHandler){if(exports.ENABLE_ASSERTS)errorHandler_=errorHandler};exports.assert=function(condition,opt_message,var_args){if(exports.ENABLE_ASSERTS&&!condition)doAssertFailure("",null,opt_message,Array.prototype.slice.call(arguments,2));return condition};exports.assertExists=
function(value,opt_message,var_args){if(exports.ENABLE_ASSERTS&&value==null)doAssertFailure("Expected to exist: %s.",[value],opt_message,Array.prototype.slice.call(arguments,2));return value};exports.fail=function(opt_message,var_args){if(exports.ENABLE_ASSERTS)errorHandler_(new AssertionError("Failure"+(opt_message?": "+opt_message:""),Array.prototype.slice.call(arguments,1)))};exports.assertNumber=function(value,opt_message,var_args){if(exports.ENABLE_ASSERTS&&typeof value!=="number")doAssertFailure("Expected number but got %s: %s.",
[goog.typeOf(value),value],opt_message,Array.prototype.slice.call(arguments,2));return value};exports.assertString=function(value,opt_message,var_args){if(exports.ENABLE_ASSERTS&&typeof value!=="string")doAssertFailure("Expected string but got %s: %s.",[goog.typeOf(value),value],opt_message,Array.prototype.slice.call(arguments,2));return value};exports.assertFunction=function(value,opt_message,var_args){if(exports.ENABLE_ASSERTS&&typeof value!=="function")doAssertFailure("Expected function but got %s: %s.",
[goog.typeOf(value),value],opt_message,Array.prototype.slice.call(arguments,2));return value};exports.assertObject=function(value,opt_message,var_args){if(exports.ENABLE_ASSERTS&&!goog.isObject(value))doAssertFailure("Expected object but got %s: %s.",[goog.typeOf(value),value],opt_message,Array.prototype.slice.call(arguments,2));return value};exports.assertArray=function(value,opt_message,var_args){if(exports.ENABLE_ASSERTS&&!Array.isArray(value))doAssertFailure("Expected array but got %s: %s.",[goog.typeOf(value),
value],opt_message,Array.prototype.slice.call(arguments,2));return value};exports.assertBoolean=function(value,opt_message,var_args){if(exports.ENABLE_ASSERTS&&typeof value!=="boolean")doAssertFailure("Expected boolean but got %s: %s.",[goog.typeOf(value),value],opt_message,Array.prototype.slice.call(arguments,2));return value};exports.assertElement=function(value,opt_message,var_args){if(exports.ENABLE_ASSERTS&&(!goog.isObject(value)||value.nodeType!=NodeType.ELEMENT))doAssertFailure("Expected Element but got %s: %s.",
[goog.typeOf(value),value],opt_message,Array.prototype.slice.call(arguments,2));return value};exports.assertInstanceof=function(value,type,opt_message,var_args){if(exports.ENABLE_ASSERTS&&!(value instanceof type))doAssertFailure("Expected instanceof %s but got %s.",[getType(type),getType(value)],opt_message,Array.prototype.slice.call(arguments,3));return value};exports.assertFinite=function(value,opt_message,var_args){if(exports.ENABLE_ASSERTS&&(typeof value!="number"||!isFinite(value)))doAssertFailure("Expected %s to be a finite number but it is not.",
[value],opt_message,Array.prototype.slice.call(arguments,2));return value};function getType(value){if(value instanceof Function)return value.displayName||value.name||"unknown type name";else if(value instanceof Object)return value.constructor.displayName||value.constructor.name||Object.prototype.toString.call(value);else return value===null?"null":typeof value}return exports});goog.provide("goog.debug.EntryPointMonitor");goog.provide("goog.debug.entryPointRegistry");goog.require("goog.asserts");goog.debug.entryPointRegistry.EntryPointMonitor=function(){};goog.debug.entryPointRegistry.EntryPointMonitor.prototype.wrap;goog.debug.entryPointRegistry.EntryPointMonitor.prototype.unwrap;goog.debug.EntryPointMonitor=goog.debug.entryPointRegistry.EntryPointMonitor;goog.debug.entryPointRegistry.refList_=[];goog.debug.entryPointRegistry.monitors_=[];
goog.debug.entryPointRegistry.monitorsMayExist_=false;goog.debug.entryPointRegistry.register=function(callback){goog.debug.entryPointRegistry.refList_[goog.debug.entryPointRegistry.refList_.length]=callback;if(goog.debug.entryPointRegistry.monitorsMayExist_){var monitors=goog.debug.entryPointRegistry.monitors_;for(var i=0;i<monitors.length;i++)callback(goog.bind(monitors[i].wrap,monitors[i]))}};
goog.debug.entryPointRegistry.monitorAll=function(monitor){goog.debug.entryPointRegistry.monitorsMayExist_=true;var transformer=goog.bind(monitor.wrap,monitor);for(var i=0;i<goog.debug.entryPointRegistry.refList_.length;i++)goog.debug.entryPointRegistry.refList_[i](transformer);goog.debug.entryPointRegistry.monitors_.push(monitor)};
goog.debug.entryPointRegistry.unmonitorAllIfPossible=function(monitor){var monitors=goog.debug.entryPointRegistry.monitors_;goog.asserts.assert(monitor==monitors[monitors.length-1],"Only the most recent monitor can be unwrapped.");var transformer=goog.bind(monitor.unwrap,monitor);for(var i=0;i<goog.debug.entryPointRegistry.refList_.length;i++)goog.debug.entryPointRegistry.refList_[i](transformer);monitors.length--};goog.loadModule(function(exports){"use strict";goog.module("goog.array");goog.module.declareLegacyNamespace();const asserts=goog.require("goog.asserts");goog.NATIVE_ARRAY_PROTOTYPES=goog.define("goog.NATIVE_ARRAY_PROTOTYPES",goog.TRUSTED_SITE);const ASSUME_NATIVE_FUNCTIONS=goog.define("goog.array.ASSUME_NATIVE_FUNCTIONS",goog.FEATURESET_YEAR>2012);exports.ASSUME_NATIVE_FUNCTIONS=ASSUME_NATIVE_FUNCTIONS;function peek(array){return array[array.length-1]}exports.peek=peek;exports.last=peek;const indexOf=
goog.NATIVE_ARRAY_PROTOTYPES&&(ASSUME_NATIVE_FUNCTIONS||Array.prototype.indexOf)?function(arr,obj,opt_fromIndex){asserts.assert(arr.length!=null);return Array.prototype.indexOf.call(arr,obj,opt_fromIndex)}:function(arr,obj,opt_fromIndex){const fromIndex=opt_fromIndex==null?0:opt_fromIndex<0?Math.max(0,arr.length+opt_fromIndex):opt_fromIndex;if(typeof arr==="string"){if(typeof obj!=="string"||obj.length!=1)return-1;return arr.indexOf(obj,fromIndex)}for(let i=fromIndex;i<arr.length;i++)if(i in arr&&
arr[i]===obj)return i;return-1};exports.indexOf=indexOf;const lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(ASSUME_NATIVE_FUNCTIONS||Array.prototype.lastIndexOf)?function(arr,obj,opt_fromIndex){asserts.assert(arr.length!=null);const fromIndex=opt_fromIndex==null?arr.length-1:opt_fromIndex;return Array.prototype.lastIndexOf.call(arr,obj,fromIndex)}:function(arr,obj,opt_fromIndex){let fromIndex=opt_fromIndex==null?arr.length-1:opt_fromIndex;if(fromIndex<0)fromIndex=Math.max(0,arr.length+fromIndex);if(typeof arr===
"string"){if(typeof obj!=="string"||obj.length!=1)return-1;return arr.lastIndexOf(obj,fromIndex)}for(let i=fromIndex;i>=0;i--)if(i in arr&&arr[i]===obj)return i;return-1};exports.lastIndexOf=lastIndexOf;const forEach=goog.NATIVE_ARRAY_PROTOTYPES&&(ASSUME_NATIVE_FUNCTIONS||Array.prototype.forEach)?function(arr,f,opt_obj){asserts.assert(arr.length!=null);Array.prototype.forEach.call(arr,f,opt_obj)}:function(arr,f,opt_obj){const l=arr.length;const arr2=typeof arr==="string"?arr.split(""):arr;for(let i=
0;i<l;i++)if(i in arr2)f.call(opt_obj,arr2[i],i,arr)};exports.forEach=forEach;function forEachRight(arr,f,opt_obj){const l=arr.length;const arr2=typeof arr==="string"?arr.split(""):arr;for(let i=l-1;i>=0;--i)if(i in arr2)f.call(opt_obj,arr2[i],i,arr)}exports.forEachRight=forEachRight;const filter=goog.NATIVE_ARRAY_PROTOTYPES&&(ASSUME_NATIVE_FUNCTIONS||Array.prototype.filter)?function(arr,f,opt_obj){asserts.assert(arr.length!=null);return Array.prototype.filter.call(arr,f,opt_obj)}:function(arr,f,
opt_obj){const l=arr.length;const res=[];let resLength=0;const arr2=typeof arr==="string"?arr.split(""):arr;for(let i=0;i<l;i++)if(i in arr2){const val=arr2[i];if(f.call(opt_obj,val,i,arr))res[resLength++]=val}return res};exports.filter=filter;const map=goog.NATIVE_ARRAY_PROTOTYPES&&(ASSUME_NATIVE_FUNCTIONS||Array.prototype.map)?function(arr,f,opt_obj){asserts.assert(arr.length!=null);return Array.prototype.map.call(arr,f,opt_obj)}:function(arr,f,opt_obj){const l=arr.length;const res=new Array(l);
const arr2=typeof arr==="string"?arr.split(""):arr;for(let i=0;i<l;i++)if(i in arr2)res[i]=f.call(opt_obj,arr2[i],i,arr);return res};exports.map=map;const reduce=goog.NATIVE_ARRAY_PROTOTYPES&&(ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduce)?function(arr,f,val,opt_obj){asserts.assert(arr.length!=null);if(opt_obj)f=goog.bind(f,opt_obj);return Array.prototype.reduce.call(arr,f,val)}:function(arr,f,val,opt_obj){let rval=val;forEach(arr,function(val,index){rval=f.call(opt_obj,rval,val,index,arr)});return rval};
exports.reduce=reduce;const reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&(ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduceRight)?function(arr,f,val,opt_obj){asserts.assert(arr.length!=null);asserts.assert(f!=null);if(opt_obj)f=goog.bind(f,opt_obj);return Array.prototype.reduceRight.call(arr,f,val)}:function(arr,f,val,opt_obj){let rval=val;forEachRight(arr,function(val,index){rval=f.call(opt_obj,rval,val,index,arr)});return rval};exports.reduceRight=reduceRight;const some=goog.NATIVE_ARRAY_PROTOTYPES&&
(ASSUME_NATIVE_FUNCTIONS||Array.prototype.some)?function(arr,f,opt_obj){asserts.assert(arr.length!=null);return Array.prototype.some.call(arr,f,opt_obj)}:function(arr,f,opt_obj){const l=arr.length;const arr2=typeof arr==="string"?arr.split(""):arr;for(let i=0;i<l;i++)if(i in arr2&&f.call(opt_obj,arr2[i],i,arr))return true;return false};exports.some=some;const every=goog.NATIVE_ARRAY_PROTOTYPES&&(ASSUME_NATIVE_FUNCTIONS||Array.prototype.every)?function(arr,f,opt_obj){asserts.assert(arr.length!=null);
return Array.prototype.every.call(arr,f,opt_obj)}:function(arr,f,opt_obj){const l=arr.length;const arr2=typeof arr==="string"?arr.split(""):arr;for(let i=0;i<l;i++)if(i in arr2&&!f.call(opt_obj,arr2[i],i,arr))return false;return true};exports.every=every;function count(arr,f,opt_obj){let count=0;forEach(arr,function(element,index,arr){if(f.call(opt_obj,element,index,arr))++count},opt_obj);return count}exports.count=count;function find(arr,f,opt_obj){const i=findIndex(arr,f,opt_obj);return i<0?null:
typeof arr==="string"?arr.charAt(i):arr[i]}exports.find=find;function findIndex(arr,f,opt_obj){const l=arr.length;const arr2=typeof arr==="string"?arr.split(""):arr;for(let i=0;i<l;i++)if(i in arr2&&f.call(opt_obj,arr2[i],i,arr))return i;return-1}exports.findIndex=findIndex;function findRight(arr,f,opt_obj){const i=findIndexRight(arr,f,opt_obj);return i<0?null:typeof arr==="string"?arr.charAt(i):arr[i]}exports.findRight=findRight;function findIndexRight(arr,f,opt_obj){const l=arr.length;const arr2=
typeof arr==="string"?arr.split(""):arr;for(let i=l-1;i>=0;i--)if(i in arr2&&f.call(opt_obj,arr2[i],i,arr))return i;return-1}exports.findIndexRight=findIndexRight;function contains(arr,obj){return indexOf(arr,obj)>=0}exports.contains=contains;function isEmpty(arr){return arr.length==0}exports.isEmpty=isEmpty;function clear(arr){if(!Array.isArray(arr))for(let i=arr.length-1;i>=0;i--)delete arr[i];arr.length=0}exports.clear=clear;function insert(arr,obj){if(!contains(arr,obj))arr.push(obj)}exports.insert=
insert;function insertAt(arr,obj,opt_i){splice(arr,opt_i,0,obj)}exports.insertAt=insertAt;function insertArrayAt(arr,elementsToAdd,opt_i){goog.partial(splice,arr,opt_i,0).apply(null,elementsToAdd)}exports.insertArrayAt=insertArrayAt;function insertBefore(arr,obj,opt_obj2){let i;if(arguments.length==2||(i=indexOf(arr,opt_obj2))<0)arr.push(obj);else insertAt(arr,obj,i)}exports.insertBefore=insertBefore;function remove(arr,obj){const i=indexOf(arr,obj);let rv;if(rv=i>=0)removeAt(arr,i);return rv}exports.remove=
remove;function removeLast(arr,obj){const i=lastIndexOf(arr,obj);if(i>=0){removeAt(arr,i);return true}return false}exports.removeLast=removeLast;function removeAt(arr,i){asserts.assert(arr.length!=null);return Array.prototype.splice.call(arr,i,1).length==1}exports.removeAt=removeAt;function removeIf(arr,f,opt_obj){const i=findIndex(arr,f,opt_obj);if(i>=0){removeAt(arr,i);return true}return false}exports.removeIf=removeIf;function removeAllIf(arr,f,opt_obj){let removedCount=0;forEachRight(arr,function(val,
index){if(f.call(opt_obj,val,index,arr))if(removeAt(arr,index))removedCount++});return removedCount}exports.removeAllIf=removeAllIf;function concat(var_args){return Array.prototype.concat.apply([],arguments)}exports.concat=concat;function join(var_args){return Array.prototype.concat.apply([],arguments)}exports.join=join;function toArray(object){const length=object.length;if(length>0){const rv=new Array(length);for(let i=0;i<length;i++)rv[i]=object[i];return rv}return[]}exports.toArray=toArray;const clone=
toArray;exports.clone=clone;function extend(arr1,var_args){for(let i=1;i<arguments.length;i++){const arr2=arguments[i];if(goog.isArrayLike(arr2)){const len1=arr1.length||0;const len2=arr2.length||0;arr1.length=len1+len2;for(let j=0;j<len2;j++)arr1[len1+j]=arr2[j]}else arr1.push(arr2)}}exports.extend=extend;function splice(arr,index,howMany,var_args){asserts.assert(arr.length!=null);return Array.prototype.splice.apply(arr,slice(arguments,1))}exports.splice=splice;function slice(arr,start,opt_end){asserts.assert(arr.length!=
null);if(arguments.length<=2)return Array.prototype.slice.call(arr,start);else return Array.prototype.slice.call(arr,start,opt_end)}exports.slice=slice;function removeDuplicates(arr,opt_rv,opt_hashFn){const returnArray=opt_rv||arr;const defaultHashFn=function(item){return goog.isObject(item)?"o"+goog.getUid(item):(typeof item).charAt(0)+item};const hashFn=opt_hashFn||defaultHashFn;let cursorInsert=0;let cursorRead=0;const seen={};while(cursorRead<arr.length){const current=arr[cursorRead++];const key=
hashFn(current);if(!Object.prototype.hasOwnProperty.call(seen,key)){seen[key]=true;returnArray[cursorInsert++]=current}}returnArray.length=cursorInsert}exports.removeDuplicates=removeDuplicates;function binarySearch(arr,target,opt_compareFn){return binarySearch_(arr,opt_compareFn||defaultCompare,false,target)}exports.binarySearch=binarySearch;function binarySelect(arr,evaluator,opt_obj){return binarySearch_(arr,evaluator,true,undefined,opt_obj)}exports.binarySelect=binarySelect;function binarySearch_(arr,
compareFn,isEvaluator,opt_target,opt_selfObj){let left=0;let right=arr.length;let found;while(left<right){const middle=left+(right-left>>>1);let compareResult;if(isEvaluator)compareResult=compareFn.call(opt_selfObj,arr[middle],middle,arr);else compareResult=compareFn(opt_target,arr[middle]);if(compareResult>0)left=middle+1;else{right=middle;found=!compareResult}}return found?left:-left-1}function sort(arr,opt_compareFn){arr.sort(opt_compareFn||defaultCompare)}exports.sort=sort;function stableSort(arr,
opt_compareFn){const compArr=new Array(arr.length);for(let i=0;i<arr.length;i++)compArr[i]={index:i,value:arr[i]};const valueCompareFn=opt_compareFn||defaultCompare;function stableCompareFn(obj1,obj2){return valueCompareFn(obj1.value,obj2.value)||obj1.index-obj2.index}sort(compArr,stableCompareFn);for(let i=0;i<arr.length;i++)arr[i]=compArr[i].value}exports.stableSort=stableSort;function sortByKey(arr,keyFn,opt_compareFn){const keyCompareFn=opt_compareFn||defaultCompare;sort(arr,function(a,b){return keyCompareFn(keyFn(a),
keyFn(b))})}exports.sortByKey=sortByKey;function sortObjectsByKey(arr,key,opt_compareFn){sortByKey(arr,function(obj){return obj[key]},opt_compareFn)}exports.sortObjectsByKey=sortObjectsByKey;function isSorted(arr,opt_compareFn,opt_strict){const compare=opt_compareFn||defaultCompare;for(let i=1;i<arr.length;i++){const compareResult=compare(arr[i-1],arr[i]);if(compareResult>0||compareResult==0&&opt_strict)return false}return true}exports.isSorted=isSorted;function equals(arr1,arr2,opt_equalsFn){if(!goog.isArrayLike(arr1)||
!goog.isArrayLike(arr2)||arr1.length!=arr2.length)return false;const l=arr1.length;const equalsFn=opt_equalsFn||defaultCompareEquality;for(let i=0;i<l;i++)if(!equalsFn(arr1[i],arr2[i]))return false;return true}exports.equals=equals;function compare3(arr1,arr2,opt_compareFn){const compare=opt_compareFn||defaultCompare;const l=Math.min(arr1.length,arr2.length);for(let i=0;i<l;i++){const result=compare(arr1[i],arr2[i]);if(result!=0)return result}return defaultCompare(arr1.length,arr2.length)}exports.compare3=
compare3;function defaultCompare(a,b){return a>b?1:a<b?-1:0}exports.defaultCompare=defaultCompare;function inverseDefaultCompare(a,b){return-defaultCompare(a,b)}exports.inverseDefaultCompare=inverseDefaultCompare;function defaultCompareEquality(a,b){return a===b}exports.defaultCompareEquality=defaultCompareEquality;function binaryInsert(array,value,opt_compareFn){const index=binarySearch(array,value,opt_compareFn);if(index<0){insertAt(array,value,-(index+1));return true}return false}exports.binaryInsert=
binaryInsert;function binaryRemove(array,value,opt_compareFn){const index=binarySearch(array,value,opt_compareFn);return index>=0?removeAt(array,index):false}exports.binaryRemove=binaryRemove;function bucket(array,sorter,opt_obj){const buckets={};for(let i=0;i<array.length;i++){const value=array[i];const key=sorter.call(opt_obj,value,i,array);if(key!==undefined){const bucket=buckets[key]||(buckets[key]=[]);bucket.push(value)}}return buckets}exports.bucket=bucket;function bucketToMap(array,sorter){const buckets=
new Map;for(let i=0;i<array.length;i++){const value=array[i];const key=sorter(value,i,array);if(key!==undefined){let bucket=buckets.get(key);if(!bucket){bucket=[];buckets.set(key,bucket)}bucket.push(value)}}return buckets}exports.bucketToMap=bucketToMap;function toObject(arr,keyFunc,opt_obj){const ret={};forEach(arr,function(element,index){ret[keyFunc.call(opt_obj,element,index,arr)]=element});return ret}exports.toObject=toObject;function toMap(arr,keyFunc){const map=new Map;for(let i=0;i<arr.length;i++){const element=
arr[i];map.set(keyFunc(element,i,arr),element)}return map}exports.toMap=toMap;function range(startOrEnd,opt_end,opt_step){const array=[];let start=0;let end=startOrEnd;const step=opt_step||1;if(opt_end!==undefined){start=startOrEnd;end=opt_end}if(step*(end-start)<0)return[];if(step>0)for(let i=start;i<end;i+=step)array.push(i);else for(let i=start;i>end;i+=step)array.push(i);return array}exports.range=range;function repeat(value,n){const array=[];for(let i=0;i<n;i++)array[i]=value;return array}exports.repeat=
repeat;function flatten(var_args){const CHUNK_SIZE=8192;const result=[];for(let i=0;i<arguments.length;i++){const element=arguments[i];if(Array.isArray(element))for(let c=0;c<element.length;c+=CHUNK_SIZE){const chunk=slice(element,c,c+CHUNK_SIZE);const recurseResult=flatten.apply(null,chunk);for(let r=0;r<recurseResult.length;r++)result.push(recurseResult[r])}else result.push(element)}return result}exports.flatten=flatten;function rotate(array,n){asserts.assert(array.length!=null);if(array.length){n%=
array.length;if(n>0)Array.prototype.unshift.apply(array,array.splice(-n,n));else if(n<0)Array.prototype.push.apply(array,array.splice(0,-n))}return array}exports.rotate=rotate;function moveItem(arr,fromIndex,toIndex){asserts.assert(fromIndex>=0&&fromIndex<arr.length);asserts.assert(toIndex>=0&&toIndex<arr.length);const removedItems=Array.prototype.splice.call(arr,fromIndex,1);Array.prototype.splice.call(arr,toIndex,0,removedItems[0])}exports.moveItem=moveItem;function zip(var_args){if(!arguments.length)return[];
const result=[];let minLen=arguments[0].length;for(let i=1;i<arguments.length;i++)if(arguments[i].length<minLen)minLen=arguments[i].length;for(let i=0;i<minLen;i++){const value=[];for(let j=0;j<arguments.length;j++)value.push(arguments[j][i]);result.push(value)}return result}exports.zip=zip;function shuffle(arr,opt_randFn){const randFn=opt_randFn||Math.random;for(let i=arr.length-1;i>0;i--){const j=Math.floor(randFn()*(i+1));const tmp=arr[i];arr[i]=arr[j];arr[j]=tmp}}exports.shuffle=shuffle;function copyByIndex(arr,
index_arr){const result=[];forEach(index_arr,function(index){result.push(arr[index])});return result}exports.copyByIndex=copyByIndex;function concatMap(arr,f,opt_obj){return concat.apply([],map(arr,f,opt_obj))}exports.concatMap=concatMap;return exports});goog.provide("goog.debug.errorcontext");goog.debug.errorcontext.addErrorContext=function(err,contextKey,contextValue){if(!err[goog.debug.errorcontext.CONTEXT_KEY_])err[goog.debug.errorcontext.CONTEXT_KEY_]={};err[goog.debug.errorcontext.CONTEXT_KEY_][contextKey]=contextValue};goog.debug.errorcontext.getErrorContext=function(err){return err[goog.debug.errorcontext.CONTEXT_KEY_]||{}};goog.debug.errorcontext.CONTEXT_KEY_="__closure__error__context__984382";goog.provide("goog.debug");goog.require("goog.array");goog.require("goog.debug.errorcontext");goog.debug.LOGGING_ENABLED=goog.define("goog.debug.LOGGING_ENABLED",goog.DEBUG);goog.debug.FORCE_SLOPPY_STACKS=goog.define("goog.debug.FORCE_SLOPPY_STACKS",false);goog.debug.CHECK_FOR_THROWN_EVENT=goog.define("goog.debug.CHECK_FOR_THROWN_EVENT",false);
goog.debug.catchErrors=function(logFunc,opt_cancel,opt_target){var target=opt_target||goog.global;var oldErrorHandler=target.onerror;var retVal=!!opt_cancel;target.onerror=function(message,url,line,opt_col,opt_error){if(oldErrorHandler)oldErrorHandler(message,url,line,opt_col,opt_error);logFunc({message:message,fileName:url,line:line,lineNumber:line,col:opt_col,error:opt_error});return retVal}};
goog.debug.expose=function(obj,opt_showFn){if(typeof obj=="undefined")return"undefined";if(obj==null)return"NULL";var str=[];for(var x in obj){if(!opt_showFn&&typeof obj[x]==="function")continue;var s=x+" = ";try{s+=obj[x]}catch(e){s+="*** "+e+" ***"}str.push(s)}return str.join("\n")};
goog.debug.deepExpose=function(obj,opt_showFn){var str=[];var uidsToCleanup=[];var ancestorUids={};var helper=function(obj,space){var nestspace=space+"  ";var indentMultiline=function(str){return str.replace(/\n/g,"\n"+space)};try{if(obj===undefined)str.push("undefined");else if(obj===null)str.push("NULL");else if(typeof obj==="string")str.push('"'+indentMultiline(obj)+'"');else if(typeof obj==="function")str.push(indentMultiline(String(obj)));else if(goog.isObject(obj)){if(!goog.hasUid(obj))uidsToCleanup.push(obj);
var uid=goog.getUid(obj);if(ancestorUids[uid])str.push("*** reference loop detected (id="+uid+") ***");else{ancestorUids[uid]=true;str.push("{");for(var x in obj){if(!opt_showFn&&typeof obj[x]==="function")continue;str.push("\n");str.push(nestspace);str.push(x+" = ");helper(obj[x],nestspace)}str.push("\n"+space+"}");delete ancestorUids[uid]}}else str.push(obj)}catch(e){str.push("*** "+e+" ***")}};helper(obj,"");for(var i=0;i<uidsToCleanup.length;i++)goog.removeUid(uidsToCleanup[i]);return str.join("")};
goog.debug.exposeArray=function(arr){var str=[];for(var i=0;i<arr.length;i++)if(Array.isArray(arr[i]))str.push(goog.debug.exposeArray(arr[i]));else str.push(arr[i]);return"[ "+str.join(", ")+" ]"};
goog.debug.normalizeErrorObject=function(err){var href=goog.getObjectByName("window.location.href");if(err==null)err='Unknown Error of type "null/undefined"';if(typeof err==="string")return{"message":err,"name":"Unknown error","lineNumber":"Not available","fileName":href,"stack":"Not available"};var lineNumber,fileName;var threwError=false;try{lineNumber=err.lineNumber||err.line||"Not available"}catch(e){lineNumber="Not available";threwError=true}try{fileName=err.fileName||err.filename||err.sourceURL||
goog.global["$googDebugFname"]||href}catch(e){fileName="Not available";threwError=true}var stack=goog.debug.serializeErrorStack_(err);if(threwError||!err.lineNumber||!err.fileName||!err.stack||!err.message||!err.name){var message=err.message;if(message==null){if(err.constructor&&err.constructor instanceof Function){var ctorName=err.constructor.name?err.constructor.name:goog.debug.getFunctionName(err.constructor);message='Unknown Error of type "'+ctorName+'"';if(goog.debug.CHECK_FOR_THROWN_EVENT&&
ctorName=="Event")try{message=message+' with Event.type "'+(err.type||"")+'"'}catch(e){}}else message="Unknown Error of unknown type";if(typeof err.toString==="function"&&Object.prototype.toString!==err.toString)message+=": "+err.toString()}return{"message":message,"name":err.name||"UnknownError","lineNumber":lineNumber,"fileName":fileName,"stack":stack||"Not available"}}err.stack=stack;return{"message":err.message,"name":err.name,"lineNumber":err.lineNumber,"fileName":err.fileName,"stack":err.stack}};
goog.debug.serializeErrorStack_=function(e,seen){if(!seen)seen={};seen[goog.debug.serializeErrorAsKey_(e)]=true;var stack=e["stack"]||"";var cause=e.cause;if(cause&&!seen[goog.debug.serializeErrorAsKey_(cause)]){stack+="\nCaused by: ";if(!cause.stack||cause.stack.indexOf(cause.toString())!=0)stack+=typeof cause==="string"?cause:cause.message+"\n";stack+=goog.debug.serializeErrorStack_(cause,seen)}return stack};
goog.debug.serializeErrorAsKey_=function(e){var keyPrefix="";if(typeof e.toString==="function")keyPrefix=""+e;return keyPrefix+e["stack"]};goog.debug.enhanceError=function(err,opt_message){var error;if(!(err instanceof Error)){error=Error(err);if(Error.captureStackTrace)Error.captureStackTrace(error,goog.debug.enhanceError)}else error=err;if(!error.stack)error.stack=goog.debug.getStacktrace(goog.debug.enhanceError);if(opt_message){var x=0;while(error["message"+x])++x;error["message"+x]=String(opt_message)}return error};
goog.debug.enhanceErrorWithContext=function(err,opt_context){var error=goog.debug.enhanceError(err);if(opt_context)for(var key in opt_context)goog.debug.errorcontext.addErrorContext(error,key,opt_context[key]);return error};
goog.debug.getStacktraceSimple=function(opt_depth){if(!goog.debug.FORCE_SLOPPY_STACKS){var stack=goog.debug.getNativeStackTrace_(goog.debug.getStacktraceSimple);if(stack)return stack}var sb=[];var fn=arguments.callee.caller;var depth=0;while(fn&&(!opt_depth||depth<opt_depth)){sb.push(goog.debug.getFunctionName(fn));sb.push("()\n");try{fn=fn.caller}catch(e){sb.push("[exception trying to get caller]\n");break}depth++;if(depth>=goog.debug.MAX_STACK_DEPTH){sb.push("[...long stack...]");break}}if(opt_depth&&
depth>=opt_depth)sb.push("[...reached max depth limit...]");else sb.push("[end]");return sb.join("")};goog.debug.MAX_STACK_DEPTH=50;goog.debug.getNativeStackTrace_=function(fn){var tempErr=new Error;if(Error.captureStackTrace){Error.captureStackTrace(tempErr,fn);return String(tempErr.stack)}else{try{throw tempErr;}catch(e){tempErr=e}var stack=tempErr.stack;if(stack)return String(stack)}return null};
goog.debug.getStacktrace=function(fn){var stack;if(!goog.debug.FORCE_SLOPPY_STACKS){var contextFn=fn||goog.debug.getStacktrace;stack=goog.debug.getNativeStackTrace_(contextFn)}if(!stack)stack=goog.debug.getStacktraceHelper_(fn||arguments.callee.caller,[]);return stack};
goog.debug.getStacktraceHelper_=function(fn,visited){var sb=[];if(goog.array.contains(visited,fn))sb.push("[...circular reference...]");else if(fn&&visited.length<goog.debug.MAX_STACK_DEPTH){sb.push(goog.debug.getFunctionName(fn)+"(");var args=fn.arguments;for(var i=0;args&&i<args.length;i++){if(i>0)sb.push(", ");var argDesc;var arg=args[i];switch(typeof arg){case "object":argDesc=arg?"object":"null";break;case "string":argDesc=arg;break;case "number":argDesc=String(arg);break;case "boolean":argDesc=
arg?"true":"false";break;case "function":argDesc=goog.debug.getFunctionName(arg);argDesc=argDesc?argDesc:"[fn]";break;case "undefined":default:argDesc=typeof arg;break}if(argDesc.length>40)argDesc=argDesc.slice(0,40)+"...";sb.push(argDesc)}visited.push(fn);sb.push(")\n");try{sb.push(goog.debug.getStacktraceHelper_(fn.caller,visited))}catch(e){sb.push("[exception trying to get caller]\n")}}else if(fn)sb.push("[...long stack...]");else sb.push("[end]");return sb.join("")};
goog.debug.getFunctionName=function(fn){if(goog.debug.fnNameCache_[fn])return goog.debug.fnNameCache_[fn];var functionSource=String(fn);if(!goog.debug.fnNameCache_[functionSource]){var matches=/function\s+([^\(]+)/m.exec(functionSource);if(matches){var method=matches[1];goog.debug.fnNameCache_[functionSource]=method}else goog.debug.fnNameCache_[functionSource]="[Anonymous]"}return goog.debug.fnNameCache_[functionSource]};
goog.debug.makeWhitespaceVisible=function(string){return string.replace(/ /g,"[_]").replace(/\f/g,"[f]").replace(/\n/g,"[n]\n").replace(/\r/g,"[r]").replace(/\t/g,"[t]")};goog.debug.runtimeType=function(value){if(value instanceof Function)return value.displayName||value.name||"unknown type name";else if(value instanceof Object)return value.constructor.displayName||value.constructor.name||Object.prototype.toString.call(value);else return value===null?"null":typeof value};goog.debug.fnNameCache_={};
goog.debug.freezeInternal_=goog.DEBUG&&Object.freeze||function(arg){return arg};goog.debug.freeze=function(arg){return{valueOf:function(){return goog.debug.freezeInternal_(arg)}}.valueOf()};goog.provide("goog.disposable.IDisposable");goog.disposable.IDisposable=function(){};goog.disposable.IDisposable.prototype.dispose=goog.abstractMethod;goog.disposable.IDisposable.prototype.isDisposed=goog.abstractMethod;goog.loadModule(function(exports){"use strict";goog.module("goog.dispose");goog.module.declareLegacyNamespace();function dispose(obj){if(obj&&typeof obj.dispose=="function")obj.dispose()}exports=dispose;return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.disposeAll");goog.module.declareLegacyNamespace();const dispose=goog.require("goog.dispose");function disposeAll(var_args){for(let i=0,len=arguments.length;i<len;++i){const disposable=arguments[i];if(goog.isArrayLike(disposable))disposeAll.apply(null,disposable);else dispose(disposable)}}exports=disposeAll;return exports});goog.provide("goog.Disposable");goog.require("goog.disposable.IDisposable");goog.require("goog.dispose");goog.require("goog.disposeAll");goog.Disposable=function(){this.creationStack;if(goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF){if(goog.Disposable.INCLUDE_STACK_ON_CREATION)this.creationStack=(new Error).stack;goog.Disposable.instances_[goog.getUid(this)]=this}this.disposed_=this.disposed_;this.onDisposeCallbacks_=this.onDisposeCallbacks_};
goog.Disposable.MonitoringMode={OFF:0,PERMANENT:1,INTERACTIVE:2};goog.Disposable.MONITORING_MODE=goog.define("goog.Disposable.MONITORING_MODE",0);goog.Disposable.INCLUDE_STACK_ON_CREATION=goog.define("goog.Disposable.INCLUDE_STACK_ON_CREATION",true);goog.Disposable.instances_={};goog.Disposable.getUndisposedObjects=function(){var ret=[];for(var id in goog.Disposable.instances_)if(goog.Disposable.instances_.hasOwnProperty(id))ret.push(goog.Disposable.instances_[Number(id)]);return ret};
goog.Disposable.clearUndisposedObjects=function(){goog.Disposable.instances_={}};goog.Disposable.prototype.disposed_=false;goog.Disposable.prototype.onDisposeCallbacks_;goog.Disposable.prototype.isDisposed=function(){return this.disposed_};goog.Disposable.prototype.getDisposed=goog.Disposable.prototype.isDisposed;
goog.Disposable.prototype.dispose=function(){if(!this.disposed_){this.disposed_=true;this.disposeInternal();if(goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF){var uid=goog.getUid(this);if(goog.Disposable.MONITORING_MODE==goog.Disposable.MonitoringMode.PERMANENT&&!goog.Disposable.instances_.hasOwnProperty(uid))throw new Error(this+" did not call the goog.Disposable base "+"constructor or was disposed of after a clearUndisposedObjects "+"call");if(goog.Disposable.MONITORING_MODE!=
goog.Disposable.MonitoringMode.OFF&&this.onDisposeCallbacks_&&this.onDisposeCallbacks_.length>0)throw new Error(this+" did not empty its onDisposeCallbacks queue. This "+"probably means it overrode dispose() or disposeInternal() "+"without calling the superclass' method.");delete goog.Disposable.instances_[uid]}}};goog.Disposable.prototype.registerDisposable=function(disposable){this.addOnDisposeCallback(goog.partial(goog.dispose,disposable))};
goog.Disposable.prototype.addOnDisposeCallback=function(callback,opt_scope){if(this.disposed_){opt_scope!==undefined?callback.call(opt_scope):callback();return}if(!this.onDisposeCallbacks_)this.onDisposeCallbacks_=[];this.onDisposeCallbacks_.push(opt_scope!==undefined?goog.bind(callback,opt_scope):callback)};goog.Disposable.prototype.disposeInternal=function(){if(this.onDisposeCallbacks_)while(this.onDisposeCallbacks_.length)this.onDisposeCallbacks_.shift()()};
goog.Disposable.isDisposed=function(obj){if(obj&&typeof obj.isDisposed=="function")return obj.isDisposed();return false};goog.provide("goog.events.EventId");goog.events.EventId=function(eventId){this.id=eventId};goog.events.EventId.prototype.toString=function(){return this.id};goog.provide("goog.events.Event");goog.require("goog.Disposable");goog.require("goog.events.EventId");goog.events.Event=function(type,opt_target){this.type=type instanceof goog.events.EventId?String(type):type;this.target=opt_target;this.currentTarget=this.target;this.propagationStopped_=false;this.defaultPrevented=false};goog.events.Event.prototype.hasPropagationStopped=function(){return this.propagationStopped_};goog.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=true};
goog.events.Event.prototype.preventDefault=function(){this.defaultPrevented=true};goog.events.Event.stopPropagation=function(e){e.stopPropagation()};goog.events.Event.preventDefault=function(e){e.preventDefault()};goog.loadModule(function(exports){"use strict";goog.module("goog.events.BrowserFeature");goog.module.declareLegacyNamespace();const purify=fn=>{return{valueOf:fn}.valueOf()};exports={TOUCH_ENABLED:"ontouchstart"in goog.global||!!(goog.global["document"]&&document.documentElement&&"ontouchstart"in document.documentElement)||!!(goog.global["navigator"]&&(goog.global["navigator"]["maxTouchPoints"]||goog.global["navigator"]["msMaxTouchPoints"])),POINTER_EVENTS:"PointerEvent"in goog.global,MSPOINTER_EVENTS:false,
PASSIVE_EVENTS:purify(function(){if(!goog.global.addEventListener||!Object.defineProperty)return false;var passive=false;var options=Object.defineProperty({},"passive",{get:function(){passive=true}});try{goog.global.addEventListener("test",()=>{},options);goog.global.removeEventListener("test",()=>{},options)}catch(e){}return passive})};return exports});goog.provide("goog.string.internal");goog.string.internal.startsWith=function(str,prefix){return str.lastIndexOf(prefix,0)==0};goog.string.internal.endsWith=function(str,suffix){const l=str.length-suffix.length;return l>=0&&str.indexOf(suffix,l)==l};goog.string.internal.caseInsensitiveStartsWith=function(str,prefix){return goog.string.internal.caseInsensitiveCompare(prefix,str.slice(0,prefix.length))==0};
goog.string.internal.caseInsensitiveEndsWith=function(str,suffix){return goog.string.internal.caseInsensitiveCompare(suffix,str.slice(str.length-suffix.length))==0};goog.string.internal.caseInsensitiveEquals=function(str1,str2){return str1.toLowerCase()==str2.toLowerCase()};goog.string.internal.isEmptyOrWhitespace=function(str){return/^[\s\xa0]*$/.test(str)};goog.string.internal.trim=goog.TRUSTED_SITE&&String.prototype.trim?function(str){return str.trim()}:function(str){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(str)[1]};
goog.string.internal.caseInsensitiveCompare=function(str1,str2){const test1=String(str1).toLowerCase();const test2=String(str2).toLowerCase();if(test1<test2)return-1;else if(test1==test2)return 0;else return 1};goog.string.internal.newLineToBr=function(str,opt_xml){return str.replace(/(\r\n|\r|\n)/g,opt_xml?"<br />":"<br>")};
goog.string.internal.htmlEscape=function(str,opt_isLikelyToContainHtmlChars){if(opt_isLikelyToContainHtmlChars){str=str.replace(goog.string.internal.AMP_RE_,"&amp;").replace(goog.string.internal.LT_RE_,"&lt;").replace(goog.string.internal.GT_RE_,"&gt;").replace(goog.string.internal.QUOT_RE_,"&quot;").replace(goog.string.internal.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.internal.NULL_RE_,"&#0;");return str}else{if(!goog.string.internal.ALL_RE_.test(str))return str;if(str.indexOf("&")!=-1)str=
str.replace(goog.string.internal.AMP_RE_,"&amp;");if(str.indexOf("<")!=-1)str=str.replace(goog.string.internal.LT_RE_,"&lt;");if(str.indexOf(">")!=-1)str=str.replace(goog.string.internal.GT_RE_,"&gt;");if(str.indexOf('"')!=-1)str=str.replace(goog.string.internal.QUOT_RE_,"&quot;");if(str.indexOf("'")!=-1)str=str.replace(goog.string.internal.SINGLE_QUOTE_RE_,"&#39;");if(str.indexOf("\x00")!=-1)str=str.replace(goog.string.internal.NULL_RE_,"&#0;");return str}};goog.string.internal.AMP_RE_=/&/g;
goog.string.internal.LT_RE_=/</g;goog.string.internal.GT_RE_=/>/g;goog.string.internal.QUOT_RE_=/"/g;goog.string.internal.SINGLE_QUOTE_RE_=/'/g;goog.string.internal.NULL_RE_=/\x00/g;goog.string.internal.ALL_RE_=/[\x00&<>"']/;goog.string.internal.whitespaceEscape=function(str,opt_xml){return goog.string.internal.newLineToBr(str.replace(/  /g," &#160;"),opt_xml)};goog.string.internal.contains=function(str,subString){return str.indexOf(subString)!=-1};
goog.string.internal.caseInsensitiveContains=function(str,subString){return goog.string.internal.contains(str.toLowerCase(),subString.toLowerCase())};
goog.string.internal.compareVersions=function(version1,version2){let order=0;const v1Subs=goog.string.internal.trim(String(version1)).split(".");const v2Subs=goog.string.internal.trim(String(version2)).split(".");const subCount=Math.max(v1Subs.length,v2Subs.length);for(let subIdx=0;order==0&&subIdx<subCount;subIdx++){let v1Sub=v1Subs[subIdx]||"";let v2Sub=v2Subs[subIdx]||"";do{const v1Comp=/(\d*)(\D*)(.*)/.exec(v1Sub)||["","","",""];const v2Comp=/(\d*)(\D*)(.*)/.exec(v2Sub)||["","","",""];if(v1Comp[0].length==
0&&v2Comp[0].length==0)break;const v1CompNum=v1Comp[1].length==0?0:parseInt(v1Comp[1],10);const v2CompNum=v2Comp[1].length==0?0:parseInt(v2Comp[1],10);order=goog.string.internal.compareElements_(v1CompNum,v2CompNum)||goog.string.internal.compareElements_(v1Comp[2].length==0,v2Comp[2].length==0)||goog.string.internal.compareElements_(v1Comp[2],v2Comp[2]);v1Sub=v1Comp[3];v2Sub=v2Comp[3]}while(order==0)}return order};
goog.string.internal.compareElements_=function(left,right){if(left<right)return-1;else if(left>right)return 1;return 0};goog.loadModule(function(exports){"use strict";goog.module("goog.flags");goog.module.declareLegacyNamespace();exports.USE_USER_AGENT_CLIENT_HINTS=false;exports.ASYNC_THROW_ON_UNICODE_TO_BYTE=false;return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.labs.userAgent");goog.module.declareLegacyNamespace();const flags=goog.require("goog.flags");const USE_CLIENT_HINTS_OVERRIDE=goog.define("goog.labs.userAgent.USE_CLIENT_HINTS_OVERRIDE","");const USE_CLIENT_HINTS=goog.define("goog.labs.userAgent.USE_CLIENT_HINTS",false);let forceClientHintsInTests=false;exports.setUseClientHintsForTesting=use=>{forceClientHintsInTests=use};const useClientHintsRuntimeOverride=USE_CLIENT_HINTS_OVERRIDE?
!!goog.getObjectByName(USE_CLIENT_HINTS_OVERRIDE):false;exports.useClientHints=()=>{return flags.USE_USER_AGENT_CLIENT_HINTS||USE_CLIENT_HINTS||useClientHintsRuntimeOverride||forceClientHintsInTests};return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.labs.userAgent.util");goog.module.declareLegacyNamespace();const {caseInsensitiveContains,contains}=goog.require("goog.string.internal");const {useClientHints}=goog.require("goog.labs.userAgent");const ASSUME_CLIENT_HINTS_SUPPORT=false;function getNativeUserAgentString(){const navigator=getNavigator();if(navigator){const userAgent=navigator.userAgent;if(userAgent)return userAgent}return""}function getNativeUserAgentData(){const navigator=
getNavigator();if(navigator)return navigator.userAgentData||null;return null}function getNavigator(){return goog.global.navigator}let userAgentInternal=null;let userAgentDataInternal=getNativeUserAgentData();function setUserAgent(userAgent=undefined){userAgentInternal=typeof userAgent==="string"?userAgent:getNativeUserAgentString()}function getUserAgent(){return userAgentInternal==null?getNativeUserAgentString():userAgentInternal}function setUserAgentData(userAgentData){userAgentDataInternal=userAgentData}
function resetUserAgentData(){userAgentDataInternal=getNativeUserAgentData()}function getUserAgentData(){return userAgentDataInternal}function matchUserAgentDataBrand(str){if(!useClientHints())return false;const data=getUserAgentData();if(!data)return false;return data.brands.some(({brand})=>brand&&contains(brand,str))}function matchUserAgent(str){const userAgent=getUserAgent();return contains(userAgent,str)}function matchUserAgentIgnoreCase(str){const userAgent=getUserAgent();return caseInsensitiveContains(userAgent,
str)}function extractVersionTuples(userAgent){const versionRegExp=new RegExp("([A-Z][\\w ]+)"+"/"+"([^\\s]+)"+"\\s*"+"(?:\\((.*?)\\))?","g");const data=[];let match;while(match=versionRegExp.exec(userAgent))data.push([match[1],match[2],match[3]||undefined]);return data}exports={ASSUME_CLIENT_HINTS_SUPPORT,extractVersionTuples,getNativeUserAgentString,getUserAgent,getUserAgentData,matchUserAgent,matchUserAgentDataBrand,matchUserAgentIgnoreCase,resetUserAgentData,setUserAgent,setUserAgentData};return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.labs.userAgent.highEntropy.highEntropyValue");const util=goog.require("goog.labs.userAgent.util");const {compareVersions}=goog.require("goog.string.internal");class AsyncValue{getIfLoaded(){}load(){}}exports.AsyncValue=AsyncValue;class HighEntropyValue{constructor(key){this.key_=key;this.value_=undefined;this.promise_=undefined;this.pending_=false}getIfLoaded(){const userAgentData=util.getUserAgentData();if(!userAgentData)return undefined;
return this.value_}async load(){const userAgentData=util.getUserAgentData();if(!userAgentData)return undefined;if(!this.promise_){this.pending_=true;this.promise_=(async()=>{try{const dataValues=await userAgentData.getHighEntropyValues([this.key_]);this.value_=dataValues[this.key_];return this.value_}finally{this.pending_=false}})()}return await this.promise_}resetForTesting(){if(this.pending_)throw new Error("Unsafe call to resetForTesting");this.promise_=undefined;this.value_=undefined;this.pending_=
false}}exports.HighEntropyValue=HighEntropyValue;class Version{constructor(versionString){this.versionString_=versionString}toVersionStringForLogging(){return this.versionString_}isAtLeast(version){return compareVersions(this.versionString_,version)>=0}}exports.Version=Version;return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.labs.userAgent.highEntropy.highEntropyData");const {HighEntropyValue}=goog.require("goog.labs.userAgent.highEntropy.highEntropyValue");const fullVersionList=new HighEntropyValue("fullVersionList");exports.fullVersionList=fullVersionList;const platformVersion=new HighEntropyValue("platformVersion");exports.platformVersion=platformVersion;return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.labs.userAgent.browser");goog.module.declareLegacyNamespace();const util=goog.require("goog.labs.userAgent.util");const {AsyncValue,Version}=goog.require("goog.labs.userAgent.highEntropy.highEntropyValue");const {assert,assertExists}=goog.require("goog.asserts");const {compareVersions}=goog.require("goog.string.internal");const {fullVersionList}=goog.require("goog.labs.userAgent.highEntropy.highEntropyData");const {useClientHints}=goog.require("goog.labs.userAgent");
const Brand={ANDROID_BROWSER:"Android Browser",CHROMIUM:"Chromium",EDGE:"Microsoft Edge",FIREFOX:"Firefox",IE:"Internet Explorer",OPERA:"Opera",SAFARI:"Safari",SILK:"Silk"};exports.Brand=Brand;function useUserAgentDataBrand(ignoreClientHintsFlag=false){if(util.ASSUME_CLIENT_HINTS_SUPPORT)return true;if(!ignoreClientHintsFlag&&!useClientHints())return false;const userAgentData=util.getUserAgentData();return!!userAgentData&&userAgentData.brands.length>0}function hasFullVersionList(){return isAtLeast(Brand.CHROMIUM,
98)}function matchOpera(){if(useUserAgentDataBrand())return false;return util.matchUserAgent("Opera")}function matchIE(){if(useUserAgentDataBrand())return false;return util.matchUserAgent("Trident")||util.matchUserAgent("MSIE")}function matchEdgeHtml(){if(useUserAgentDataBrand())return false;return util.matchUserAgent("Edge")}function matchEdgeChromium(){if(useUserAgentDataBrand())return util.matchUserAgentDataBrand(Brand.EDGE);return util.matchUserAgent("Edg/")}function matchOperaChromium(){if(useUserAgentDataBrand())return util.matchUserAgentDataBrand(Brand.OPERA);
return util.matchUserAgent("OPR")}function matchFirefox(){return util.matchUserAgent("Firefox")||util.matchUserAgent("FxiOS")}function matchSafari(){return util.matchUserAgent("Safari")&&!(matchChrome()||matchCoast()||matchOpera()||matchEdgeHtml()||matchEdgeChromium()||matchOperaChromium()||matchFirefox()||isSilk()||util.matchUserAgent("Android"))}function matchCoast(){if(useUserAgentDataBrand())return false;return util.matchUserAgent("Coast")}function matchIosWebview(){return(util.matchUserAgent("iPad")||
util.matchUserAgent("iPhone"))&&!matchSafari()&&!matchChrome()&&!matchCoast()&&!matchFirefox()&&util.matchUserAgent("AppleWebKit")}function matchChrome(){if(useUserAgentDataBrand())return util.matchUserAgentDataBrand(Brand.CHROMIUM);return(util.matchUserAgent("Chrome")||util.matchUserAgent("CriOS"))&&!matchEdgeHtml()||isSilk()}function matchAndroidBrowser(){return util.matchUserAgent("Android")&&!(isChrome()||isFirefox()||isOpera()||isSilk())}const isOpera=matchOpera;exports.isOpera=isOpera;const isIE=
matchIE;exports.isIE=isIE;const isEdge=matchEdgeHtml;exports.isEdge=isEdge;const isEdgeChromium=matchEdgeChromium;exports.isEdgeChromium=isEdgeChromium;const isOperaChromium=matchOperaChromium;exports.isOperaChromium=isOperaChromium;const isFirefox=matchFirefox;exports.isFirefox=isFirefox;const isSafari=matchSafari;exports.isSafari=isSafari;const isCoast=matchCoast;exports.isCoast=isCoast;const isIosWebview=matchIosWebview;exports.isIosWebview=isIosWebview;const isChrome=matchChrome;exports.isChrome=
isChrome;const isAndroidBrowser=matchAndroidBrowser;exports.isAndroidBrowser=isAndroidBrowser;function isSilk(){return util.matchUserAgent("Silk")}exports.isSilk=isSilk;function createVersionMap(versionTuples){const versionMap={};versionTuples.forEach(tuple=>{const key=tuple[0];const value=tuple[1];versionMap[key]=value});return keys=>versionMap[keys.find(key=>key in versionMap)]||""}function getVersion(){const userAgentString=util.getUserAgent();if(isIE())return getIEVersion(userAgentString);const versionTuples=
util.extractVersionTuples(userAgentString);const lookUpValueWithKeys=createVersionMap(versionTuples);if(isOpera())return lookUpValueWithKeys(["Version","Opera"]);if(isEdge())return lookUpValueWithKeys(["Edge"]);if(isEdgeChromium())return lookUpValueWithKeys(["Edg"]);if(isSilk())return lookUpValueWithKeys(["Silk"]);if(isChrome())return lookUpValueWithKeys(["Chrome","CriOS","HeadlessChrome"]);const tuple=versionTuples[2];return tuple&&tuple[1]||""}exports.getVersion=getVersion;function isVersionOrHigher(version){return compareVersions(getVersion(),
version)>=0}exports.isVersionOrHigher=isVersionOrHigher;function getIEVersion(userAgent){const rv=/rv: *([\d\.]*)/.exec(userAgent);if(rv&&rv[1])return rv[1];let version="";const msie=/MSIE +([\d\.]+)/.exec(userAgent);if(msie&&msie[1]){const tridentVersion=/Trident\/(\d.\d)/.exec(userAgent);if(msie[1]=="7.0")if(tridentVersion&&tridentVersion[1])switch(tridentVersion[1]){case "4.0":version="8.0";break;case "5.0":version="9.0";break;case "6.0":version="10.0";break;case "7.0":version="11.0";break}else version=
"7.0";else version=msie[1]}return version}function getFullVersionFromUserAgentString(browser){const userAgentString=util.getUserAgent();if(browser===Brand.IE)return isIE()?getIEVersion(userAgentString):"";const versionTuples=util.extractVersionTuples(userAgentString);const lookUpValueWithKeys=createVersionMap(versionTuples);switch(browser){case Brand.OPERA:if(isOpera())return lookUpValueWithKeys(["Version","Opera"]);else if(isOperaChromium())return lookUpValueWithKeys(["OPR"]);break;case Brand.EDGE:if(isEdge())return lookUpValueWithKeys(["Edge"]);
else if(isEdgeChromium())return lookUpValueWithKeys(["Edg"]);break;case Brand.CHROMIUM:if(isChrome())return lookUpValueWithKeys(["Chrome","CriOS","HeadlessChrome"]);break}if(browser===Brand.FIREFOX&&isFirefox()||browser===Brand.SAFARI&&isSafari()||browser===Brand.ANDROID_BROWSER&&isAndroidBrowser()||browser===Brand.SILK&&isSilk()){const tuple=versionTuples[2];return tuple&&tuple[1]||""}return""}function versionOf_(browser){let versionParts;if(useUserAgentDataBrand()&&browser!==Brand.SILK){const data=
util.getUserAgentData();const matchingBrand=data.brands.find(({brand})=>brand===browser);if(!matchingBrand||!matchingBrand.version)return NaN;versionParts=matchingBrand.version.split(".")}else{const fullVersion=getFullVersionFromUserAgentString(browser);if(fullVersion==="")return NaN;versionParts=fullVersion.split(".")}if(versionParts.length===0)return NaN;const majorVersion=versionParts[0];return Number(majorVersion)}function isAtLeast(brand,majorVersion){assert(Math.floor(majorVersion)===majorVersion,
"Major version must be an integer");return versionOf_(brand)>=majorVersion}exports.isAtLeast=isAtLeast;function isAtMost(brand,majorVersion){assert(Math.floor(majorVersion)===majorVersion,"Major version must be an integer");return versionOf_(brand)<=majorVersion}exports.isAtMost=isAtMost;class HighEntropyBrandVersion{constructor(brand,useUach,fallbackVersion){this.brand_=brand;this.version_=new Version(fallbackVersion);this.useUach_=useUach}getIfLoaded(){if(this.useUach_){const loadedVersionList=
fullVersionList.getIfLoaded();if(loadedVersionList!==undefined){const matchingBrand=loadedVersionList.find(({brand})=>this.brand_===brand);assertExists(matchingBrand);return new Version(matchingBrand.version)}}if(preUachHasLoaded)return this.version_;return}async load(){if(this.useUach_){const loadedVersionList=await fullVersionList.load();if(loadedVersionList!==undefined){const matchingBrand=loadedVersionList.find(({brand})=>this.brand_===brand);assertExists(matchingBrand);return new Version(matchingBrand.version)}}else await 0;
preUachHasLoaded=true;return this.version_}}let preUachHasLoaded=false;async function loadFullVersions(){if(useUserAgentDataBrand(true))await fullVersionList.load();preUachHasLoaded=true}exports.loadFullVersions=loadFullVersions;exports.resetForTesting=()=>{preUachHasLoaded=false;fullVersionList.resetForTesting()};function fullVersionOf(browser){let fallbackVersionString="";if(!hasFullVersionList())fallbackVersionString=getFullVersionFromUserAgentString(browser);const useUach=browser!==Brand.SILK&&
useUserAgentDataBrand(true);if(useUach){const data=util.getUserAgentData();if(!data.brands.find(({brand})=>brand===browser))return undefined}else if(fallbackVersionString==="")return undefined;return new HighEntropyBrandVersion(browser,useUach,fallbackVersionString)}exports.fullVersionOf=fullVersionOf;function getVersionStringForLogging(browser){if(useUserAgentDataBrand(true)){const fullVersionObj=fullVersionOf(browser);if(fullVersionObj){const fullVersion=fullVersionObj.getIfLoaded();if(fullVersion)return fullVersion.toVersionStringForLogging();
const data=util.getUserAgentData();const matchingBrand=data.brands.find(({brand})=>brand===browser);assertExists(matchingBrand);return matchingBrand.version}return""}else return getFullVersionFromUserAgentString(browser)}exports.getVersionStringForLogging=getVersionStringForLogging;return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.labs.userAgent.engine");goog.module.declareLegacyNamespace();const googArray=goog.require("goog.array");const googString=goog.require("goog.string.internal");const util=goog.require("goog.labs.userAgent.util");function isPresto(){return util.matchUserAgent("Presto")}function isTrident(){return util.matchUserAgent("Trident")||util.matchUserAgent("MSIE")}function isEdge(){return util.matchUserAgent("Edge")}function isWebKit(){return util.matchUserAgentIgnoreCase("WebKit")&&
!isEdge()}function isGecko(){return util.matchUserAgent("Gecko")&&!isWebKit()&&!isTrident()&&!isEdge()}function getVersion(){const userAgentString=util.getUserAgent();if(userAgentString){const tuples=util.extractVersionTuples(userAgentString);const engineTuple=getEngineTuple(tuples);if(engineTuple){if(engineTuple[0]=="Gecko")return getVersionForKey(tuples,"Firefox");return engineTuple[1]}const browserTuple=tuples[0];let info;if(browserTuple&&(info=browserTuple[2])){const match=/Trident\/([^\s;]+)/.exec(info);
if(match)return match[1]}}return""}function getEngineTuple(tuples){if(!isEdge())return tuples[1];for(let i=0;i<tuples.length;i++){const tuple=tuples[i];if(tuple[0]=="Edge")return tuple}}function isVersionOrHigher(version){return googString.compareVersions(getVersion(),version)>=0}function getVersionForKey(tuples,key){const pair=googArray.find(tuples,function(pair){return key==pair[0]});return pair&&pair[1]||""}exports={getVersion,isEdge,isGecko,isPresto,isTrident,isVersionOrHigher,isWebKit};return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.labs.userAgent.platform");goog.module.declareLegacyNamespace();const googString=goog.require("goog.string.internal");const util=goog.require("goog.labs.userAgent.util");const {AsyncValue,Version}=goog.require("goog.labs.userAgent.highEntropy.highEntropyValue");const {platformVersion}=goog.require("goog.labs.userAgent.highEntropy.highEntropyData");const {useClientHints}=goog.require("goog.labs.userAgent");function useUserAgentDataPlatform(ignoreClientHintsFlag=
false){if(util.ASSUME_CLIENT_HINTS_SUPPORT)return true;if(!ignoreClientHintsFlag&&!useClientHints())return false;const userAgentData=util.getUserAgentData();return!!userAgentData&&!!userAgentData.platform}function isAndroid(){if(useUserAgentDataPlatform())return util.getUserAgentData().platform==="Android";return util.matchUserAgent("Android")}function isIpod(){return util.matchUserAgent("iPod")}function isIphone(){return util.matchUserAgent("iPhone")&&!util.matchUserAgent("iPod")&&!util.matchUserAgent("iPad")}
function isIpad(){return util.matchUserAgent("iPad")}function isIos(){return isIphone()||isIpad()||isIpod()}function isMacintosh(){if(useUserAgentDataPlatform())return util.getUserAgentData().platform==="macOS";return util.matchUserAgent("Macintosh")}function isLinux(){if(useUserAgentDataPlatform())return util.getUserAgentData().platform==="Linux";return util.matchUserAgent("Linux")}function isWindows(){if(useUserAgentDataPlatform())return util.getUserAgentData().platform==="Windows";return util.matchUserAgent("Windows")}
function isChromeOS(){if(useUserAgentDataPlatform())return util.getUserAgentData().platform==="Chrome OS";return util.matchUserAgent("CrOS")}function isChromecast(){return util.matchUserAgent("CrKey")}function isKaiOS(){return util.matchUserAgentIgnoreCase("KaiOS")}function getVersion(){const userAgentString=util.getUserAgent();let version="",re;if(isWindows()){re=/Windows (?:NT|Phone) ([0-9.]+)/;const match=re.exec(userAgentString);if(match)version=match[1];else version="0.0"}else if(isIos()){re=
/(?:iPhone|iPod|iPad|CPU)\s+OS\s+(\S+)/;const match=re.exec(userAgentString);version=match&&match[1].replace(/_/g,".")}else if(isMacintosh()){re=/Mac OS X ([0-9_.]+)/;const match=re.exec(userAgentString);version=match?match[1].replace(/_/g,"."):"10"}else if(isKaiOS()){re=/(?:KaiOS)\/(\S+)/i;const match=re.exec(userAgentString);version=match&&match[1]}else if(isAndroid()){re=/Android\s+([^\);]+)(\)|;)/;const match=re.exec(userAgentString);version=match&&match[1]}else if(isChromeOS()){re=/(?:CrOS\s+(?:i686|x86_64)\s+([0-9.]+))/;
const match=re.exec(userAgentString);version=match&&match[1]}return version||""}function isVersionOrHigher(version){return googString.compareVersions(getVersion(),version)>=0}class PlatformVersion{constructor(){this.preUachHasLoaded_=false}getIfLoaded(){if(useUserAgentDataPlatform(true)){const loadedPlatformVersion=platformVersion.getIfLoaded();if(loadedPlatformVersion===undefined)return undefined;return new Version(loadedPlatformVersion)}else if(!this.preUachHasLoaded_)return undefined;else return new Version(getVersion())}async load(){if(useUserAgentDataPlatform(true))return new Version(await platformVersion.load());
else{this.preUachHasLoaded_=true;return new Version(getVersion())}}resetForTesting(){platformVersion.resetForTesting();this.preUachHasLoaded_=false}}const version=new PlatformVersion;exports={getVersion,isAndroid,isChromeOS,isChromecast,isIos,isIpad,isIphone,isIpod,isKaiOS,isLinux,isMacintosh,isVersionOrHigher,isWindows,version};return exports});goog.provide("goog.reflect");goog.reflect.object=function(type,object){return object};goog.reflect.objectProperty=function(prop,object){return prop};goog.reflect.sinkValue=function(x){goog.reflect.sinkValue[" "](x);return x};goog.reflect.sinkValue[" "]=function(){};goog.reflect.canAccessProperty=function(obj,prop){try{goog.reflect.sinkValue(obj[prop]);return true}catch(e){}return false};
goog.reflect.cache=function(cacheObj,key,valueFn,opt_keyFn){const storedKey=opt_keyFn?opt_keyFn(key):key;if(Object.prototype.hasOwnProperty.call(cacheObj,storedKey))return cacheObj[storedKey];return cacheObj[storedKey]=valueFn(key)};goog.provide("goog.userAgent");goog.require("goog.labs.userAgent.browser");goog.require("goog.labs.userAgent.engine");goog.require("goog.labs.userAgent.platform");goog.require("goog.labs.userAgent.util");goog.require("goog.reflect");goog.require("goog.string.internal");goog.userAgent.ASSUME_IE=goog.define("goog.userAgent.ASSUME_IE",false);goog.userAgent.ASSUME_EDGE=goog.define("goog.userAgent.ASSUME_EDGE",false);goog.userAgent.ASSUME_GECKO=goog.define("goog.userAgent.ASSUME_GECKO",false);
goog.userAgent.ASSUME_WEBKIT=goog.define("goog.userAgent.ASSUME_WEBKIT",false);goog.userAgent.ASSUME_MOBILE_WEBKIT=goog.define("goog.userAgent.ASSUME_MOBILE_WEBKIT",false);goog.userAgent.ASSUME_OPERA=goog.define("goog.userAgent.ASSUME_OPERA",false);goog.userAgent.ASSUME_ANY_VERSION=goog.define("goog.userAgent.ASSUME_ANY_VERSION",false);
goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA;goog.userAgent.getUserAgentString=function(){return goog.labs.userAgent.util.getUserAgent()};goog.userAgent.getNavigatorTyped=function(){return goog.global["navigator"]||null};goog.userAgent.getNavigator=function(){return goog.userAgent.getNavigatorTyped()};
goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.labs.userAgent.browser.isOpera();goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.labs.userAgent.browser.isIE();goog.userAgent.EDGE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_EDGE:goog.labs.userAgent.engine.isEdge();goog.userAgent.EDGE_OR_IE=goog.userAgent.EDGE||goog.userAgent.IE;goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.labs.userAgent.engine.isGecko();
goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.labs.userAgent.engine.isWebKit();goog.userAgent.isMobile_=function(){return goog.userAgent.WEBKIT&&goog.labs.userAgent.util.matchUserAgent("Mobile")};goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.isMobile_();goog.userAgent.SAFARI=goog.userAgent.WEBKIT;
goog.userAgent.determinePlatform_=function(){var navigator=goog.userAgent.getNavigatorTyped();return navigator&&navigator.platform||""};goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_();goog.userAgent.ASSUME_MAC=goog.define("goog.userAgent.ASSUME_MAC",false);goog.userAgent.ASSUME_WINDOWS=goog.define("goog.userAgent.ASSUME_WINDOWS",false);goog.userAgent.ASSUME_LINUX=goog.define("goog.userAgent.ASSUME_LINUX",false);goog.userAgent.ASSUME_X11=goog.define("goog.userAgent.ASSUME_X11",false);
goog.userAgent.ASSUME_ANDROID=goog.define("goog.userAgent.ASSUME_ANDROID",false);goog.userAgent.ASSUME_IPHONE=goog.define("goog.userAgent.ASSUME_IPHONE",false);goog.userAgent.ASSUME_IPAD=goog.define("goog.userAgent.ASSUME_IPAD",false);goog.userAgent.ASSUME_IPOD=goog.define("goog.userAgent.ASSUME_IPOD",false);goog.userAgent.ASSUME_KAIOS=goog.define("goog.userAgent.ASSUME_KAIOS",false);
goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD;goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.labs.userAgent.platform.isMacintosh();goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.labs.userAgent.platform.isWindows();
goog.userAgent.isLegacyLinux_=function(){return goog.labs.userAgent.platform.isLinux()||goog.labs.userAgent.platform.isChromeOS()};goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.isLegacyLinux_();goog.userAgent.isX11_=function(){var navigator=goog.userAgent.getNavigatorTyped();return!!navigator&&goog.string.internal.contains(navigator["appVersion"]||"","X11")};goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.isX11_();
goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.labs.userAgent.platform.isAndroid();goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.labs.userAgent.platform.isIphone();goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad();goog.userAgent.IPOD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIpod();
goog.userAgent.IOS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIos();goog.userAgent.KAIOS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_KAIOS:goog.labs.userAgent.platform.isKaiOS();
goog.userAgent.determineVersion_=function(){var version="";var arr=goog.userAgent.getVersionRegexResult_();if(arr)version=arr?arr[1]:"";if(goog.userAgent.IE){var docMode=goog.userAgent.getDocumentMode_();if(docMode!=null&&docMode>parseFloat(version))return String(docMode)}return version};
goog.userAgent.getVersionRegexResult_=function(){var userAgent=goog.userAgent.getUserAgentString();if(goog.userAgent.GECKO)return/rv:([^\);]+)(\)|;)/.exec(userAgent);if(goog.userAgent.EDGE)return/Edge\/([\d\.]+)/.exec(userAgent);if(goog.userAgent.IE)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(userAgent);if(goog.userAgent.WEBKIT)return/WebKit\/(\S+)/.exec(userAgent);if(goog.userAgent.OPERA)return/(?:Version)[ \/]?(\S+)/.exec(userAgent);return undefined};
goog.userAgent.getDocumentMode_=function(){var doc=goog.global["document"];return doc?doc["documentMode"]:undefined};goog.userAgent.VERSION=goog.userAgent.determineVersion_();goog.userAgent.compare=function(v1,v2){return goog.string.internal.compareVersions(v1,v2)};goog.userAgent.isVersionOrHigherCache_={};
goog.userAgent.isVersionOrHigher=function(version){return goog.userAgent.ASSUME_ANY_VERSION||goog.reflect.cache(goog.userAgent.isVersionOrHigherCache_,version,function(){return goog.string.internal.compareVersions(goog.userAgent.VERSION,version)>=0})};goog.userAgent.isDocumentModeOrHigher=function(documentMode){return Number(goog.userAgent.DOCUMENT_MODE)>=documentMode};goog.userAgent.isDocumentMode=goog.userAgent.isDocumentModeOrHigher;
goog.userAgent.DOCUMENT_MODE=function(){var doc=goog.global["document"];if(!doc||!goog.userAgent.IE)return undefined;var documentMode=goog.userAgent.getDocumentMode_();if(documentMode)return documentMode;var ieVersion=parseInt(goog.userAgent.VERSION,10);return ieVersion||undefined}();goog.provide("goog.events.eventTypeHelpers");goog.require("goog.events.BrowserFeature");goog.require("goog.userAgent");goog.events.eventTypeHelpers.getVendorPrefixedName=function(eventName){return goog.userAgent.WEBKIT?"webkit"+eventName:eventName.toLowerCase()};
goog.events.eventTypeHelpers.getPointerFallbackEventName=function(pointerEventName,msPointerEventName,fallbackEventName){if(goog.events.BrowserFeature.POINTER_EVENTS)return pointerEventName;if(goog.events.BrowserFeature.MSPOINTER_EVENTS)return msPointerEventName;return fallbackEventName};goog.provide("goog.events.EventType");goog.require("goog.events.eventTypeHelpers");goog.require("goog.userAgent");
goog.events.EventType={CLICK:"click",RIGHTCLICK:"rightclick",DBLCLICK:"dblclick",AUXCLICK:"auxclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSECANCEL:"mousecancel",SELECTIONCHANGE:"selectionchange",SELECTSTART:"selectstart",WHEEL:"wheel",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",BLUR:"blur",FOCUS:"focus",DEACTIVATE:"deactivate",FOCUSIN:"focusin",FOCUSOUT:"focusout",CHANGE:"change",
RESET:"reset",SELECT:"select",SUBMIT:"submit",INPUT:"input",PROPERTYCHANGE:"propertychange",DRAGSTART:"dragstart",DRAG:"drag",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",DRAGEND:"dragend",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel",BEFOREUNLOAD:"beforeunload",CONSOLEMESSAGE:"consolemessage",CONTEXTMENU:"contextmenu",DEVICECHANGE:"devicechange",DEVICEMOTION:"devicemotion",DEVICEORIENTATION:"deviceorientation",DOMCONTENTLOADED:"DOMContentLoaded",
ERROR:"error",HELP:"help",LOAD:"load",LOSECAPTURE:"losecapture",ORIENTATIONCHANGE:"orientationchange",READYSTATECHANGE:"readystatechange",RESIZE:"resize",SCROLL:"scroll",UNLOAD:"unload",CANPLAY:"canplay",CANPLAYTHROUGH:"canplaythrough",DURATIONCHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",LOADEDDATA:"loadeddata",LOADEDMETADATA:"loadedmetadata",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATECHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",
TIMEUPDATE:"timeupdate",VOLUMECHANGE:"volumechange",WAITING:"waiting",SOURCEOPEN:"sourceopen",SOURCEENDED:"sourceended",SOURCECLOSED:"sourceclosed",ABORT:"abort",UPDATE:"update",UPDATESTART:"updatestart",UPDATEEND:"updateend",HASHCHANGE:"hashchange",PAGEHIDE:"pagehide",PAGESHOW:"pageshow",POPSTATE:"popstate",COPY:"copy",PASTE:"paste",CUT:"cut",BEFORECOPY:"beforecopy",BEFORECUT:"beforecut",BEFOREPASTE:"beforepaste",ONLINE:"online",OFFLINE:"offline",MESSAGE:"message",CONNECT:"connect",INSTALL:"install",
ACTIVATE:"activate",FETCH:"fetch",FOREIGNFETCH:"foreignfetch",MESSAGEERROR:"messageerror",STATECHANGE:"statechange",UPDATEFOUND:"updatefound",CONTROLLERCHANGE:"controllerchange",ANIMATIONSTART:goog.events.eventTypeHelpers.getVendorPrefixedName("AnimationStart"),ANIMATIONEND:goog.events.eventTypeHelpers.getVendorPrefixedName("AnimationEnd"),ANIMATIONITERATION:goog.events.eventTypeHelpers.getVendorPrefixedName("AnimationIteration"),TRANSITIONEND:goog.events.eventTypeHelpers.getVendorPrefixedName("TransitionEnd"),
POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTERCANCEL:"pointercancel",POINTERMOVE:"pointermove",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",GOTPOINTERCAPTURE:"gotpointercapture",LOSTPOINTERCAPTURE:"lostpointercapture",MSGESTURECHANGE:"MSGestureChange",MSGESTUREEND:"MSGestureEnd",MSGESTUREHOLD:"MSGestureHold",MSGESTURESTART:"MSGestureStart",MSGESTURETAP:"MSGestureTap",MSGOTPOINTERCAPTURE:"MSGotPointerCapture",MSINERTIASTART:"MSInertiaStart",
MSLOSTPOINTERCAPTURE:"MSLostPointerCapture",MSPOINTERCANCEL:"MSPointerCancel",MSPOINTERDOWN:"MSPointerDown",MSPOINTERENTER:"MSPointerEnter",MSPOINTERHOVER:"MSPointerHover",MSPOINTERLEAVE:"MSPointerLeave",MSPOINTERMOVE:"MSPointerMove",MSPOINTEROUT:"MSPointerOut",MSPOINTEROVER:"MSPointerOver",MSPOINTERUP:"MSPointerUp",TEXT:"text",TEXTINPUT:goog.userAgent.IE?"textinput":"textInput",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend",BEFOREINPUT:"beforeinput",
FULLSCREENCHANGE:"fullscreenchange",WEBKITBEGINFULLSCREEN:"webkitbeginfullscreen",WEBKITENDFULLSCREEN:"webkitendfullscreen",EXIT:"exit",LOADABORT:"loadabort",LOADCOMMIT:"loadcommit",LOADREDIRECT:"loadredirect",LOADSTART:"loadstart",LOADSTOP:"loadstop",RESPONSIVE:"responsive",SIZECHANGED:"sizechanged",UNRESPONSIVE:"unresponsive",VISIBILITYCHANGE:"visibilitychange",STORAGE:"storage",DOMSUBTREEMODIFIED:"DOMSubtreeModified",DOMNODEINSERTED:"DOMNodeInserted",DOMNODEREMOVED:"DOMNodeRemoved",DOMNODEREMOVEDFROMDOCUMENT:"DOMNodeRemovedFromDocument",
DOMNODEINSERTEDINTODOCUMENT:"DOMNodeInsertedIntoDocument",DOMATTRMODIFIED:"DOMAttrModified",DOMCHARACTERDATAMODIFIED:"DOMCharacterDataModified",BEFOREPRINT:"beforeprint",AFTERPRINT:"afterprint",BEFOREINSTALLPROMPT:"beforeinstallprompt",APPINSTALLED:"appinstalled",CANCEL:"cancel",FINISH:"finish",REMOVE:"remove"};goog.provide("goog.events.BrowserEvent");goog.provide("goog.events.BrowserEvent.MouseButton");goog.provide("goog.events.BrowserEvent.PointerType");goog.require("goog.debug");goog.require("goog.events.Event");goog.require("goog.events.EventType");goog.require("goog.reflect");goog.require("goog.userAgent");
goog.events.BrowserEvent=function(opt_e,opt_currentTarget){goog.events.BrowserEvent.base(this,"constructor",opt_e?opt_e.type:"");this.target=null;this.currentTarget=null;this.relatedTarget=null;this.offsetX=0;this.offsetY=0;this.clientX=0;this.clientY=0;this.screenX=0;this.screenY=0;this.button=0;this.key="";this.keyCode=0;this.charCode=0;this.ctrlKey=false;this.altKey=false;this.shiftKey=false;this.metaKey=false;this.state=null;this.platformModifierKey=false;this.pointerId=0;this.pointerType="";
this.event_=null;if(opt_e)this.init(opt_e,opt_currentTarget)};goog.inherits(goog.events.BrowserEvent,goog.events.Event);goog.events.BrowserEvent.USE_LAYER_XY_AS_OFFSET_XY=goog.define("goog.events.BrowserEvent.USE_LAYER_XY_AS_OFFSET_XY",false);goog.events.BrowserEvent.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2,BACK:3,FORWARD:4};goog.events.BrowserEvent.PointerType={MOUSE:"mouse",PEN:"pen",TOUCH:"touch"};goog.events.BrowserEvent.IEButtonMap=goog.debug.freeze([1,4,2]);
goog.events.BrowserEvent.IE_BUTTON_MAP=goog.events.BrowserEvent.IEButtonMap;goog.events.BrowserEvent.IE_POINTER_TYPE_MAP=goog.debug.freeze({2:goog.events.BrowserEvent.PointerType.TOUCH,3:goog.events.BrowserEvent.PointerType.PEN,4:goog.events.BrowserEvent.PointerType.MOUSE});
goog.events.BrowserEvent.prototype.init=function(e,opt_currentTarget){var type=this.type=e.type;var relevantTouch=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement;this.currentTarget=opt_currentTarget;var relatedTarget=e.relatedTarget;if(relatedTarget){if(goog.userAgent.GECKO)if(!goog.reflect.canAccessProperty(relatedTarget,"nodeName"))relatedTarget=null}else if(type==goog.events.EventType.MOUSEOVER)relatedTarget=e.fromElement;else if(type==goog.events.EventType.MOUSEOUT)relatedTarget=
e.toElement;this.relatedTarget=relatedTarget;if(relevantTouch){this.clientX=relevantTouch.clientX!==undefined?relevantTouch.clientX:relevantTouch.pageX;this.clientY=relevantTouch.clientY!==undefined?relevantTouch.clientY:relevantTouch.pageY;this.screenX=relevantTouch.screenX||0;this.screenY=relevantTouch.screenY||0}else{if(goog.events.BrowserEvent.USE_LAYER_XY_AS_OFFSET_XY){this.offsetX=e.layerX!==undefined?e.layerX:e.offsetX;this.offsetY=e.layerY!==undefined?e.layerY:e.offsetY}else{this.offsetX=
goog.userAgent.WEBKIT||e.offsetX!==undefined?e.offsetX:e.layerX;this.offsetY=goog.userAgent.WEBKIT||e.offsetY!==undefined?e.offsetY:e.layerY}this.clientX=e.clientX!==undefined?e.clientX:e.pageX;this.clientY=e.clientY!==undefined?e.clientY:e.pageY;this.screenX=e.screenX||0;this.screenY=e.screenY||0}this.button=e.button;this.keyCode=e.keyCode||0;this.key=e.key||"";this.charCode=e.charCode||(type=="keypress"?e.keyCode:0);this.ctrlKey=e.ctrlKey;this.altKey=e.altKey;this.shiftKey=e.shiftKey;this.metaKey=
e.metaKey;this.platformModifierKey=goog.userAgent.MAC?e.metaKey:e.ctrlKey;this.pointerId=e.pointerId||0;this.pointerType=goog.events.BrowserEvent.getPointerType_(e);this.state=e.state;this.event_=e;if(e.defaultPrevented)goog.events.BrowserEvent.superClass_.preventDefault.call(this)};goog.events.BrowserEvent.prototype.isButton=function(button){return this.event_.button==button};
goog.events.BrowserEvent.prototype.isMouseActionButton=function(){return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT)&&!(goog.userAgent.MAC&&this.ctrlKey)};goog.events.BrowserEvent.prototype.stopPropagation=function(){goog.events.BrowserEvent.superClass_.stopPropagation.call(this);if(this.event_.stopPropagation)this.event_.stopPropagation();else this.event_.cancelBubble=true};
goog.events.BrowserEvent.prototype.preventDefault=function(){goog.events.BrowserEvent.superClass_.preventDefault.call(this);var be=this.event_;if(!be.preventDefault)be.returnValue=false;else be.preventDefault()};goog.events.BrowserEvent.prototype.getBrowserEvent=function(){return this.event_};goog.events.BrowserEvent.getPointerType_=function(e){if(typeof e.pointerType==="string")return e.pointerType;return goog.events.BrowserEvent.IE_POINTER_TYPE_MAP[e.pointerType]||""};goog.provide("goog.events.Listenable");goog.requireType("goog.events.EventId");goog.requireType("goog.events.EventLike");goog.requireType("goog.events.ListenableKey");goog.events.Listenable=function(){};goog.events.Listenable.IMPLEMENTED_BY_PROP="closure_listenable_"+(Math.random()*1E6|0);goog.events.Listenable.addImplementation=function(cls){cls.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP]=true};goog.events.Listenable.isImplementedBy=function(obj){return!!(obj&&obj[goog.events.Listenable.IMPLEMENTED_BY_PROP])};
goog.events.Listenable.prototype.listen=function(type,listener,opt_useCapture,opt_listenerScope){};goog.events.Listenable.prototype.listenOnce=function(type,listener,opt_useCapture,opt_listenerScope){};goog.events.Listenable.prototype.unlisten=function(type,listener,opt_useCapture,opt_listenerScope){};goog.events.Listenable.prototype.unlistenByKey=function(key){};goog.events.Listenable.prototype.dispatchEvent=function(e){};goog.events.Listenable.prototype.removeAllListeners=function(opt_type){};
goog.events.Listenable.prototype.getParentEventTarget=function(){};goog.events.Listenable.prototype.fireListeners=function(type,capture,eventObject){};goog.events.Listenable.prototype.getListeners=function(type,capture){};goog.events.Listenable.prototype.getListener=function(type,listener,capture,opt_listenerScope){};goog.events.Listenable.prototype.hasListener=function(opt_type,opt_capture){};goog.provide("goog.events.ListenableKey");goog.requireType("goog.events.Listenable");goog.events.ListenableKey=function(){};goog.events.ListenableKey.counter_=0;goog.events.ListenableKey.reserveKey=function(){return++goog.events.ListenableKey.counter_};goog.events.ListenableKey.prototype.src;goog.events.ListenableKey.prototype.type;goog.events.ListenableKey.prototype.listener;goog.events.ListenableKey.prototype.capture;goog.events.ListenableKey.prototype.handler;goog.events.ListenableKey.prototype.key;goog.provide("goog.events.Listener");goog.require("goog.events.ListenableKey");goog.requireType("goog.events.Listenable");goog.events.Listener=function(listener,proxy,src,type,capture,opt_handler){if(goog.events.Listener.ENABLE_MONITORING)this.creationStack=(new Error).stack;this.listener=listener;this.proxy=proxy;this.src=src;this.type=type;this.capture=!!capture;this.handler=opt_handler;this.key=goog.events.ListenableKey.reserveKey();this.callOnce=false;this.removed=false};
goog.events.Listener.ENABLE_MONITORING=goog.define("goog.events.Listener.ENABLE_MONITORING",false);goog.events.Listener.prototype.creationStack;goog.events.Listener.prototype.markAsRemoved=function(){this.removed=true;this.listener=null;this.proxy=null;this.src=null;this.handler=null};goog.loadModule(function(exports){"use strict";goog.module("goog.object");goog.module.declareLegacyNamespace();function forEach(obj,f,opt_obj){for(const key in obj)f.call(opt_obj,obj[key],key,obj)}function filter(obj,f,opt_obj){const res={};for(const key in obj)if(f.call(opt_obj,obj[key],key,obj))res[key]=obj[key];return res}function map(obj,f,opt_obj){const res={};for(const key in obj)res[key]=f.call(opt_obj,obj[key],key,obj);return res}function some(obj,f,opt_obj){for(const key in obj)if(f.call(opt_obj,
obj[key],key,obj))return true;return false}function every(obj,f,opt_obj){for(const key in obj)if(!f.call(opt_obj,obj[key],key,obj))return false;return true}function getCount(obj){let rv=0;for(const key in obj)rv++;return rv}function getAnyKey(obj){for(const key in obj)return key}function getAnyValue(obj){for(const key in obj)return obj[key]}function contains(obj,val){return containsValue(obj,val)}function getValues(obj){const res=[];let i=0;for(const key in obj)res[i++]=obj[key];return res}function getKeys(obj){const res=
[];let i=0;for(const key in obj)res[i++]=key;return res}function getValueByKeys(obj,var_args){const isArrayLike=goog.isArrayLike(var_args);const keys=isArrayLike?var_args:arguments;for(let i=isArrayLike?0:1;i<keys.length;i++){if(obj==null)return undefined;obj=obj[keys[i]]}return obj}function containsKey(obj,key){return obj!==null&&key in obj}function containsValue(obj,val){for(const key in obj)if(obj[key]==val)return true;return false}function findKey(obj,f,thisObj=undefined){for(const key in obj)if(f.call(thisObj,
obj[key],key,obj))return key;return undefined}function findValue(obj,f,thisObj=undefined){const key=findKey(obj,f,thisObj);return key&&obj[key]}function isEmpty(obj){for(const key in obj)return false;return true}function clear(obj){for(const i in obj)delete obj[i]}function remove(obj,key){let rv;if(rv=key in obj)delete obj[key];return rv}function add(obj,key,val){if(obj!==null&&key in obj)throw new Error(`The object already contains the key "${key}"`);set(obj,key,val)}function get(obj,key,val=undefined){if(obj!==
null&&key in obj)return obj[key];return val}function set(obj,key,value){obj[key]=value}function setIfUndefined(obj,key,value){return key in obj?obj[key]:obj[key]=value}function setWithReturnValueIfNotSet(obj,key,f){if(key in obj)return obj[key];const val=f();obj[key]=val;return val}function equals(a,b){for(const k in a)if(!(k in b)||a[k]!==b[k])return false;for(const k in b)if(!(k in a))return false;return true}function clone(obj){const res={};for(const key in obj)res[key]=obj[key];return res}function unsafeClone(obj){if(!obj||
typeof obj!=="object")return obj;if(typeof obj.clone==="function")return obj.clone();if(typeof Map!=="undefined"&&obj instanceof Map)return new Map(obj);else if(typeof Set!=="undefined"&&obj instanceof Set)return new Set(obj);else if(obj instanceof Date)return new Date(obj.getTime());const clone=Array.isArray(obj)?[]:typeof ArrayBuffer==="function"&&typeof ArrayBuffer.isView==="function"&&ArrayBuffer.isView(obj)&&!(obj instanceof DataView)?new obj.constructor(obj.length):{};for(const key in obj)clone[key]=
unsafeClone(obj[key]);return clone}function transpose(obj){const transposed={};for(const key in obj)transposed[obj[key]]=key;return transposed}const PROTOTYPE_FIELDS=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];function extend(target,var_args){let key;let source;for(let i=1;i<arguments.length;i++){source=arguments[i];for(key in source)target[key]=source[key];for(let j=0;j<PROTOTYPE_FIELDS.length;j++){key=PROTOTYPE_FIELDS[j];if(Object.prototype.hasOwnProperty.call(source,
key))target[key]=source[key]}}}function create(var_args){const argLength=arguments.length;if(argLength==1&&Array.isArray(arguments[0]))return create.apply(null,arguments[0]);if(argLength%2)throw new Error("Uneven number of arguments");const rv={};for(let i=0;i<argLength;i+=2)rv[arguments[i]]=arguments[i+1];return rv}function createSet(var_args){const argLength=arguments.length;if(argLength==1&&Array.isArray(arguments[0]))return createSet.apply(null,arguments[0]);const rv={};for(let i=0;i<argLength;i++)rv[arguments[i]]=
true;return rv}function createImmutableView(obj){let result=obj;if(Object.isFrozen&&!Object.isFrozen(obj)){result=Object.create(obj);Object.freeze(result)}return result}function isImmutableView(obj){return!!Object.isFrozen&&Object.isFrozen(obj)}function getAllPropertyNames(obj,includeObjectPrototype=undefined,includeFunctionPrototype=undefined){if(!obj)return[];if(!Object.getOwnPropertyNames||!Object.getPrototypeOf)return getKeys(obj);const visitedSet={};let proto=obj;while(proto&&(proto!==Object.prototype||
!!includeObjectPrototype)&&(proto!==Function.prototype||!!includeFunctionPrototype)){const names=Object.getOwnPropertyNames(proto);for(let i=0;i<names.length;i++)visitedSet[names[i]]=true;proto=Object.getPrototypeOf(proto)}return getKeys(visitedSet)}function getSuperClass(constructor){const proto=Object.getPrototypeOf(constructor.prototype);return proto&&proto.constructor}exports={add,clear,clone,contains,containsKey,containsValue,create,createImmutableView,createSet,equals,every,extend,filter,findKey,
findValue,forEach,get,getAllPropertyNames,getAnyKey,getAnyValue,getCount,getKeys,getSuperClass,getValueByKeys,getValues,isEmpty,isImmutableView,map,remove,set,setIfUndefined,setWithReturnValueIfNotSet,some,transpose,unsafeClone};return exports});goog.provide("goog.events.ListenerMap");goog.require("goog.array");goog.require("goog.events.Listener");goog.require("goog.object");goog.requireType("goog.events.EventId");goog.requireType("goog.events.Listenable");goog.requireType("goog.events.ListenableKey");goog.events.ListenerMap=function(src){this.src=src;this.listeners={};this.typeCount_=0};goog.events.ListenerMap.prototype.getTypeCount=function(){return this.typeCount_};
goog.events.ListenerMap.prototype.getListenerCount=function(){var count=0;for(var type in this.listeners)count+=this.listeners[type].length;return count};
goog.events.ListenerMap.prototype.add=function(type,listener,callOnce,opt_useCapture,opt_listenerScope){var typeStr=type.toString();var listenerArray=this.listeners[typeStr];if(!listenerArray){listenerArray=this.listeners[typeStr]=[];this.typeCount_++}var listenerObj;var index=goog.events.ListenerMap.findListenerIndex_(listenerArray,listener,opt_useCapture,opt_listenerScope);if(index>-1){listenerObj=listenerArray[index];if(!callOnce)listenerObj.callOnce=false}else{listenerObj=new goog.events.Listener(listener,
null,this.src,typeStr,!!opt_useCapture,opt_listenerScope);listenerObj.callOnce=callOnce;listenerArray.push(listenerObj)}return listenerObj};
goog.events.ListenerMap.prototype.remove=function(type,listener,opt_useCapture,opt_listenerScope){var typeStr=type.toString();if(!(typeStr in this.listeners))return false;var listenerArray=this.listeners[typeStr];var index=goog.events.ListenerMap.findListenerIndex_(listenerArray,listener,opt_useCapture,opt_listenerScope);if(index>-1){var listenerObj=listenerArray[index];listenerObj.markAsRemoved();goog.array.removeAt(listenerArray,index);if(listenerArray.length==0){delete this.listeners[typeStr];
this.typeCount_--}return true}return false};goog.events.ListenerMap.prototype.removeByKey=function(listener){var type=listener.type;if(!(type in this.listeners))return false;var removed=goog.array.remove(this.listeners[type],listener);if(removed){listener.markAsRemoved();if(this.listeners[type].length==0){delete this.listeners[type];this.typeCount_--}}return removed};
goog.events.ListenerMap.prototype.removeAll=function(opt_type){var typeStr=opt_type&&opt_type.toString();var count=0;for(var type in this.listeners)if(!typeStr||type==typeStr){var listenerArray=this.listeners[type];for(var i=0;i<listenerArray.length;i++){++count;listenerArray[i].markAsRemoved()}delete this.listeners[type];this.typeCount_--}return count};
goog.events.ListenerMap.prototype.getListeners=function(type,capture){var listenerArray=this.listeners[type.toString()];var rv=[];if(listenerArray)for(var i=0;i<listenerArray.length;++i){var listenerObj=listenerArray[i];if(listenerObj.capture==capture)rv.push(listenerObj)}return rv};
goog.events.ListenerMap.prototype.getListener=function(type,listener,capture,opt_listenerScope){var listenerArray=this.listeners[type.toString()];var i=-1;if(listenerArray)i=goog.events.ListenerMap.findListenerIndex_(listenerArray,listener,capture,opt_listenerScope);return i>-1?listenerArray[i]:null};
goog.events.ListenerMap.prototype.hasListener=function(opt_type,opt_capture){var hasType=opt_type!==undefined;var typeStr=hasType?opt_type.toString():"";var hasCapture=opt_capture!==undefined;return goog.object.some(this.listeners,function(listenerArray,type){for(var i=0;i<listenerArray.length;++i)if((!hasType||listenerArray[i].type==typeStr)&&(!hasCapture||listenerArray[i].capture==opt_capture))return true;return false})};
goog.events.ListenerMap.findListenerIndex_=function(listenerArray,listener,opt_useCapture,opt_listenerScope){for(var i=0;i<listenerArray.length;++i){var listenerObj=listenerArray[i];if(!listenerObj.removed&&listenerObj.listener==listener&&listenerObj.capture==!!opt_useCapture&&listenerObj.handler==opt_listenerScope)return i}return-1};goog.provide("goog.events");goog.provide("goog.events.CaptureSimulationMode");goog.provide("goog.events.Key");goog.provide("goog.events.ListenableType");goog.require("goog.asserts");goog.require("goog.debug.entryPointRegistry");goog.require("goog.events.BrowserEvent");goog.require("goog.events.BrowserFeature");goog.require("goog.events.Listenable");goog.require("goog.events.ListenerMap");goog.requireType("goog.debug.ErrorHandler");goog.requireType("goog.events.EventId");goog.requireType("goog.events.EventLike");
goog.requireType("goog.events.EventWrapper");goog.requireType("goog.events.ListenableKey");goog.requireType("goog.events.Listener");goog.events.Key;goog.events.ListenableType;goog.events.LISTENER_MAP_PROP_="closure_lm_"+(Math.random()*1E6|0);goog.events.onString_="on";goog.events.onStringMap_={};goog.events.CaptureSimulationMode={OFF_AND_FAIL:0,OFF_AND_SILENT:1,ON:2};goog.events.CAPTURE_SIMULATION_MODE=goog.define("goog.events.CAPTURE_SIMULATION_MODE",2);goog.events.listenerCountEstimate_=0;
goog.events.listen=function(src,type,listener,opt_options,opt_handler){if(opt_options&&opt_options.once)return goog.events.listenOnce(src,type,listener,opt_options,opt_handler);if(Array.isArray(type)){for(var i=0;i<type.length;i++)goog.events.listen(src,type[i],listener,opt_options,opt_handler);return null}listener=goog.events.wrapListener(listener);if(goog.events.Listenable.isImplementedBy(src)){var capture=goog.isObject(opt_options)?!!opt_options.capture:!!opt_options;return src.listen(type,listener,
capture,opt_handler)}else return goog.events.listen_(src,type,listener,false,opt_options,opt_handler)};
goog.events.listen_=function(src,type,listener,callOnce,opt_options,opt_handler){if(!type)throw new Error("Invalid event type");var capture=goog.isObject(opt_options)?!!opt_options.capture:!!opt_options;var listenerMap=goog.events.getListenerMap_(src);if(!listenerMap)src[goog.events.LISTENER_MAP_PROP_]=listenerMap=new goog.events.ListenerMap(src);var listenerObj=listenerMap.add(type,listener,callOnce,capture,opt_handler);if(listenerObj.proxy)return listenerObj;var proxy=goog.events.getProxy();listenerObj.proxy=
proxy;proxy.src=src;proxy.listener=listenerObj;if(src.addEventListener){if(!goog.events.BrowserFeature.PASSIVE_EVENTS)opt_options=capture;if(opt_options===undefined)opt_options=false;src.addEventListener(type.toString(),proxy,opt_options)}else if(src.attachEvent)src.attachEvent(goog.events.getOnString_(type.toString()),proxy);else if(src.addListener&&src.removeListener){goog.asserts.assert(type==="change","MediaQueryList only has a change event");src.addListener(proxy)}else throw new Error("addEventListener and attachEvent are unavailable.");
goog.events.listenerCountEstimate_++;return listenerObj};goog.events.getProxy=function(){const proxyCallbackFunction=goog.events.handleBrowserEvent_;const f=function(eventObject){return proxyCallbackFunction.call(f.src,f.listener,eventObject)};return f};
goog.events.listenOnce=function(src,type,listener,opt_options,opt_handler){if(Array.isArray(type)){for(var i=0;i<type.length;i++)goog.events.listenOnce(src,type[i],listener,opt_options,opt_handler);return null}listener=goog.events.wrapListener(listener);if(goog.events.Listenable.isImplementedBy(src)){var capture=goog.isObject(opt_options)?!!opt_options.capture:!!opt_options;return src.listenOnce(type,listener,capture,opt_handler)}else return goog.events.listen_(src,type,listener,true,opt_options,
opt_handler)};goog.events.listenWithWrapper=function(src,wrapper,listener,opt_capt,opt_handler){wrapper.listen(src,listener,opt_capt,opt_handler)};
goog.events.unlisten=function(src,type,listener,opt_options,opt_handler){if(Array.isArray(type)){for(var i=0;i<type.length;i++)goog.events.unlisten(src,type[i],listener,opt_options,opt_handler);return null}var capture=goog.isObject(opt_options)?!!opt_options.capture:!!opt_options;listener=goog.events.wrapListener(listener);if(goog.events.Listenable.isImplementedBy(src))return src.unlisten(type,listener,capture,opt_handler);if(!src)return false;var listenerMap=goog.events.getListenerMap_(src);if(listenerMap){var listenerObj=
listenerMap.getListener(type,listener,capture,opt_handler);if(listenerObj)return goog.events.unlistenByKey(listenerObj)}return false};
goog.events.unlistenByKey=function(key){if(typeof key==="number")return false;var listener=key;if(!listener||listener.removed)return false;var src=listener.src;if(goog.events.Listenable.isImplementedBy(src))return src.unlistenByKey(listener);var type=listener.type;var proxy=listener.proxy;if(src.removeEventListener)src.removeEventListener(type,proxy,listener.capture);else if(src.detachEvent)src.detachEvent(goog.events.getOnString_(type),proxy);else if(src.addListener&&src.removeListener)src.removeListener(proxy);
goog.events.listenerCountEstimate_--;var listenerMap=goog.events.getListenerMap_(src);if(listenerMap){listenerMap.removeByKey(listener);if(listenerMap.getTypeCount()==0){listenerMap.src=null;src[goog.events.LISTENER_MAP_PROP_]=null}}else listener.markAsRemoved();return true};goog.events.unlistenWithWrapper=function(src,wrapper,listener,opt_capt,opt_handler){wrapper.unlisten(src,listener,opt_capt,opt_handler)};
goog.events.removeAll=function(obj,opt_type){if(!obj)return 0;if(goog.events.Listenable.isImplementedBy(obj))return obj.removeAllListeners(opt_type);var listenerMap=goog.events.getListenerMap_(obj);if(!listenerMap)return 0;var count=0;var typeStr=opt_type&&opt_type.toString();for(var type in listenerMap.listeners)if(!typeStr||type==typeStr){var listeners=listenerMap.listeners[type].concat();for(var i=0;i<listeners.length;++i)if(goog.events.unlistenByKey(listeners[i]))++count}return count};
goog.events.getListeners=function(obj,type,capture){if(goog.events.Listenable.isImplementedBy(obj))return obj.getListeners(type,capture);else{if(!obj)return[];var listenerMap=goog.events.getListenerMap_(obj);return listenerMap?listenerMap.getListeners(type,capture):[]}};
goog.events.getListener=function(src,type,listener,opt_capt,opt_handler){type=type;listener=goog.events.wrapListener(listener);var capture=!!opt_capt;if(goog.events.Listenable.isImplementedBy(src))return src.getListener(type,listener,capture,opt_handler);if(!src)return null;var listenerMap=goog.events.getListenerMap_(src);if(listenerMap)return listenerMap.getListener(type,listener,capture,opt_handler);return null};
goog.events.hasListener=function(obj,opt_type,opt_capture){if(goog.events.Listenable.isImplementedBy(obj))return obj.hasListener(opt_type,opt_capture);var listenerMap=goog.events.getListenerMap_(obj);return!!listenerMap&&listenerMap.hasListener(opt_type,opt_capture)};goog.events.expose=function(e){var str=[];for(var key in e)if(e[key]&&e[key].id)str.push(key+" = "+e[key]+" ("+e[key].id+")");else str.push(key+" = "+e[key]);return str.join("\n")};
goog.events.getOnString_=function(type){if(type in goog.events.onStringMap_)return goog.events.onStringMap_[type];return goog.events.onStringMap_[type]=goog.events.onString_+type};goog.events.fireListeners=function(obj,type,capture,eventObject){if(goog.events.Listenable.isImplementedBy(obj))return obj.fireListeners(type,capture,eventObject);return goog.events.fireListeners_(obj,type,capture,eventObject)};
goog.events.fireListeners_=function(obj,type,capture,eventObject){var retval=true;var listenerMap=goog.events.getListenerMap_(obj);if(listenerMap){var listenerArray=listenerMap.listeners[type.toString()];if(listenerArray){listenerArray=listenerArray.concat();for(var i=0;i<listenerArray.length;i++){var listener=listenerArray[i];if(listener&&listener.capture==capture&&!listener.removed){var result=goog.events.fireListener(listener,eventObject);retval=retval&&result!==false}}}}return retval};
goog.events.fireListener=function(listener,eventObject){var listenerFn=listener.listener;var listenerHandler=listener.handler||listener.src;if(listener.callOnce)goog.events.unlistenByKey(listener);return listenerFn.call(listenerHandler,eventObject)};goog.events.getTotalListenerCount=function(){return goog.events.listenerCountEstimate_};
goog.events.dispatchEvent=function(src,e){goog.asserts.assert(goog.events.Listenable.isImplementedBy(src),"Can not use goog.events.dispatchEvent with "+"non-goog.events.Listenable instance.");return src.dispatchEvent(e)};goog.events.protectBrowserEventEntryPoint=function(errorHandler){goog.events.handleBrowserEvent_=errorHandler.protectEntryPoint(goog.events.handleBrowserEvent_)};
goog.events.handleBrowserEvent_=function(listener,opt_evt){if(listener.removed)return true;return goog.events.fireListener(listener,new goog.events.BrowserEvent(opt_evt,this))};goog.events.markIeEvent_=function(e){var useReturnValue=false;if(e.keyCode==0)try{e.keyCode=-1;return}catch(ex){useReturnValue=true}if(useReturnValue||e.returnValue==undefined)e.returnValue=true};goog.events.isMarkedIeEvent_=function(e){return e.keyCode<0||e.returnValue!=undefined};goog.events.uniqueIdCounter_=0;
goog.events.getUniqueId=function(identifier){return identifier+"_"+goog.events.uniqueIdCounter_++};goog.events.getListenerMap_=function(src){var listenerMap=src[goog.events.LISTENER_MAP_PROP_];return listenerMap instanceof goog.events.ListenerMap?listenerMap:null};goog.events.LISTENER_WRAPPER_PROP_="__closure_events_fn_"+(Math.random()*1E9>>>0);
goog.events.wrapListener=function(listener){goog.asserts.assert(listener,"Listener can not be null.");if(typeof listener==="function")return listener;goog.asserts.assert(listener.handleEvent,"An object listener must have handleEvent method.");if(!listener[goog.events.LISTENER_WRAPPER_PROP_])listener[goog.events.LISTENER_WRAPPER_PROP_]=function(e){return listener.handleEvent(e)};return listener[goog.events.LISTENER_WRAPPER_PROP_]};
goog.debug.entryPointRegistry.register(function(transformer){goog.events.handleBrowserEvent_=transformer(goog.events.handleBrowserEvent_)});goog.provide("goog.math");goog.require("goog.asserts");goog.math.randomInt=function(a){return Math.floor(Math.random()*a)};goog.math.uniformRandom=function(a,b){return a+Math.random()*(b-a)};goog.math.clamp=function(value,min,max){return Math.min(Math.max(value,min),max)};goog.math.modulo=function(a,b){var r=a%b;return r*b<0?r+b:r};goog.math.lerp=function(a,b,x){return a+x*(b-a)};goog.math.nearlyEquals=function(a,b,opt_tolerance){return Math.abs(a-b)<=(opt_tolerance||1E-6)};
goog.math.standardAngle=function(angle){return goog.math.modulo(angle,360)};goog.math.standardAngleInRadians=function(angle){return goog.math.modulo(angle,2*Math.PI)};goog.math.toRadians=function(angleDegrees){return angleDegrees*Math.PI/180};goog.math.toDegrees=function(angleRadians){return angleRadians*180/Math.PI};goog.math.angleDx=function(degrees,radius){return radius*Math.cos(goog.math.toRadians(degrees))};goog.math.angleDy=function(degrees,radius){return radius*Math.sin(goog.math.toRadians(degrees))};
goog.math.angle=function(x1,y1,x2,y2){return goog.math.standardAngle(goog.math.toDegrees(Math.atan2(y2-y1,x2-x1)))};goog.math.angleDifference=function(startAngle,endAngle){var d=goog.math.standardAngle(endAngle)-goog.math.standardAngle(startAngle);if(d>180)d=d-360;else if(d<=-180)d=360+d;return d};goog.math.sign=function(x){if(x>0)return 1;if(x<0)return-1;return x};
goog.math.longestCommonSubsequence=function(array1,array2,opt_compareFn,opt_collectorFn){var compare=opt_compareFn||function(a,b){return a==b};var collect=opt_collectorFn||function(i1,i2){return array1[i1]};var length1=array1.length;var length2=array2.length;var arr=[];for(var i=0;i<length1+1;i++){arr[i]=[];arr[i][0]=0}for(var j=0;j<length2+1;j++)arr[0][j]=0;for(i=1;i<=length1;i++)for(j=1;j<=length2;j++)if(compare(array1[i-1],array2[j-1]))arr[i][j]=arr[i-1][j-1]+1;else arr[i][j]=Math.max(arr[i-1][j],
arr[i][j-1]);var result=[];var i=length1,j=length2;while(i>0&&j>0)if(compare(array1[i-1],array2[j-1])){result.unshift(collect(i-1,j-1));i--;j--}else if(arr[i-1][j]>arr[i][j-1])i--;else j--;return result};goog.math.sum=function(var_args){return Array.prototype.reduce.call(arguments,function(sum,value){return sum+value},0)};goog.math.average=function(var_args){return goog.math.sum.apply(null,arguments)/arguments.length};
goog.math.sampleVariance=function(var_args){var sampleSize=arguments.length;if(sampleSize<2)return 0;var mean=goog.math.average.apply(null,arguments);var variance=goog.math.sum.apply(null,Array.prototype.map.call(arguments,function(val){return Math.pow(val-mean,2)}))/(sampleSize-1);return variance};goog.math.standardDeviation=function(var_args){return Math.sqrt(goog.math.sampleVariance.apply(null,arguments))};goog.math.isInt=function(num){return isFinite(num)&&num%1==0};goog.math.isFiniteNumber=function(num){return isFinite(num)};
goog.math.isNegativeZero=function(num){return num==0&&1/num<0};goog.math.log10Floor=function(num){if(num>0){var x=Math.round(Math.log(num)*Math.LOG10E);return x-(parseFloat("1e"+x)>num?1:0)}return num==0?-Infinity:NaN};goog.math.safeFloor=function(num,opt_epsilon){goog.asserts.assert(opt_epsilon===undefined||opt_epsilon>0);return Math.floor(num+(opt_epsilon||2E-15))};
goog.math.safeCeil=function(num,opt_epsilon){goog.asserts.assert(opt_epsilon===undefined||opt_epsilon>0);return Math.ceil(num-(opt_epsilon||2E-15))};goog.provide("goog.math.Coordinate");goog.require("goog.math");goog.math.Coordinate=function(opt_x,opt_y){this.x=opt_x!==undefined?opt_x:0;this.y=opt_y!==undefined?opt_y:0};goog.math.Coordinate.prototype.clone=function(){return new goog.math.Coordinate(this.x,this.y)};if(goog.DEBUG)goog.math.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"};
goog.math.Coordinate.prototype.equals=function(other){return other instanceof goog.math.Coordinate&&goog.math.Coordinate.equals(this,other)};goog.math.Coordinate.equals=function(a,b){if(a==b)return true;if(!a||!b)return false;return a.x==b.x&&a.y==b.y};goog.math.Coordinate.distance=function(a,b){var dx=a.x-b.x;var dy=a.y-b.y;return Math.sqrt(dx*dx+dy*dy)};goog.math.Coordinate.magnitude=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)};
goog.math.Coordinate.azimuth=function(a){return goog.math.angle(0,0,a.x,a.y)};goog.math.Coordinate.squaredDistance=function(a,b){var dx=a.x-b.x;var dy=a.y-b.y;return dx*dx+dy*dy};goog.math.Coordinate.difference=function(a,b){return new goog.math.Coordinate(a.x-b.x,a.y-b.y)};goog.math.Coordinate.sum=function(a,b){return new goog.math.Coordinate(a.x+b.x,a.y+b.y)};goog.math.Coordinate.prototype.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};
goog.math.Coordinate.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};goog.math.Coordinate.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};goog.math.Coordinate.prototype.translate=function(tx,opt_ty){if(tx instanceof goog.math.Coordinate){this.x+=tx.x;this.y+=tx.y}else{this.x+=Number(tx);if(typeof opt_ty==="number")this.y+=opt_ty}return this};
goog.math.Coordinate.prototype.scale=function(sx,opt_sy){var sy=typeof opt_sy==="number"?opt_sy:sx;this.x*=sx;this.y*=sy;return this};goog.math.Coordinate.prototype.rotateRadians=function(radians,opt_center){var center=opt_center||new goog.math.Coordinate(0,0);var x=this.x;var y=this.y;var cos=Math.cos(radians);var sin=Math.sin(radians);this.x=(x-center.x)*cos-(y-center.y)*sin+center.x;this.y=(x-center.x)*sin+(y-center.y)*cos+center.y};
goog.math.Coordinate.prototype.rotateDegrees=function(degrees,opt_center){this.rotateRadians(goog.math.toRadians(degrees),opt_center)};goog.provide("goog.math.Box");goog.require("goog.asserts");goog.require("goog.math.Coordinate");goog.math.Box=function(top,right,bottom,left){this.top=top;this.right=right;this.bottom=bottom;this.left=left};goog.math.Box.boundingBox=function(var_args){var box=new goog.math.Box(arguments[0].y,arguments[0].x,arguments[0].y,arguments[0].x);for(var i=1;i<arguments.length;i++)box.expandToIncludeCoordinate(arguments[i]);return box};goog.math.Box.prototype.getWidth=function(){return this.right-this.left};
goog.math.Box.prototype.getHeight=function(){return this.bottom-this.top};goog.math.Box.prototype.clone=function(){return new goog.math.Box(this.top,this.right,this.bottom,this.left)};if(goog.DEBUG)goog.math.Box.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};goog.math.Box.prototype.contains=function(other){return goog.math.Box.contains(this,other)};
goog.math.Box.prototype.expand=function(top,opt_right,opt_bottom,opt_left){if(goog.isObject(top)){this.top-=top.top;this.right+=top.right;this.bottom+=top.bottom;this.left-=top.left}else{this.top-=top;this.right+=Number(opt_right);this.bottom+=Number(opt_bottom);this.left-=Number(opt_left)}return this};
goog.math.Box.prototype.expandToInclude=function(box){this.left=Math.min(this.left,box.left);this.top=Math.min(this.top,box.top);this.right=Math.max(this.right,box.right);this.bottom=Math.max(this.bottom,box.bottom)};goog.math.Box.prototype.expandToIncludeCoordinate=function(coord){this.top=Math.min(this.top,coord.y);this.right=Math.max(this.right,coord.x);this.bottom=Math.max(this.bottom,coord.y);this.left=Math.min(this.left,coord.x)};
goog.math.Box.equals=function(a,b){if(a==b)return true;if(!a||!b)return false;return a.top==b.top&&a.right==b.right&&a.bottom==b.bottom&&a.left==b.left};goog.math.Box.contains=function(box,other){if(!box||!other)return false;if(other instanceof goog.math.Box)return other.left>=box.left&&other.right<=box.right&&other.top>=box.top&&other.bottom<=box.bottom;return other.x>=box.left&&other.x<=box.right&&other.y>=box.top&&other.y<=box.bottom};
goog.math.Box.relativePositionX=function(box,coord){if(coord.x<box.left)return coord.x-box.left;else if(coord.x>box.right)return coord.x-box.right;return 0};goog.math.Box.relativePositionY=function(box,coord){if(coord.y<box.top)return coord.y-box.top;else if(coord.y>box.bottom)return coord.y-box.bottom;return 0};goog.math.Box.distance=function(box,coord){var x=goog.math.Box.relativePositionX(box,coord);var y=goog.math.Box.relativePositionY(box,coord);return Math.sqrt(x*x+y*y)};
goog.math.Box.intersects=function(a,b){return a.left<=b.right&&b.left<=a.right&&a.top<=b.bottom&&b.top<=a.bottom};goog.math.Box.intersectsWithPadding=function(a,b,padding){return a.left<=b.right+padding&&b.left<=a.right+padding&&a.top<=b.bottom+padding&&b.top<=a.bottom+padding};goog.math.Box.prototype.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};
goog.math.Box.prototype.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};goog.math.Box.prototype.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};
goog.math.Box.prototype.translate=function(tx,opt_ty){if(tx instanceof goog.math.Coordinate){this.left+=tx.x;this.right+=tx.x;this.top+=tx.y;this.bottom+=tx.y}else{goog.asserts.assertNumber(tx);this.left+=tx;this.right+=tx;if(typeof opt_ty==="number"){this.top+=opt_ty;this.bottom+=opt_ty}}return this};goog.math.Box.prototype.scale=function(sx,opt_sy){var sy=typeof opt_sy==="number"?opt_sy:sx;this.left*=sx;this.right*=sx;this.top*=sy;this.bottom*=sy;return this};goog.provide("goog.dom.HtmlElement");goog.dom.HtmlElement=function(){};goog.provide("goog.dom.TagName");goog.require("goog.dom.HtmlElement");goog.dom.TagName=class{static cast(name,type){return name}constructor(){this.googDomTagName_doNotImplementThisTypeOrElse_;this.ensureTypeScriptRemembersTypeT_}toString(){}};goog.dom.TagName.A="A";goog.dom.TagName.ABBR="ABBR";goog.dom.TagName.ACRONYM="ACRONYM";goog.dom.TagName.ADDRESS="ADDRESS";goog.dom.TagName.APPLET="APPLET";goog.dom.TagName.AREA="AREA";goog.dom.TagName.ARTICLE="ARTICLE";goog.dom.TagName.ASIDE="ASIDE";
goog.dom.TagName.AUDIO="AUDIO";goog.dom.TagName.B="B";goog.dom.TagName.BASE="BASE";goog.dom.TagName.BASEFONT="BASEFONT";goog.dom.TagName.BDI="BDI";goog.dom.TagName.BDO="BDO";goog.dom.TagName.BIG="BIG";goog.dom.TagName.BLOCKQUOTE="BLOCKQUOTE";goog.dom.TagName.BODY="BODY";goog.dom.TagName.BR="BR";goog.dom.TagName.BUTTON="BUTTON";goog.dom.TagName.CANVAS="CANVAS";goog.dom.TagName.CAPTION="CAPTION";goog.dom.TagName.CENTER="CENTER";goog.dom.TagName.CITE="CITE";goog.dom.TagName.CODE="CODE";
goog.dom.TagName.COL="COL";goog.dom.TagName.COLGROUP="COLGROUP";goog.dom.TagName.COMMAND="COMMAND";goog.dom.TagName.DATA="DATA";goog.dom.TagName.DATALIST="DATALIST";goog.dom.TagName.DD="DD";goog.dom.TagName.DEL="DEL";goog.dom.TagName.DETAILS="DETAILS";goog.dom.TagName.DFN="DFN";goog.dom.TagName.DIALOG="DIALOG";goog.dom.TagName.DIR="DIR";goog.dom.TagName.DIV="DIV";goog.dom.TagName.DL="DL";goog.dom.TagName.DT="DT";goog.dom.TagName.EM="EM";goog.dom.TagName.EMBED="EMBED";goog.dom.TagName.FIELDSET="FIELDSET";
goog.dom.TagName.FIGCAPTION="FIGCAPTION";goog.dom.TagName.FIGURE="FIGURE";goog.dom.TagName.FONT="FONT";goog.dom.TagName.FOOTER="FOOTER";goog.dom.TagName.FORM="FORM";goog.dom.TagName.FRAME="FRAME";goog.dom.TagName.FRAMESET="FRAMESET";goog.dom.TagName.H1="H1";goog.dom.TagName.H2="H2";goog.dom.TagName.H3="H3";goog.dom.TagName.H4="H4";goog.dom.TagName.H5="H5";goog.dom.TagName.H6="H6";goog.dom.TagName.HEAD="HEAD";goog.dom.TagName.HEADER="HEADER";goog.dom.TagName.HGROUP="HGROUP";goog.dom.TagName.HR="HR";
goog.dom.TagName.HTML="HTML";goog.dom.TagName.I="I";goog.dom.TagName.IFRAME="IFRAME";goog.dom.TagName.IMG="IMG";goog.dom.TagName.INPUT="INPUT";goog.dom.TagName.INS="INS";goog.dom.TagName.ISINDEX="ISINDEX";goog.dom.TagName.KBD="KBD";goog.dom.TagName.KEYGEN="KEYGEN";goog.dom.TagName.LABEL="LABEL";goog.dom.TagName.LEGEND="LEGEND";goog.dom.TagName.LI="LI";goog.dom.TagName.LINK="LINK";goog.dom.TagName.MAIN="MAIN";goog.dom.TagName.MAP="MAP";goog.dom.TagName.MARK="MARK";goog.dom.TagName.MATH="MATH";
goog.dom.TagName.MENU="MENU";goog.dom.TagName.MENUITEM="MENUITEM";goog.dom.TagName.META="META";goog.dom.TagName.METER="METER";goog.dom.TagName.NAV="NAV";goog.dom.TagName.NOFRAMES="NOFRAMES";goog.dom.TagName.NOSCRIPT="NOSCRIPT";goog.dom.TagName.OBJECT="OBJECT";goog.dom.TagName.OL="OL";goog.dom.TagName.OPTGROUP="OPTGROUP";goog.dom.TagName.OPTION="OPTION";goog.dom.TagName.OUTPUT="OUTPUT";goog.dom.TagName.P="P";goog.dom.TagName.PARAM="PARAM";goog.dom.TagName.PICTURE="PICTURE";goog.dom.TagName.PRE="PRE";
goog.dom.TagName.PROGRESS="PROGRESS";goog.dom.TagName.Q="Q";goog.dom.TagName.RP="RP";goog.dom.TagName.RT="RT";goog.dom.TagName.RTC="RTC";goog.dom.TagName.RUBY="RUBY";goog.dom.TagName.S="S";goog.dom.TagName.SAMP="SAMP";goog.dom.TagName.SCRIPT="SCRIPT";goog.dom.TagName.SECTION="SECTION";goog.dom.TagName.SELECT="SELECT";goog.dom.TagName.SMALL="SMALL";goog.dom.TagName.SOURCE="SOURCE";goog.dom.TagName.SPAN="SPAN";goog.dom.TagName.STRIKE="STRIKE";goog.dom.TagName.STRONG="STRONG";
goog.dom.TagName.STYLE="STYLE";goog.dom.TagName.SUB="SUB";goog.dom.TagName.SUMMARY="SUMMARY";goog.dom.TagName.SUP="SUP";goog.dom.TagName.SVG="SVG";goog.dom.TagName.TABLE="TABLE";goog.dom.TagName.TBODY="TBODY";goog.dom.TagName.TD="TD";goog.dom.TagName.TEMPLATE="TEMPLATE";goog.dom.TagName.TEXTAREA="TEXTAREA";goog.dom.TagName.TFOOT="TFOOT";goog.dom.TagName.TH="TH";goog.dom.TagName.THEAD="THEAD";goog.dom.TagName.TIME="TIME";goog.dom.TagName.TITLE="TITLE";goog.dom.TagName.TR="TR";
goog.dom.TagName.TRACK="TRACK";goog.dom.TagName.TT="TT";goog.dom.TagName.U="U";goog.dom.TagName.UL="UL";goog.dom.TagName.VAR="VAR";goog.dom.TagName.VIDEO="VIDEO";goog.dom.TagName.WBR="WBR";goog.loadModule(function(exports){"use strict";goog.module("goog.dom.element");goog.module.declareLegacyNamespace();const NodeType=goog.require("goog.dom.NodeType");const TagName=goog.require("goog.dom.TagName");const HTML_NAMESPACE="http://www.w3.org/1999/xhtml";const isElement=value=>{return goog.isObject(value)&&value.nodeType===NodeType.ELEMENT};const isHtmlElement=value=>{return goog.isObject(value)&&isElement(value)&&(!value.namespaceURI||value.namespaceURI===HTML_NAMESPACE)};const isHtmlElementOfType=
(value,tagName)=>{return goog.isObject(value)&&isHtmlElement(value)&&value.tagName.toUpperCase()===tagName.toString()};const isHtmlAnchorElement=value=>{return isHtmlElementOfType(value,TagName.A)};const isHtmlButtonElement=value=>{return isHtmlElementOfType(value,TagName.BUTTON)};const isHtmlLinkElement=value=>{return isHtmlElementOfType(value,TagName.LINK)};const isHtmlImageElement=value=>{return isHtmlElementOfType(value,TagName.IMG)};const isHtmlAudioElement=value=>{return isHtmlElementOfType(value,
TagName.AUDIO)};const isHtmlVideoElement=value=>{return isHtmlElementOfType(value,TagName.VIDEO)};const isHtmlInputElement=value=>{return isHtmlElementOfType(value,TagName.INPUT)};const isHtmlTextAreaElement=value=>{return isHtmlElementOfType(value,TagName.TEXTAREA)};const isHtmlCanvasElement=value=>{return isHtmlElementOfType(value,TagName.CANVAS)};const isHtmlEmbedElement=value=>{return isHtmlElementOfType(value,TagName.EMBED)};const isHtmlFormElement=value=>{return isHtmlElementOfType(value,TagName.FORM)};
const isHtmlFrameElement=value=>{return isHtmlElementOfType(value,TagName.FRAME)};const isHtmlIFrameElement=value=>{return isHtmlElementOfType(value,TagName.IFRAME)};const isHtmlObjectElement=value=>{return isHtmlElementOfType(value,TagName.OBJECT)};const isHtmlScriptElement=value=>{return isHtmlElementOfType(value,TagName.SCRIPT)};exports={isElement,isHtmlElement,isHtmlElementOfType,isHtmlAnchorElement,isHtmlButtonElement,isHtmlLinkElement,isHtmlImageElement,isHtmlAudioElement,isHtmlVideoElement,
isHtmlInputElement,isHtmlTextAreaElement,isHtmlCanvasElement,isHtmlEmbedElement,isHtmlFormElement,isHtmlFrameElement,isHtmlIFrameElement,isHtmlObjectElement,isHtmlScriptElement};return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.asserts.dom");goog.module.declareLegacyNamespace();const TagName=goog.require("goog.dom.TagName");const asserts=goog.require("goog.asserts");const element=goog.require("goog.dom.element");const assertIsElement=value=>{if(asserts.ENABLE_ASSERTS&&!element.isElement(value))asserts.fail(`Argument is not an Element; got: ${debugStringForType(value)}`);return value};const assertIsHtmlElement=value=>{if(asserts.ENABLE_ASSERTS&&!element.isHtmlElement(value))asserts.fail(`Argument is not an HTML Element; got: ${debugStringForType(value)}`);
return value};const assertIsHtmlElementOfType=(value,tagName)=>{if(asserts.ENABLE_ASSERTS&&!element.isHtmlElementOfType(value,tagName))asserts.fail(`Argument is not an HTML Element with tag name `+`${tagName.toString()}; got: ${debugStringForType(value)}`);return value};const assertIsHtmlAnchorElement=value=>{return assertIsHtmlElementOfType(value,TagName.A)};const assertIsHtmlButtonElement=value=>{return assertIsHtmlElementOfType(value,TagName.BUTTON)};const assertIsHtmlLinkElement=value=>{return assertIsHtmlElementOfType(value,
TagName.LINK)};const assertIsHtmlImageElement=value=>{return assertIsHtmlElementOfType(value,TagName.IMG)};const assertIsHtmlAudioElement=value=>{return assertIsHtmlElementOfType(value,TagName.AUDIO)};const assertIsHtmlVideoElement=value=>{return assertIsHtmlElementOfType(value,TagName.VIDEO)};const assertIsHtmlInputElement=value=>{return assertIsHtmlElementOfType(value,TagName.INPUT)};const assertIsHtmlTextAreaElement=value=>{return assertIsHtmlElementOfType(value,TagName.TEXTAREA)};const assertIsHtmlCanvasElement=
value=>{return assertIsHtmlElementOfType(value,TagName.CANVAS)};const assertIsHtmlEmbedElement=value=>{return assertIsHtmlElementOfType(value,TagName.EMBED)};const assertIsHtmlFormElement=value=>{return assertIsHtmlElementOfType(value,TagName.FORM)};const assertIsHtmlFrameElement=value=>{return assertIsHtmlElementOfType(value,TagName.FRAME)};const assertIsHtmlIFrameElement=value=>{return assertIsHtmlElementOfType(value,TagName.IFRAME)};const assertIsHtmlObjectElement=value=>{return assertIsHtmlElementOfType(value,
TagName.OBJECT)};const assertIsHtmlScriptElement=value=>{return assertIsHtmlElementOfType(value,TagName.SCRIPT)};const debugStringForType=value=>{if(goog.isObject(value))try{return value.constructor.displayName||value.constructor.name||Object.prototype.toString.call(value)}catch(e){return"<object could not be stringified>"}else return value===undefined?"undefined":value===null?"null":typeof value};exports={assertIsElement,assertIsHtmlElement,assertIsHtmlElementOfType,assertIsHtmlAnchorElement,assertIsHtmlButtonElement,
assertIsHtmlLinkElement,assertIsHtmlImageElement,assertIsHtmlAudioElement,assertIsHtmlVideoElement,assertIsHtmlInputElement,assertIsHtmlTextAreaElement,assertIsHtmlCanvasElement,assertIsHtmlEmbedElement,assertIsHtmlFormElement,assertIsHtmlFrameElement,assertIsHtmlIFrameElement,assertIsHtmlObjectElement,assertIsHtmlScriptElement};return exports});goog.provide("goog.dom.BrowserFeature");goog.require("goog.userAgent");goog.dom.BrowserFeature.ASSUME_NO_OFFSCREEN_CANVAS=goog.define("goog.dom.ASSUME_NO_OFFSCREEN_CANVAS",false);goog.dom.BrowserFeature.ASSUME_OFFSCREEN_CANVAS=goog.define("goog.dom.ASSUME_OFFSCREEN_CANVAS",false);goog.dom.BrowserFeature.detectOffscreenCanvas_=function(contextName){try{return Boolean((new self.OffscreenCanvas(0,0)).getContext(contextName))}catch(ex){}return false};
goog.dom.BrowserFeature.OFFSCREEN_CANVAS_2D=!goog.dom.BrowserFeature.ASSUME_NO_OFFSCREEN_CANVAS&&(goog.dom.BrowserFeature.ASSUME_OFFSCREEN_CANVAS||goog.dom.BrowserFeature.detectOffscreenCanvas_("2d"));goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES=true;goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE=true;goog.dom.BrowserFeature.CAN_USE_INNER_TEXT=false;goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY=goog.userAgent.IE||goog.userAgent.WEBKIT;
goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT=goog.userAgent.IE;goog.provide("goog.dom.asserts");goog.require("goog.asserts");goog.dom.asserts.assertIsLocation=function(o){if(goog.asserts.ENABLE_ASSERTS){var win=goog.dom.asserts.getWindow_(o);if(win)if(!o||!(o instanceof win.Location)&&o instanceof win.Element)goog.asserts.fail("Argument is not a Location (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(o))}return o};
goog.dom.asserts.debugStringForType_=function(value){if(goog.isObject(value))try{return value.constructor.displayName||value.constructor.name||Object.prototype.toString.call(value)}catch(e){return"<object could not be stringified>"}else return value===undefined?"undefined":value===null?"null":typeof value};goog.dom.asserts.getWindow_=function(o){try{var doc=o&&o.ownerDocument;var win=doc&&(doc.defaultView||doc.parentWindow);win=win||goog.global;if(win.Element&&win.Location)return win}catch(ex){}return null};goog.provide("goog.functions");goog.functions.constant=function(retValue){return function(){return retValue}};goog.functions.FALSE=function(){return false};goog.functions.TRUE=function(){return true};goog.functions.NULL=function(){return null};goog.functions.UNDEFINED=function(){return undefined};goog.functions.EMPTY=goog.functions.UNDEFINED;goog.functions.identity=function(opt_returnValue,var_args){return opt_returnValue};
goog.functions.error=function(message){return function(){throw new Error(message);}};goog.functions.fail=function(err){return function(){throw err;}};goog.functions.lock=function(f,opt_numArgs){opt_numArgs=opt_numArgs||0;return function(){const self=this;return f.apply(self,Array.prototype.slice.call(arguments,0,opt_numArgs))}};goog.functions.nth=function(n){return function(){return arguments[n]}};
goog.functions.partialRight=function(fn,var_args){const rightArgs=Array.prototype.slice.call(arguments,1);return function(){let self=this;if(self===goog.global)self=undefined;const newArgs=Array.prototype.slice.call(arguments);newArgs.push.apply(newArgs,rightArgs);return fn.apply(self,newArgs)}};goog.functions.withReturnValue=function(f,retValue){return goog.functions.sequence(f,goog.functions.constant(retValue))};
goog.functions.equalTo=function(value,opt_useLooseComparison){return function(other){return opt_useLooseComparison?value==other:value===other}};goog.functions.compose=function(fn,var_args){const functions=arguments;const length=functions.length;return function(){const self=this;let result;if(length)result=functions[length-1].apply(self,arguments);for(let i=length-2;i>=0;i--)result=functions[i].call(self,result);return result}};
goog.functions.sequence=function(var_args){const functions=arguments;const length=functions.length;return function(){const self=this;let result;for(let i=0;i<length;i++)result=functions[i].apply(self,arguments);return result}};goog.functions.and=function(var_args){const functions=arguments;const length=functions.length;return function(){const self=this;for(let i=0;i<length;i++)if(!functions[i].apply(self,arguments))return false;return true}};
goog.functions.or=function(var_args){const functions=arguments;const length=functions.length;return function(){const self=this;for(let i=0;i<length;i++)if(functions[i].apply(self,arguments))return true;return false}};goog.functions.not=function(f){return function(){const self=this;return!f.apply(self,arguments)}};
goog.functions.create=function(constructor,var_args){const temp=function(){};temp.prototype=constructor.prototype;const obj=new temp;constructor.apply(obj,Array.prototype.slice.call(arguments,1));return obj};goog.functions.CACHE_RETURN_VALUE=goog.define("goog.functions.CACHE_RETURN_VALUE",true);goog.functions.cacheReturnValue=function(fn){let called=false;let value;return function(){if(!goog.functions.CACHE_RETURN_VALUE)return fn();if(!called){value=fn();called=true}return value}};
goog.functions.once=function(f){let inner=f;return function(){if(inner){const tmp=inner;inner=null;tmp()}}};goog.functions.debounce=function(f,interval,opt_scope){let timeout=0;return function(var_args){goog.global.clearTimeout(timeout);const args=arguments;timeout=goog.global.setTimeout(function(){f.apply(opt_scope,args)},interval)}};
goog.functions.throttle=function(f,interval,opt_scope){let timeout=0;let shouldFire=false;let storedArgs=[];const handleTimeout=function(){timeout=0;if(shouldFire){shouldFire=false;fire()}};const fire=function(){timeout=goog.global.setTimeout(handleTimeout,interval);let args=storedArgs;storedArgs=[];f.apply(opt_scope,args)};return function(var_args){storedArgs=arguments;if(!timeout)fire();else shouldFire=true}};
goog.functions.rateLimit=function(f,interval,opt_scope){let timeout=0;const handleTimeout=function(){timeout=0};return function(var_args){if(!timeout){timeout=goog.global.setTimeout(handleTimeout,interval);f.apply(opt_scope,arguments)}}};goog.functions.isFunction=val=>{return typeof val==="function"};goog.provide("goog.string.TypedString");goog.string.TypedString=function(){};goog.string.TypedString.prototype.implementsGoogStringTypedString;goog.string.TypedString.prototype.getTypedStringValue;goog.provide("goog.string.Const");goog.require("goog.asserts");goog.require("goog.string.TypedString");goog.string.Const=function(opt_token,opt_content){this.stringConstValueWithSecurityContract__googStringSecurityPrivate_=opt_token===goog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_&&opt_content||"";this.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_=goog.string.Const.TYPE_MARKER_};goog.string.Const.prototype.implementsGoogStringTypedString=true;
goog.string.Const.prototype.getTypedStringValue=function(){return this.stringConstValueWithSecurityContract__googStringSecurityPrivate_};if(goog.DEBUG)goog.string.Const.prototype.toString=function(){return"Const{"+this.stringConstValueWithSecurityContract__googStringSecurityPrivate_+"}"};
goog.string.Const.unwrap=function(stringConst){if(stringConst instanceof goog.string.Const&&stringConst.constructor===goog.string.Const&&stringConst.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_===goog.string.Const.TYPE_MARKER_)return stringConst.stringConstValueWithSecurityContract__googStringSecurityPrivate_;else{goog.asserts.fail("expected object of type Const, got '"+stringConst+"'");return"type_error:Const"}};
goog.string.Const.from=function(s){return new goog.string.Const(goog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_,s)};goog.string.Const.TYPE_MARKER_={};goog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_={};goog.string.Const.EMPTY=goog.string.Const.from("");goog.provide("goog.html.trustedtypes");goog.html.trustedtypes.POLICY_NAME=goog.define("goog.html.trustedtypes.POLICY_NAME",goog.TRUSTED_TYPES_POLICY_NAME?goog.TRUSTED_TYPES_POLICY_NAME+"#html":"");goog.html.trustedtypes.cachedPolicy_;
goog.html.trustedtypes.getPolicyPrivateDoNotAccessOrElse=function(){if(!goog.html.trustedtypes.POLICY_NAME)return null;if(goog.html.trustedtypes.cachedPolicy_===undefined)goog.html.trustedtypes.cachedPolicy_=goog.createTrustedTypesPolicy(goog.html.trustedtypes.POLICY_NAME);return goog.html.trustedtypes.cachedPolicy_};goog.loadModule(function(exports){"use strict";goog.module("goog.html.SafeScript");goog.module.declareLegacyNamespace();const Const=goog.require("goog.string.Const");const TypedString=goog.require("goog.string.TypedString");const trustedtypes=goog.require("goog.html.trustedtypes");const {fail}=goog.require("goog.asserts");const CONSTRUCTOR_TOKEN_PRIVATE={};class SafeScript{constructor(value,token){this.privateDoNotAccessOrElseSafeScriptWrappedValue_=token===CONSTRUCTOR_TOKEN_PRIVATE?value:"";this.implementsGoogStringTypedString=
true}toString(){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_.toString()}static fromConstant(script){const scriptString=Const.unwrap(script);if(scriptString.length===0)return SafeScript.EMPTY;return SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(scriptString)}static fromJson(val){return SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(SafeScript.stringify_(val))}getTypedStringValue(){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_.toString()}static unwrap(safeScript){return SafeScript.unwrapTrustedScript(safeScript).toString()}static unwrapTrustedScript(safeScript){if(safeScript instanceof
SafeScript&&safeScript.constructor===SafeScript)return safeScript.privateDoNotAccessOrElseSafeScriptWrappedValue_;else{fail("expected object of type SafeScript, got '"+safeScript+"' of type "+goog.typeOf(safeScript));return"type_error:SafeScript"}}static stringify_(val){const json=JSON.stringify(val);return json.replace(/</g,"\\x3c")}static createSafeScriptSecurityPrivateDoNotAccessOrElse(script){const noinlineScript=script;const policy=trustedtypes.getPolicyPrivateDoNotAccessOrElse();const trustedScript=
policy?policy.createScript(noinlineScript):noinlineScript;return new SafeScript(trustedScript,CONSTRUCTOR_TOKEN_PRIVATE)}}SafeScript.EMPTY={valueOf:function(){return SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse("")}}.valueOf();exports=SafeScript;return exports});goog.provide("goog.fs.url");goog.fs.url.createObjectUrl=function(obj){return goog.fs.url.getUrlObject_().createObjectURL(obj)};goog.fs.url.revokeObjectUrl=function(url){goog.fs.url.getUrlObject_().revokeObjectURL(url)};goog.fs.url.UrlObject_=function(){};goog.fs.url.UrlObject_.prototype.createObjectURL=function(arg){};goog.fs.url.UrlObject_.prototype.revokeObjectURL=function(s){};
goog.fs.url.getUrlObject_=function(){const urlObject=goog.fs.url.findUrlObject_();if(urlObject!=null)return urlObject;else throw new Error("This browser doesn't seem to support blob URLs");};goog.fs.url.findUrlObject_=function(){if(goog.global.URL!==undefined&&goog.global.URL.createObjectURL!==undefined)return goog.global.URL;else if(goog.global.createObjectURL!==undefined)return goog.global;else return null};goog.fs.url.browserSupportsObjectUrls=function(){return goog.fs.url.findUrlObject_()!=null};goog.provide("goog.fs.blob");goog.fs.blob.getBlob=function(var_args){const BlobBuilder=goog.global.BlobBuilder||goog.global.WebKitBlobBuilder;if(BlobBuilder!==undefined){const bb=new BlobBuilder;for(let i=0;i<arguments.length;i++)bb.append(arguments[i]);return bb.getBlob()}else return goog.fs.blob.getBlobWithProperties(Array.prototype.slice.call(arguments))};
goog.fs.blob.getBlobWithProperties=function(parts,opt_type,opt_endings){const BlobBuilder=goog.global.BlobBuilder||goog.global.WebKitBlobBuilder;if(BlobBuilder!==undefined){const bb=new BlobBuilder;for(let i=0;i<parts.length;i++)bb.append(parts[i],opt_endings);return bb.getBlob(opt_type)}else if(goog.global.Blob!==undefined){const properties={};if(opt_type)properties["type"]=opt_type;if(opt_endings)properties["endings"]=opt_endings;return new Blob(parts,properties)}else throw new Error("This browser doesn't seem to support creating Blobs");
};goog.provide("goog.html.TrustedResourceUrl");goog.require("goog.asserts");goog.require("goog.fs.blob");goog.require("goog.fs.url");goog.require("goog.html.SafeScript");goog.require("goog.html.trustedtypes");goog.require("goog.string.Const");goog.require("goog.string.TypedString");
goog.html.TrustedResourceUrl=class{constructor(value,token){this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_=token===goog.html.TrustedResourceUrl.CONSTRUCTOR_TOKEN_PRIVATE_?value:""}toString(){return this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_+""}};goog.html.TrustedResourceUrl.prototype.implementsGoogStringTypedString=true;goog.html.TrustedResourceUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_.toString()};
goog.html.TrustedResourceUrl.prototype.cloneWithParams=function(searchParams,opt_hashParams){var url=goog.html.TrustedResourceUrl.unwrap(this);var parts=goog.html.TrustedResourceUrl.URL_PARAM_PARSER_.exec(url);var urlBase=parts[1];var urlSearch=parts[2]||"";var urlHash=parts[3]||"";return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(urlBase+goog.html.TrustedResourceUrl.stringifyParams_("?",urlSearch,searchParams)+goog.html.TrustedResourceUrl.stringifyParams_("#",
urlHash,opt_hashParams))};goog.html.TrustedResourceUrl.unwrap=function(trustedResourceUrl){return goog.html.TrustedResourceUrl.unwrapTrustedScriptURL(trustedResourceUrl).toString()};
goog.html.TrustedResourceUrl.unwrapTrustedScriptURL=function(trustedResourceUrl){if(trustedResourceUrl instanceof goog.html.TrustedResourceUrl&&trustedResourceUrl.constructor===goog.html.TrustedResourceUrl)return trustedResourceUrl.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_;else{goog.asserts.fail("expected object of type TrustedResourceUrl, got '"+trustedResourceUrl+"' of type "+goog.typeOf(trustedResourceUrl));return"type_error:TrustedResourceUrl"}};
goog.html.TrustedResourceUrl.format=function(format,args){var formatStr=goog.string.Const.unwrap(format);if(!goog.html.TrustedResourceUrl.BASE_URL_.test(formatStr))throw new Error("Invalid TrustedResourceUrl format: "+formatStr);var result=formatStr.replace(goog.html.TrustedResourceUrl.FORMAT_MARKER_,function(match,id){if(!Object.prototype.hasOwnProperty.call(args,id))throw new Error('Found marker, "'+id+'", in format string, "'+formatStr+'", but no valid label mapping found '+"in args: "+JSON.stringify(args));
var arg=args[id];if(arg instanceof goog.string.Const)return goog.string.Const.unwrap(arg);else return encodeURIComponent(String(arg))});return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(result)};goog.html.TrustedResourceUrl.FORMAT_MARKER_=/%{(\w+)}/g;goog.html.TrustedResourceUrl.BASE_URL_=new RegExp("^((https:)?//[0-9a-z.:[\\]-]+/"+"|/[^/\\\\]"+"|[^:/\\\\%]+/"+"|[^:/\\\\%]*[?#]"+"|about:blank#"+")","i");goog.html.TrustedResourceUrl.URL_PARAM_PARSER_=/^([^?#]*)(\?[^#]*)?(#[\s\S]*)?/;
goog.html.TrustedResourceUrl.formatWithParams=function(format,args,searchParams,opt_hashParams){var url=goog.html.TrustedResourceUrl.format(format,args);return url.cloneWithParams(searchParams,opt_hashParams)};goog.html.TrustedResourceUrl.fromConstant=function(url){return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(url))};
goog.html.TrustedResourceUrl.fromConstants=function(parts){var unwrapped="";for(var i=0;i<parts.length;i++)unwrapped+=goog.string.Const.unwrap(parts[i]);return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(unwrapped)};goog.html.TrustedResourceUrl.fromSafeScript=function(safeScript){var blob=goog.fs.blob.getBlobWithProperties([goog.html.SafeScript.unwrap(safeScript)],"text/javascript");var url=goog.fs.url.createObjectUrl(blob);return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(url)};
goog.html.TrustedResourceUrl.CONSTRUCTOR_TOKEN_PRIVATE_={};goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse=function(url){const noinlineUrl=url;const policy=goog.html.trustedtypes.getPolicyPrivateDoNotAccessOrElse();const value=policy?policy.createScriptURL(noinlineUrl):noinlineUrl;return new goog.html.TrustedResourceUrl(value,goog.html.TrustedResourceUrl.CONSTRUCTOR_TOKEN_PRIVATE_)};
goog.html.TrustedResourceUrl.stringifyParams_=function(prefix,currentString,params){if(params==null)return currentString;if(typeof params==="string")return params?prefix+encodeURIComponent(params):"";for(var key in params)if(Object.prototype.hasOwnProperty.call(params,key)){var value=params[key];var outputValues=Array.isArray(value)?value:[value];for(var i=0;i<outputValues.length;i++){var outputValue=outputValues[i];if(outputValue!=null){if(!currentString)currentString=prefix;currentString+=(currentString.length>
prefix.length?"&":"")+encodeURIComponent(key)+"="+encodeURIComponent(String(outputValue))}}}return currentString};goog.provide("goog.html.SafeUrl");goog.require("goog.asserts");goog.require("goog.fs.url");goog.require("goog.html.TrustedResourceUrl");goog.require("goog.string.Const");goog.require("goog.string.TypedString");goog.require("goog.string.internal");goog.html.SafeUrl=class{constructor(value,token){this.privateDoNotAccessOrElseSafeUrlWrappedValue_=token===goog.html.SafeUrl.CONSTRUCTOR_TOKEN_PRIVATE_?value:""}toString(){return this.privateDoNotAccessOrElseSafeUrlWrappedValue_.toString()}};
goog.html.SafeUrl.INNOCUOUS_STRING="about:invalid#zClosurez";goog.html.SafeUrl.prototype.implementsGoogStringTypedString=true;goog.html.SafeUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeUrlWrappedValue_.toString()};
goog.html.SafeUrl.unwrap=function(safeUrl){if(safeUrl instanceof goog.html.SafeUrl&&safeUrl.constructor===goog.html.SafeUrl)return safeUrl.privateDoNotAccessOrElseSafeUrlWrappedValue_;else{goog.asserts.fail("expected object of type SafeUrl, got '"+safeUrl+"' of type "+goog.typeOf(safeUrl));return"type_error:SafeUrl"}};goog.html.SafeUrl.fromConstant=function(url){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(url))};
goog.html.SAFE_MIME_TYPE_PATTERN_=new RegExp("^(?:audio/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|"+"font/\\w+|"+"image/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon|heic|heif)|"+"video/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))"+'(?:;\\w+=(?:\\w+|"[\\w;,= ]+"))*$',"i");goog.html.SafeUrl.isSafeMimeType=function(mimeType){return goog.html.SAFE_MIME_TYPE_PATTERN_.test(mimeType)};
goog.html.SafeUrl.fromBlob=function(blob){var url=goog.html.SafeUrl.isSafeMimeType(blob.type)?goog.fs.url.createObjectUrl(blob):goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url)};goog.html.SafeUrl.revokeObjectUrl=function(safeUrl){var url=safeUrl.getTypedStringValue();if(url!==goog.html.SafeUrl.INNOCUOUS_STRING)goog.fs.url.revokeObjectUrl(url)};
goog.html.SafeUrl.fromMediaSource=function(mediaSource){goog.asserts.assert("MediaSource"in goog.global,"No support for MediaSource");const url=mediaSource instanceof MediaSource?goog.fs.url.createObjectUrl(mediaSource):goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url)};goog.html.DATA_URL_PATTERN_=/^data:(.*);base64,[a-z0-9+\/]+=*$/i;
goog.html.SafeUrl.tryFromDataUrl=function(dataUrl){dataUrl=String(dataUrl);var filteredDataUrl=dataUrl.replace(/(%0A|%0D)/g,"");var match=filteredDataUrl.match(goog.html.DATA_URL_PATTERN_);if(match)return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(filteredDataUrl);return null};goog.html.SafeUrl.fromDataUrl=function(dataUrl){return goog.html.SafeUrl.tryFromDataUrl(dataUrl)||goog.html.SafeUrl.INNOCUOUS_URL};
goog.html.SafeUrl.fromTelUrl=function(telUrl){if(!goog.string.internal.caseInsensitiveStartsWith(telUrl,"tel:"))telUrl=goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(telUrl)};goog.html.SIP_URL_PATTERN_=new RegExp("^sip[s]?:[+a-z0-9_.!$%&'*\\/=^`{|}~-]+@([a-z0-9-]+\\.)+[a-z0-9]{2,63}$","i");
goog.html.SafeUrl.fromSipUrl=function(sipUrl){if(!goog.html.SIP_URL_PATTERN_.test(decodeURIComponent(sipUrl)))sipUrl=goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(sipUrl)};goog.html.SafeUrl.fromFacebookMessengerUrl=function(facebookMessengerUrl){if(!goog.string.internal.caseInsensitiveStartsWith(facebookMessengerUrl,"fb-messenger://share"))facebookMessengerUrl=goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(facebookMessengerUrl)};
goog.html.SafeUrl.fromWhatsAppUrl=function(whatsAppUrl){if(!goog.string.internal.caseInsensitiveStartsWith(whatsAppUrl,"whatsapp://send"))whatsAppUrl=goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(whatsAppUrl)};goog.html.SafeUrl.fromSmsUrl=function(smsUrl){if(!goog.string.internal.caseInsensitiveStartsWith(smsUrl,"sms:")||!goog.html.SafeUrl.isSmsUrlBodyValid_(smsUrl))smsUrl=goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(smsUrl)};
goog.html.SafeUrl.isSmsUrlBodyValid_=function(smsUrl){var hash=smsUrl.indexOf("#");if(hash>0)smsUrl=smsUrl.substring(0,hash);var bodyParams=smsUrl.match(/[?&]body=/gi);if(!bodyParams)return true;if(bodyParams.length>1)return false;var bodyValue=smsUrl.match(/[?&]body=([^&]*)/)[1];if(!bodyValue)return true;try{decodeURIComponent(bodyValue)}catch(error){return false}return/^(?:[a-z0-9\-_.~]|%[0-9a-f]{2})+$/i.test(bodyValue)};
goog.html.SafeUrl.fromSshUrl=function(sshUrl){if(!goog.string.internal.caseInsensitiveStartsWith(sshUrl,"ssh://"))sshUrl=goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(sshUrl)};goog.html.SafeUrl.sanitizeChromeExtensionUrl=function(url,extensionId){return goog.html.SafeUrl.sanitizeExtensionUrl_(/^chrome-extension:\/\/([^\/]+)\//,url,extensionId)};
goog.html.SafeUrl.sanitizeFirefoxExtensionUrl=function(url,extensionId){return goog.html.SafeUrl.sanitizeExtensionUrl_(/^moz-extension:\/\/([^\/]+)\//,url,extensionId)};goog.html.SafeUrl.sanitizeEdgeExtensionUrl=function(url,extensionId){return goog.html.SafeUrl.sanitizeExtensionUrl_(/^ms-browser-extension:\/\/([^\/]+)\//,url,extensionId)};
goog.html.SafeUrl.sanitizeExtensionUrl_=function(scheme,url,extensionId){var matches=scheme.exec(url);if(!matches)url=goog.html.SafeUrl.INNOCUOUS_STRING;else{var extractedExtensionId=matches[1];var acceptedExtensionIds;if(extensionId instanceof goog.string.Const)acceptedExtensionIds=[goog.string.Const.unwrap(extensionId)];else acceptedExtensionIds=extensionId.map(function unwrap(x){return goog.string.Const.unwrap(x)});if(acceptedExtensionIds.indexOf(extractedExtensionId)==-1)url=goog.html.SafeUrl.INNOCUOUS_STRING}return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url)};
goog.html.SafeUrl.fromTrustedResourceUrl=function(trustedResourceUrl){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.html.TrustedResourceUrl.unwrap(trustedResourceUrl))};goog.html.SAFE_URL_PATTERN_=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;goog.html.SafeUrl.SAFE_URL_PATTERN=goog.html.SAFE_URL_PATTERN_;
goog.html.SafeUrl.trySanitize=function(url){if(url instanceof goog.html.SafeUrl)return url;if(typeof url=="object"&&url.implementsGoogStringTypedString)url=url.getTypedStringValue();else url=String(url);if(!goog.html.SAFE_URL_PATTERN_.test(url))return goog.html.SafeUrl.tryFromDataUrl(url);return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url)};goog.html.SafeUrl.sanitize=function(url){return goog.html.SafeUrl.trySanitize(url)||goog.html.SafeUrl.INNOCUOUS_URL};
goog.html.SafeUrl.sanitizeAssertUnchanged=function(url,opt_allowDataUrl){if(url instanceof goog.html.SafeUrl)return url;else if(typeof url=="object"&&url.implementsGoogStringTypedString)url=url.getTypedStringValue();else url=String(url);if(opt_allowDataUrl&&/^data:/i.test(url)){var safeUrl=goog.html.SafeUrl.fromDataUrl(url);if(safeUrl.getTypedStringValue()==url)return safeUrl}if(!goog.asserts.assert(goog.html.SAFE_URL_PATTERN_.test(url),"%s does not match the safe URL pattern",url))url=goog.html.SafeUrl.INNOCUOUS_STRING;
return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url)};goog.html.SafeUrl.extractScheme=function(url){let parsedUrl;try{parsedUrl=new URL(url)}catch(e){return"https:"}return parsedUrl.protocol};
goog.html.SafeUrl.sanitizeJavascriptUrlAssertUnchanged=function(url){if(url instanceof goog.html.SafeUrl)return url;else if(typeof url=="object"&&url.implementsGoogStringTypedString)url=url.getTypedStringValue();else url=String(url);const parsedScheme=goog.html.SafeUrl.extractScheme(url);if(!goog.asserts.assert(parsedScheme!=="javascript:","%s is a javascript: URL",url))url=goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url)};
goog.html.SafeUrl.CONSTRUCTOR_TOKEN_PRIVATE_={};goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse=function(url){return new goog.html.SafeUrl(url,goog.html.SafeUrl.CONSTRUCTOR_TOKEN_PRIVATE_)};goog.html.SafeUrl.INNOCUOUS_URL=goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.html.SafeUrl.INNOCUOUS_STRING);goog.html.SafeUrl.ABOUT_BLANK=goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse("about:blank");goog.loadModule(function(exports){"use strict";goog.module("goog.html.SafeStyle");goog.module.declareLegacyNamespace();const Const=goog.require("goog.string.Const");const SafeUrl=goog.require("goog.html.SafeUrl");const TypedString=goog.require("goog.string.TypedString");const {AssertionError,assert,fail}=goog.require("goog.asserts");const {contains,endsWith}=goog.require("goog.string.internal");const CONSTRUCTOR_TOKEN_PRIVATE={};class SafeStyle{constructor(value,token){this.privateDoNotAccessOrElseSafeStyleWrappedValue_=
token===CONSTRUCTOR_TOKEN_PRIVATE?value:"";this.implementsGoogStringTypedString=true}static fromConstant(style){const styleString=Const.unwrap(style);if(styleString.length===0)return SafeStyle.EMPTY;assert(endsWith(styleString,";"),`Last character of style string is not ';': ${styleString}`);assert(contains(styleString,":"),"Style string must contain at least one ':', to "+'specify a "name: value" pair: '+styleString);return SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(styleString)}getTypedStringValue(){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_}toString(){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_.toString()}static unwrap(safeStyle){if(safeStyle instanceof
SafeStyle&&safeStyle.constructor===SafeStyle)return safeStyle.privateDoNotAccessOrElseSafeStyleWrappedValue_;else{fail(`expected object of type SafeStyle, got '${safeStyle}`+"' of type "+goog.typeOf(safeStyle));return"type_error:SafeStyle"}}static createSafeStyleSecurityPrivateDoNotAccessOrElse(style){return new SafeStyle(style,CONSTRUCTOR_TOKEN_PRIVATE)}static create(map){let style="";for(let name in map)if(Object.prototype.hasOwnProperty.call(map,name)){if(!/^[-_a-zA-Z0-9]+$/.test(name))throw new Error(`Name allows only [-_a-zA-Z0-9], got: ${name}`);
let value=map[name];if(value==null)continue;if(Array.isArray(value))value=value.map(sanitizePropertyValue).join(" ");else value=sanitizePropertyValue(value);style+=`${name}:${value};`}if(!style)return SafeStyle.EMPTY;return SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(style)}static concat(var_args){let style="";const addArgument=argument=>{if(Array.isArray(argument))argument.forEach(addArgument);else style+=SafeStyle.unwrap(argument)};Array.prototype.forEach.call(arguments,addArgument);
if(!style)return SafeStyle.EMPTY;return SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(style)}}SafeStyle.EMPTY=SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse("");SafeStyle.INNOCUOUS_STRING="zClosurez";SafeStyle.PropertyValue;SafeStyle.PropertyMap;function sanitizePropertyValue(value){if(value instanceof SafeUrl){const url=SafeUrl.unwrap(value);return'url("'+url.replace(/</g,"%3c").replace(/[\\"]/g,"\\$&")+'")'}const result=value instanceof Const?Const.unwrap(value):sanitizePropertyValueString(String(value));
if(/[{;}]/.test(result))throw new AssertionError("Value does not allow [{;}], got: %s.",[result]);return result}function sanitizePropertyValueString(value){const valueWithoutFunctions=value.replace(FUNCTIONS_RE,"$1").replace(FUNCTIONS_RE,"$1").replace(URL_RE,"url");if(!VALUE_RE.test(valueWithoutFunctions)){fail(`String value allows only ${VALUE_ALLOWED_CHARS}`+" and simple functions, got: "+value);return SafeStyle.INNOCUOUS_STRING}else if(COMMENT_RE.test(value)){fail(`String value disallows comments, got: ${value}`);
return SafeStyle.INNOCUOUS_STRING}else if(!hasBalancedQuotes(value)){fail(`String value requires balanced quotes, got: ${value}`);return SafeStyle.INNOCUOUS_STRING}else if(!hasBalancedSquareBrackets(value)){fail("String value requires balanced square brackets and one"+" identifier per pair of brackets, got: "+value);return SafeStyle.INNOCUOUS_STRING}return sanitizeUrl(value)}function hasBalancedQuotes(value){let outsideSingle=true;let outsideDouble=true;for(let i=0;i<value.length;i++){const c=value.charAt(i);
if(c=="'"&&outsideDouble)outsideSingle=!outsideSingle;else if(c=='"'&&outsideSingle)outsideDouble=!outsideDouble}return outsideSingle&&outsideDouble}function hasBalancedSquareBrackets(value){let outside=true;const tokenRe=/^[-_a-zA-Z0-9]$/;for(let i=0;i<value.length;i++){const c=value.charAt(i);if(c=="]"){if(outside)return false;outside=true}else if(c=="["){if(!outside)return false;outside=false}else if(!outside&&!tokenRe.test(c))return false}return outside}const VALUE_ALLOWED_CHARS="[-+,.\"'%_!#/ a-zA-Z0-9\\[\\]]";
const VALUE_RE=new RegExp(`^${VALUE_ALLOWED_CHARS}+\$`);const URL_RE=new RegExp("\\b(url\\([ \t\n]*)("+"'[ -&(-\\[\\]-~]*'"+'|"[ !#-\\[\\]-~]*"'+"|[!#-&*-\\[\\]-~]*"+")([ \t\n]*\\))","g");const ALLOWED_FUNCTIONS=["calc","cubic-bezier","fit-content","hsl","hsla","linear-gradient","matrix","minmax","radial-gradient","repeat","rgb","rgba","(rotate|scale|translate)(X|Y|Z|3d)?","steps","var"];const FUNCTIONS_RE=new RegExp("\\b("+ALLOWED_FUNCTIONS.join("|")+")"+"\\([-+*/0-9a-zA-Z.%#\\[\\], ]+\\)","g");
const COMMENT_RE=/\/\*/;function sanitizeUrl(value){return value.replace(URL_RE,(match,before,url,after)=>{let quote="";url=url.replace(/^(['"])(.*)\1$/,(match,start,inside)=>{quote=start;return inside});const sanitized=SafeUrl.sanitize(url).getTypedStringValue();return before+quote+sanitized+quote+after})}exports=SafeStyle;return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.html.SafeStyleSheet");goog.module.declareLegacyNamespace();const Const=goog.require("goog.string.Const");const SafeStyle=goog.require("goog.html.SafeStyle");const TypedString=goog.require("goog.string.TypedString");const googObject=goog.require("goog.object");const {assert,fail}=goog.require("goog.asserts");const {contains}=goog.require("goog.string.internal");const CONSTRUCTOR_TOKEN_PRIVATE={};class SafeStyleSheet{constructor(value,
token){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_=token===CONSTRUCTOR_TOKEN_PRIVATE?value:"";this.implementsGoogStringTypedString=true}toString(){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_.toString()}static createRule(selector,style){if(contains(selector,"<"))throw new Error(`Selector does not allow '<', got: ${selector}`);const selectorToCheck=selector.replace(/('|")((?!\1)[^\r\n\f\\]|\\[\s\S])*\1/g,"");if(!/^[-_a-zA-Z0-9#.:* ,>+~[\]()=\\^$|]+$/.test(selectorToCheck))throw new Error("Selector allows only [-_a-zA-Z0-9#.:* ,>+~[\\]()=\\^$|] and "+
"strings, got: "+selector);if(!SafeStyleSheet.hasBalancedBrackets_(selectorToCheck))throw new Error("() and [] in selector must be balanced, got: "+selector);if(!(style instanceof SafeStyle))style=SafeStyle.create(style);const styleSheet=`${selector}{`+SafeStyle.unwrap(style).replace(/</g,"\\3C ")+"}";return SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(styleSheet)}static hasBalancedBrackets_(s){const brackets={"(":")","[":"]"};const expectedBrackets=[];for(let i=0;i<s.length;i++){const ch=
s[i];if(brackets[ch])expectedBrackets.push(brackets[ch]);else if(googObject.contains(brackets,ch))if(expectedBrackets.pop()!=ch)return false}return expectedBrackets.length==0}static concat(var_args){let result="";const addArgument=argument=>{if(Array.isArray(argument))argument.forEach(addArgument);else result+=SafeStyleSheet.unwrap(argument)};Array.prototype.forEach.call(arguments,addArgument);return SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(result)}static fromConstant(styleSheet){const styleSheetString=
Const.unwrap(styleSheet);if(styleSheetString.length===0)return SafeStyleSheet.EMPTY;assert(!contains(styleSheetString,"<"),`Forbidden '<' character in style sheet string: ${styleSheetString}`);return SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(styleSheetString)}getTypedStringValue(){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_}static unwrap(safeStyleSheet){if(safeStyleSheet instanceof SafeStyleSheet&&safeStyleSheet.constructor===SafeStyleSheet)return safeStyleSheet.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_;
else{fail("expected object of type SafeStyleSheet, got '"+safeStyleSheet+"' of type "+goog.typeOf(safeStyleSheet));return"type_error:SafeStyleSheet"}}static createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(styleSheet){return new SafeStyleSheet(styleSheet,CONSTRUCTOR_TOKEN_PRIVATE)}}SafeStyleSheet.EMPTY=SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse("");exports=SafeStyleSheet;return exports});goog.provide("goog.dom.tags");goog.require("goog.object");goog.dom.tags.VOID_TAGS_=goog.object.createSet("area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr");goog.dom.tags.isVoidTag=function(tagName){return goog.dom.tags.VOID_TAGS_[tagName]===true};goog.loadModule(function(exports){"use strict";goog.module("goog.html.SafeHtml");goog.module.declareLegacyNamespace();const Const=goog.require("goog.string.Const");const SafeScript=goog.require("goog.html.SafeScript");const SafeStyle=goog.require("goog.html.SafeStyle");const SafeStyleSheet=goog.require("goog.html.SafeStyleSheet");const SafeUrl=goog.require("goog.html.SafeUrl");const TagName=goog.require("goog.dom.TagName");const TrustedResourceUrl=goog.require("goog.html.TrustedResourceUrl");const TypedString=
goog.require("goog.string.TypedString");const asserts=goog.require("goog.asserts");const browser=goog.require("goog.labs.userAgent.browser");const googArray=goog.require("goog.array");const googObject=goog.require("goog.object");const internal=goog.require("goog.string.internal");const tags=goog.require("goog.dom.tags");const trustedtypes=goog.require("goog.html.trustedtypes");const CONSTRUCTOR_TOKEN_PRIVATE={};class SafeHtml{constructor(value,token){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_=
token===CONSTRUCTOR_TOKEN_PRIVATE?value:"";this.implementsGoogStringTypedString=true}getTypedStringValue(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_.toString()}toString(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_.toString()}static unwrap(safeHtml){return SafeHtml.unwrapTrustedHTML(safeHtml).toString()}static unwrapTrustedHTML(safeHtml){if(safeHtml instanceof SafeHtml&&safeHtml.constructor===SafeHtml)return safeHtml.privateDoNotAccessOrElseSafeHtmlWrappedValue_;else{asserts.fail(`expected object of type SafeHtml, got '${safeHtml}' of type `+
goog.typeOf(safeHtml));return"type_error:SafeHtml"}}static htmlEscape(textOrHtml){if(textOrHtml instanceof SafeHtml)return textOrHtml;const textIsObject=typeof textOrHtml=="object";let textAsString;if(textIsObject&&textOrHtml.implementsGoogStringTypedString)textAsString=textOrHtml.getTypedStringValue();else textAsString=String(textOrHtml);return SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(internal.htmlEscape(textAsString))}static htmlEscapePreservingNewlines(textOrHtml){if(textOrHtml instanceof
SafeHtml)return textOrHtml;const html=SafeHtml.htmlEscape(textOrHtml);return SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(internal.newLineToBr(SafeHtml.unwrap(html)))}static htmlEscapePreservingNewlinesAndSpaces(textOrHtml){if(textOrHtml instanceof SafeHtml)return textOrHtml;const html=SafeHtml.htmlEscape(textOrHtml);return SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(internal.whitespaceEscape(SafeHtml.unwrap(html)))}static comment(text){return SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("\x3c!--"+
internal.htmlEscape(text)+"--\x3e")}static create(tagName,attributes=undefined,content=undefined){SafeHtml.verifyTagName(String(tagName));return SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(String(tagName),attributes,content)}static verifyTagName(tagName){if(!VALID_NAMES_IN_TAG.test(tagName))throw new Error(SafeHtml.ENABLE_ERROR_MESSAGES?`Invalid tag name <${tagName}>.`:"");if(tagName.toUpperCase()in NOT_ALLOWED_TAG_NAMES)throw new Error(SafeHtml.ENABLE_ERROR_MESSAGES?`Tag name <${tagName}> is not allowed for SafeHtml.`:
"");}static createIframe(src=undefined,srcdoc=undefined,attributes=undefined,content=undefined){if(src)TrustedResourceUrl.unwrap(src);const fixedAttributes={};fixedAttributes["src"]=src||null;fixedAttributes["srcdoc"]=srcdoc&&SafeHtml.unwrap(srcdoc);const defaultAttributes={"sandbox":""};const combinedAttrs=SafeHtml.combineAttributes(fixedAttributes,defaultAttributes,attributes);return SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",combinedAttrs,content)}static createSandboxIframe(src=
undefined,srcdoc=undefined,attributes=undefined,content=undefined){if(!SafeHtml.canUseSandboxIframe())throw new Error(SafeHtml.ENABLE_ERROR_MESSAGES?"The browser does not support sandboxed iframes.":"");const fixedAttributes={};if(src)fixedAttributes["src"]=SafeUrl.unwrap(SafeUrl.sanitize(src));else fixedAttributes["src"]=null;fixedAttributes["srcdoc"]=srcdoc||null;fixedAttributes["sandbox"]="";const combinedAttrs=SafeHtml.combineAttributes(fixedAttributes,{},attributes);return SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",
combinedAttrs,content)}static canUseSandboxIframe(){return goog.global["HTMLIFrameElement"]&&"sandbox"in goog.global["HTMLIFrameElement"].prototype}static createScriptSrc(src,attributes=undefined){TrustedResourceUrl.unwrap(src);const fixedAttributes={"src":src};const defaultAttributes={};const combinedAttrs=SafeHtml.combineAttributes(fixedAttributes,defaultAttributes,attributes);return SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",combinedAttrs)}static createScript(script,attributes=
undefined){for(let attr in attributes)if(Object.prototype.hasOwnProperty.call(attributes,attr)){const attrLower=attr.toLowerCase();if(attrLower=="language"||attrLower=="src"||attrLower=="text")throw new Error(SafeHtml.ENABLE_ERROR_MESSAGES?`Cannot set "${attrLower}" attribute`:"");}let content="";script=googArray.concat(script);for(let i=0;i<script.length;i++)content+=SafeScript.unwrap(script[i]);const htmlContent=SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(content);return SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",
attributes,htmlContent)}static createStyle(styleSheet,attributes=undefined){const fixedAttributes={"type":"text/css"};const defaultAttributes={};const combinedAttrs=SafeHtml.combineAttributes(fixedAttributes,defaultAttributes,attributes);let content="";styleSheet=googArray.concat(styleSheet);for(let i=0;i<styleSheet.length;i++)content+=SafeStyleSheet.unwrap(styleSheet[i]);const htmlContent=SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(content);return SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("style",
combinedAttrs,htmlContent)}static createMetaRefresh(url,secs=undefined){let unwrappedUrl=SafeUrl.unwrap(SafeUrl.sanitize(url));if(browser.isIE()||browser.isEdge())if(internal.contains(unwrappedUrl,";"))unwrappedUrl="'"+unwrappedUrl.replace(/'/g,"%27")+"'";const attributes={"http-equiv":"refresh","content":(secs||0)+"; url="+unwrappedUrl};return SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("meta",attributes)}static join(separator,parts){const separatorHtml=SafeHtml.htmlEscape(separator);
const content=[];const addArgument=argument=>{if(Array.isArray(argument))argument.forEach(addArgument);else{const html=SafeHtml.htmlEscape(argument);content.push(SafeHtml.unwrap(html))}};parts.forEach(addArgument);return SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(content.join(SafeHtml.unwrap(separatorHtml)))}static concat(var_args){return SafeHtml.join(SafeHtml.EMPTY,Array.prototype.slice.call(arguments))}static createSafeHtmlSecurityPrivateDoNotAccessOrElse(html){const noinlineHtml=
html;const policy=trustedtypes.getPolicyPrivateDoNotAccessOrElse();const trustedHtml=policy?policy.createHTML(noinlineHtml):noinlineHtml;return new SafeHtml(trustedHtml,CONSTRUCTOR_TOKEN_PRIVATE)}static createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(tagName,attributes=undefined,content=undefined){let result=`<${tagName}`;result+=SafeHtml.stringifyAttributes(tagName,attributes);if(content==null)content=[];else if(!Array.isArray(content))content=[content];if(tags.isVoidTag(tagName.toLowerCase())){asserts.assert(!content.length,
`Void tag <${tagName}> does not allow content.`);result+=">"}else{const html=SafeHtml.concat(content);result+=">"+SafeHtml.unwrap(html)+"</"+tagName+">"}return SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(result)}static stringifyAttributes(tagName,attributes=undefined){let result="";if(attributes)for(let name in attributes)if(Object.prototype.hasOwnProperty.call(attributes,name)){if(!VALID_NAMES_IN_TAG.test(name))throw new Error(SafeHtml.ENABLE_ERROR_MESSAGES?`Invalid attribute name "${name}".`:
"");const value=attributes[name];if(value==null)continue;result+=" "+getAttrNameAndValue(tagName,name,value)}return result}static combineAttributes(fixedAttributes,defaultAttributes,attributes=undefined){const combinedAttributes={};for(const name in fixedAttributes)if(Object.prototype.hasOwnProperty.call(fixedAttributes,name)){asserts.assert(name.toLowerCase()==name,"Must be lower case");combinedAttributes[name]=fixedAttributes[name]}for(const name in defaultAttributes)if(Object.prototype.hasOwnProperty.call(defaultAttributes,
name)){asserts.assert(name.toLowerCase()==name,"Must be lower case");combinedAttributes[name]=defaultAttributes[name]}if(attributes)for(const name in attributes)if(Object.prototype.hasOwnProperty.call(attributes,name)){const nameLower=name.toLowerCase();if(nameLower in fixedAttributes)throw new Error(SafeHtml.ENABLE_ERROR_MESSAGES?`Cannot override "${nameLower}" attribute, got "`+name+'" with value "'+attributes[name]+'"':"");if(nameLower in defaultAttributes)delete combinedAttributes[nameLower];
combinedAttributes[name]=attributes[name]}return combinedAttributes}}SafeHtml.ENABLE_ERROR_MESSAGES=goog.define("goog.html.SafeHtml.ENABLE_ERROR_MESSAGES",goog.DEBUG);SafeHtml.SUPPORT_STYLE_ATTRIBUTE=goog.define("goog.html.SafeHtml.SUPPORT_STYLE_ATTRIBUTE",true);SafeHtml.TextOrHtml_;SafeHtml.from=SafeHtml.htmlEscape;const VALID_NAMES_IN_TAG=/^[a-zA-Z0-9-]+$/;const URL_ATTRIBUTES=googObject.createSet("action","cite","data","formaction","href","manifest","poster","src");const NOT_ALLOWED_TAG_NAMES=
googObject.createSet(TagName.APPLET,TagName.BASE,TagName.EMBED,TagName.IFRAME,TagName.LINK,TagName.MATH,TagName.META,TagName.OBJECT,TagName.SCRIPT,TagName.STYLE,TagName.SVG,TagName.TEMPLATE);SafeHtml.AttributeValue;function getAttrNameAndValue(tagName,name,value){if(value instanceof Const)value=Const.unwrap(value);else if(name.toLowerCase()=="style")if(SafeHtml.SUPPORT_STYLE_ATTRIBUTE)value=getStyleValue(value);else throw new Error(SafeHtml.ENABLE_ERROR_MESSAGES?'Attribute "style" not supported.':
"");else if(/^on/i.test(name))throw new Error(SafeHtml.ENABLE_ERROR_MESSAGES?`Attribute "${name}`+'" requires goog.string.Const value, "'+value+'" given.':"");else if(name.toLowerCase()in URL_ATTRIBUTES)if(value instanceof TrustedResourceUrl)value=TrustedResourceUrl.unwrap(value);else if(value instanceof SafeUrl)value=SafeUrl.unwrap(value);else if(typeof value==="string")value=SafeUrl.sanitize(value).getTypedStringValue();else throw new Error(SafeHtml.ENABLE_ERROR_MESSAGES?`Attribute "${name}" on tag "${tagName}`+
'" requires goog.html.SafeUrl, goog.string.Const, or'+' string, value "'+value+'" given.':"");if(value.implementsGoogStringTypedString)value=value.getTypedStringValue();asserts.assert(typeof value==="string"||typeof value==="number","String or number value expected, got "+typeof value+" with value: "+value);return`${name}="`+internal.htmlEscape(String(value))+'"'}function getStyleValue(value){if(!goog.isObject(value))throw new Error(SafeHtml.ENABLE_ERROR_MESSAGES?'The "style" attribute requires goog.html.SafeStyle or map '+
"of style properties, "+typeof value+" given: "+value:"");if(!(value instanceof SafeStyle))value=SafeStyle.create(value);return SafeStyle.unwrap(value)}SafeHtml.DOCTYPE_HTML={valueOf:function(){return SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<!DOCTYPE html>")}}.valueOf();SafeHtml.EMPTY=new SafeHtml(goog.global.trustedTypes&&goog.global.trustedTypes.emptyHTML||"",CONSTRUCTOR_TOKEN_PRIVATE);SafeHtml.BR={valueOf:function(){return SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<br>")}}.valueOf();
exports=SafeHtml;return exports});goog.provide("goog.html.uncheckedconversions");goog.require("goog.asserts");goog.require("goog.html.SafeHtml");goog.require("goog.html.SafeScript");goog.require("goog.html.SafeStyle");goog.require("goog.html.SafeStyleSheet");goog.require("goog.html.SafeUrl");goog.require("goog.html.TrustedResourceUrl");goog.require("goog.string.Const");goog.require("goog.string.internal");
goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract=function(justification,html){goog.asserts.assertString(goog.string.Const.unwrap(justification),"must provide justification");goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(justification)),"must provide non-empty justification");return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(html)};
goog.html.uncheckedconversions.safeScriptFromStringKnownToSatisfyTypeContract=function(justification,script){goog.asserts.assertString(goog.string.Const.unwrap(justification),"must provide justification");goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(justification)),"must provide non-empty justification");return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(script)};
goog.html.uncheckedconversions.safeStyleFromStringKnownToSatisfyTypeContract=function(justification,style){goog.asserts.assertString(goog.string.Const.unwrap(justification),"must provide justification");goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(justification)),"must provide non-empty justification");return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(style)};
goog.html.uncheckedconversions.safeStyleSheetFromStringKnownToSatisfyTypeContract=function(justification,styleSheet){goog.asserts.assertString(goog.string.Const.unwrap(justification),"must provide justification");goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(justification)),"must provide non-empty justification");return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(styleSheet)};
goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract=function(justification,url){goog.asserts.assertString(goog.string.Const.unwrap(justification),"must provide justification");goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(justification)),"must provide non-empty justification");return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(url)};
goog.html.uncheckedconversions.trustedResourceUrlFromStringKnownToSatisfyTypeContract=function(justification,url){goog.asserts.assertString(goog.string.Const.unwrap(justification),"must provide justification");goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(justification)),"must provide non-empty justification");return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(url)};goog.provide("goog.dom.safe");goog.provide("goog.dom.safe.InsertAdjacentHtmlPosition");goog.require("goog.asserts");goog.require("goog.asserts.dom");goog.require("goog.dom.asserts");goog.require("goog.functions");goog.require("goog.html.SafeHtml");goog.require("goog.html.SafeScript");goog.require("goog.html.SafeStyle");goog.require("goog.html.SafeUrl");goog.require("goog.html.TrustedResourceUrl");goog.require("goog.html.uncheckedconversions");goog.require("goog.string.Const");goog.require("goog.string.internal");
goog.dom.safe.InsertAdjacentHtmlPosition={AFTERBEGIN:"afterbegin",AFTEREND:"afterend",BEFOREBEGIN:"beforebegin",BEFOREEND:"beforeend"};goog.dom.safe.insertAdjacentHtml=function(node,position,html){node.insertAdjacentHTML(position,goog.html.SafeHtml.unwrapTrustedHTML(html))};goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_={"MATH":true,"SCRIPT":true,"STYLE":true,"SVG":true,"TEMPLATE":true};
goog.dom.safe.isInnerHtmlCleanupRecursive_=goog.functions.cacheReturnValue(function(){if(goog.DEBUG&&typeof document==="undefined")return false;var div=document.createElement("div");var childDiv=document.createElement("div");childDiv.appendChild(document.createElement("div"));div.appendChild(childDiv);if(goog.DEBUG&&!div.firstChild)return false;var innerChild=div.firstChild.firstChild;div.innerHTML=goog.html.SafeHtml.unwrapTrustedHTML(goog.html.SafeHtml.EMPTY);return!innerChild.parentElement});
goog.dom.safe.unsafeSetInnerHtmlDoNotUseOrElse=function(elem,html){if(goog.dom.safe.isInnerHtmlCleanupRecursive_())while(elem.lastChild)elem.removeChild(elem.lastChild);elem.innerHTML=goog.html.SafeHtml.unwrapTrustedHTML(html)};
goog.dom.safe.setInnerHtml=function(elem,html){if(goog.asserts.ENABLE_ASSERTS&&elem.tagName){var tagName=elem.tagName.toUpperCase();if(goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_[tagName])throw new Error("goog.dom.safe.setInnerHtml cannot be used to set content of "+elem.tagName+".");}goog.dom.safe.unsafeSetInnerHtmlDoNotUseOrElse(elem,html)};
goog.dom.safe.setInnerHtmlFromConstant=function(element,constHtml){goog.dom.safe.setInnerHtml(element,goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Constant HTML to be immediatelly used."),goog.string.Const.unwrap(constHtml)))};goog.dom.safe.setOuterHtml=function(elem,html){elem.outerHTML=goog.html.SafeHtml.unwrapTrustedHTML(html)};
goog.dom.safe.setFormElementAction=function(form,url){var safeUrl;if(url instanceof goog.html.SafeUrl)safeUrl=url;else safeUrl=goog.html.SafeUrl.sanitizeJavascriptUrlAssertUnchanged(url);goog.asserts.dom.assertIsHtmlFormElement(form).action=goog.html.SafeUrl.unwrap(safeUrl)};
goog.dom.safe.setButtonFormAction=function(button,url){var safeUrl;if(url instanceof goog.html.SafeUrl)safeUrl=url;else safeUrl=goog.html.SafeUrl.sanitizeJavascriptUrlAssertUnchanged(url);goog.asserts.dom.assertIsHtmlButtonElement(button).formAction=goog.html.SafeUrl.unwrap(safeUrl)};
goog.dom.safe.setInputFormAction=function(input,url){var safeUrl;if(url instanceof goog.html.SafeUrl)safeUrl=url;else safeUrl=goog.html.SafeUrl.sanitizeJavascriptUrlAssertUnchanged(url);goog.asserts.dom.assertIsHtmlInputElement(input).formAction=goog.html.SafeUrl.unwrap(safeUrl)};goog.dom.safe.setStyle=function(elem,style){elem.style.cssText=goog.html.SafeStyle.unwrap(style)};goog.dom.safe.documentWrite=function(doc,html){doc.write(goog.html.SafeHtml.unwrapTrustedHTML(html))};
goog.dom.safe.setAnchorHref=function(anchor,url){goog.asserts.dom.assertIsHtmlAnchorElement(anchor);var safeUrl;if(url instanceof goog.html.SafeUrl)safeUrl=url;else safeUrl=goog.html.SafeUrl.sanitizeJavascriptUrlAssertUnchanged(url);anchor.href=goog.html.SafeUrl.unwrap(safeUrl)};
goog.dom.safe.setAudioSrc=function(audioElement,url){goog.asserts.dom.assertIsHtmlAudioElement(audioElement);var safeUrl;if(url instanceof goog.html.SafeUrl)safeUrl=url;else safeUrl=goog.html.SafeUrl.sanitizeJavascriptUrlAssertUnchanged(url);audioElement.src=goog.html.SafeUrl.unwrap(safeUrl)};
goog.dom.safe.setVideoSrc=function(videoElement,url){goog.asserts.dom.assertIsHtmlVideoElement(videoElement);var safeUrl;if(url instanceof goog.html.SafeUrl)safeUrl=url;else safeUrl=goog.html.SafeUrl.sanitizeJavascriptUrlAssertUnchanged(url);videoElement.src=goog.html.SafeUrl.unwrap(safeUrl)};goog.dom.safe.setEmbedSrc=function(embed,url){goog.asserts.dom.assertIsHtmlEmbedElement(embed);embed.src=goog.html.TrustedResourceUrl.unwrapTrustedScriptURL(url)};
goog.dom.safe.setFrameSrc=function(frame,url){goog.asserts.dom.assertIsHtmlFrameElement(frame);frame.src=goog.html.TrustedResourceUrl.unwrap(url)};goog.dom.safe.setIframeSrc=function(iframe,url){goog.asserts.dom.assertIsHtmlIFrameElement(iframe);iframe.src=goog.html.TrustedResourceUrl.unwrap(url)};goog.dom.safe.setIframeSrcdoc=function(iframe,html){goog.asserts.dom.assertIsHtmlIFrameElement(iframe);iframe.srcdoc=goog.html.SafeHtml.unwrapTrustedHTML(html)};
goog.dom.safe.setLinkHrefAndRel=function(link,url,rel){goog.asserts.dom.assertIsHtmlLinkElement(link);link.rel=rel;if(goog.string.internal.caseInsensitiveContains(rel,"stylesheet")){goog.asserts.assert(url instanceof goog.html.TrustedResourceUrl,'URL must be TrustedResourceUrl because "rel" contains "stylesheet"');link.href=goog.html.TrustedResourceUrl.unwrap(url);const win=link.ownerDocument&&link.ownerDocument.defaultView;const nonce=goog.dom.safe.getStyleNonce(win);if(nonce)link.setAttribute("nonce",
nonce)}else if(url instanceof goog.html.TrustedResourceUrl)link.href=goog.html.TrustedResourceUrl.unwrap(url);else if(url instanceof goog.html.SafeUrl)link.href=goog.html.SafeUrl.unwrap(url);else link.href=goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitizeJavascriptUrlAssertUnchanged(url))};goog.dom.safe.setObjectData=function(object,url){goog.asserts.dom.assertIsHtmlObjectElement(object);object.data=goog.html.TrustedResourceUrl.unwrapTrustedScriptURL(url)};
goog.dom.safe.setScriptSrc=function(script,url){goog.asserts.dom.assertIsHtmlScriptElement(script);goog.dom.safe.setNonceForScriptElement_(script);script.src=goog.html.TrustedResourceUrl.unwrapTrustedScriptURL(url)};goog.dom.safe.setScriptContent=function(script,content){goog.asserts.dom.assertIsHtmlScriptElement(script);goog.dom.safe.setNonceForScriptElement_(script);script.textContent=goog.html.SafeScript.unwrapTrustedScript(content)};
goog.dom.safe.setNonceForScriptElement_=function(script){var win=script.ownerDocument&&script.ownerDocument.defaultView;const nonce=goog.dom.safe.getScriptNonce(win);if(nonce)script.setAttribute("nonce",nonce)};goog.dom.safe.setLocationHref=function(loc,url){goog.dom.asserts.assertIsLocation(loc);var safeUrl;if(url instanceof goog.html.SafeUrl)safeUrl=url;else safeUrl=goog.html.SafeUrl.sanitizeJavascriptUrlAssertUnchanged(url);loc.href=goog.html.SafeUrl.unwrap(safeUrl)};
goog.dom.safe.assignLocation=function(loc,url){goog.dom.asserts.assertIsLocation(loc);var safeUrl;if(url instanceof goog.html.SafeUrl)safeUrl=url;else safeUrl=goog.html.SafeUrl.sanitizeJavascriptUrlAssertUnchanged(url);loc.assign(goog.html.SafeUrl.unwrap(safeUrl))};goog.dom.safe.replaceLocation=function(loc,url){var safeUrl;if(url instanceof goog.html.SafeUrl)safeUrl=url;else safeUrl=goog.html.SafeUrl.sanitizeJavascriptUrlAssertUnchanged(url);loc.replace(goog.html.SafeUrl.unwrap(safeUrl))};
goog.dom.safe.openInWindow=function(url,opt_openerWin,opt_name,opt_specs){var safeUrl;if(url instanceof goog.html.SafeUrl)safeUrl=url;else safeUrl=goog.html.SafeUrl.sanitizeJavascriptUrlAssertUnchanged(url);var win=opt_openerWin||goog.global;var name=opt_name instanceof goog.string.Const?goog.string.Const.unwrap(opt_name):opt_name||"";if(opt_specs!==undefined)return win.open(goog.html.SafeUrl.unwrap(safeUrl),name,opt_specs);else return win.open(goog.html.SafeUrl.unwrap(safeUrl),name)};
goog.dom.safe.parseFromStringHtml=function(parser,html){return goog.dom.safe.parseFromString(parser,html,"text/html")};goog.dom.safe.parseFromString=function(parser,content,type){return parser.parseFromString(goog.html.SafeHtml.unwrapTrustedHTML(content),type)};
goog.dom.safe.createImageFromBlob=function(blob){if(!/^image\/.*/g.test(blob.type))throw new Error("goog.dom.safe.createImageFromBlob only accepts MIME type image/.*.");var objectUrl=goog.global.URL.createObjectURL(blob);var image=new goog.global.Image;image.onload=function(){goog.global.URL.revokeObjectURL(objectUrl)};image.src=objectUrl;return image};goog.dom.safe.createContextualFragment=function(range,html){return range.createContextualFragment(goog.html.SafeHtml.unwrapTrustedHTML(html))};
goog.dom.safe.getScriptNonce=function(opt_window){return goog.dom.safe.getNonce_("script[nonce]",opt_window)};goog.dom.safe.getStyleNonce=function(opt_window){return goog.dom.safe.getNonce_('style[nonce],link[rel="stylesheet"][nonce]',opt_window)};goog.dom.safe.NONCE_PATTERN_=/^[\w+/_-]+[=]{0,2}$/;
goog.dom.safe.getNonce_=function(selector,win){const doc=(win||goog.global).document;if(!doc.querySelector)return"";let el=doc.querySelector(selector);if(el){const nonce=el["nonce"]||el.getAttribute("nonce");if(nonce&&goog.dom.safe.NONCE_PATTERN_.test(nonce))return nonce}return""};goog.provide("goog.math.Size");goog.math.Size=function(width,height){this.width=width;this.height=height};goog.math.Size.equals=function(a,b){if(a==b)return true;if(!a||!b)return false;return a.width==b.width&&a.height==b.height};goog.math.Size.prototype.clone=function(){return new goog.math.Size(this.width,this.height)};if(goog.DEBUG)goog.math.Size.prototype.toString=function(){return"("+this.width+" x "+this.height+")"};goog.math.Size.prototype.getLongest=function(){return Math.max(this.width,this.height)};
goog.math.Size.prototype.getShortest=function(){return Math.min(this.width,this.height)};goog.math.Size.prototype.area=function(){return this.width*this.height};goog.math.Size.prototype.perimeter=function(){return(this.width+this.height)*2};goog.math.Size.prototype.aspectRatio=function(){return this.width/this.height};goog.math.Size.prototype.isEmpty=function(){return!this.area()};goog.math.Size.prototype.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};
goog.math.Size.prototype.fitsInside=function(target){return this.width<=target.width&&this.height<=target.height};goog.math.Size.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};goog.math.Size.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Size.prototype.scale=function(sx,opt_sy){const sy=typeof opt_sy==="number"?opt_sy:sx;this.width*=sx;this.height*=sy;return this};
goog.math.Size.prototype.scaleToCover=function(target){const s=this.aspectRatio()<=target.aspectRatio()?target.width/this.width:target.height/this.height;return this.scale(s)};goog.math.Size.prototype.scaleToFit=function(target){const s=this.aspectRatio()>target.aspectRatio()?target.width/this.width:target.height/this.height;return this.scale(s)};goog.provide("goog.string");goog.provide("goog.string.Unicode");goog.require("goog.dom.safe");goog.require("goog.html.uncheckedconversions");goog.require("goog.string.Const");goog.require("goog.string.internal");goog.string.DETECT_DOUBLE_ESCAPING=goog.define("goog.string.DETECT_DOUBLE_ESCAPING",false);goog.string.FORCE_NON_DOM_HTML_UNESCAPING=goog.define("goog.string.FORCE_NON_DOM_HTML_UNESCAPING",false);goog.string.Unicode={NBSP:"\u00a0",ZERO_WIDTH_SPACE:"\u200b"};goog.string.startsWith=goog.string.internal.startsWith;
goog.string.endsWith=goog.string.internal.endsWith;goog.string.caseInsensitiveStartsWith=goog.string.internal.caseInsensitiveStartsWith;goog.string.caseInsensitiveEndsWith=goog.string.internal.caseInsensitiveEndsWith;goog.string.caseInsensitiveEquals=goog.string.internal.caseInsensitiveEquals;
goog.string.subs=function(str,var_args){const splitParts=str.split("%s");let returnString="";const subsArguments=Array.prototype.slice.call(arguments,1);while(subsArguments.length&&splitParts.length>1)returnString+=splitParts.shift()+subsArguments.shift();return returnString+splitParts.join("%s")};goog.string.collapseWhitespace=function(str){return str.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")};goog.string.isEmptyOrWhitespace=goog.string.internal.isEmptyOrWhitespace;
goog.string.isEmptyString=function(str){return str.length==0};goog.string.isEmpty=goog.string.isEmptyOrWhitespace;goog.string.isEmptyOrWhitespaceSafe=function(str){return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(str))};goog.string.isEmptySafe=goog.string.isEmptyOrWhitespaceSafe;goog.string.isBreakingWhitespace=function(str){return!/[^\t\n\r ]/.test(str)};goog.string.isAlpha=function(str){return!/[^a-zA-Z]/.test(str)};goog.string.isNumeric=function(str){return!/[^0-9]/.test(str)};
goog.string.isAlphaNumeric=function(str){return!/[^a-zA-Z0-9]/.test(str)};goog.string.isSpace=function(ch){return ch==" "};goog.string.isUnicodeChar=function(ch){return ch.length==1&&ch>=" "&&ch<="~"||ch>="\u0080"&&ch<="\ufffd"};goog.string.stripNewlines=function(str){return str.replace(/(\r\n|\r|\n)+/g," ")};goog.string.canonicalizeNewlines=function(str){return str.replace(/(\r\n|\r|\n)/g,"\n")};goog.string.normalizeWhitespace=function(str){return str.replace(/\xa0|\s/g," ")};
goog.string.normalizeSpaces=function(str){return str.replace(/\xa0|[ \t]+/g," ")};goog.string.collapseBreakingSpaces=function(str){return str.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")};goog.string.trim=goog.string.internal.trim;goog.string.trimLeft=function(str){return str.replace(/^[\s\xa0]+/,"")};goog.string.trimRight=function(str){return str.replace(/[\s\xa0]+$/,"")};goog.string.caseInsensitiveCompare=goog.string.internal.caseInsensitiveCompare;
goog.string.numberAwareCompare_=function(str1,str2,tokenizerRegExp){if(str1==str2)return 0;if(!str1)return-1;if(!str2)return 1;const tokens1=str1.toLowerCase().match(tokenizerRegExp);const tokens2=str2.toLowerCase().match(tokenizerRegExp);const count=Math.min(tokens1.length,tokens2.length);for(let i=0;i<count;i++){const a=tokens1[i];const b=tokens2[i];if(a!=b){const num1=parseInt(a,10);if(!isNaN(num1)){const num2=parseInt(b,10);if(!isNaN(num2)&&num1-num2)return num1-num2}return a<b?-1:1}}if(tokens1.length!=
tokens2.length)return tokens1.length-tokens2.length;return str1<str2?-1:1};goog.string.intAwareCompare=function(str1,str2){return goog.string.numberAwareCompare_(str1,str2,/\d+|\D+/g)};goog.string.floatAwareCompare=function(str1,str2){return goog.string.numberAwareCompare_(str1,str2,/\d+|\.\d+|\D+/g)};goog.string.numerateCompare=goog.string.floatAwareCompare;goog.string.urlEncode=function(str){return encodeURIComponent(String(str))};
goog.string.urlDecode=function(str){return decodeURIComponent(str.replace(/\+/g," "))};goog.string.newLineToBr=goog.string.internal.newLineToBr;goog.string.htmlEscape=function(str,opt_isLikelyToContainHtmlChars){str=goog.string.internal.htmlEscape(str,opt_isLikelyToContainHtmlChars);if(goog.string.DETECT_DOUBLE_ESCAPING)str=str.replace(goog.string.E_RE_,"&#101;");return str};goog.string.E_RE_=/e/g;
goog.string.unescapeEntities=function(str){if(goog.string.contains(str,"&"))if(!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document"in goog.global)return goog.string.unescapeEntitiesUsingDom_(str);else return goog.string.unescapePureXmlEntities_(str);return str};goog.string.unescapeEntitiesWithDocument=function(str,document){if(goog.string.contains(str,"&"))return goog.string.unescapeEntitiesUsingDom_(str,document);return str};
goog.string.unescapeEntitiesUsingDom_=function(str,opt_document){const seen={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'};let div;if(opt_document)div=opt_document.createElement("div");else div=goog.global.document.createElement("div");return str.replace(goog.string.HTML_ENTITY_PATTERN_,function(s,entity){let value=seen[s];if(value)return value;if(entity.charAt(0)=="#"){const n=Number("0"+entity.slice(1));if(!isNaN(n))value=String.fromCharCode(n)}if(!value){goog.dom.safe.setInnerHtml(div,goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Single HTML entity."),
s+" "));value=div.firstChild.nodeValue.slice(0,-1)}return seen[s]=value})};goog.string.unescapePureXmlEntities_=function(str){return str.replace(/&([^;]+);/g,function(s,entity){switch(entity){case "amp":return"&";case "lt":return"<";case "gt":return">";case "quot":return'"';default:if(entity.charAt(0)=="#"){const n=Number("0"+entity.slice(1));if(!isNaN(n))return String.fromCharCode(n)}return s}})};goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g;
goog.string.whitespaceEscape=function(str,opt_xml){return goog.string.newLineToBr(str.replace(/  /g," &#160;"),opt_xml)};goog.string.preserveSpaces=function(str){return str.replace(/(^|[\n ]) /g,"$1"+goog.string.Unicode.NBSP)};goog.string.stripQuotes=function(str,quoteChars){const length=quoteChars.length;for(let i=0;i<length;i++){const quoteChar=length==1?quoteChars:quoteChars.charAt(i);if(str.charAt(0)==quoteChar&&str.charAt(str.length-1)==quoteChar)return str.substring(1,str.length-1)}return str};
goog.string.truncate=function(str,chars,opt_protectEscapedCharacters){if(opt_protectEscapedCharacters)str=goog.string.unescapeEntities(str);if(str.length>chars)str=str.substring(0,chars-3)+"...";if(opt_protectEscapedCharacters)str=goog.string.htmlEscape(str);return str};
goog.string.truncateMiddle=function(str,chars,opt_protectEscapedCharacters,opt_trailingChars){if(opt_protectEscapedCharacters)str=goog.string.unescapeEntities(str);if(opt_trailingChars&&str.length>chars){if(opt_trailingChars>chars)opt_trailingChars=chars;const endPoint=str.length-opt_trailingChars;const startPoint=chars-opt_trailingChars;str=str.substring(0,startPoint)+"..."+str.substring(endPoint)}else if(str.length>chars){let half=Math.floor(chars/2);const endPos=str.length-half;half+=chars%2;str=
str.substring(0,half)+"..."+str.substring(endPos)}if(opt_protectEscapedCharacters)str=goog.string.htmlEscape(str);return str};goog.string.specialEscapeChars_={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\","<":"\\u003C"};goog.string.jsEscapeCache_={"'":"\\'"};
goog.string.quote=function(s){s=String(s);const sb=['"'];for(let i=0;i<s.length;i++){const ch=s.charAt(i);const cc=ch.charCodeAt(0);sb[i+1]=goog.string.specialEscapeChars_[ch]||(cc>31&&cc<127?ch:goog.string.escapeChar(ch))}sb.push('"');return sb.join("")};goog.string.escapeString=function(str){const sb=[];for(let i=0;i<str.length;i++)sb[i]=goog.string.escapeChar(str.charAt(i));return sb.join("")};
goog.string.escapeChar=function(c){if(c in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[c];if(c in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[c]=goog.string.specialEscapeChars_[c];let rv=c;const cc=c.charCodeAt(0);if(cc>31&&cc<127)rv=c;else{if(cc<256){rv="\\x";if(cc<16||cc>256)rv+="0"}else{rv="\\u";if(cc<4096)rv+="0"}rv+=cc.toString(16).toUpperCase()}return goog.string.jsEscapeCache_[c]=rv};goog.string.contains=goog.string.internal.contains;
goog.string.caseInsensitiveContains=goog.string.internal.caseInsensitiveContains;goog.string.countOf=function(s,ss){return s&&ss?s.split(ss).length-1:0};goog.string.removeAt=function(s,index,stringLength){let resultStr=s;if(index>=0&&index<s.length&&stringLength>0)resultStr=s.slice(0,index)+s.slice(index+stringLength);return resultStr};goog.string.remove=function(str,substr){return str.replace(substr,"")};
goog.string.removeAll=function(s,ss){const re=new RegExp(goog.string.regExpEscape(ss),"g");return s.replace(re,"")};goog.string.replaceAll=function(s,ss,replacement){const re=new RegExp(goog.string.regExpEscape(ss),"g");return s.replace(re,replacement.replace(/\$/g,"$$$$"))};goog.string.regExpEscape=function(s){return String(s).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};
goog.string.repeat=String.prototype.repeat?function(string,length){return string.repeat(length)}:function(string,length){return(new Array(length+1)).join(string)};
goog.string.padNumber=function(num,length,opt_precision){if(!Number.isFinite(num))return String(num);let s=opt_precision!==undefined?num.toFixed(opt_precision):String(num);let index=s.indexOf(".");if(index===-1)index=s.length;const sign=s[0]==="-"?"-":"";if(sign)s=s.substring(1);return sign+goog.string.repeat("0",Math.max(0,length-index))+s};goog.string.makeSafe=function(obj){return obj==null?"":String(obj)};
goog.string.getRandomString=function(){const x=2147483648;return Math.floor(Math.random()*x).toString(36)+Math.abs(Math.floor(Math.random()*x)^goog.now()).toString(36)};goog.string.compareVersions=goog.string.internal.compareVersions;goog.string.hashCode=function(str){let result=0;for(let i=0;i<str.length;++i)result=31*result+str.charCodeAt(i)>>>0;return result};goog.string.uniqueStringCounter_=Math.random()*2147483648|0;goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++};
goog.string.toNumber=function(str){const num=Number(str);if(num==0&&goog.string.isEmptyOrWhitespace(str))return NaN;return num};goog.string.isLowerCamelCase=function(str){return/^[a-z]+([A-Z][a-z]*)*$/.test(str)};goog.string.isUpperCamelCase=function(str){return/^([A-Z][a-z]*)+$/.test(str)};goog.string.toCamelCase=function(str){return String(str).replace(/\-([a-z])/g,function(all,match){return match.toUpperCase()})};goog.string.toSelectorCase=function(str){return String(str).replace(/([A-Z])/g,"-$1").toLowerCase()};
goog.string.toTitleCase=function(str,opt_delimiters){let delimiters=typeof opt_delimiters==="string"?goog.string.regExpEscape(opt_delimiters):"\\s";delimiters=delimiters?"|["+delimiters+"]+":"";const regexp=new RegExp("(^"+delimiters+")([a-z])","g");return str.replace(regexp,function(all,p1,p2){return p1+p2.toUpperCase()})};goog.string.capitalize=function(str){return String(str.charAt(0)).toUpperCase()+String(str.slice(1)).toLowerCase()};
goog.string.parseInt=function(value){if(isFinite(value))value=String(value);if(typeof value==="string")return/^\s*-?0x/i.test(value)?parseInt(value,16):parseInt(value,10);return NaN};goog.string.splitLimit=function(str,separator,limit){const parts=str.split(separator);const returnVal=[];while(limit>0&&parts.length){returnVal.push(parts.shift());limit--}if(parts.length)returnVal.push(parts.join(separator));return returnVal};
goog.string.lastComponent=function(str,separators){if(!separators)return str;else if(typeof separators=="string")separators=[separators];let lastSeparatorIndex=-1;for(let i=0;i<separators.length;i++){if(separators[i]=="")continue;const currentSeparatorIndex=str.lastIndexOf(separators[i]);if(currentSeparatorIndex>lastSeparatorIndex)lastSeparatorIndex=currentSeparatorIndex}if(lastSeparatorIndex==-1)return str;return str.slice(lastSeparatorIndex+1)};
goog.string.editDistance=function(a,b){const v0=[];const v1=[];if(a==b)return 0;if(!a.length||!b.length)return Math.max(a.length,b.length);for(let i=0;i<b.length+1;i++)v0[i]=i;for(let i=0;i<a.length;i++){v1[0]=i+1;for(let j=0;j<b.length;j++){const cost=Number(a[i]!=b[j]);v1[j+1]=Math.min(v1[j]+1,v0[j+1]+1,v0[j]+cost)}for(let j=0;j<v0.length;j++)v0[j]=v1[j]}return v1[b.length]};goog.provide("goog.dom");goog.provide("goog.dom.Appendable");goog.provide("goog.dom.DomHelper");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.asserts.dom");goog.require("goog.dom.BrowserFeature");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.dom.safe");goog.require("goog.html.SafeHtml");goog.require("goog.html.uncheckedconversions");goog.require("goog.math.Coordinate");goog.require("goog.math.Size");goog.require("goog.object");goog.require("goog.string");
goog.require("goog.string.Const");goog.require("goog.string.Unicode");goog.require("goog.userAgent");goog.dom.ASSUME_QUIRKS_MODE=goog.define("goog.dom.ASSUME_QUIRKS_MODE",false);goog.dom.ASSUME_STANDARDS_MODE=goog.define("goog.dom.ASSUME_STANDARDS_MODE",false);goog.dom.COMPAT_MODE_KNOWN_=goog.dom.ASSUME_QUIRKS_MODE||goog.dom.ASSUME_STANDARDS_MODE;
goog.dom.getDomHelper=function(opt_element){return opt_element?new goog.dom.DomHelper(goog.dom.getOwnerDocument(opt_element)):goog.dom.defaultDomHelper_||(goog.dom.defaultDomHelper_=new goog.dom.DomHelper)};goog.dom.defaultDomHelper_;goog.dom.getDocument=function(){return document};goog.dom.getElement=function(element){return goog.dom.getElementHelper_(document,element)};goog.dom.getHTMLElement=function(id){const element=goog.dom.getElement(id);if(!element)return null;return goog.asserts.dom.assertIsHtmlElement(element)};
goog.dom.getElementHelper_=function(doc,element){return typeof element==="string"?doc.getElementById(element):element};goog.dom.getRequiredElement=function(id){return goog.dom.getRequiredElementHelper_(document,id)};goog.dom.getRequiredHTMLElement=function(id){return goog.asserts.dom.assertIsHtmlElement(goog.dom.getRequiredElementHelper_(document,id))};
goog.dom.getRequiredElementHelper_=function(doc,id){goog.asserts.assertString(id);var element=goog.dom.getElementHelper_(doc,id);return goog.asserts.assert(element,"No element found with id: "+id)};goog.dom.$=goog.dom.getElement;goog.dom.getElementsByTagName=function(tagName,opt_parent){var parent=opt_parent||document;return parent.getElementsByTagName(String(tagName))};
goog.dom.getElementsByTagNameAndClass=function(opt_tag,opt_class,opt_el){return goog.dom.getElementsByTagNameAndClass_(document,opt_tag,opt_class,opt_el)};goog.dom.getElementByTagNameAndClass=function(opt_tag,opt_class,opt_el){return goog.dom.getElementByTagNameAndClass_(document,opt_tag,opt_class,opt_el)};
goog.dom.getElementsByClass=function(className,opt_el){var parent=opt_el||document;if(goog.dom.canUseQuerySelector_(parent))return parent.querySelectorAll("."+className);return goog.dom.getElementsByTagNameAndClass_(document,"*",className,opt_el)};
goog.dom.getElementByClass=function(className,opt_el){var parent=opt_el||document;var retVal=null;if(parent.getElementsByClassName)retVal=parent.getElementsByClassName(className)[0];else retVal=goog.dom.getElementByTagNameAndClass_(document,"*",className,opt_el);return retVal||null};goog.dom.getHTMLElementByClass=function(className,opt_parent){const element=goog.dom.getElementByClass(className,opt_parent);if(!element)return null;return goog.asserts.dom.assertIsHtmlElement(element)};
goog.dom.getRequiredElementByClass=function(className,opt_root){var retValue=goog.dom.getElementByClass(className,opt_root);return goog.asserts.assert(retValue,"No element found with className: "+className)};goog.dom.getRequiredHTMLElementByClass=function(className,opt_parent){const retValue=goog.dom.getElementByClass(className,opt_parent);goog.asserts.assert(retValue,"No HTMLElement found with className: "+className);return goog.asserts.dom.assertIsHtmlElement(retValue)};
goog.dom.canUseQuerySelector_=function(parent){return!!(parent.querySelectorAll&&parent.querySelector)};
goog.dom.getElementsByTagNameAndClass_=function(doc,opt_tag,opt_class,opt_el){var parent=opt_el||doc;var tagName=opt_tag&&opt_tag!="*"?String(opt_tag).toUpperCase():"";if(goog.dom.canUseQuerySelector_(parent)&&(tagName||opt_class)){var query=tagName+(opt_class?"."+opt_class:"");return parent.querySelectorAll(query)}if(opt_class&&parent.getElementsByClassName){var els=parent.getElementsByClassName(opt_class);if(tagName){var arrayLike={};var len=0;for(var i=0,el;el=els[i];i++)if(tagName==el.nodeName)arrayLike[len++]=
el;arrayLike.length=len;return arrayLike}else return els}var els=parent.getElementsByTagName(tagName||"*");if(opt_class){var arrayLike={};var len=0;for(var i=0,el;el=els[i];i++){var className=el.className;if(typeof className.split=="function"&&goog.array.contains(className.split(/\s+/),opt_class))arrayLike[len++]=el}arrayLike.length=len;return arrayLike}else return els};
goog.dom.getElementByTagNameAndClass_=function(doc,opt_tag,opt_class,opt_el){var parent=opt_el||doc;var tag=opt_tag&&opt_tag!="*"?String(opt_tag).toUpperCase():"";if(goog.dom.canUseQuerySelector_(parent)&&(tag||opt_class))return parent.querySelector(tag+(opt_class?"."+opt_class:""));var elements=goog.dom.getElementsByTagNameAndClass_(doc,opt_tag,opt_class,opt_el);return elements[0]||null};goog.dom.$$=goog.dom.getElementsByTagNameAndClass;
goog.dom.setProperties=function(element,properties){goog.object.forEach(properties,function(val,key){if(val&&typeof val=="object"&&val.implementsGoogStringTypedString)val=val.getTypedStringValue();if(key=="style")element.style.cssText=val;else if(key=="class")element.className=val;else if(key=="for")element.htmlFor=val;else if(goog.dom.DIRECT_ATTRIBUTE_MAP_.hasOwnProperty(key))element.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[key],val);else if(goog.string.startsWith(key,"aria-")||goog.string.startsWith(key,
"data-"))element.setAttribute(key,val);else element[key]=val})};goog.dom.DIRECT_ATTRIBUTE_MAP_={"cellpadding":"cellPadding","cellspacing":"cellSpacing","colspan":"colSpan","frameborder":"frameBorder","height":"height","maxlength":"maxLength","nonce":"nonce","role":"role","rowspan":"rowSpan","type":"type","usemap":"useMap","valign":"vAlign","width":"width"};goog.dom.getViewportSize=function(opt_window){return goog.dom.getViewportSize_(opt_window||window)};
goog.dom.getViewportSize_=function(win){var doc=win.document;var el=goog.dom.isCss1CompatMode_(doc)?doc.documentElement:doc.body;return new goog.math.Size(el.clientWidth,el.clientHeight)};goog.dom.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(window)};goog.dom.getDocumentHeightForWindow=function(win){return goog.dom.getDocumentHeight_(win)};
goog.dom.getDocumentHeight_=function(win){var doc=win.document;var height=0;if(doc){var body=doc.body;var docEl=doc.documentElement;if(!(docEl&&body))return 0;var vh=goog.dom.getViewportSize_(win).height;if(goog.dom.isCss1CompatMode_(doc)&&docEl.scrollHeight)height=docEl.scrollHeight!=vh?docEl.scrollHeight:docEl.offsetHeight;else{var sh=docEl.scrollHeight;var oh=docEl.offsetHeight;if(docEl.clientHeight!=oh){sh=body.scrollHeight;oh=body.offsetHeight}if(sh>vh)height=sh>oh?sh:oh;else height=sh<oh?sh:
oh}}return height};goog.dom.getPageScroll=function(opt_window){var win=opt_window||goog.global||window;return goog.dom.getDomHelper(win.document).getDocumentScroll()};goog.dom.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(document)};
goog.dom.getDocumentScroll_=function(doc){var el=goog.dom.getDocumentScrollElement_(doc);var win=goog.dom.getWindow_(doc);if(goog.userAgent.IE&&win.pageYOffset!=el.scrollTop)return new goog.math.Coordinate(el.scrollLeft,el.scrollTop);return new goog.math.Coordinate(win.pageXOffset||el.scrollLeft,win.pageYOffset||el.scrollTop)};goog.dom.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(document)};
goog.dom.getDocumentScrollElement_=function(doc){if(doc.scrollingElement)return doc.scrollingElement;if(!goog.userAgent.WEBKIT&&goog.dom.isCss1CompatMode_(doc))return doc.documentElement;return doc.body||doc.documentElement};goog.dom.getWindow=function(opt_doc){return opt_doc?goog.dom.getWindow_(opt_doc):window};goog.dom.getWindow_=function(doc){return doc.parentWindow||doc.defaultView};goog.dom.createDom=function(tagName,opt_attributes,var_args){return goog.dom.createDom_(document,arguments)};
goog.dom.createDom_=function(doc,args){var tagName=String(args[0]);var attributes=args[1];var element=goog.dom.createElement_(doc,tagName);if(attributes)if(typeof attributes==="string")element.className=attributes;else if(Array.isArray(attributes))element.className=attributes.join(" ");else goog.dom.setProperties(element,attributes);if(args.length>2)goog.dom.append_(doc,element,args,2);return element};
goog.dom.append_=function(doc,parent,args,startIndex){function childHandler(child){if(child)parent.appendChild(typeof child==="string"?doc.createTextNode(child):child)}for(var i=startIndex;i<args.length;i++){var arg=args[i];if(goog.isArrayLike(arg)&&!goog.dom.isNodeLike(arg))goog.array.forEach(goog.dom.isNodeList(arg)?goog.array.toArray(arg):arg,childHandler);else childHandler(arg)}};goog.dom.$dom=goog.dom.createDom;goog.dom.createElement=function(name){return goog.dom.createElement_(document,name)};
goog.dom.createElement_=function(doc,name){name=String(name);if(doc.contentType==="application/xhtml+xml")name=name.toLowerCase();return doc.createElement(name)};goog.dom.createTextNode=function(content){return document.createTextNode(String(content))};goog.dom.createTable=function(rows,columns,opt_fillWithNbsp){return goog.dom.createTable_(document,rows,columns,!!opt_fillWithNbsp)};
goog.dom.createTable_=function(doc,rows,columns,fillWithNbsp){var table=goog.dom.createElement_(doc,goog.dom.TagName.TABLE);var tbody=table.appendChild(goog.dom.createElement_(doc,goog.dom.TagName.TBODY));for(var i=0;i<rows;i++){var tr=goog.dom.createElement_(doc,goog.dom.TagName.TR);for(var j=0;j<columns;j++){var td=goog.dom.createElement_(doc,goog.dom.TagName.TD);if(fillWithNbsp)goog.dom.setTextContent(td,goog.string.Unicode.NBSP);tr.appendChild(td)}tbody.appendChild(tr)}return table};
goog.dom.constHtmlToNode=function(var_args){var stringArray=Array.prototype.map.call(arguments,goog.string.Const.unwrap);var safeHtml=goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Constant HTML string, that gets turned into a "+"Node later, so it will be automatically balanced."),stringArray.join(""));return goog.dom.safeHtmlToNode(safeHtml)};goog.dom.safeHtmlToNode=function(html){return goog.dom.safeHtmlToNode_(document,html)};
goog.dom.safeHtmlToNode_=function(doc,html){var tempDiv=goog.dom.createElement_(doc,goog.dom.TagName.DIV);if(goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT){goog.dom.safe.setInnerHtml(tempDiv,goog.html.SafeHtml.concat(goog.html.SafeHtml.BR,html));tempDiv.removeChild(goog.asserts.assert(tempDiv.firstChild))}else goog.dom.safe.setInnerHtml(tempDiv,html);return goog.dom.childrenToNode_(doc,tempDiv)};
goog.dom.childrenToNode_=function(doc,tempDiv){if(tempDiv.childNodes.length==1)return tempDiv.removeChild(goog.asserts.assert(tempDiv.firstChild));else{var fragment=doc.createDocumentFragment();while(tempDiv.firstChild)fragment.appendChild(tempDiv.firstChild);return fragment}};goog.dom.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(document)};goog.dom.isCss1CompatMode_=function(doc){if(goog.dom.COMPAT_MODE_KNOWN_)return goog.dom.ASSUME_STANDARDS_MODE;return doc.compatMode=="CSS1Compat"};
goog.dom.canHaveChildren=function(node){if(node.nodeType!=goog.dom.NodeType.ELEMENT)return false;switch(node.tagName){case String(goog.dom.TagName.APPLET):case String(goog.dom.TagName.AREA):case String(goog.dom.TagName.BASE):case String(goog.dom.TagName.BR):case String(goog.dom.TagName.COL):case String(goog.dom.TagName.COMMAND):case String(goog.dom.TagName.EMBED):case String(goog.dom.TagName.FRAME):case String(goog.dom.TagName.HR):case String(goog.dom.TagName.IMG):case String(goog.dom.TagName.INPUT):case String(goog.dom.TagName.IFRAME):case String(goog.dom.TagName.ISINDEX):case String(goog.dom.TagName.KEYGEN):case String(goog.dom.TagName.LINK):case String(goog.dom.TagName.NOFRAMES):case String(goog.dom.TagName.NOSCRIPT):case String(goog.dom.TagName.META):case String(goog.dom.TagName.OBJECT):case String(goog.dom.TagName.PARAM):case String(goog.dom.TagName.SCRIPT):case String(goog.dom.TagName.SOURCE):case String(goog.dom.TagName.STYLE):case String(goog.dom.TagName.TRACK):case String(goog.dom.TagName.WBR):return false}return true};
goog.dom.appendChild=function(parent,child){goog.asserts.assert(parent!=null&&child!=null,"goog.dom.appendChild expects non-null arguments");parent.appendChild(child)};goog.dom.append=function(parent,var_args){goog.dom.append_(goog.dom.getOwnerDocument(parent),parent,arguments,1)};goog.dom.removeChildren=function(node){var child;while(child=node.firstChild)node.removeChild(child)};
goog.dom.insertSiblingBefore=function(newNode,refNode){goog.asserts.assert(newNode!=null&&refNode!=null,"goog.dom.insertSiblingBefore expects non-null arguments");if(refNode.parentNode)refNode.parentNode.insertBefore(newNode,refNode)};goog.dom.insertSiblingAfter=function(newNode,refNode){goog.asserts.assert(newNode!=null&&refNode!=null,"goog.dom.insertSiblingAfter expects non-null arguments");if(refNode.parentNode)refNode.parentNode.insertBefore(newNode,refNode.nextSibling)};
goog.dom.insertChildAt=function(parent,child,index){goog.asserts.assert(parent!=null,"goog.dom.insertChildAt expects a non-null parent");parent.insertBefore(child,parent.childNodes[index]||null)};goog.dom.removeNode=function(node){return node&&node.parentNode?node.parentNode.removeChild(node):null};
goog.dom.replaceNode=function(newNode,oldNode){goog.asserts.assert(newNode!=null&&oldNode!=null,"goog.dom.replaceNode expects non-null arguments");var parent=oldNode.parentNode;if(parent)parent.replaceChild(newNode,oldNode)};goog.dom.copyContents=function(target,source){goog.asserts.assert(target!=null&&source!=null,"goog.dom.copyContents expects non-null arguments");var childNodes=source.cloneNode(true).childNodes;goog.dom.removeChildren(target);while(childNodes.length)target.appendChild(childNodes[0])};
goog.dom.flattenElement=function(element){var child,parent=element.parentNode;if(parent&&parent.nodeType!=goog.dom.NodeType.DOCUMENT_FRAGMENT)if(element.removeNode)return element.removeNode(false);else{while(child=element.firstChild)parent.insertBefore(child,element);return goog.dom.removeNode(element)}};goog.dom.getChildren=function(element){if(element.children!=undefined)return element.children;return Array.prototype.filter.call(element.childNodes,function(node){return node.nodeType==goog.dom.NodeType.ELEMENT})};
goog.dom.getFirstElementChild=function(node){if(node.firstElementChild!==undefined)return node.firstElementChild;return goog.dom.getNextElementNode_(node.firstChild,true)};goog.dom.getLastElementChild=function(node){if(node.lastElementChild!==undefined)return node.lastElementChild;return goog.dom.getNextElementNode_(node.lastChild,false)};
goog.dom.getNextElementSibling=function(node){if(node.nextElementSibling!==undefined)return node.nextElementSibling;return goog.dom.getNextElementNode_(node.nextSibling,true)};goog.dom.getPreviousElementSibling=function(node){if(node.previousElementSibling!==undefined)return node.previousElementSibling;return goog.dom.getNextElementNode_(node.previousSibling,false)};
goog.dom.getNextElementNode_=function(node,forward){while(node&&node.nodeType!=goog.dom.NodeType.ELEMENT)node=forward?node.nextSibling:node.previousSibling;return node};goog.dom.getNextNode=function(node){if(!node)return null;if(node.firstChild)return node.firstChild;while(node&&!node.nextSibling)node=node.parentNode;return node?node.nextSibling:null};
goog.dom.getPreviousNode=function(node){if(!node)return null;if(!node.previousSibling)return node.parentNode;node=node.previousSibling;while(node&&node.lastChild)node=node.lastChild;return node};goog.dom.isNodeLike=function(obj){return goog.isObject(obj)&&obj.nodeType>0};goog.dom.isElement=function(obj){return goog.isObject(obj)&&obj.nodeType==goog.dom.NodeType.ELEMENT};goog.dom.isWindow=function(obj){return goog.isObject(obj)&&obj["window"]==obj};
goog.dom.getParentElement=function(element){var parent;if(goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY){parent=element.parentElement;if(parent)return parent}parent=element.parentNode;return goog.dom.isElement(parent)?parent:null};
goog.dom.contains=function(parent,descendant){if(!parent||!descendant)return false;if(parent.contains&&descendant.nodeType==goog.dom.NodeType.ELEMENT)return parent==descendant||parent.contains(descendant);if(typeof parent.compareDocumentPosition!="undefined")return parent==descendant||Boolean(parent.compareDocumentPosition(descendant)&16);while(descendant&&parent!=descendant)descendant=descendant.parentNode;return descendant==parent};
goog.dom.compareNodeOrder=function(node1,node2){if(node1==node2)return 0;if(node1.compareDocumentPosition)return node1.compareDocumentPosition(node2)&2?1:-1;if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){if(node1.nodeType==goog.dom.NodeType.DOCUMENT)return-1;if(node2.nodeType==goog.dom.NodeType.DOCUMENT)return 1}if("sourceIndex"in node1||node1.parentNode&&"sourceIndex"in node1.parentNode){var isElement1=node1.nodeType==goog.dom.NodeType.ELEMENT;var isElement2=node2.nodeType==goog.dom.NodeType.ELEMENT;
if(isElement1&&isElement2)return node1.sourceIndex-node2.sourceIndex;else{var parent1=node1.parentNode;var parent2=node2.parentNode;if(parent1==parent2)return goog.dom.compareSiblingOrder_(node1,node2);if(!isElement1&&goog.dom.contains(parent1,node2))return-1*goog.dom.compareParentsDescendantNodeIe_(node1,node2);if(!isElement2&&goog.dom.contains(parent2,node1))return goog.dom.compareParentsDescendantNodeIe_(node2,node1);return(isElement1?node1.sourceIndex:parent1.sourceIndex)-(isElement2?node2.sourceIndex:
parent2.sourceIndex)}}var doc=goog.dom.getOwnerDocument(node1);var range1,range2;range1=doc.createRange();range1.selectNode(node1);range1.collapse(true);range2=doc.createRange();range2.selectNode(node2);range2.collapse(true);return range1.compareBoundaryPoints(goog.global["Range"].START_TO_END,range2)};
goog.dom.compareParentsDescendantNodeIe_=function(textNode,node){var parent=textNode.parentNode;if(parent==node)return-1;var sibling=node;while(sibling.parentNode!=parent)sibling=sibling.parentNode;return goog.dom.compareSiblingOrder_(sibling,textNode)};goog.dom.compareSiblingOrder_=function(node1,node2){var s=node2;while(s=s.previousSibling)if(s==node1)return-1;return 1};
goog.dom.findCommonAncestor=function(var_args){var i,count=arguments.length;if(!count)return null;else if(count==1)return arguments[0];var paths=[];var minLength=Infinity;for(i=0;i<count;i++){var ancestors=[];var node=arguments[i];while(node){ancestors.unshift(node);node=node.parentNode}paths.push(ancestors);minLength=Math.min(minLength,ancestors.length)}var output=null;for(i=0;i<minLength;i++){var first=paths[0][i];for(var j=1;j<count;j++)if(first!=paths[j][i])return output;output=first}return output};
goog.dom.isInDocument=function(node){return(node.ownerDocument.compareDocumentPosition(node)&16)==16};goog.dom.getOwnerDocument=function(node){goog.asserts.assert(node,"Node cannot be null or undefined.");return node.nodeType==goog.dom.NodeType.DOCUMENT?node:node.ownerDocument||node.document};goog.dom.getFrameContentDocument=function(frame){return frame.contentDocument||frame.contentWindow.document};
goog.dom.getFrameContentWindow=function(frame){try{return frame.contentWindow||(frame.contentDocument?goog.dom.getWindow(frame.contentDocument):null)}catch(e){}return null};
goog.dom.setTextContent=function(node,text){goog.asserts.assert(node!=null,"goog.dom.setTextContent expects a non-null value for node");if("textContent"in node)node.textContent=text;else if(node.nodeType==goog.dom.NodeType.TEXT)node.data=String(text);else if(node.firstChild&&node.firstChild.nodeType==goog.dom.NodeType.TEXT){while(node.lastChild!=node.firstChild)node.removeChild(goog.asserts.assert(node.lastChild));node.firstChild.data=String(text)}else{goog.dom.removeChildren(node);var doc=goog.dom.getOwnerDocument(node);
node.appendChild(doc.createTextNode(String(text)))}};goog.dom.getOuterHtml=function(element){goog.asserts.assert(element!==null,"goog.dom.getOuterHtml expects a non-null value for element");if("outerHTML"in element)return element.outerHTML;else{var doc=goog.dom.getOwnerDocument(element);var div=goog.dom.createElement_(doc,goog.dom.TagName.DIV);div.appendChild(element.cloneNode(true));return div.innerHTML}};
goog.dom.findNode=function(root,p){var rv=[];var found=goog.dom.findNodes_(root,p,rv,true);return found?rv[0]:undefined};goog.dom.findNodes=function(root,p){var rv=[];goog.dom.findNodes_(root,p,rv,false);return rv};goog.dom.findNodes_=function(root,p,rv,findOne){if(root!=null){var child=root.firstChild;while(child){if(p(child)){rv.push(child);if(findOne)return true}if(goog.dom.findNodes_(child,p,rv,findOne))return true;child=child.nextSibling}}return false};
goog.dom.findElement=function(root,pred){var stack=goog.dom.getChildrenReverse_(root);while(stack.length>0){var next=stack.pop();if(pred(next))return next;for(var c=next.lastElementChild;c;c=c.previousElementSibling)stack.push(c)}return null};goog.dom.findElements=function(root,pred){var result=[],stack=goog.dom.getChildrenReverse_(root);while(stack.length>0){var next=stack.pop();if(pred(next))result.push(next);for(var c=next.lastElementChild;c;c=c.previousElementSibling)stack.push(c)}return result};
goog.dom.getChildrenReverse_=function(node){if(node.nodeType==goog.dom.NodeType.DOCUMENT)return[node.documentElement];else{var children=[];for(var c=node.lastElementChild;c;c=c.previousElementSibling)children.push(c);return children}};goog.dom.TAGS_TO_IGNORE_={"SCRIPT":1,"STYLE":1,"HEAD":1,"IFRAME":1,"OBJECT":1};goog.dom.PREDEFINED_TAG_VALUES_={"IMG":" ","BR":"\n"};goog.dom.isFocusableTabIndex=function(element){return goog.dom.hasSpecifiedTabIndex_(element)&&goog.dom.isTabIndexFocusable_(element)};
goog.dom.setFocusableTabIndex=function(element,enable){if(enable)element.tabIndex=0;else{element.tabIndex=-1;element.removeAttribute("tabIndex")}};goog.dom.isFocusable=function(element){var focusable;if(goog.dom.nativelySupportsFocus_(element))focusable=!element.disabled&&(!goog.dom.hasSpecifiedTabIndex_(element)||goog.dom.isTabIndexFocusable_(element));else focusable=goog.dom.isFocusableTabIndex(element);return focusable&&goog.userAgent.IE?goog.dom.hasNonZeroBoundingRect_(element):focusable};
goog.dom.hasSpecifiedTabIndex_=function(element){return element.hasAttribute("tabindex")};goog.dom.isTabIndexFocusable_=function(element){var index=element.tabIndex;return typeof index==="number"&&index>=0&&index<32768};goog.dom.nativelySupportsFocus_=function(element){return element.tagName==goog.dom.TagName.A&&element.hasAttribute("href")||element.tagName==goog.dom.TagName.INPUT||element.tagName==goog.dom.TagName.TEXTAREA||element.tagName==goog.dom.TagName.SELECT||element.tagName==goog.dom.TagName.BUTTON};
goog.dom.hasNonZeroBoundingRect_=function(element){var rect;if(typeof element["getBoundingClientRect"]!=="function"||goog.userAgent.IE&&element.parentElement==null)rect={"height":element.offsetHeight,"width":element.offsetWidth};else rect=element.getBoundingClientRect();return rect!=null&&rect.height>0&&rect.width>0};
goog.dom.getTextContent=function(node){var textContent;var buf=[];goog.dom.getTextContent_(node,buf,true);textContent=buf.join("");textContent=textContent.replace(/ \xAD /g," ").replace(/\xAD/g,"");textContent=textContent.replace(/\u200B/g,"");textContent=textContent.replace(/ +/g," ");if(textContent!=" ")textContent=textContent.replace(/^\s*/,"");return textContent};goog.dom.getRawTextContent=function(node){var buf=[];goog.dom.getTextContent_(node,buf,false);return buf.join("")};
goog.dom.getTextContent_=function(node,buf,normalizeWhitespace){if(node.nodeName in goog.dom.TAGS_TO_IGNORE_);else if(node.nodeType==goog.dom.NodeType.TEXT)if(normalizeWhitespace)buf.push(String(node.nodeValue).replace(/(\r\n|\r|\n)/g,""));else buf.push(node.nodeValue);else if(node.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)buf.push(goog.dom.PREDEFINED_TAG_VALUES_[node.nodeName]);else{var child=node.firstChild;while(child){goog.dom.getTextContent_(child,buf,normalizeWhitespace);child=child.nextSibling}}};
goog.dom.getNodeTextLength=function(node){return goog.dom.getTextContent(node).length};goog.dom.getNodeTextOffset=function(node,opt_offsetParent){var root=opt_offsetParent||goog.dom.getOwnerDocument(node).body;var buf=[];while(node&&node!=root){var cur=node;while(cur=cur.previousSibling)buf.unshift(goog.dom.getTextContent(cur));node=node.parentNode}return goog.string.trimLeft(buf.join("")).replace(/ +/g," ").length};
goog.dom.getNodeAtOffset=function(parent,offset,opt_result){var stack=[parent],pos=0,cur=null;while(stack.length>0&&pos<offset){cur=stack.pop();if(cur.nodeName in goog.dom.TAGS_TO_IGNORE_);else if(cur.nodeType==goog.dom.NodeType.TEXT){var text=cur.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," ");pos+=text.length}else if(cur.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)pos+=goog.dom.PREDEFINED_TAG_VALUES_[cur.nodeName].length;else for(var i=cur.childNodes.length-1;i>=0;i--)stack.push(cur.childNodes[i])}if(goog.isObject(opt_result)){opt_result.remainder=
cur?cur.nodeValue.length+offset-pos-1:0;opt_result.node=cur}return cur};goog.dom.isNodeList=function(val){if(val&&typeof val.length=="number")if(goog.isObject(val))return typeof val.item=="function"||typeof val.item=="string";else if(typeof val==="function")return typeof val.item=="function";return false};
goog.dom.getAncestorByTagNameAndClass=function(element,opt_tag,opt_class,opt_maxSearchSteps){if(!opt_tag&&!opt_class)return null;var tagName=opt_tag?String(opt_tag).toUpperCase():null;return goog.dom.getAncestor(element,function(node){return(!tagName||node.nodeName==tagName)&&(!opt_class||typeof node.className==="string"&&goog.array.contains(node.className.split(/\s+/),opt_class))},true,opt_maxSearchSteps)};
goog.dom.getAncestorByClass=function(element,className,opt_maxSearchSteps){return goog.dom.getAncestorByTagNameAndClass(element,null,className,opt_maxSearchSteps)};goog.dom.getAncestor=function(element,matcher,opt_includeNode,opt_maxSearchSteps){if(element&&!opt_includeNode)element=element.parentNode;var steps=0;while(element&&(opt_maxSearchSteps==null||steps<=opt_maxSearchSteps)){goog.asserts.assert(element.name!="parentNode");if(matcher(element))return element;element=element.parentNode;steps++}return null};
goog.dom.getActiveElement=function(doc){try{var activeElement=doc&&doc.activeElement;return activeElement&&activeElement.nodeName?activeElement:null}catch(e){return null}};goog.dom.getPixelRatio=function(){var win=goog.dom.getWindow();if(win.devicePixelRatio!==undefined)return win.devicePixelRatio;else if(win.matchMedia)return goog.dom.matchesPixelRatio_(3)||goog.dom.matchesPixelRatio_(2)||goog.dom.matchesPixelRatio_(1.5)||goog.dom.matchesPixelRatio_(1)||.75;return 1};
goog.dom.matchesPixelRatio_=function(pixelRatio){var win=goog.dom.getWindow();var dpiPerDppx=96;var query="(min-resolution: "+pixelRatio+"dppx),"+"(min--moz-device-pixel-ratio: "+pixelRatio+"),"+"(min-resolution: "+pixelRatio*dpiPerDppx+"dpi)";return win.matchMedia(query).matches?pixelRatio:0};goog.dom.getCanvasContext2D=function(canvas){return canvas.getContext("2d")};goog.dom.DomHelper=function(opt_document){this.document_=opt_document||goog.global.document||document};
goog.dom.DomHelper.prototype.getDomHelper=goog.dom.getDomHelper;goog.dom.DomHelper.prototype.setDocument=function(document){this.document_=document};goog.dom.DomHelper.prototype.getDocument=function(){return this.document_};goog.dom.DomHelper.prototype.getElement=function(element){return goog.dom.getElementHelper_(this.document_,element)};goog.dom.DomHelper.prototype.getRequiredElement=function(id){return goog.dom.getRequiredElementHelper_(this.document_,id)};goog.dom.DomHelper.prototype.$=goog.dom.DomHelper.prototype.getElement;
goog.dom.DomHelper.prototype.getElementsByTagName=function(tagName,opt_parent){var parent=opt_parent||this.document_;return parent.getElementsByTagName(String(tagName))};goog.dom.DomHelper.prototype.getElementsByTagNameAndClass=function(opt_tag,opt_class,opt_el){return goog.dom.getElementsByTagNameAndClass_(this.document_,opt_tag,opt_class,opt_el)};
goog.dom.DomHelper.prototype.getElementByTagNameAndClass=function(opt_tag,opt_class,opt_el){return goog.dom.getElementByTagNameAndClass_(this.document_,opt_tag,opt_class,opt_el)};goog.dom.DomHelper.prototype.getElementsByClass=function(className,opt_el){var doc=opt_el||this.document_;return goog.dom.getElementsByClass(className,doc)};goog.dom.DomHelper.prototype.getElementByClass=function(className,opt_el){var doc=opt_el||this.document_;return goog.dom.getElementByClass(className,doc)};
goog.dom.DomHelper.prototype.getRequiredElementByClass=function(className,opt_root){var root=opt_root||this.document_;return goog.dom.getRequiredElementByClass(className,root)};goog.dom.DomHelper.prototype.$$=goog.dom.DomHelper.prototype.getElementsByTagNameAndClass;goog.dom.DomHelper.prototype.setProperties=goog.dom.setProperties;goog.dom.DomHelper.prototype.getViewportSize=function(opt_window){return goog.dom.getViewportSize(opt_window||this.getWindow())};
goog.dom.DomHelper.prototype.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(this.getWindow())};goog.dom.Appendable;goog.dom.DomHelper.prototype.createDom=function(tagName,opt_attributes,var_args){return goog.dom.createDom_(this.document_,arguments)};goog.dom.DomHelper.prototype.$dom=goog.dom.DomHelper.prototype.createDom;goog.dom.DomHelper.prototype.createElement=function(name){return goog.dom.createElement_(this.document_,name)};goog.dom.DomHelper.prototype.createTextNode=function(content){return this.document_.createTextNode(String(content))};
goog.dom.DomHelper.prototype.createTable=function(rows,columns,opt_fillWithNbsp){return goog.dom.createTable_(this.document_,rows,columns,!!opt_fillWithNbsp)};goog.dom.DomHelper.prototype.safeHtmlToNode=function(html){return goog.dom.safeHtmlToNode_(this.document_,html)};goog.dom.DomHelper.prototype.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(this.document_)};goog.dom.DomHelper.prototype.getWindow=function(){return goog.dom.getWindow_(this.document_)};
goog.dom.DomHelper.prototype.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(this.document_)};goog.dom.DomHelper.prototype.getActiveElement=function(opt_doc){return goog.dom.getActiveElement(opt_doc||this.document_)};goog.dom.DomHelper.prototype.appendChild=goog.dom.appendChild;goog.dom.DomHelper.prototype.append=goog.dom.append;
goog.dom.DomHelper.prototype.canHaveChildren=goog.dom.canHaveChildren;goog.dom.DomHelper.prototype.removeChildren=goog.dom.removeChildren;goog.dom.DomHelper.prototype.insertSiblingBefore=goog.dom.insertSiblingBefore;goog.dom.DomHelper.prototype.insertSiblingAfter=goog.dom.insertSiblingAfter;goog.dom.DomHelper.prototype.insertChildAt=goog.dom.insertChildAt;goog.dom.DomHelper.prototype.removeNode=goog.dom.removeNode;goog.dom.DomHelper.prototype.replaceNode=goog.dom.replaceNode;
goog.dom.DomHelper.prototype.copyContents=goog.dom.copyContents;goog.dom.DomHelper.prototype.flattenElement=goog.dom.flattenElement;goog.dom.DomHelper.prototype.getChildren=goog.dom.getChildren;goog.dom.DomHelper.prototype.getFirstElementChild=goog.dom.getFirstElementChild;goog.dom.DomHelper.prototype.getLastElementChild=goog.dom.getLastElementChild;goog.dom.DomHelper.prototype.getNextElementSibling=goog.dom.getNextElementSibling;goog.dom.DomHelper.prototype.getPreviousElementSibling=goog.dom.getPreviousElementSibling;
goog.dom.DomHelper.prototype.getNextNode=goog.dom.getNextNode;goog.dom.DomHelper.prototype.getPreviousNode=goog.dom.getPreviousNode;goog.dom.DomHelper.prototype.isNodeLike=goog.dom.isNodeLike;goog.dom.DomHelper.prototype.isElement=goog.dom.isElement;goog.dom.DomHelper.prototype.isWindow=goog.dom.isWindow;goog.dom.DomHelper.prototype.getParentElement=goog.dom.getParentElement;goog.dom.DomHelper.prototype.contains=goog.dom.contains;goog.dom.DomHelper.prototype.compareNodeOrder=goog.dom.compareNodeOrder;
goog.dom.DomHelper.prototype.findCommonAncestor=goog.dom.findCommonAncestor;goog.dom.DomHelper.prototype.getOwnerDocument=goog.dom.getOwnerDocument;goog.dom.DomHelper.prototype.getFrameContentDocument=goog.dom.getFrameContentDocument;goog.dom.DomHelper.prototype.getFrameContentWindow=goog.dom.getFrameContentWindow;goog.dom.DomHelper.prototype.setTextContent=goog.dom.setTextContent;goog.dom.DomHelper.prototype.getOuterHtml=goog.dom.getOuterHtml;goog.dom.DomHelper.prototype.findNode=goog.dom.findNode;
goog.dom.DomHelper.prototype.findNodes=goog.dom.findNodes;goog.dom.DomHelper.prototype.isFocusableTabIndex=goog.dom.isFocusableTabIndex;goog.dom.DomHelper.prototype.setFocusableTabIndex=goog.dom.setFocusableTabIndex;goog.dom.DomHelper.prototype.isFocusable=goog.dom.isFocusable;goog.dom.DomHelper.prototype.getTextContent=goog.dom.getTextContent;goog.dom.DomHelper.prototype.getNodeTextLength=goog.dom.getNodeTextLength;goog.dom.DomHelper.prototype.getNodeTextOffset=goog.dom.getNodeTextOffset;
goog.dom.DomHelper.prototype.getNodeAtOffset=goog.dom.getNodeAtOffset;goog.dom.DomHelper.prototype.isNodeList=goog.dom.isNodeList;goog.dom.DomHelper.prototype.getAncestorByTagNameAndClass=goog.dom.getAncestorByTagNameAndClass;goog.dom.DomHelper.prototype.getAncestorByClass=goog.dom.getAncestorByClass;goog.dom.DomHelper.prototype.getAncestor=goog.dom.getAncestor;goog.dom.DomHelper.prototype.getCanvasContext2D=goog.dom.getCanvasContext2D;goog.provide("goog.dom.vendor");goog.require("goog.string");goog.require("goog.userAgent");goog.dom.vendor.getVendorJsPrefix=function(){if(goog.userAgent.WEBKIT)return"Webkit";else if(goog.userAgent.GECKO)return"Moz";else if(goog.userAgent.IE)return"ms";return null};goog.dom.vendor.getVendorPrefix=function(){if(goog.userAgent.WEBKIT)return"-webkit";else if(goog.userAgent.GECKO)return"-moz";else if(goog.userAgent.IE)return"-ms";return null};
goog.dom.vendor.getPrefixedPropertyName=function(propertyName,opt_object){if(opt_object&&propertyName in opt_object)return propertyName;var prefix=goog.dom.vendor.getVendorJsPrefix();if(prefix){prefix=prefix.toLowerCase();var prefixedPropertyName=prefix+goog.string.toTitleCase(propertyName);return opt_object===undefined||prefixedPropertyName in opt_object?prefixedPropertyName:null}return null};
goog.dom.vendor.getPrefixedEventType=function(eventType){var prefix=goog.dom.vendor.getVendorJsPrefix()||"";return(prefix+eventType).toLowerCase()};goog.provide("goog.math.IRect");goog.math.IRect=function(){};goog.math.IRect.prototype.left;goog.math.IRect.prototype.top;goog.math.IRect.prototype.width;goog.math.IRect.prototype.height;goog.provide("goog.math.Rect");goog.require("goog.asserts");goog.require("goog.math.Box");goog.require("goog.math.Coordinate");goog.require("goog.math.IRect");goog.require("goog.math.Size");goog.math.Rect=function(x,y,w,h){this.left=x;this.top=y;this.width=w;this.height=h};goog.math.Rect.prototype.clone=function(){return new goog.math.Rect(this.left,this.top,this.width,this.height)};
goog.math.Rect.prototype.toBox=function(){var right=this.left+this.width;var bottom=this.top+this.height;return new goog.math.Box(this.top,right,bottom,this.left)};goog.math.Rect.createFromPositionAndSize=function(position,size){return new goog.math.Rect(position.x,position.y,size.width,size.height)};goog.math.Rect.createFromBox=function(box){return new goog.math.Rect(box.left,box.top,box.right-box.left,box.bottom-box.top)};
if(goog.DEBUG)goog.math.Rect.prototype.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};goog.math.Rect.equals=function(a,b){if(a==b)return true;if(!a||!b)return false;return a.left==b.left&&a.width==b.width&&a.top==b.top&&a.height==b.height};
goog.math.Rect.prototype.intersection=function(rect){var x0=Math.max(this.left,rect.left);var x1=Math.min(this.left+this.width,rect.left+rect.width);if(x0<=x1){var y0=Math.max(this.top,rect.top);var y1=Math.min(this.top+this.height,rect.top+rect.height);if(y0<=y1){this.left=x0;this.top=y0;this.width=x1-x0;this.height=y1-y0;return true}}return false};
goog.math.Rect.intersection=function(a,b){var x0=Math.max(a.left,b.left);var x1=Math.min(a.left+a.width,b.left+b.width);if(x0<=x1){var y0=Math.max(a.top,b.top);var y1=Math.min(a.top+a.height,b.top+b.height);if(y0<=y1)return new goog.math.Rect(x0,y0,x1-x0,y1-y0)}return null};goog.math.Rect.intersects=function(a,b){return a.left<=b.left+b.width&&b.left<=a.left+a.width&&a.top<=b.top+b.height&&b.top<=a.top+a.height};
goog.math.Rect.prototype.intersects=function(rect){return goog.math.Rect.intersects(this,rect)};
goog.math.Rect.difference=function(a,b){var intersection=goog.math.Rect.intersection(a,b);if(!intersection||!intersection.height||!intersection.width)return[a.clone()];var result=[];var top=a.top;var height=a.height;var ar=a.left+a.width;var ab=a.top+a.height;var br=b.left+b.width;var bb=b.top+b.height;if(b.top>a.top){result.push(new goog.math.Rect(a.left,a.top,a.width,b.top-a.top));top=b.top;height-=b.top-a.top}if(bb<ab){result.push(new goog.math.Rect(a.left,bb,a.width,ab-bb));height=bb-top}if(b.left>
a.left)result.push(new goog.math.Rect(a.left,top,b.left-a.left,height));if(br<ar)result.push(new goog.math.Rect(br,top,ar-br,height));return result};goog.math.Rect.prototype.difference=function(rect){return goog.math.Rect.difference(this,rect)};
goog.math.Rect.prototype.boundingRect=function(rect){var right=Math.max(this.left+this.width,rect.left+rect.width);var bottom=Math.max(this.top+this.height,rect.top+rect.height);this.left=Math.min(this.left,rect.left);this.top=Math.min(this.top,rect.top);this.width=right-this.left;this.height=bottom-this.top};goog.math.Rect.boundingRect=function(a,b){if(!a||!b)return null;var newRect=new goog.math.Rect(a.left,a.top,a.width,a.height);newRect.boundingRect(b);return newRect};
goog.math.Rect.prototype.contains=function(another){if(another instanceof goog.math.Coordinate)return another.x>=this.left&&another.x<=this.left+this.width&&another.y>=this.top&&another.y<=this.top+this.height;else return this.left<=another.left&&this.left+this.width>=another.left+another.width&&this.top<=another.top&&this.top+this.height>=another.top+another.height};
goog.math.Rect.prototype.squaredDistance=function(point){var dx=point.x<this.left?this.left-point.x:Math.max(point.x-(this.left+this.width),0);var dy=point.y<this.top?this.top-point.y:Math.max(point.y-(this.top+this.height),0);return dx*dx+dy*dy};goog.math.Rect.prototype.distance=function(point){return Math.sqrt(this.squaredDistance(point))};goog.math.Rect.prototype.getSize=function(){return new goog.math.Size(this.width,this.height)};
goog.math.Rect.prototype.getTopLeft=function(){return new goog.math.Coordinate(this.left,this.top)};goog.math.Rect.prototype.getCenter=function(){return new goog.math.Coordinate(this.left+this.width/2,this.top+this.height/2)};goog.math.Rect.prototype.getBottomRight=function(){return new goog.math.Coordinate(this.left+this.width,this.top+this.height)};
goog.math.Rect.prototype.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};goog.math.Rect.prototype.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
goog.math.Rect.prototype.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Rect.prototype.translate=function(tx,opt_ty){if(tx instanceof goog.math.Coordinate){this.left+=tx.x;this.top+=tx.y}else{this.left+=goog.asserts.assertNumber(tx);if(typeof opt_ty==="number")this.top+=opt_ty}return this};
goog.math.Rect.prototype.scale=function(sx,opt_sy){var sy=typeof opt_sy==="number"?opt_sy:sx;this.left*=sx;this.width*=sx;this.top*=sy;this.height*=sy;return this};goog.provide("goog.style");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.NodeType");goog.require("goog.dom.TagName");goog.require("goog.dom.safe");goog.require("goog.dom.vendor");goog.require("goog.html.SafeStyleSheet");goog.require("goog.math.Box");goog.require("goog.math.Coordinate");goog.require("goog.math.Rect");goog.require("goog.math.Size");goog.require("goog.object");goog.require("goog.reflect");goog.require("goog.string");goog.require("goog.userAgent");goog.requireType("goog.events.Event");
goog.style.setStyle=function(element,style,opt_value){if(typeof style==="string")goog.style.setStyle_(element,opt_value,style);else for(var key in style)goog.style.setStyle_(element,style[key],key)};goog.style.setStyle_=function(element,value,style){var propertyName=goog.style.getVendorJsStyleName_(element,style);if(propertyName)element.style[propertyName]=value};goog.style.styleNameCache_={};
goog.style.getVendorJsStyleName_=function(element,style){var propertyName=goog.style.styleNameCache_[style];if(!propertyName){var camelStyle=goog.string.toCamelCase(style);propertyName=camelStyle;if(element.style[camelStyle]===undefined){var prefixedStyle=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(camelStyle);if(element.style[prefixedStyle]!==undefined)propertyName=prefixedStyle}goog.style.styleNameCache_[style]=propertyName}return propertyName};
goog.style.getVendorStyleName_=function(element,style){var camelStyle=goog.string.toCamelCase(style);if(element.style[camelStyle]===undefined){var prefixedStyle=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(camelStyle);if(element.style[prefixedStyle]!==undefined)return goog.dom.vendor.getVendorPrefix()+"-"+style}return style};
goog.style.getStyle=function(element,property){var styleValue=element.style[goog.string.toCamelCase(property)];if(typeof styleValue!=="undefined")return styleValue;return element.style[goog.style.getVendorJsStyleName_(element,property)]||""};
goog.style.getComputedStyle=function(element,property){var doc=goog.dom.getOwnerDocument(element);if(doc.defaultView&&doc.defaultView.getComputedStyle){var styles=doc.defaultView.getComputedStyle(element,null);if(styles)return styles[property]||styles.getPropertyValue(property)||""}return""};goog.style.getCascadedStyle=function(element,style){return element.currentStyle?element.currentStyle[style]:null};
goog.style.getStyle_=function(element,style){return goog.style.getComputedStyle(element,style)||goog.style.getCascadedStyle(element,style)||element.style&&element.style[style]};goog.style.getComputedBoxSizing=function(element){return goog.style.getStyle_(element,"boxSizing")||goog.style.getStyle_(element,"MozBoxSizing")||goog.style.getStyle_(element,"WebkitBoxSizing")||null};goog.style.getComputedPosition=function(element){return goog.style.getStyle_(element,"position")};
goog.style.getBackgroundColor=function(element){return goog.style.getStyle_(element,"backgroundColor")};goog.style.getComputedOverflowX=function(element){return goog.style.getStyle_(element,"overflowX")};goog.style.getComputedOverflowY=function(element){return goog.style.getStyle_(element,"overflowY")};goog.style.getComputedZIndex=function(element){return goog.style.getStyle_(element,"zIndex")};goog.style.getComputedTextAlign=function(element){return goog.style.getStyle_(element,"textAlign")};
goog.style.getComputedCursor=function(element){return goog.style.getStyle_(element,"cursor")};goog.style.getComputedTransform=function(element){var property=goog.style.getVendorStyleName_(element,"transform");return goog.style.getStyle_(element,property)||goog.style.getStyle_(element,"transform")};
goog.style.setPosition=function(el,arg1,opt_arg2){var x,y;if(arg1 instanceof goog.math.Coordinate){x=arg1.x;y=arg1.y}else{x=arg1;y=opt_arg2}el.style.left=goog.style.getPixelStyleValue_(x,false);el.style.top=goog.style.getPixelStyleValue_(y,false)};goog.style.getPosition=function(element){return new goog.math.Coordinate(element.offsetLeft,element.offsetTop)};
goog.style.getClientViewportElement=function(opt_node){var doc;if(opt_node)doc=goog.dom.getOwnerDocument(opt_node);else doc=goog.dom.getDocument();if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)&&!goog.dom.getDomHelper(doc).isCss1CompatMode())return doc.body;return doc.documentElement};
goog.style.getViewportPageOffset=function(doc){var body=doc.body;var documentElement=doc.documentElement;var scrollLeft=body.scrollLeft||documentElement.scrollLeft;var scrollTop=body.scrollTop||documentElement.scrollTop;return new goog.math.Coordinate(scrollLeft,scrollTop)};goog.style.getBoundingClientRect_=function(el){try{return el.getBoundingClientRect()}catch(e){return{"left":0,"top":0,"right":0,"bottom":0}}};
goog.style.getOffsetParent=function(element){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(8)){goog.asserts.assert(element&&"offsetParent"in element);return element.offsetParent}var doc=goog.dom.getOwnerDocument(element);var positionStyle=goog.style.getStyle_(element,"position");var skipStatic=positionStyle=="fixed"||positionStyle=="absolute";for(var parent=element.parentNode;parent&&parent!=doc;parent=parent.parentNode){if(parent.nodeType==goog.dom.NodeType.DOCUMENT_FRAGMENT&&parent.host)parent=
parent.host;positionStyle=goog.style.getStyle_(parent,"position");skipStatic=skipStatic&&positionStyle=="static"&&parent!=doc.documentElement&&parent!=doc.body;if(!skipStatic&&(parent.scrollWidth>parent.clientWidth||parent.scrollHeight>parent.clientHeight||positionStyle=="fixed"||positionStyle=="absolute"||positionStyle=="relative"))return parent}return null};
goog.style.getVisibleRectForElement=function(element){var visibleRect=new goog.math.Box(0,Infinity,Infinity,0);var dom=goog.dom.getDomHelper(element);var body=dom.getDocument().body;var documentElement=dom.getDocument().documentElement;var scrollEl=dom.getDocumentScrollElement();for(var el=element;el=goog.style.getOffsetParent(el);)if((!goog.userAgent.IE||el.clientWidth!=0)&&(!goog.userAgent.WEBKIT||el.clientHeight!=0||el!=body)&&(el!=body&&el!=documentElement&&goog.style.getStyle_(el,"overflow")!=
"visible")){var pos=goog.style.getPageOffset(el);var client=goog.style.getClientLeftTop(el);pos.x+=client.x;pos.y+=client.y;visibleRect.top=Math.max(visibleRect.top,pos.y);visibleRect.right=Math.min(visibleRect.right,pos.x+el.clientWidth);visibleRect.bottom=Math.min(visibleRect.bottom,pos.y+el.clientHeight);visibleRect.left=Math.max(visibleRect.left,pos.x)}var scrollX=scrollEl.scrollLeft,scrollY=scrollEl.scrollTop;visibleRect.left=Math.max(visibleRect.left,scrollX);visibleRect.top=Math.max(visibleRect.top,
scrollY);var winSize=dom.getViewportSize();visibleRect.right=Math.min(visibleRect.right,scrollX+winSize.width);visibleRect.bottom=Math.min(visibleRect.bottom,scrollY+winSize.height);return visibleRect.top>=0&&visibleRect.left>=0&&visibleRect.bottom>visibleRect.top&&visibleRect.right>visibleRect.left?visibleRect:null};
goog.style.getContainerOffsetToScrollInto=function(element,opt_container,opt_center){var container=opt_container||goog.dom.getDocumentScrollElement();var elementPos=goog.style.getPageOffset(element);var containerPos=goog.style.getPageOffset(container);var containerBorder=goog.style.getBorderBox(container);if(container==goog.dom.getDocumentScrollElement()){var relX=elementPos.x-container.scrollLeft;var relY=elementPos.y-container.scrollTop;if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(10)){relX+=
containerBorder.left;relY+=containerBorder.top}}else{var relX=elementPos.x-containerPos.x-containerBorder.left;var relY=elementPos.y-containerPos.y-containerBorder.top}var elementSize=goog.style.getSizeWithDisplay_(element);var spaceX=container.clientWidth-elementSize.width;var spaceY=container.clientHeight-elementSize.height;var scrollLeft=container.scrollLeft;var scrollTop=container.scrollTop;if(opt_center){scrollLeft+=relX-spaceX/2;scrollTop+=relY-spaceY/2}else{scrollLeft+=Math.min(relX,Math.max(relX-
spaceX,0));scrollTop+=Math.min(relY,Math.max(relY-spaceY,0))}return new goog.math.Coordinate(scrollLeft,scrollTop)};goog.style.scrollIntoContainerView=function(element,opt_container,opt_center){var container=opt_container||goog.dom.getDocumentScrollElement();var offset=goog.style.getContainerOffsetToScrollInto(element,container,opt_center);container.scrollLeft=offset.x;container.scrollTop=offset.y};goog.style.getClientLeftTop=function(el){return new goog.math.Coordinate(el.clientLeft,el.clientTop)};
goog.style.getPageOffset=function(el){var doc=goog.dom.getOwnerDocument(el);goog.asserts.assertObject(el,"Parameter is required");var pos=new goog.math.Coordinate(0,0);var viewportElement=goog.style.getClientViewportElement(doc);if(el==viewportElement)return pos;var box=goog.style.getBoundingClientRect_(el);var scrollCoord=goog.dom.getDomHelper(doc).getDocumentScroll();pos.x=box.left+scrollCoord.x;pos.y=box.top+scrollCoord.y;return pos};goog.style.getPageOffsetLeft=function(el){return goog.style.getPageOffset(el).x};
goog.style.getPageOffsetTop=function(el){return goog.style.getPageOffset(el).y};
goog.style.getFramedPageOffset=function(el,relativeWin){var position=new goog.math.Coordinate(0,0);var currentWin=goog.dom.getWindow(goog.dom.getOwnerDocument(el));if(!goog.reflect.canAccessProperty(currentWin,"parent"))return position;var currentEl=el;do{var offset=currentWin==relativeWin?goog.style.getPageOffset(currentEl):goog.style.getClientPositionForElement_(goog.asserts.assert(currentEl));position.x+=offset.x;position.y+=offset.y}while(currentWin&&currentWin!=relativeWin&&currentWin!=currentWin.parent&&
(currentEl=currentWin.frameElement)&&(currentWin=currentWin.parent));return position};
goog.style.translateRectForAnotherFrame=function(rect,origBase,newBase){if(origBase.getDocument()!=newBase.getDocument()){var body=origBase.getDocument().body;var pos=goog.style.getFramedPageOffset(body,newBase.getWindow());pos=goog.math.Coordinate.difference(pos,goog.style.getPageOffset(body));if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)&&!origBase.isCss1CompatMode())pos=goog.math.Coordinate.difference(pos,origBase.getDocumentScroll());rect.left+=pos.x;rect.top+=pos.y}};
goog.style.getRelativePosition=function(a,b){var ap=goog.style.getClientPosition(a);var bp=goog.style.getClientPosition(b);return new goog.math.Coordinate(ap.x-bp.x,ap.y-bp.y)};goog.style.getClientPositionForElement_=function(el){var box=goog.style.getBoundingClientRect_(el);return new goog.math.Coordinate(box.left,box.top)};
goog.style.getClientPosition=function(el){goog.asserts.assert(el);if(el.nodeType==goog.dom.NodeType.ELEMENT)return goog.style.getClientPositionForElement_(el);else{var targetEvent=el.changedTouches?el.changedTouches[0]:el;return new goog.math.Coordinate(targetEvent.clientX,targetEvent.clientY)}};
goog.style.setPageOffset=function(el,x,opt_y){var cur=goog.style.getPageOffset(el);if(x instanceof goog.math.Coordinate){opt_y=x.y;x=x.x}var dx=goog.asserts.assertNumber(x)-cur.x;var dy=Number(opt_y)-cur.y;goog.style.setPosition(el,el.offsetLeft+dx,el.offsetTop+dy)};
goog.style.setSize=function(element,w,opt_h){var h;if(w instanceof goog.math.Size){h=w.height;w=w.width}else{if(opt_h==undefined)throw new Error("missing height argument");h=opt_h}goog.style.setWidth(element,w);goog.style.setHeight(element,h)};goog.style.getPixelStyleValue_=function(value,round){if(typeof value=="number")value=(round?Math.round(value):value)+"px";return value};goog.style.setHeight=function(element,height){element.style.height=goog.style.getPixelStyleValue_(height,true)};
goog.style.setWidth=function(element,width){element.style.width=goog.style.getPixelStyleValue_(width,true)};goog.style.getSize=function(element){return goog.style.evaluateWithTemporaryDisplay_(goog.style.getSizeWithDisplay_,element)};
goog.style.evaluateWithTemporaryDisplay_=function(fn,element){if(goog.style.getStyle_(element,"display")!="none")return fn(element);var style=element.style;var originalDisplay=style.display;var originalVisibility=style.visibility;var originalPosition=style.position;style.visibility="hidden";style.position="absolute";style.display="inline";var retVal=fn(element);style.display=originalDisplay;style.position=originalPosition;style.visibility=originalVisibility;return retVal};
goog.style.getSizeWithDisplay_=function(element){var offsetWidth=element.offsetWidth;var offsetHeight=element.offsetHeight;var webkitOffsetsZero=goog.userAgent.WEBKIT&&!offsetWidth&&!offsetHeight;if((offsetWidth===undefined||webkitOffsetsZero)&&element.getBoundingClientRect){var clientRect=goog.style.getBoundingClientRect_(element);return new goog.math.Size(clientRect.right-clientRect.left,clientRect.bottom-clientRect.top)}return new goog.math.Size(offsetWidth,offsetHeight)};
goog.style.getTransformedSize=function(element){if(!element.getBoundingClientRect)return null;var clientRect=goog.style.evaluateWithTemporaryDisplay_(goog.style.getBoundingClientRect_,element);return new goog.math.Size(clientRect.right-clientRect.left,clientRect.bottom-clientRect.top)};goog.style.getBounds=function(element){var o=goog.style.getPageOffset(element);var s=goog.style.getSize(element);return new goog.math.Rect(o.x,o.y,s.width,s.height)};goog.style.toCamelCase=function(selector){return goog.string.toCamelCase(String(selector))};
goog.style.toSelectorCase=function(selector){return goog.string.toSelectorCase(selector)};goog.style.getOpacity=function(el){goog.asserts.assert(el);var style=el.style;var result="";if("opacity"in style)result=style.opacity;else if("MozOpacity"in style)result=style.MozOpacity;else if("filter"in style){var match=style.filter.match(/alpha\(opacity=([\d.]+)\)/);if(match)result=String(match[1]/100)}return result==""?result:Number(result)};
goog.style.setOpacity=function(el,alpha){goog.asserts.assert(el);var style=el.style;if("opacity"in style)style.opacity=alpha;else if("MozOpacity"in style)style.MozOpacity=alpha;else if("filter"in style)if(alpha==="")style.filter="";else style.filter="alpha(opacity="+Number(alpha)*100+")"};goog.style.setTransparentBackgroundImage=function(el,src){var style=el.style;style.backgroundImage="url("+src+")";style.backgroundPosition="top left";style.backgroundRepeat="no-repeat"};
goog.style.clearTransparentBackgroundImage=function(el){var style=el.style;if("filter"in style)style.filter="";else style.backgroundImage="none"};goog.style.showElement=function(el,display){goog.style.setElementShown(el,display)};goog.style.setElementShown=function(el,isShown){el.style.display=isShown?"":"none"};goog.style.isElementShown=function(el){return el.style.display!="none"};
goog.style.installSafeStyleSheet=function(safeStyleSheet,opt_node){var dh=goog.dom.getDomHelper(opt_node);var doc=dh.getDocument();if(goog.userAgent.IE&&doc.createStyleSheet){var styleSheet=doc.createStyleSheet();goog.style.setSafeStyleSheet(styleSheet,safeStyleSheet);return styleSheet}else{var head=dh.getElementsByTagNameAndClass(goog.dom.TagName.HEAD)[0];if(!head){var body=dh.getElementsByTagNameAndClass(goog.dom.TagName.BODY)[0];head=dh.createDom(goog.dom.TagName.HEAD);body.parentNode.insertBefore(head,
body)}var el=dh.createDom(goog.dom.TagName.STYLE);const nonce=goog.dom.safe.getStyleNonce();if(nonce)el.setAttribute("nonce",nonce);goog.style.setSafeStyleSheet(el,safeStyleSheet);dh.appendChild(head,el);return el}};goog.style.uninstallStyles=function(styleSheet){var node=styleSheet.ownerNode||styleSheet.owningElement||styleSheet;goog.dom.removeNode(node)};
goog.style.setSafeStyleSheet=function(element,safeStyleSheet){var stylesString=goog.html.SafeStyleSheet.unwrap(safeStyleSheet);if(goog.userAgent.IE&&element.cssText!==undefined)element.cssText=stylesString;else if(goog.global.trustedTypes)goog.dom.setTextContent(element,stylesString);else element.innerHTML=stylesString};goog.style.setPreWrap=function(el){var style=el.style;if(goog.userAgent.GECKO)style.whiteSpace="-moz-pre-wrap";else style.whiteSpace="pre-wrap"};
goog.style.setInlineBlock=function(el){var style=el.style;style.position="relative";style.display="inline-block"};goog.style.isRightToLeft=function(el){return"rtl"==goog.style.getStyle_(el,"direction")};goog.style.unselectableStyle_=goog.userAgent.GECKO?"MozUserSelect":goog.userAgent.WEBKIT||goog.userAgent.EDGE?"WebkitUserSelect":null;
goog.style.isUnselectable=function(el){if(goog.style.unselectableStyle_)return el.style[goog.style.unselectableStyle_].toLowerCase()=="none";else if(goog.userAgent.IE)return el.getAttribute("unselectable")=="on";return false};
goog.style.setUnselectable=function(el,unselectable,opt_noRecurse){var descendants=!opt_noRecurse?el.getElementsByTagName("*"):null;var name=goog.style.unselectableStyle_;if(name){var value=unselectable?"none":"";if(el.style)el.style[name]=value;if(descendants)for(var i=0,descendant;descendant=descendants[i];i++)if(descendant.style)descendant.style[name]=value}else if(goog.userAgent.IE){var value=unselectable?"on":"";el.setAttribute("unselectable",value);if(descendants)for(var i=0,descendant;descendant=
descendants[i];i++)descendant.setAttribute("unselectable",value)}};goog.style.getBorderBoxSize=function(element){return new goog.math.Size(element.offsetWidth,element.offsetHeight)};goog.style.setBorderBoxSize=function(element,size){goog.style.setBoxSizingSize_(element,size,"border-box")};
goog.style.getContentBoxSize=function(element){var doc=goog.dom.getOwnerDocument(element);var ieCurrentStyle=goog.userAgent.IE&&element.currentStyle;if(ieCurrentStyle&&goog.dom.getDomHelper(doc).isCss1CompatMode()&&ieCurrentStyle.width!="auto"&&ieCurrentStyle.height!="auto"&&!ieCurrentStyle.boxSizing){var width=goog.style.getIePixelValue_(element,ieCurrentStyle.width,"width","pixelWidth");var height=goog.style.getIePixelValue_(element,ieCurrentStyle.height,"height","pixelHeight");return new goog.math.Size(width,
height)}else{var borderBoxSize=goog.style.getBorderBoxSize(element);var paddingBox=goog.style.getPaddingBox(element);var borderBox=goog.style.getBorderBox(element);return new goog.math.Size(borderBoxSize.width-borderBox.left-paddingBox.left-paddingBox.right-borderBox.right,borderBoxSize.height-borderBox.top-paddingBox.top-paddingBox.bottom-borderBox.bottom)}};goog.style.setContentBoxSize=function(element,size){goog.style.setBoxSizingSize_(element,size,"content-box")};
goog.style.setBoxSizingSize_=function(element,size,boxSizing){var style=element.style;if(goog.userAgent.GECKO)style.MozBoxSizing=boxSizing;else if(goog.userAgent.WEBKIT)style.WebkitBoxSizing=boxSizing;else style.boxSizing=boxSizing;style.width=Math.max(size.width,0)+"px";style.height=Math.max(size.height,0)+"px"};
goog.style.getIePixelValue_=function(element,value,name,pixelName){if(/^\d+px?$/.test(value))return parseInt(value,10);else{var oldStyleValue=element.style[name];var oldRuntimeValue=element.runtimeStyle[name];element.runtimeStyle[name]=element.currentStyle[name];element.style[name]=value;var pixelValue=element.style[pixelName];element.style[name]=oldStyleValue;element.runtimeStyle[name]=oldRuntimeValue;return+pixelValue}};
goog.style.getIePixelDistance_=function(element,propName){var value=goog.style.getCascadedStyle(element,propName);return value?goog.style.getIePixelValue_(element,value,"left","pixelLeft"):0};
goog.style.getBox_=function(element,stylePrefix){if(goog.userAgent.IE){var left=goog.style.getIePixelDistance_(element,stylePrefix+"Left");var right=goog.style.getIePixelDistance_(element,stylePrefix+"Right");var top=goog.style.getIePixelDistance_(element,stylePrefix+"Top");var bottom=goog.style.getIePixelDistance_(element,stylePrefix+"Bottom");return new goog.math.Box(top,right,bottom,left)}else{var left=goog.style.getComputedStyle(element,stylePrefix+"Left");var right=goog.style.getComputedStyle(element,
stylePrefix+"Right");var top=goog.style.getComputedStyle(element,stylePrefix+"Top");var bottom=goog.style.getComputedStyle(element,stylePrefix+"Bottom");return new goog.math.Box(parseFloat(top),parseFloat(right),parseFloat(bottom),parseFloat(left))}};goog.style.getPaddingBox=function(element){return goog.style.getBox_(element,"padding")};goog.style.getMarginBox=function(element){return goog.style.getBox_(element,"margin")};goog.style.ieBorderWidthKeywords_={"thin":2,"medium":4,"thick":6};
goog.style.getIePixelBorder_=function(element,prop){if(goog.style.getCascadedStyle(element,prop+"Style")=="none")return 0;var width=goog.style.getCascadedStyle(element,prop+"Width");if(width in goog.style.ieBorderWidthKeywords_)return goog.style.ieBorderWidthKeywords_[width];return goog.style.getIePixelValue_(element,width,"left","pixelLeft")};
goog.style.getBorderBox=function(element){if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){var left=goog.style.getIePixelBorder_(element,"borderLeft");var right=goog.style.getIePixelBorder_(element,"borderRight");var top=goog.style.getIePixelBorder_(element,"borderTop");var bottom=goog.style.getIePixelBorder_(element,"borderBottom");return new goog.math.Box(top,right,bottom,left)}else{var left=goog.style.getComputedStyle(element,"borderLeftWidth");var right=goog.style.getComputedStyle(element,
"borderRightWidth");var top=goog.style.getComputedStyle(element,"borderTopWidth");var bottom=goog.style.getComputedStyle(element,"borderBottomWidth");return new goog.math.Box(parseFloat(top),parseFloat(right),parseFloat(bottom),parseFloat(left))}};
goog.style.getFontFamily=function(el){var doc=goog.dom.getOwnerDocument(el);var font="";if(doc.body.createTextRange&&goog.dom.contains(doc,el)){var range=doc.body.createTextRange();range.moveToElementText(el);try{font=range.queryCommandValue("FontName")}catch(e){font=""}}if(!font)font=goog.style.getStyle_(el,"fontFamily");var fontsArray=font.split(",");if(fontsArray.length>1)font=fontsArray[0];return goog.string.stripQuotes(font,"\"'")};goog.style.lengthUnitRegex_=/[^\d]+$/;
goog.style.getLengthUnits=function(value){var units=value.match(goog.style.lengthUnitRegex_);return units&&units[0]||null};goog.style.ABSOLUTE_CSS_LENGTH_UNITS_={"cm":1,"in":1,"mm":1,"pc":1,"pt":1};goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_={"em":1,"ex":1};
goog.style.getFontSize=function(el){var fontSize=goog.style.getStyle_(el,"fontSize");var sizeUnits=goog.style.getLengthUnits(fontSize);if(fontSize&&"px"==sizeUnits)return parseInt(fontSize,10);if(goog.userAgent.IE)if(String(sizeUnits)in goog.style.ABSOLUTE_CSS_LENGTH_UNITS_)return goog.style.getIePixelValue_(el,fontSize,"left","pixelLeft");else if(el.parentNode&&el.parentNode.nodeType==goog.dom.NodeType.ELEMENT&&String(sizeUnits)in goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_){var parentElement=el.parentNode;
var parentSize=goog.style.getStyle_(parentElement,"fontSize");return goog.style.getIePixelValue_(parentElement,fontSize==parentSize?"1em":fontSize,"left","pixelLeft")}var sizeElement=goog.dom.createDom(goog.dom.TagName.SPAN,{"style":"visibility:hidden;position:absolute;"+"line-height:0;padding:0;margin:0;border:0;height:1em;"});goog.dom.appendChild(el,sizeElement);fontSize=sizeElement.offsetHeight;goog.dom.removeNode(sizeElement);return fontSize};
goog.style.parseStyleAttribute=function(value){var result={};value.split(/\s*;\s*/).forEach(function(pair){var keyValue=pair.match(/\s*([\w-]+)\s*:(.+)/);if(keyValue){var styleName=keyValue[1];var styleValue=goog.string.trim(keyValue[2]);result[goog.string.toCamelCase(styleName.toLowerCase())]=styleValue}});return result};goog.style.toStyleAttribute=function(obj){var buffer=[];goog.object.forEach(obj,function(value,key){buffer.push(goog.string.toSelectorCase(key),":",value,";")});return buffer.join("")};
goog.style.setFloat=function(el,value){el.style[goog.userAgent.IE?"styleFloat":"cssFloat"]=value};goog.style.getFloat=function(el){return el.style[goog.userAgent.IE?"styleFloat":"cssFloat"]||""};
goog.style.getScrollbarWidth=function(opt_className){var outerDiv=goog.dom.createElement(goog.dom.TagName.DIV);if(opt_className)outerDiv.className=opt_className;outerDiv.style.cssText="overflow:auto;"+"position:absolute;top:0;width:100px;height:100px";var innerDiv=goog.dom.createElement(goog.dom.TagName.DIV);goog.style.setSize(innerDiv,"200px","200px");outerDiv.appendChild(innerDiv);goog.dom.appendChild(goog.dom.getDocument().body,outerDiv);var width=outerDiv.offsetWidth-outerDiv.clientWidth;goog.dom.removeNode(outerDiv);
return width};goog.style.MATRIX_TRANSLATION_REGEX_=new RegExp("matrix\\([0-9\\.\\-]+, [0-9\\.\\-]+, "+"[0-9\\.\\-]+, [0-9\\.\\-]+, "+"([0-9\\.\\-]+)p?x?, ([0-9\\.\\-]+)p?x?\\)");
goog.style.getCssTranslation=function(element){var transform=goog.style.getComputedTransform(element);if(!transform)return new goog.math.Coordinate(0,0);var matches=transform.match(goog.style.MATRIX_TRANSLATION_REGEX_);if(!matches)return new goog.math.Coordinate(0,0);return new goog.math.Coordinate(parseFloat(matches[1]),parseFloat(matches[2]))};goog.loadModule(function(exports){"use strict";goog.module("goog.Thenable");goog.module.declareLegacyNamespace();const GoogPromise=goog.requireType("goog.Promise");function Thenable(){}Thenable.prototype.then=function(opt_onFulfilled,opt_onRejected,opt_context){};Thenable.IMPLEMENTED_BY_PROP="$goog_Thenable";Thenable.addImplementation=function(ctor){if(COMPILED)ctor.prototype[Thenable.IMPLEMENTED_BY_PROP]=true;else ctor.prototype.$goog_Thenable=true};Thenable.isImplementedBy=function(object){if(!object)return false;
try{if(COMPILED)return!!object[Thenable.IMPLEMENTED_BY_PROP];return!!object.$goog_Thenable}catch(e){return false}};exports=Thenable;return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.async.FreeList");goog.module.declareLegacyNamespace();class FreeList{constructor(create,reset,limit){this.limit_=limit;this.create_=create;this.reset_=reset;this.occupants_=0;this.head_=null}get(){let item;if(this.occupants_>0){this.occupants_--;item=this.head_;this.head_=item.next;item.next=null}else item=this.create_();return item}put(item){this.reset_(item);if(this.occupants_<this.limit_){this.occupants_++;item.next=this.head_;this.head_=
item}}occupants(){return this.occupants_}}exports=FreeList;return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.async.WorkQueue");goog.module.declareLegacyNamespace();const FreeList=goog.require("goog.async.FreeList");const {assert}=goog.require("goog.asserts");class WorkQueue{constructor(){this.workHead_=null;this.workTail_=null}add(fn,scope){const item=this.getUnusedItem_();item.set(fn,scope);if(this.workTail_){this.workTail_.next=item;this.workTail_=item}else{assert(!this.workHead_);this.workHead_=item;this.workTail_=item}}remove(){let item=
null;if(this.workHead_){item=this.workHead_;this.workHead_=this.workHead_.next;if(!this.workHead_)this.workTail_=null;item.next=null}return item}returnUnused(item){WorkQueue.freelist_.put(item)}getUnusedItem_(){return WorkQueue.freelist_.get()}}WorkQueue.DEFAULT_MAX_UNUSED=goog.define("goog.async.WorkQueue.DEFAULT_MAX_UNUSED",100);WorkQueue.freelist_=new FreeList(()=>new WorkItem,item=>item.reset(),WorkQueue.DEFAULT_MAX_UNUSED);class WorkItem{constructor(){this.fn=null;this.scope=null;this.next=null}set(fn,
scope){this.fn=fn;this.scope=scope;this.next=null}reset(){this.fn=null;this.scope=null;this.next=null}}exports=WorkQueue;return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.debug.asyncStackTag");goog.module.declareLegacyNamespace();const {assertExists}=goog.require("goog.asserts");const createTask=goog.DEBUG&&goog.global.console&&goog.global.console.createTask?goog.global.console.createTask.bind(goog.global.console):undefined;const CONSOLE_TASK_SYMBOL=createTask?Symbol("consoleTask"):undefined;function wrap(fn,name="anonymous"){if(!goog.DEBUG||!createTask)return fn;if(fn[assertExists(CONSOLE_TASK_SYMBOL)])return fn;
const consoleTask=createTask(fn.name||name);function wrappedFn(...args){return consoleTask["run"](()=>fn.call(this,...args))}wrappedFn[assertExists(CONSOLE_TASK_SYMBOL)]=consoleTask;return wrappedFn}exports={wrap};return exports});goog.provide("goog.async.nextTick");goog.require("goog.debug.entryPointRegistry");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.functions");goog.require("goog.labs.userAgent.browser");goog.require("goog.labs.userAgent.engine");
goog.async.nextTick=function(callback,opt_context,opt_useSetImmediate){var cb=callback;if(opt_context)cb=goog.bind(callback,opt_context);cb=goog.async.nextTick.wrapCallback_(cb);if(typeof goog.global.setImmediate==="function"&&(opt_useSetImmediate||goog.async.nextTick.useSetImmediate_())){goog.global.setImmediate(cb);return}if(!goog.async.nextTick.nextTickImpl)goog.async.nextTick.nextTickImpl=goog.async.nextTick.getNextTickImpl_();goog.async.nextTick.nextTickImpl(cb)};
goog.async.nextTick.useSetImmediate_=function(){if(!goog.global.Window||!goog.global.Window.prototype)return true;if(goog.labs.userAgent.browser.isEdge()||goog.global.Window.prototype.setImmediate!=goog.global.setImmediate)return true;return false};goog.async.nextTick.nextTickImpl;
goog.async.nextTick.getNextTickImpl_=function(){var Channel=goog.global["MessageChannel"];if(typeof Channel==="undefined"&&typeof window!=="undefined"&&window.postMessage&&window.addEventListener&&!goog.labs.userAgent.engine.isPresto())Channel=function(){var iframe=goog.dom.createElement(goog.dom.TagName.IFRAME);iframe.style.display="none";document.documentElement.appendChild(iframe);var win=iframe.contentWindow;var doc=win.document;doc.open();doc.close();var message="callImmediate"+Math.random();
var origin=win.location.protocol=="file:"?"*":win.location.protocol+"//"+win.location.host;var onmessage=goog.bind(function(e){if(origin!="*"&&e.origin!=origin||e.data!=message)return;this["port1"].onmessage()},this);win.addEventListener("message",onmessage,false);this["port1"]={};this["port2"]={postMessage:function(){win.postMessage(message,origin)}}};if(typeof Channel!=="undefined"&&!goog.labs.userAgent.browser.isIE()){var channel=new Channel;var head={};var tail=head;channel["port1"].onmessage=
function(){if(head.next!==undefined){head=head.next;var cb=head.cb;head.cb=null;cb()}};return function(cb){tail.next={cb:cb};tail=tail.next;channel["port2"].postMessage(0)}}return function(cb){goog.global.setTimeout(cb,0)}};goog.async.nextTick.wrapCallback_=goog.functions.identity;goog.debug.entryPointRegistry.register(function(transformer){goog.async.nextTick.wrapCallback_=transformer});goog.loadModule(function(exports){"use strict";goog.module("goog.async.throwException");goog.module.declareLegacyNamespace();function throwException(exception){goog.global.setTimeout(()=>{throw exception;},0)}exports=throwException;return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.async.run");goog.module.declareLegacyNamespace();const WorkQueue=goog.require("goog.async.WorkQueue");const asyncStackTag=goog.require("goog.debug.asyncStackTag");const nextTick=goog.require("goog.async.nextTick");const throwException=goog.require("goog.async.throwException");goog.ASSUME_NATIVE_PROMISE=goog.define("goog.ASSUME_NATIVE_PROMISE",false);let schedule;let workQueueScheduled=false;let workQueue=new WorkQueue;let run=(callback,
context=undefined)=>{if(!schedule)initializeRunner();if(!workQueueScheduled){schedule();workQueueScheduled=true}callback=asyncStackTag.wrap(callback,"goog.async.run");workQueue.add(callback,context)};let initializeRunner=()=>{if(goog.ASSUME_NATIVE_PROMISE||goog.global.Promise&&goog.global.Promise.resolve){const promise=goog.global.Promise.resolve(undefined);schedule=()=>{promise.then(run.processWorkQueue)}}else schedule=()=>{nextTick(run.processWorkQueue)}};run.forceNextTick=(realSetTimeout=undefined)=>
{schedule=()=>{nextTick(run.processWorkQueue);if(realSetTimeout)realSetTimeout(run.processWorkQueue)}};if(goog.DEBUG){run.resetQueue=()=>{workQueueScheduled=false;workQueue=new WorkQueue};run.resetSchedulerForTest=()=>{initializeRunner()}}run.processWorkQueue=()=>{let item=null;while(item=workQueue.remove()){try{item.fn.call(item.scope)}catch(e){throwException(e)}workQueue.returnUnused(item)}workQueueScheduled=false};exports=run;return exports});goog.loadModule(function(exports){"use strict";goog.module("goog.promise.Resolver");goog.module.declareLegacyNamespace();const GoogPromise=goog.requireType("goog.Promise");const Thenable=goog.requireType("goog.Thenable");class Resolver{constructor(){this.promise;this.resolve;this.reject}}exports=Resolver;return exports});goog.provide("goog.Promise");goog.require("goog.Thenable");goog.require("goog.asserts");goog.require("goog.async.FreeList");goog.require("goog.async.run");goog.require("goog.async.throwException");goog.require("goog.debug.Error");goog.require("goog.debug.asyncStackTag");goog.require("goog.functions");goog.require("goog.promise.Resolver");
goog.Promise=function(resolver,opt_context){this.state_=goog.Promise.State_.PENDING;this.result_=undefined;this.parent_=null;this.callbackEntries_=null;this.callbackEntriesTail_=null;this.executing_=false;if(goog.Promise.UNHANDLED_REJECTION_DELAY>0)this.unhandledRejectionId_=0;else if(goog.Promise.UNHANDLED_REJECTION_DELAY==0)this.hadUnhandledRejection_=false;if(goog.Promise.LONG_STACK_TRACES){this.stack_=[];this.addStackTrace_(new Error("created"));this.currentStep_=0}if(resolver!=goog.functions.UNDEFINED)try{var self=
this;resolver.call(opt_context,function(value){self.resolve_(goog.Promise.State_.FULFILLED,value)},function(reason){if(goog.DEBUG&&!(reason instanceof goog.Promise.CancellationError))try{if(reason instanceof Error)throw reason;else throw new Error("Promise rejected.");}catch(e){}self.resolve_(goog.Promise.State_.REJECTED,reason)})}catch(e){this.resolve_(goog.Promise.State_.REJECTED,e)}};goog.Promise.LONG_STACK_TRACES=goog.define("goog.Promise.LONG_STACK_TRACES",false);
goog.Promise.UNHANDLED_REJECTION_DELAY=goog.define("goog.Promise.UNHANDLED_REJECTION_DELAY",0);goog.Promise.State_={PENDING:0,BLOCKED:1,FULFILLED:2,REJECTED:3};goog.Promise.CallbackEntry_=function(){this.child=null;this.onFulfilled=null;this.onRejected=null;this.context=null;this.next=null;this.always=false};goog.Promise.CallbackEntry_.prototype.reset=function(){this.child=null;this.onFulfilled=null;this.onRejected=null;this.context=null;this.always=false};
goog.Promise.DEFAULT_MAX_UNUSED=goog.define("goog.Promise.DEFAULT_MAX_UNUSED",100);goog.Promise.freelist_=new goog.async.FreeList(function(){return new goog.Promise.CallbackEntry_},function(item){item.reset()},goog.Promise.DEFAULT_MAX_UNUSED);goog.Promise.getCallbackEntry_=function(onFulfilled,onRejected,context){var entry=goog.Promise.freelist_.get();entry.onFulfilled=onFulfilled;entry.onRejected=onRejected;entry.context=context;return entry};goog.Promise.returnEntry_=function(entry){goog.Promise.freelist_.put(entry)};
goog.Promise.resolve=function(opt_value){if(opt_value instanceof goog.Promise)return opt_value;var promise=new goog.Promise(goog.functions.UNDEFINED);promise.resolve_(goog.Promise.State_.FULFILLED,opt_value);return promise};goog.Promise.reject=function(opt_reason){return new goog.Promise(function(resolve,reject){reject(opt_reason)})};
goog.Promise.resolveThen_=function(value,onFulfilled,onRejected){var isThenable=goog.Promise.maybeThen_(value,onFulfilled,onRejected,null);if(!isThenable)goog.async.run(goog.partial(onFulfilled,value))};goog.Promise.race=function(promises){return new goog.Promise(function(resolve,reject){if(!promises.length)resolve(undefined);for(var i=0,promise;i<promises.length;i++){promise=promises[i];goog.Promise.resolveThen_(promise,resolve,reject)}})};
goog.Promise.all=function(promises){return new goog.Promise(function(resolve,reject){var toFulfill=promises.length;var values=[];if(!toFulfill){resolve(values);return}var onFulfill=function(index,value){toFulfill--;values[index]=value;if(toFulfill==0)resolve(values)};var onReject=function(reason){reject(reason)};for(var i=0,promise;i<promises.length;i++){promise=promises[i];goog.Promise.resolveThen_(promise,goog.partial(onFulfill,i),onReject)}})};
goog.Promise.allSettled=function(promises){return new goog.Promise(function(resolve,reject){var toSettle=promises.length;var results=[];if(!toSettle){resolve(results);return}var onSettled=function(index,fulfilled,result){toSettle--;results[index]=fulfilled?{fulfilled:true,value:result}:{fulfilled:false,reason:result};if(toSettle==0)resolve(results)};for(var i=0,promise;i<promises.length;i++){promise=promises[i];goog.Promise.resolveThen_(promise,goog.partial(onSettled,i,true),goog.partial(onSettled,
i,false))}})};goog.Promise.firstFulfilled=function(promises){return new goog.Promise(function(resolve,reject){var toReject=promises.length;var reasons=[];if(!toReject){resolve(undefined);return}var onFulfill=function(value){resolve(value)};var onReject=function(index,reason){toReject--;reasons[index]=reason;if(toReject==0)reject(reasons)};for(var i=0,promise;i<promises.length;i++){promise=promises[i];goog.Promise.resolveThen_(promise,onFulfill,goog.partial(onReject,i))}})};
goog.Promise.withResolver=function(){var resolve,reject;var promise=new goog.Promise(function(rs,rj){resolve=rs;reject=rj});return new goog.Promise.Resolver_(promise,resolve,reject)};
goog.Promise.prototype.then=function(opt_onFulfilled,opt_onRejected,opt_context){if(opt_onFulfilled!=null)goog.asserts.assertFunction(opt_onFulfilled,"opt_onFulfilled should be a function.");if(opt_onRejected!=null)goog.asserts.assertFunction(opt_onRejected,"opt_onRejected should be a function. Did you pass opt_context "+"as the second argument instead of the third?");if(goog.Promise.LONG_STACK_TRACES)this.addStackTrace_(new Error("then"));return this.addChildPromise_(typeof opt_onFulfilled==="function"?
opt_onFulfilled:null,typeof opt_onRejected==="function"?opt_onRejected:null,opt_context)};goog.Thenable.addImplementation(goog.Promise);
goog.Promise.prototype.thenVoid=function(opt_onFulfilled,opt_onRejected,opt_context){if(opt_onFulfilled!=null)goog.asserts.assertFunction(opt_onFulfilled,"opt_onFulfilled should be a function.");if(opt_onRejected!=null)goog.asserts.assertFunction(opt_onRejected,"opt_onRejected should be a function. Did you pass opt_context "+"as the second argument instead of the third?");if(goog.Promise.LONG_STACK_TRACES)this.addStackTrace_(new Error("then"));this.addCallbackEntry_(goog.Promise.getCallbackEntry_(opt_onFulfilled||
goog.functions.UNDEFINED,opt_onRejected||null,opt_context))};goog.Promise.prototype.thenAlways=function(onSettled,opt_context){if(goog.Promise.LONG_STACK_TRACES)this.addStackTrace_(new Error("thenAlways"));var entry=goog.Promise.getCallbackEntry_(onSettled,onSettled,opt_context);entry.always=true;this.addCallbackEntry_(entry);return this};
goog.Promise.prototype.thenCatch=function(onRejected,opt_context){if(goog.Promise.LONG_STACK_TRACES)this.addStackTrace_(new Error("thenCatch"));return this.addChildPromise_(null,onRejected,opt_context)};goog.Promise.prototype.catch=goog.Promise.prototype.thenCatch;goog.Promise.prototype.cancel=function(opt_message){if(this.state_==goog.Promise.State_.PENDING){var err=new goog.Promise.CancellationError(opt_message);goog.async.run(function(){this.cancelInternal_(err)},this)}};
goog.Promise.prototype.cancelInternal_=function(err){if(this.state_==goog.Promise.State_.PENDING)if(this.parent_){this.parent_.cancelChild_(this,err);this.parent_=null}else this.resolve_(goog.Promise.State_.REJECTED,err)};
goog.Promise.prototype.cancelChild_=function(childPromise,err){if(!this.callbackEntries_)return;var childCount=0;var childEntry=null;var beforeChildEntry=null;for(var entry=this.callbackEntries_;entry;entry=entry.next){if(!entry.always){childCount++;if(entry.child==childPromise)childEntry=entry;if(childEntry&&childCount>1)break}if(!childEntry)beforeChildEntry=entry}if(childEntry)if(this.state_==goog.Promise.State_.PENDING&&childCount==1)this.cancelInternal_(err);else{if(beforeChildEntry)this.removeEntryAfter_(beforeChildEntry);
else this.popEntry_();this.executeCallback_(childEntry,goog.Promise.State_.REJECTED,err)}};goog.Promise.prototype.addCallbackEntry_=function(callbackEntry){if(!this.hasEntry_()&&(this.state_==goog.Promise.State_.FULFILLED||this.state_==goog.Promise.State_.REJECTED))this.scheduleCallbacks_();this.queueEntry_(callbackEntry)};
goog.Promise.prototype.addChildPromise_=function(onFulfilled,onRejected,opt_context){if(onFulfilled)onFulfilled=goog.debug.asyncStackTag.wrap(onFulfilled,"goog.Promise.then");if(onRejected)onRejected=goog.debug.asyncStackTag.wrap(onRejected,"goog.Promise.then");var callbackEntry=goog.Promise.getCallbackEntry_(null,null,null);callbackEntry.child=new goog.Promise(function(resolve,reject){callbackEntry.onFulfilled=onFulfilled?function(value){try{var result=onFulfilled.call(opt_context,value);resolve(result)}catch(err){reject(err)}}:
resolve;callbackEntry.onRejected=onRejected?function(reason){try{var result=onRejected.call(opt_context,reason);if(result===undefined&&reason instanceof goog.Promise.CancellationError)reject(reason);else resolve(result)}catch(err){reject(err)}}:reject});callbackEntry.child.parent_=this;this.addCallbackEntry_(callbackEntry);return callbackEntry.child};
goog.Promise.prototype.unblockAndFulfill_=function(value){goog.asserts.assert(this.state_==goog.Promise.State_.BLOCKED);this.state_=goog.Promise.State_.PENDING;this.resolve_(goog.Promise.State_.FULFILLED,value)};goog.Promise.prototype.unblockAndReject_=function(reason){goog.asserts.assert(this.state_==goog.Promise.State_.BLOCKED);this.state_=goog.Promise.State_.PENDING;this.resolve_(goog.Promise.State_.REJECTED,reason)};
goog.Promise.prototype.resolve_=function(state,x){if(this.state_!=goog.Promise.State_.PENDING)return;if(this===x){state=goog.Promise.State_.REJECTED;x=new TypeError("Promise cannot resolve to itself")}this.state_=goog.Promise.State_.BLOCKED;var isThenable=goog.Promise.maybeThen_(x,this.unblockAndFulfill_,this.unblockAndReject_,this);if(isThenable)return;this.result_=x;this.state_=state;this.parent_=null;this.scheduleCallbacks_();if(state==goog.Promise.State_.REJECTED&&!(x instanceof goog.Promise.CancellationError))goog.Promise.addUnhandledRejection_(this,
x)};
goog.Promise.maybeThen_=function(value,onFulfilled,onRejected,context){if(value instanceof goog.Promise){value.thenVoid(onFulfilled,onRejected,context);return true}else if(goog.Thenable.isImplementedBy(value)){value=value;value.then(onFulfilled,onRejected,context);return true}else if(goog.isObject(value)){const thenable=value;try{var then=thenable.then;if(typeof then==="function"){goog.Promise.tryThen_(thenable,then,onFulfilled,onRejected,context);return true}}catch(e){onRejected.call(context,e);
return true}}return false};goog.Promise.tryThen_=function(thenable,then,onFulfilled,onRejected,context){var called=false;var resolve=function(value){if(!called){called=true;onFulfilled.call(context,value)}};var reject=function(reason){if(!called){called=true;onRejected.call(context,reason)}};try{then.call(thenable,resolve,reject)}catch(e){reject(e)}};goog.Promise.prototype.scheduleCallbacks_=function(){if(!this.executing_){this.executing_=true;goog.async.run(this.executeCallbacks_,this)}};
goog.Promise.prototype.hasEntry_=function(){return!!this.callbackEntries_};goog.Promise.prototype.queueEntry_=function(entry){goog.asserts.assert(entry.onFulfilled!=null);if(this.callbackEntriesTail_){this.callbackEntriesTail_.next=entry;this.callbackEntriesTail_=entry}else{this.callbackEntries_=entry;this.callbackEntriesTail_=entry}};
goog.Promise.prototype.popEntry_=function(){var entry=null;if(this.callbackEntries_){entry=this.callbackEntries_;this.callbackEntries_=entry.next;entry.next=null}if(!this.callbackEntries_)this.callbackEntriesTail_=null;if(entry!=null)goog.asserts.assert(entry.onFulfilled!=null);return entry};
goog.Promise.prototype.removeEntryAfter_=function(previous){goog.asserts.assert(this.callbackEntries_);goog.asserts.assert(previous!=null);if(previous.next==this.callbackEntriesTail_)this.callbackEntriesTail_=previous;previous.next=previous.next.next};goog.Promise.prototype.executeCallbacks_=function(){var entry=null;while(entry=this.popEntry_()){if(goog.Promise.LONG_STACK_TRACES)this.currentStep_++;this.executeCallback_(entry,this.state_,this.result_)}this.executing_=false};
goog.Promise.prototype.executeCallback_=function(callbackEntry,state,result){if(state==goog.Promise.State_.REJECTED&&callbackEntry.onRejected&&!callbackEntry.always)this.removeUnhandledRejection_();if(callbackEntry.child){callbackEntry.child.parent_=null;goog.Promise.invokeCallback_(callbackEntry,state,result)}else try{callbackEntry.always?callbackEntry.onFulfilled.call(callbackEntry.context):goog.Promise.invokeCallback_(callbackEntry,state,result)}catch(err){goog.Promise.handleRejection_.call(null,
err)}goog.Promise.returnEntry_(callbackEntry)};goog.Promise.invokeCallback_=function(callbackEntry,state,result){if(state==goog.Promise.State_.FULFILLED)callbackEntry.onFulfilled.call(callbackEntry.context,result);else if(callbackEntry.onRejected)callbackEntry.onRejected.call(callbackEntry.context,result)};
goog.Promise.prototype.addStackTrace_=function(err){if(goog.Promise.LONG_STACK_TRACES&&typeof err.stack==="string"){var trace=err.stack.split("\n",4)[3];var message=err.message;message+=Array(11-message.length).join(" ");this.stack_.push(message+trace)}};
goog.Promise.prototype.appendLongStack_=function(err){if(goog.Promise.LONG_STACK_TRACES&&err&&typeof err.stack==="string"&&this.stack_.length){var longTrace=["Promise trace:"];for(var promise=this;promise;promise=promise.parent_){for(var i=this.currentStep_;i>=0;i--)longTrace.push(promise.stack_[i]);longTrace.push("Value: "+"["+(promise.state_==goog.Promise.State_.REJECTED?"REJECTED":"FULFILLED")+"] "+"<"+String(promise.result_)+">")}err.stack+="\n\n"+longTrace.join("\n")}};
goog.Promise.prototype.removeUnhandledRejection_=function(){if(goog.Promise.UNHANDLED_REJECTION_DELAY>0)for(var p=this;p&&p.unhandledRejectionId_;p=p.parent_){goog.global.clearTimeout(p.unhandledRejectionId_);p.unhandledRejectionId_=0}else if(goog.Promise.UNHANDLED_REJECTION_DELAY==0)for(var p=this;p&&p.hadUnhandledRejection_;p=p.parent_)p.hadUnhandledRejection_=false};
goog.Promise.addUnhandledRejection_=function(promise,reason){if(goog.Promise.UNHANDLED_REJECTION_DELAY>0)promise.unhandledRejectionId_=goog.global.setTimeout(function(){promise.appendLongStack_(reason);goog.Promise.handleRejection_.call(null,reason)},goog.Promise.UNHANDLED_REJECTION_DELAY);else if(goog.Promise.UNHANDLED_REJECTION_DELAY==0){promise.hadUnhandledRejection_=true;goog.async.run(function(){if(promise.hadUnhandledRejection_){promise.appendLongStack_(reason);goog.Promise.handleRejection_.call(null,
reason)}})}};goog.Promise.handleRejection_=goog.async.throwException;goog.Promise.setUnhandledRejectionHandler=function(handler){goog.Promise.handleRejection_=handler};goog.Promise.CancellationError=function(opt_message){goog.Promise.CancellationError.base(this,"constructor",opt_message);this.reportErrorToServer=false};goog.inherits(goog.Promise.CancellationError,goog.debug.Error);goog.Promise.CancellationError.prototype.name="cancel";
goog.Promise.Resolver_=function(promise,resolve,reject){this.promise=promise;this.resolve=resolve;this.reject=reject};goog.provide("goog.events.EventTarget");goog.require("goog.Disposable");goog.require("goog.asserts");goog.require("goog.events");goog.require("goog.events.Event");goog.require("goog.events.Listenable");goog.require("goog.events.ListenerMap");goog.require("goog.object");goog.requireType("goog.events.EventId");goog.requireType("goog.events.EventLike");goog.requireType("goog.events.ListenableKey");
goog.events.EventTarget=function(){goog.Disposable.call(this);this.eventTargetListeners_=new goog.events.ListenerMap(this);this.actualEventTarget_=this;this.parentEventTarget_=null};goog.inherits(goog.events.EventTarget,goog.Disposable);goog.events.Listenable.addImplementation(goog.events.EventTarget);goog.events.EventTarget.MAX_ANCESTORS_=1E3;goog.events.EventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_};
goog.events.EventTarget.prototype.setParentEventTarget=function(parent){this.parentEventTarget_=parent};goog.events.EventTarget.prototype.addEventListener=function(type,handler,opt_capture,opt_handlerScope){goog.events.listen(this,type,handler,opt_capture,opt_handlerScope)};goog.events.EventTarget.prototype.removeEventListener=function(type,handler,opt_capture,opt_handlerScope){goog.events.unlisten(this,type,handler,opt_capture,opt_handlerScope)};
goog.events.EventTarget.prototype.dispatchEvent=function(e){this.assertInitialized_();var ancestorsTree,ancestor=this.getParentEventTarget();if(ancestor){ancestorsTree=[];var ancestorCount=1;for(;ancestor;ancestor=ancestor.getParentEventTarget()){ancestorsTree.push(ancestor);goog.asserts.assert(++ancestorCount<goog.events.EventTarget.MAX_ANCESTORS_,"infinite loop")}}return goog.events.EventTarget.dispatchEventInternal_(this.actualEventTarget_,e,ancestorsTree)};
goog.events.EventTarget.prototype.disposeInternal=function(){goog.events.EventTarget.superClass_.disposeInternal.call(this);this.removeAllListeners();this.parentEventTarget_=null};goog.events.EventTarget.prototype.listen=function(type,listener,opt_useCapture,opt_listenerScope){this.assertInitialized_();return this.eventTargetListeners_.add(String(type),listener,false,opt_useCapture,opt_listenerScope)};
goog.events.EventTarget.prototype.listenOnce=function(type,listener,opt_useCapture,opt_listenerScope){return this.eventTargetListeners_.add(String(type),listener,true,opt_useCapture,opt_listenerScope)};goog.events.EventTarget.prototype.unlisten=function(type,listener,opt_useCapture,opt_listenerScope){return this.eventTargetListeners_.remove(String(type),listener,opt_useCapture,opt_listenerScope)};goog.events.EventTarget.prototype.unlistenByKey=function(key){return this.eventTargetListeners_.removeByKey(key)};
goog.events.EventTarget.prototype.removeAllListeners=function(opt_type){if(!this.eventTargetListeners_)return 0;return this.eventTargetListeners_.removeAll(opt_type)};
goog.events.EventTarget.prototype.fireListeners=function(type,capture,eventObject){var listenerArray=this.eventTargetListeners_.listeners[String(type)];if(!listenerArray)return true;listenerArray=listenerArray.concat();var rv=true;for(var i=0;i<listenerArray.length;++i){var listener=listenerArray[i];if(listener&&!listener.removed&&listener.capture==capture){var listenerFn=listener.listener;var listenerHandler=listener.handler||listener.src;if(listener.callOnce)this.unlistenByKey(listener);rv=listenerFn.call(listenerHandler,
eventObject)!==false&&rv}}return rv&&!eventObject.defaultPrevented};goog.events.EventTarget.prototype.getListeners=function(type,capture){return this.eventTargetListeners_.getListeners(String(type),capture)};goog.events.EventTarget.prototype.getListener=function(type,listener,capture,opt_listenerScope){return this.eventTargetListeners_.getListener(String(type),listener,capture,opt_listenerScope)};
goog.events.EventTarget.prototype.hasListener=function(opt_type,opt_capture){var id=opt_type!==undefined?String(opt_type):undefined;return this.eventTargetListeners_.hasListener(id,opt_capture)};goog.events.EventTarget.prototype.setTargetForTesting=function(target){this.actualEventTarget_=target};goog.events.EventTarget.prototype.assertInitialized_=function(){goog.asserts.assert(this.eventTargetListeners_,"Event target is not initialized. Did you call the superclass "+"(goog.events.EventTarget) constructor?")};
goog.events.EventTarget.dispatchEventInternal_=function(target,e,opt_ancestorsTree){var type=e.type||e;if(typeof e==="string")e=new goog.events.Event(e,target);else if(!(e instanceof goog.events.Event)){var oldEvent=e;e=new goog.events.Event(type,target);goog.object.extend(e,oldEvent)}else e.target=e.target||target;var rv=true,currentTarget;if(opt_ancestorsTree)for(var i=opt_ancestorsTree.length-1;!e.hasPropagationStopped()&&i>=0;i--){currentTarget=e.currentTarget=opt_ancestorsTree[i];rv=currentTarget.fireListeners(type,
true,e)&&rv}if(!e.hasPropagationStopped()){currentTarget=e.currentTarget=target;rv=currentTarget.fireListeners(type,true,e)&&rv;if(!e.hasPropagationStopped())rv=currentTarget.fireListeners(type,false,e)&&rv}if(opt_ancestorsTree)for(i=0;!e.hasPropagationStopped()&&i<opt_ancestorsTree.length;i++){currentTarget=e.currentTarget=opt_ancestorsTree[i];rv=currentTarget.fireListeners(type,false,e)&&rv}return rv};goog.provide("goog.Timer");goog.require("goog.Promise");goog.require("goog.events.EventTarget");goog.requireType("goog.Thenable");goog.Timer=function(opt_interval,opt_timerObject){goog.events.EventTarget.call(this);this.interval_=opt_interval||1;this.timerObject_=opt_timerObject||goog.Timer.defaultTimerObject;this.boundTick_=goog.bind(this.tick_,this);this.last_=goog.now()};goog.inherits(goog.Timer,goog.events.EventTarget);goog.Timer.MAX_TIMEOUT_=2147483647;goog.Timer.INVALID_TIMEOUT_ID_=-1;
goog.Timer.prototype.enabled=false;goog.Timer.defaultTimerObject=goog.global;goog.Timer.intervalScale=.8;goog.Timer.prototype.timer_=null;goog.Timer.prototype.getInterval=function(){return this.interval_};goog.Timer.prototype.setInterval=function(interval){this.interval_=interval;if(this.timer_&&this.enabled){this.stop();this.start()}else if(this.timer_)this.stop()};
goog.Timer.prototype.tick_=function(){if(this.enabled){var elapsed=goog.now()-this.last_;if(elapsed>0&&elapsed<this.interval_*goog.Timer.intervalScale){this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_-elapsed);return}if(this.timer_){this.timerObject_.clearTimeout(this.timer_);this.timer_=null}this.dispatchTick();if(this.enabled){this.stop();this.start()}}};goog.Timer.prototype.dispatchTick=function(){this.dispatchEvent(goog.Timer.TICK)};
goog.Timer.prototype.start=function(){this.enabled=true;if(!this.timer_){this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_);this.last_=goog.now()}};goog.Timer.prototype.stop=function(){this.enabled=false;if(this.timer_){this.timerObject_.clearTimeout(this.timer_);this.timer_=null}};goog.Timer.prototype.disposeInternal=function(){goog.Timer.superClass_.disposeInternal.call(this);this.stop();delete this.timerObject_};goog.Timer.TICK="tick";
goog.Timer.callOnce=function(listener,opt_delay,opt_handler){if(typeof listener==="function"){if(opt_handler)listener=goog.bind(listener,opt_handler)}else if(listener&&typeof listener.handleEvent=="function")listener=goog.bind(listener.handleEvent,listener);else throw new Error("Invalid listener argument");if(Number(opt_delay)>goog.Timer.MAX_TIMEOUT_)return goog.Timer.INVALID_TIMEOUT_ID_;else return goog.Timer.defaultTimerObject.setTimeout(listener,opt_delay||0)};goog.Timer.clear=function(timerId){goog.Timer.defaultTimerObject.clearTimeout(timerId)};
goog.Timer.promise=function(delay,opt_result){var timerKey=null;return(new goog.Promise(function(resolve,reject){timerKey=goog.Timer.callOnce(function(){resolve(opt_result)},delay);if(timerKey==goog.Timer.INVALID_TIMEOUT_ID_)reject(new Error("Failed to schedule timer."))})).thenCatch(function(error){goog.Timer.clear(timerKey);throw error;})};goog.provide("goog.events.FocusHandler");goog.provide("goog.events.FocusHandler.EventType");goog.require("goog.events");goog.require("goog.events.BrowserEvent");goog.require("goog.events.EventTarget");goog.require("goog.userAgent");
goog.events.FocusHandler=function(element){goog.events.EventTarget.call(this);this.element_=element;var typeIn=goog.userAgent.IE?"focusin":"focus";var typeOut=goog.userAgent.IE?"focusout":"blur";this.listenKeyIn_=goog.events.listen(this.element_,typeIn,this,!goog.userAgent.IE);this.listenKeyOut_=goog.events.listen(this.element_,typeOut,this,!goog.userAgent.IE)};goog.inherits(goog.events.FocusHandler,goog.events.EventTarget);goog.events.FocusHandler.EventType={FOCUSIN:"focusin",FOCUSOUT:"focusout"};
goog.events.FocusHandler.prototype.handleEvent=function(e){var be=e.getBrowserEvent();var event=new goog.events.BrowserEvent(be);event.type=e.type=="focusin"||e.type=="focus"?goog.events.FocusHandler.EventType.FOCUSIN:goog.events.FocusHandler.EventType.FOCUSOUT;this.dispatchEvent(event)};
goog.events.FocusHandler.prototype.disposeInternal=function(){goog.events.FocusHandler.superClass_.disposeInternal.call(this);goog.events.unlistenByKey(this.listenKeyIn_);goog.events.unlistenByKey(this.listenKeyOut_);delete this.element_};goog.provide("goog.userAgent.platform");goog.require("goog.string");goog.require("goog.userAgent");
goog.userAgent.platform.determineVersion_=function(){var re;if(goog.userAgent.WINDOWS){re=/Windows NT ([0-9.]+)/;var match=re.exec(goog.userAgent.getUserAgentString());if(match)return match[1];else return"0"}else if(goog.userAgent.MAC){re=/1[0|1][_.][0-9_.]+/;var match=re.exec(goog.userAgent.getUserAgentString());return match?match[0].replace(/_/g,"."):"10"}else if(goog.userAgent.ANDROID){re=/Android\s+([^\);]+)(\)|;)/;var match=re.exec(goog.userAgent.getUserAgentString());return match?match[1]:""}else if(goog.userAgent.IPHONE||
goog.userAgent.IPAD||goog.userAgent.IPOD){re=/(?:iPhone|CPU)\s+OS\s+(\S+)/;var match=re.exec(goog.userAgent.getUserAgentString());return match?match[1].replace(/_/g,"."):""}return""};goog.userAgent.platform.VERSION=goog.userAgent.platform.determineVersion_();goog.userAgent.platform.isVersion=function(version){return goog.string.compareVersions(goog.userAgent.platform.VERSION,version)>=0};goog.provide("goog.userAgent.product");goog.require("goog.labs.userAgent.browser");goog.require("goog.labs.userAgent.platform");goog.require("goog.userAgent");goog.userAgent.product.ASSUME_FIREFOX=goog.define("goog.userAgent.product.ASSUME_FIREFOX",false);goog.userAgent.product.ASSUME_IPHONE=goog.define("goog.userAgent.product.ASSUME_IPHONE",false);goog.userAgent.product.ASSUME_IPAD=goog.define("goog.userAgent.product.ASSUME_IPAD",false);
goog.userAgent.product.ASSUME_ANDROID=goog.define("goog.userAgent.product.ASSUME_ANDROID",false);goog.userAgent.product.ASSUME_CHROME=goog.define("goog.userAgent.product.ASSUME_CHROME",false);goog.userAgent.product.ASSUME_SAFARI=goog.define("goog.userAgent.product.ASSUME_SAFARI",false);
goog.userAgent.product.PRODUCT_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_OPERA||goog.userAgent.product.ASSUME_FIREFOX||goog.userAgent.product.ASSUME_IPHONE||goog.userAgent.product.ASSUME_IPAD||goog.userAgent.product.ASSUME_ANDROID||goog.userAgent.product.ASSUME_CHROME||goog.userAgent.product.ASSUME_SAFARI;goog.userAgent.product.OPERA=goog.userAgent.OPERA;goog.userAgent.product.IE=goog.userAgent.IE;goog.userAgent.product.EDGE=goog.userAgent.EDGE;
goog.userAgent.product.FIREFOX=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_FIREFOX:goog.labs.userAgent.browser.isFirefox();goog.userAgent.product.isIphoneOrIpod_=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpod()};goog.userAgent.product.IPHONE=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPHONE:goog.userAgent.product.isIphoneOrIpod_();
goog.userAgent.product.IPAD=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad();goog.userAgent.product.ANDROID=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_ANDROID:goog.labs.userAgent.browser.isAndroidBrowser();goog.userAgent.product.CHROME=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_CHROME:goog.labs.userAgent.browser.isChrome();
goog.userAgent.product.isSafariDesktop_=function(){return goog.labs.userAgent.browser.isSafari()&&!goog.labs.userAgent.platform.isIos()};goog.userAgent.product.SAFARI=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_SAFARI:goog.userAgent.product.isSafariDesktop_();goog.provide("goog.userAgent.product.isVersion");goog.require("goog.labs.userAgent.platform");goog.require("goog.string");goog.require("goog.userAgent");goog.require("goog.userAgent.product");
goog.userAgent.product.determineVersion_=function(){if(goog.userAgent.product.FIREFOX)return goog.userAgent.product.getFirstRegExpGroup_(/Firefox\/([0-9.]+)/);if(goog.userAgent.product.IE||goog.userAgent.product.EDGE||goog.userAgent.product.OPERA)return goog.userAgent.VERSION;if(goog.userAgent.product.CHROME){if(goog.labs.userAgent.platform.isIos()||goog.labs.userAgent.platform.isMacintosh()){const chromeIosVersion=goog.userAgent.product.getFirstRegExpGroup_(/CriOS\/([0-9.]+)/);if(chromeIosVersion)return chromeIosVersion}return goog.userAgent.product.getFirstRegExpGroup_(/Chrome\/([0-9.]+)/)}if(goog.userAgent.product.SAFARI&&
!goog.labs.userAgent.platform.isIos())return goog.userAgent.product.getFirstRegExpGroup_(/Version\/([0-9.]+)/);if(goog.userAgent.product.IPHONE||goog.userAgent.product.IPAD){var arr=goog.userAgent.product.execRegExp_(/Version\/(\S+).*Mobile\/(\S+)/);if(arr)return arr[1]+"."+arr[2]}else if(goog.userAgent.product.ANDROID){var version=goog.userAgent.product.getFirstRegExpGroup_(/Android\s+([0-9.]+)/);if(version)return version;return goog.userAgent.product.getFirstRegExpGroup_(/Version\/([0-9.]+)/)}return""};
goog.userAgent.product.getFirstRegExpGroup_=function(re){var arr=goog.userAgent.product.execRegExp_(re);return arr?arr[1]:""};goog.userAgent.product.execRegExp_=function(re){return re.exec(goog.userAgent.getUserAgentString())};goog.userAgent.product.VERSION=goog.userAgent.product.determineVersion_();goog.userAgent.product.isVersion=function(version){return goog.string.compareVersions(goog.userAgent.product.VERSION,version)>=0};goog.provide("goog.style.bidi");goog.require("goog.dom");goog.require("goog.style");goog.require("goog.userAgent");goog.require("goog.userAgent.platform");goog.require("goog.userAgent.product");goog.require("goog.userAgent.product.isVersion");
goog.style.bidi.getScrollLeft=function(element){var isRtl=goog.style.isRightToLeft(element);if(isRtl&&goog.style.bidi.usesNegativeScrollLeftInRtl_())return-element.scrollLeft;else if(isRtl&&!goog.userAgent.EDGE_OR_IE){var overflowX=goog.style.getComputedOverflowX(element);if(overflowX=="visible")return element.scrollLeft;else return element.scrollWidth-element.clientWidth-element.scrollLeft}return element.scrollLeft};
goog.style.bidi.getOffsetStart=function(element){element=element;var offsetLeftForReal=element.offsetLeft;var bestParent=element.offsetParent;if(!bestParent&&goog.style.getComputedPosition(element)=="fixed")bestParent=goog.dom.getOwnerDocument(element).documentElement;if(!bestParent)return offsetLeftForReal;if(goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher(58)){var borderWidths=goog.style.getBorderBox(bestParent);offsetLeftForReal+=borderWidths.left}else if(goog.userAgent.isDocumentModeOrHigher(8)&&
!goog.userAgent.isDocumentModeOrHigher(9)){var borderWidths=goog.style.getBorderBox(bestParent);offsetLeftForReal-=borderWidths.left}if(goog.style.isRightToLeft(bestParent)){var elementRightOffset=offsetLeftForReal+element.offsetWidth;return bestParent.clientWidth-elementRightOffset}return offsetLeftForReal};
goog.style.bidi.setScrollOffset=function(element,offsetStart){offsetStart=Math.max(offsetStart,0);if(!goog.style.isRightToLeft(element))element.scrollLeft=offsetStart;else if(goog.style.bidi.usesNegativeScrollLeftInRtl_())element.scrollLeft=-offsetStart;else if(!goog.userAgent.EDGE_OR_IE)element.scrollLeft=element.scrollWidth-offsetStart-element.clientWidth;else element.scrollLeft=offsetStart};
goog.style.bidi.usesNegativeScrollLeftInRtl_=function(){var isSafari10Plus=goog.userAgent.product.SAFARI&&goog.userAgent.product.isVersion(10);var isIOS10Plus=goog.userAgent.IOS&&goog.userAgent.platform.isVersion(10);const isChrome85Plus=goog.userAgent.product.CHROME&&goog.userAgent.product.isVersion(85);return goog.userAgent.GECKO||isSafari10Plus||isIOS10Plus||isChrome85Plus};
goog.style.bidi.setPosition=function(elem,left,top,isRtl){if(top!==null)elem.style.top=top+"px";if(isRtl){elem.style.right=left+"px";elem.style.left=""}else{elem.style.left=left+"px";elem.style.right=""}};goog.provide("goog.positioning");goog.provide("goog.positioning.Corner");goog.provide("goog.positioning.CornerBit");goog.provide("goog.positioning.Overflow");goog.provide("goog.positioning.OverflowStatus");goog.require("goog.asserts");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.math.Coordinate");goog.require("goog.math.Rect");goog.require("goog.math.Size");goog.require("goog.style");goog.require("goog.style.bidi");goog.requireType("goog.math.Box");
goog.positioning.CornerBit={BOTTOM:1,CENTER:2,RIGHT:4,FLIP_RTL:8};
goog.positioning.Corner={TOP_LEFT:0,TOP_RIGHT:goog.positioning.CornerBit.RIGHT,BOTTOM_LEFT:goog.positioning.CornerBit.BOTTOM,BOTTOM_RIGHT:goog.positioning.CornerBit.BOTTOM|goog.positioning.CornerBit.RIGHT,TOP_START:goog.positioning.CornerBit.FLIP_RTL,TOP_END:goog.positioning.CornerBit.FLIP_RTL|goog.positioning.CornerBit.RIGHT,BOTTOM_START:goog.positioning.CornerBit.BOTTOM|goog.positioning.CornerBit.FLIP_RTL,BOTTOM_END:goog.positioning.CornerBit.BOTTOM|goog.positioning.CornerBit.RIGHT|goog.positioning.CornerBit.FLIP_RTL,
TOP_CENTER:goog.positioning.CornerBit.CENTER,BOTTOM_CENTER:goog.positioning.CornerBit.BOTTOM|goog.positioning.CornerBit.CENTER};goog.positioning.Overflow={IGNORE:0,ADJUST_X:1,FAIL_X:2,ADJUST_Y:4,FAIL_Y:8,RESIZE_WIDTH:16,RESIZE_HEIGHT:32,ADJUST_X_EXCEPT_OFFSCREEN:64|1,ADJUST_Y_EXCEPT_OFFSCREEN:128|4};
goog.positioning.OverflowStatus={NONE:0,ADJUSTED_X:1,ADJUSTED_Y:2,WIDTH_ADJUSTED:4,HEIGHT_ADJUSTED:8,FAILED_LEFT:16,FAILED_RIGHT:32,FAILED_TOP:64,FAILED_BOTTOM:128,FAILED_OUTSIDE_VIEWPORT:256,FAILED:16|32|64|128|256,FAILED_HORIZONTAL:16|32,FAILED_VERTICAL:64|128};
goog.positioning.positionAtAnchor=function(anchorElement,anchorElementCorner,movableElement,movableElementCorner,opt_offset,opt_margin,opt_overflow,opt_preferredSize,opt_viewport){goog.asserts.assert(movableElement);var movableParentTopLeft=goog.positioning.getOffsetParentPageOffset(movableElement);var anchorRect=goog.positioning.getVisiblePart_(anchorElement);goog.style.translateRectForAnotherFrame(anchorRect,goog.dom.getDomHelper(anchorElement),goog.dom.getDomHelper(movableElement));var corner=
goog.positioning.getEffectiveCorner(anchorElement,anchorElementCorner);var offsetLeft=anchorRect.left;if(corner&goog.positioning.CornerBit.RIGHT)offsetLeft+=anchorRect.width;else if(corner&goog.positioning.CornerBit.CENTER)offsetLeft+=anchorRect.width/2;var absolutePos=new goog.math.Coordinate(offsetLeft,anchorRect.top+(corner&goog.positioning.CornerBit.BOTTOM?anchorRect.height:0));absolutePos=goog.math.Coordinate.difference(absolutePos,movableParentTopLeft);if(opt_offset){absolutePos.x+=(corner&
goog.positioning.CornerBit.RIGHT?-1:1)*opt_offset.x;absolutePos.y+=(corner&goog.positioning.CornerBit.BOTTOM?-1:1)*opt_offset.y}var viewport;if(opt_overflow)if(opt_viewport)viewport=opt_viewport;else{viewport=goog.style.getVisibleRectForElement(movableElement);if(viewport){viewport.top-=movableParentTopLeft.y;viewport.right-=movableParentTopLeft.x;viewport.bottom-=movableParentTopLeft.y;viewport.left-=movableParentTopLeft.x}}return goog.positioning.positionAtCoordinate(absolutePos,movableElement,
movableElementCorner,opt_margin,viewport,opt_overflow,opt_preferredSize)};
goog.positioning.getOffsetParentPageOffset=function(movableElement){var movableParentTopLeft;var parent=movableElement.offsetParent;if(parent){var isBody=parent.tagName==goog.dom.TagName.HTML||parent.tagName==goog.dom.TagName.BODY;if(!isBody||goog.style.getComputedPosition(parent)!="static"){movableParentTopLeft=goog.style.getPageOffset(parent);if(!isBody)movableParentTopLeft=goog.math.Coordinate.difference(movableParentTopLeft,new goog.math.Coordinate(goog.style.bidi.getScrollLeft(parent),parent.scrollTop))}}return movableParentTopLeft||
new goog.math.Coordinate};goog.positioning.getVisiblePart_=function(el){var rect=goog.style.getBounds(el);var visibleBox=goog.style.getVisibleRectForElement(el);if(visibleBox)rect.intersection(goog.math.Rect.createFromBox(visibleBox));return rect};
goog.positioning.positionAtCoordinate=function(absolutePos,movableElement,movableElementCorner,opt_margin,opt_viewport,opt_overflow,opt_preferredSize){absolutePos=absolutePos.clone();var corner=goog.positioning.getEffectiveCorner(movableElement,movableElementCorner);var elementSize=goog.style.getSize(movableElement);var size=opt_preferredSize?opt_preferredSize.clone():elementSize.clone();var positionResult=goog.positioning.getPositionAtCoordinate(absolutePos,size,corner,opt_margin,opt_viewport,opt_overflow);
if(positionResult.status&goog.positioning.OverflowStatus.FAILED)return positionResult.status;goog.style.setPosition(movableElement,positionResult.rect.getTopLeft());size=positionResult.rect.getSize();if(!goog.math.Size.equals(elementSize,size))goog.style.setBorderBoxSize(movableElement,size);return positionResult.status};
goog.positioning.getPositionAtCoordinate=function(absolutePos,elementSize,elementCorner,opt_margin,opt_viewport,opt_overflow){absolutePos=absolutePos.clone();elementSize=elementSize.clone();var status=goog.positioning.OverflowStatus.NONE;if(opt_margin||elementCorner!=goog.positioning.Corner.TOP_LEFT){if(elementCorner&goog.positioning.CornerBit.RIGHT)absolutePos.x-=elementSize.width+(opt_margin?opt_margin.right:0);else if(elementCorner&goog.positioning.CornerBit.CENTER)absolutePos.x-=elementSize.width/
2;else if(opt_margin)absolutePos.x+=opt_margin.left;if(elementCorner&goog.positioning.CornerBit.BOTTOM)absolutePos.y-=elementSize.height+(opt_margin?opt_margin.bottom:0);else if(opt_margin)absolutePos.y+=opt_margin.top}if(opt_overflow)status=opt_viewport?goog.positioning.adjustForViewport_(absolutePos,elementSize,opt_viewport,opt_overflow):goog.positioning.OverflowStatus.FAILED_OUTSIDE_VIEWPORT;var rect=new goog.math.Rect(0,0,0,0);rect.left=absolutePos.x;rect.top=absolutePos.y;rect.width=elementSize.width;
rect.height=elementSize.height;return{rect:rect,status:status}};
goog.positioning.adjustForViewport_=function(pos,size,viewport,overflow){var status=goog.positioning.OverflowStatus.NONE;var ADJUST_X_EXCEPT_OFFSCREEN=goog.positioning.Overflow.ADJUST_X_EXCEPT_OFFSCREEN;var ADJUST_Y_EXCEPT_OFFSCREEN=goog.positioning.Overflow.ADJUST_Y_EXCEPT_OFFSCREEN;if((overflow&ADJUST_X_EXCEPT_OFFSCREEN)==ADJUST_X_EXCEPT_OFFSCREEN&&(pos.x<viewport.left||pos.x>=viewport.right))overflow&=~goog.positioning.Overflow.ADJUST_X;if((overflow&ADJUST_Y_EXCEPT_OFFSCREEN)==ADJUST_Y_EXCEPT_OFFSCREEN&&
(pos.y<viewport.top||pos.y>=viewport.bottom))overflow&=~goog.positioning.Overflow.ADJUST_Y;if(pos.x<viewport.left&&overflow&goog.positioning.Overflow.ADJUST_X){pos.x=viewport.left;status|=goog.positioning.OverflowStatus.ADJUSTED_X}if(overflow&goog.positioning.Overflow.RESIZE_WIDTH){var originalX=pos.x;if(pos.x<viewport.left){pos.x=viewport.left;status|=goog.positioning.OverflowStatus.WIDTH_ADJUSTED}if(pos.x+size.width>viewport.right){size.width=Math.min(viewport.right-pos.x,originalX+size.width-viewport.left);
size.width=Math.max(size.width,0);status|=goog.positioning.OverflowStatus.WIDTH_ADJUSTED}}if(pos.x+size.width>viewport.right&&overflow&goog.positioning.Overflow.ADJUST_X){pos.x=Math.max(viewport.right-size.width,viewport.left);status|=goog.positioning.OverflowStatus.ADJUSTED_X}if(overflow&goog.positioning.Overflow.FAIL_X)status|=(pos.x<viewport.left?goog.positioning.OverflowStatus.FAILED_LEFT:0)|(pos.x+size.width>viewport.right?goog.positioning.OverflowStatus.FAILED_RIGHT:0);if(pos.y<viewport.top&&
overflow&goog.positioning.Overflow.ADJUST_Y){pos.y=viewport.top;status|=goog.positioning.OverflowStatus.ADJUSTED_Y}if(overflow&goog.positioning.Overflow.RESIZE_HEIGHT){var originalY=pos.y;if(pos.y<viewport.top){pos.y=viewport.top;status|=goog.positioning.OverflowStatus.HEIGHT_ADJUSTED}if(pos.y+size.height>viewport.bottom){size.height=Math.min(viewport.bottom-pos.y,originalY+size.height-viewport.top);size.height=Math.max(size.height,0);status|=goog.positioning.OverflowStatus.HEIGHT_ADJUSTED}}if(pos.y+
size.height>viewport.bottom&&overflow&goog.positioning.Overflow.ADJUST_Y){pos.y=Math.max(viewport.bottom-size.height,viewport.top);status|=goog.positioning.OverflowStatus.ADJUSTED_Y}if(overflow&goog.positioning.Overflow.FAIL_Y)status|=(pos.y<viewport.top?goog.positioning.OverflowStatus.FAILED_TOP:0)|(pos.y+size.height>viewport.bottom?goog.positioning.OverflowStatus.FAILED_BOTTOM:0);return status};
goog.positioning.getEffectiveCorner=function(element,corner){return(corner&goog.positioning.CornerBit.FLIP_RTL&&goog.style.isRightToLeft(element)?corner^goog.positioning.CornerBit.RIGHT:corner)&~goog.positioning.CornerBit.FLIP_RTL};goog.positioning.flipCornerHorizontal=function(corner){return corner^goog.positioning.CornerBit.RIGHT};goog.positioning.flipCornerVertical=function(corner){return corner^goog.positioning.CornerBit.BOTTOM};
goog.positioning.flipCorner=function(corner){return corner^goog.positioning.CornerBit.BOTTOM^goog.positioning.CornerBit.RIGHT};goog.provide("goog.positioning.AbstractPosition");goog.requireType("goog.math.Box");goog.requireType("goog.math.Size");goog.requireType("goog.positioning.Corner");goog.positioning.AbstractPosition=function(){};goog.positioning.AbstractPosition.prototype.reposition=function(movableElement,corner,opt_margin,opt_preferredSize){};goog.provide("goog.positioning.AnchoredPosition");goog.require("goog.positioning");goog.require("goog.positioning.AbstractPosition");goog.requireType("goog.math.Box");goog.requireType("goog.math.Size");goog.positioning.AnchoredPosition=function(anchorElement,corner,opt_overflow){this.element=anchorElement;this.corner=corner;this.overflow_=opt_overflow};goog.inherits(goog.positioning.AnchoredPosition,goog.positioning.AbstractPosition);
goog.positioning.AnchoredPosition.prototype.reposition=function(movableElement,movableCorner,opt_margin,opt_preferredSize){goog.positioning.positionAtAnchor(this.element,this.corner,movableElement,movableCorner,undefined,opt_margin,this.overflow_)};goog.provide("goog.positioning.ViewportPosition");goog.require("goog.math.Coordinate");goog.require("goog.positioning");goog.require("goog.positioning.AbstractPosition");goog.require("goog.positioning.Corner");goog.require("goog.style");goog.requireType("goog.math.Box");goog.requireType("goog.math.Size");goog.positioning.ViewportPosition=function(arg1,opt_arg2){this.coordinate=arg1 instanceof goog.math.Coordinate?arg1:new goog.math.Coordinate(arg1,opt_arg2)};
goog.inherits(goog.positioning.ViewportPosition,goog.positioning.AbstractPosition);goog.positioning.ViewportPosition.prototype.reposition=function(element,popupCorner,opt_margin,opt_preferredSize){goog.positioning.positionAtAnchor(goog.style.getClientViewportElement(element),goog.positioning.Corner.TOP_LEFT,element,popupCorner,this.coordinate,opt_margin,null,opt_preferredSize)};goog.provide("goog.structs");goog.require("goog.array");goog.require("goog.object");goog.structs.getCount=function(col){if(col.getCount&&typeof col.getCount=="function")return col.getCount();if(goog.isArrayLike(col)||typeof col==="string")return col.length;return goog.object.getCount(col)};
goog.structs.getValues=function(col){if(col.getValues&&typeof col.getValues=="function")return col.getValues();if(typeof Map!=="undefined"&&col instanceof Map||typeof Set!=="undefined"&&col instanceof Set)return Array.from(col.values());if(typeof col==="string")return col.split("");if(goog.isArrayLike(col)){var rv=[];var l=col.length;for(var i=0;i<l;i++)rv.push(col[i]);return rv}return goog.object.getValues(col)};
goog.structs.getKeys=function(col){if(col.getKeys&&typeof col.getKeys=="function")return col.getKeys();if(col.getValues&&typeof col.getValues=="function")return undefined;if(typeof Map!=="undefined"&&col instanceof Map)return Array.from(col.keys());if(typeof Set!=="undefined"&&col instanceof Set)return undefined;if(goog.isArrayLike(col)||typeof col==="string"){var rv=[];var l=col.length;for(var i=0;i<l;i++)rv.push(i);return rv}return goog.object.getKeys(col)};
goog.structs.contains=function(col,val){if(col.contains&&typeof col.contains=="function")return col.contains(val);if(col.containsValue&&typeof col.containsValue=="function")return col.containsValue(val);if(goog.isArrayLike(col)||typeof col==="string")return goog.array.contains(col,val);return goog.object.containsValue(col,val)};
goog.structs.isEmpty=function(col){if(col.isEmpty&&typeof col.isEmpty=="function")return col.isEmpty();if(goog.isArrayLike(col)||typeof col==="string")return col.length===0;return goog.object.isEmpty(col)};goog.structs.clear=function(col){if(col.clear&&typeof col.clear=="function")col.clear();else if(goog.isArrayLike(col))goog.array.clear(col);else goog.object.clear(col)};
goog.structs.forEach=function(col,f,opt_obj){if(col.forEach&&typeof col.forEach=="function")col.forEach(f,opt_obj);else if(goog.isArrayLike(col)||typeof col==="string")Array.prototype.forEach.call(col,f,opt_obj);else{var keys=goog.structs.getKeys(col);var values=goog.structs.getValues(col);var l=values.length;for(var i=0;i<l;i++)f.call(opt_obj,values[i],keys&&keys[i],col)}};
goog.structs.filter=function(col,f,opt_obj){if(typeof col.filter=="function")return col.filter(f,opt_obj);if(goog.isArrayLike(col)||typeof col==="string")return Array.prototype.filter.call(col,f,opt_obj);var rv;var keys=goog.structs.getKeys(col);var values=goog.structs.getValues(col);var l=values.length;if(keys){rv={};for(var i=0;i<l;i++)if(f.call(opt_obj,values[i],keys[i],col))rv[keys[i]]=values[i]}else{rv=[];for(var i=0;i<l;i++)if(f.call(opt_obj,values[i],undefined,col))rv.push(values[i])}return rv};
goog.structs.map=function(col,f,opt_obj){if(typeof col.map=="function")return col.map(f,opt_obj);if(goog.isArrayLike(col)||typeof col==="string")return Array.prototype.map.call(col,f,opt_obj);var rv;var keys=goog.structs.getKeys(col);var values=goog.structs.getValues(col);var l=values.length;if(keys){rv={};for(var i=0;i<l;i++)rv[keys[i]]=f.call(opt_obj,values[i],keys[i],col)}else{rv=[];for(var i=0;i<l;i++)rv[i]=f.call(opt_obj,values[i],undefined,col)}return rv};
goog.structs.some=function(col,f,opt_obj){if(typeof col.some=="function")return col.some(f,opt_obj);if(goog.isArrayLike(col)||typeof col==="string")return Array.prototype.some.call(col,f,opt_obj);var keys=goog.structs.getKeys(col);var values=goog.structs.getValues(col);var l=values.length;for(var i=0;i<l;i++)if(f.call(opt_obj,values[i],keys&&keys[i],col))return true;return false};
goog.structs.every=function(col,f,opt_obj){if(typeof col.every=="function")return col.every(f,opt_obj);if(goog.isArrayLike(col)||typeof col==="string")return Array.prototype.every.call(col,f,opt_obj);var keys=goog.structs.getKeys(col);var values=goog.structs.getValues(col);var l=values.length;for(var i=0;i<l;i++)if(!f.call(opt_obj,values[i],keys&&keys[i],col))return false;return true};goog.provide("goog.structs.Collection");goog.structs.Collection=function(){};goog.structs.Collection.prototype.add;goog.structs.Collection.prototype.remove;goog.structs.Collection.prototype.contains;goog.structs.Collection.prototype.getCount;goog.loadModule(function(exports){"use strict";goog.module("goog.collections.iters");goog.module.declareLegacyNamespace();function getIterator(iterable){return iterable[goog.global.Symbol.iterator]()}exports.getIterator=getIterator;function forEach(iterator,f){let result;while(!(result=iterator.next()).done)f(result.value)}exports.forEach=forEach;class MapIterator{constructor(childIter,mapFn){this.childIterator_=getIterator(childIter);this.mapFn_=mapFn}[Symbol.iterator](){return this}next(){const childResult=
this.childIterator_.next();return{value:childResult.done?undefined:this.mapFn_.call(undefined,childResult.value),done:childResult.done}}}exports.map=function(iterable,f){return new MapIterator(iterable,f)};class FilterIterator{constructor(childIter,filterFn){this.childIter_=getIterator(childIter);this.filterFn_=filterFn}[Symbol.iterator](){return this}next(){while(true){const childResult=this.childIter_.next();if(childResult.done)return{done:true,value:undefined};const passesFilter=this.filterFn_.call(undefined,
childResult.value);if(passesFilter)return childResult}}}exports.filter=function(iterable,f){return new FilterIterator(iterable,f)};class ConcatIterator{constructor(iterators){this.iterators_=iterators;this.iterIndex_=0}[Symbol.iterator](){return this}next(){while(this.iterIndex_<this.iterators_.length){const result=this.iterators_[this.iterIndex_].next();if(!result.done)return result;this.iterIndex_++}return{done:true}}}exports.concat=function(...iterables){return new ConcatIterator(iterables.map(getIterator))};
exports.toArray=function(iterator){const arr=[];forEach(iterator,e=>arr.push(e));return arr};return exports});goog.provide("goog.iter");goog.provide("goog.iter.Iterable");goog.provide("goog.iter.Iterator");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.debug");goog.require("goog.functions");goog.require("goog.math");goog.iter.Iterable;goog.iter.Iterator=function(){};goog.iter.Iterator.prototype.next=function(){return goog.iter.ES6_ITERATOR_DONE};goog.iter.ES6_ITERATOR_DONE=goog.debug.freeze({done:true,value:undefined});
goog.iter.createEs6IteratorYield=function(value){return{value,done:false}};goog.iter.Iterator.prototype.__iterator__=function(opt_keys){return this};
goog.iter.toIterator=function(iterable){if(iterable instanceof goog.iter.Iterator)return iterable;if(typeof iterable.__iterator__=="function")return iterable.__iterator__(false);if(goog.isArrayLike(iterable)){const like=iterable;let i=0;const newIter=new goog.iter.Iterator;newIter.next=function(){while(true){if(i>=like.length)return goog.iter.ES6_ITERATOR_DONE;if(!(i in like)){i++;continue}return goog.iter.createEs6IteratorYield(like[i++])}};return newIter}throw new Error("Not implemented");};
goog.iter.forEach=function(iterable,f,opt_obj){if(goog.isArrayLike(iterable))goog.array.forEach(iterable,f,opt_obj);else{const iterator=goog.iter.toIterator(iterable);while(true){const {done,value}=iterator.next();if(done)return;f.call(opt_obj,value,undefined,iterator)}}};
goog.iter.filter=function(iterable,f,opt_obj){const iterator=goog.iter.toIterator(iterable);const newIter=new goog.iter.Iterator;newIter.next=function(){while(true){const {done,value}=iterator.next();if(done)return goog.iter.ES6_ITERATOR_DONE;if(f.call(opt_obj,value,undefined,iterator))return goog.iter.createEs6IteratorYield(value)}};return newIter};goog.iter.filterFalse=function(iterable,f,opt_obj){return goog.iter.filter(iterable,goog.functions.not(f),opt_obj)};
goog.iter.range=function(startOrStop,opt_stop,opt_step){let start=0;let stop=startOrStop;let step=opt_step||1;if(arguments.length>1){start=startOrStop;stop=+opt_stop}if(step==0)throw new Error("Range step argument must not be zero");const newIter=new goog.iter.Iterator;newIter.next=function(){if(step>0&&start>=stop||step<0&&start<=stop)return goog.iter.ES6_ITERATOR_DONE;const rv=start;start+=step;return goog.iter.createEs6IteratorYield(rv)};return newIter};goog.iter.join=function(iterable,deliminator){return goog.iter.toArray(iterable).join(deliminator)};
goog.iter.map=function(iterable,f,opt_obj){const iterator=goog.iter.toIterator(iterable);const newIter=new goog.iter.Iterator;newIter.next=function(){const {done,value}=iterator.next();if(done)return goog.iter.ES6_ITERATOR_DONE;const mappedVal=f.call(opt_obj,value,undefined,iterator);return goog.iter.createEs6IteratorYield(mappedVal)};return newIter};goog.iter.reduce=function(iterable,f,val,opt_obj){let rval=val;goog.iter.forEach(iterable,function(val){rval=f.call(opt_obj,rval,val)});return rval};
goog.iter.some=function(iterable,f,opt_obj){const iterator=goog.iter.toIterator(iterable);while(true){const {done,value}=iterator.next();if(done)return false;if(f.call(opt_obj,value,undefined,iterator))return true}};goog.iter.every=function(iterable,f,opt_obj){const iterator=goog.iter.toIterator(iterable);while(true){const {done,value}=iterator.next();if(done)return true;if(!f.call(opt_obj,value,undefined,iterator))return false}};goog.iter.chain=function(var_args){return goog.iter.chainFromIterable(arguments)};
goog.iter.chainFromIterable=function(iterable){const iteratorOfIterators=goog.iter.toIterator(iterable);const iter=new goog.iter.Iterator;let current=null;iter.next=function(){while(true){if(current==null){const it=iteratorOfIterators.next();if(it.done)return goog.iter.ES6_ITERATOR_DONE;const value=it.value;current=goog.iter.toIterator(value)}const it=current.next();if(it.done){current=null;continue}const value=it.value;return goog.iter.createEs6IteratorYield(value)}};return iter};
goog.iter.dropWhile=function(iterable,f,opt_obj){const iterator=goog.iter.toIterator(iterable);const newIter=new goog.iter.Iterator;let dropping=true;newIter.next=function(){while(true){const {done,value}=iterator.next();if(done)return goog.iter.ES6_ITERATOR_DONE;if(dropping&&f.call(opt_obj,value,undefined,iterator))continue;else dropping=false;return goog.iter.createEs6IteratorYield(value)}};return newIter};
goog.iter.takeWhile=function(iterable,f,opt_obj){const iterator=goog.iter.toIterator(iterable);const iter=new goog.iter.Iterator;iter.next=function(){const {done,value}=iterator.next();if(done)return goog.iter.ES6_ITERATOR_DONE;if(f.call(opt_obj,value,undefined,iterator))return goog.iter.createEs6IteratorYield(value);return goog.iter.ES6_ITERATOR_DONE};return iter};
goog.iter.toArray=function(iterable){if(goog.isArrayLike(iterable))return goog.array.toArray(iterable);iterable=goog.iter.toIterator(iterable);const array=[];goog.iter.forEach(iterable,function(val){array.push(val)});return array};
goog.iter.equals=function(iterable1,iterable2,opt_equalsFn){const fillValue={};const pairs=goog.iter.zipLongest(fillValue,iterable1,iterable2);const equalsFn=opt_equalsFn||goog.array.defaultCompareEquality;return goog.iter.every(pairs,function(pair){return equalsFn(pair[0],pair[1])})};goog.iter.nextOrValue=function(iterable,defaultValue){const iterator=goog.iter.toIterator(iterable);const {done,value}=iterator.next();if(done)return defaultValue;return value};
goog.iter.product=function(var_args){const someArrayEmpty=Array.prototype.some.call(arguments,function(arr){return!arr.length});if(someArrayEmpty||!arguments.length)return new goog.iter.Iterator;const iter=new goog.iter.Iterator;const arrays=arguments;let indices=goog.array.repeat(0,arrays.length);iter.next=function(){if(indices){const retVal=goog.array.map(indices,function(valueIndex,arrayIndex){return arrays[arrayIndex][valueIndex]});for(let i=indices.length-1;i>=0;i--){goog.asserts.assert(indices);
if(indices[i]<arrays[i].length-1){indices[i]++;break}if(i==0){indices=null;break}indices[i]=0}return goog.iter.createEs6IteratorYield(retVal)}return goog.iter.ES6_ITERATOR_DONE};return iter};
goog.iter.cycle=function(iterable){const baseIterator=goog.iter.toIterator(iterable);const cache=[];let cacheIndex=0;const iter=new goog.iter.Iterator;let useCache=false;iter.next=function(){let returnElement=null;if(!useCache){const it=baseIterator.next();if(it.done){if(goog.array.isEmpty(cache))return goog.iter.ES6_ITERATOR_DONE;useCache=true}else{cache.push(it.value);return it}}returnElement=cache[cacheIndex];cacheIndex=(cacheIndex+1)%cache.length;return goog.iter.createEs6IteratorYield(returnElement)};
return iter};goog.iter.count=function(opt_start,opt_step){let counter=opt_start||0;const step=opt_step!==undefined?opt_step:1;const iter=new goog.iter.Iterator;iter.next=function(){const returnValue=counter;counter+=step;return goog.iter.createEs6IteratorYield(returnValue)};return iter};goog.iter.repeat=function(value){const iter=new goog.iter.Iterator;iter.next=function(){return goog.iter.createEs6IteratorYield(value)};return iter};
goog.iter.accumulate=function(iterable){const iterator=goog.iter.toIterator(iterable);let total=0;const iter=new goog.iter.Iterator;iter.next=function(){const {done,value}=iterator.next();if(done)return goog.iter.ES6_ITERATOR_DONE;total+=value;return goog.iter.createEs6IteratorYield(total)};return iter};
goog.iter.zip=function(var_args){const args=arguments;const iter=new goog.iter.Iterator;if(args.length>0){const iterators=goog.array.map(args,goog.iter.toIterator);let allDone=false;iter.next=function(){if(allDone)return goog.iter.ES6_ITERATOR_DONE;const arr=[];for(let i=0,iterator;iterator=iterators[i++];){const it=iterator.next();if(it.done){allDone=true;return goog.iter.ES6_ITERATOR_DONE}arr.push(it.value)}return goog.iter.createEs6IteratorYield(arr)}}return iter};
goog.iter.zipLongest=function(fillValue,var_args){const args=Array.prototype.slice.call(arguments,1);const iter=new goog.iter.Iterator;if(args.length>0){const iterators=goog.array.map(args,goog.iter.toIterator);let allDone=false;iter.next=function(){if(allDone)return goog.iter.ES6_ITERATOR_DONE;let iteratorsHaveValues=false;const arr=[];for(let i=0,iterator;iterator=iterators[i++];){const it=iterator.next();if(it.done){arr.push(fillValue);continue}arr.push(it.value);iteratorsHaveValues=true}if(!iteratorsHaveValues){allDone=
true;return goog.iter.ES6_ITERATOR_DONE}return goog.iter.createEs6IteratorYield(arr)}}return iter};
goog.iter.compress=function(iterable,selectors){const valueIterator=goog.iter.toIterator(iterable);const selectorIterator=goog.iter.toIterator(selectors);const iter=new goog.iter.Iterator;let allDone=false;iter.next=function(){if(allDone)return goog.iter.ES6_ITERATOR_DONE;while(true){const valIt=valueIterator.next();if(valIt.done){allDone=true;return goog.iter.ES6_ITERATOR_DONE}const selectorIt=selectorIterator.next();if(selectorIt.done){allDone=true;return goog.iter.ES6_ITERATOR_DONE}const val=valIt.value;
const selectorVal=selectorIt.value;if(selectorVal)return goog.iter.createEs6IteratorYield(val)}};return iter};goog.iter.GroupByIterator_=function(iterable,opt_keyFunc){this.iterator=goog.iter.toIterator(iterable);this.keyFunc=opt_keyFunc||goog.functions.identity;this.targetKey;this.currentKey;this.currentValue};goog.inherits(goog.iter.GroupByIterator_,goog.iter.Iterator);
goog.iter.GroupByIterator_.prototype.next=function(){while(this.currentKey==this.targetKey){const it=this.iterator.next();if(it.done)return goog.iter.ES6_ITERATOR_DONE;this.currentValue=it.value;this.currentKey=this.keyFunc(this.currentValue)}this.targetKey=this.currentKey;return goog.iter.createEs6IteratorYield([this.currentKey,this.groupItems_(this.targetKey)])};
goog.iter.GroupByIterator_.prototype.groupItems_=function(targetKey){const arr=[];while(this.currentKey==targetKey){arr.push(this.currentValue);const it=this.iterator.next();if(it.done)break;this.currentValue=it.value;this.currentKey=this.keyFunc(this.currentValue)}return arr};goog.iter.groupBy=function(iterable,opt_keyFunc){return new goog.iter.GroupByIterator_(iterable,opt_keyFunc)};
goog.iter.starMap=function(iterable,f,opt_obj){const iterator=goog.iter.toIterator(iterable);const iter=new goog.iter.Iterator;iter.next=function(){const it=iterator.next();if(it.done)return goog.iter.ES6_ITERATOR_DONE;const args=goog.iter.toArray(it.value);const value=f.apply(opt_obj,[].concat(args,undefined,iterator));return goog.iter.createEs6IteratorYield(value)};return iter};
goog.iter.tee=function(iterable,opt_num){const iterator=goog.iter.toIterator(iterable);const num=typeof opt_num==="number"?opt_num:2;const buffers=goog.array.map(goog.array.range(num),function(){return[]});function addNextIteratorValueToBuffers(){const {done,value}=iterator.next();if(done)return false;for(let i=0,buffer;buffer=buffers[i++];)buffer.push(value);return true}function createIterator(buffer){const iter=new goog.iter.Iterator;iter.next=function(){if(goog.array.isEmpty(buffer)){const added=
addNextIteratorValueToBuffers();if(!added)return goog.iter.ES6_ITERATOR_DONE}goog.asserts.assert(!goog.array.isEmpty(buffer));return goog.iter.createEs6IteratorYield(buffer.shift())};return iter}return goog.array.map(buffers,createIterator)};goog.iter.enumerate=function(iterable,opt_start){return goog.iter.zip(goog.iter.count(opt_start),iterable)};
goog.iter.limit=function(iterable,limitSize){goog.asserts.assert(goog.math.isInt(limitSize)&&limitSize>=0);const iterator=goog.iter.toIterator(iterable);const iter=new goog.iter.Iterator;let remaining=limitSize;iter.next=function(){if(remaining-- >0)return iterator.next();return goog.iter.ES6_ITERATOR_DONE};return iter};
goog.iter.consume=function(iterable,count){goog.asserts.assert(goog.math.isInt(count)&&count>=0);const iterator=goog.iter.toIterator(iterable);while(count-- >0)goog.iter.nextOrValue(iterator,null);return iterator};goog.iter.slice=function(iterable,start,opt_end){goog.asserts.assert(goog.math.isInt(start)&&start>=0);let iterator=goog.iter.consume(iterable,start);if(typeof opt_end==="number"){goog.asserts.assert(goog.math.isInt(opt_end)&&opt_end>=start);iterator=goog.iter.limit(iterator,opt_end-start)}return iterator};
goog.iter.hasDuplicates_=function(arr){const deduped=[];goog.array.removeDuplicates(arr,deduped);return arr.length!=deduped.length};goog.iter.permutations=function(iterable,opt_length){const elements=goog.iter.toArray(iterable);const length=typeof opt_length==="number"?opt_length:elements.length;const sets=goog.array.repeat(elements,length);const product=goog.iter.product.apply(undefined,sets);return goog.iter.filter(product,function(arr){return!goog.iter.hasDuplicates_(arr)})};
goog.iter.combinations=function(iterable,length){const elements=goog.iter.toArray(iterable);const indexes=goog.iter.range(elements.length);const indexIterator=goog.iter.permutations(indexes,length);const sortedIndexIterator=goog.iter.filter(indexIterator,function(arr){return goog.array.isSorted(arr)});const iter=new goog.iter.Iterator;function getIndexFromElements(index){return elements[index]}iter.next=function(){const {done,value}=sortedIndexIterator.next();if(done)return goog.iter.ES6_ITERATOR_DONE;
return goog.iter.createEs6IteratorYield(goog.array.map(value,getIndexFromElements))};return iter};
goog.iter.combinationsWithReplacement=function(iterable,length){const elements=goog.iter.toArray(iterable);const indexes=goog.array.range(elements.length);const sets=goog.array.repeat(indexes,length);const indexIterator=goog.iter.product.apply(undefined,sets);const sortedIndexIterator=goog.iter.filter(indexIterator,function(arr){return goog.array.isSorted(arr)});const iter=new goog.iter.Iterator;function getIndexFromElements(index){return elements[index]}iter.next=function(){const {done,value}=sortedIndexIterator.next();
if(done)return goog.iter.ES6_ITERATOR_DONE;return goog.iter.createEs6IteratorYield(goog.array.map(value,getIndexFromElements))};return iter};goog.loadModule(function(exports){"use strict";goog.module("goog.iter.es6");goog.module.declareLegacyNamespace();const GoogIterable=goog.require("goog.iter.Iterable");const GoogIterator=goog.require("goog.iter.Iterator");class ShimIterable{__iterator__(){}toGoog(){}toEs6(){}static of(iter){if(iter instanceof ShimIterableImpl||iter instanceof ShimGoogIterator||iter instanceof ShimEs6Iterator)return iter;else if(typeof iter.next=="function")return new ShimIterableImpl(()=>iter);else if(typeof iter[Symbol.iterator]==
"function")return new ShimIterableImpl(()=>iter[Symbol.iterator]());else if(typeof iter.__iterator__=="function")return new ShimIterableImpl(()=>iter.__iterator__());throw new Error("Not an iterator or iterable.");}}class ShimIterableImpl{constructor(func){this.func_=func}__iterator__(){return new ShimGoogIterator(this.func_())}toGoog(){return new ShimGoogIterator(this.func_())}[Symbol.iterator](){return new ShimEs6Iterator(this.func_())}toEs6(){return new ShimEs6Iterator(this.func_())}}class ShimGoogIterator extends GoogIterator{constructor(iter){super();
this.iter_=iter}next(){return this.iter_.next()}toGoog(){return this}[Symbol.iterator](){return new ShimEs6Iterator(this.iter_)}toEs6(){return new ShimEs6Iterator(this.iter_)}}class ShimEs6Iterator extends ShimIterableImpl{constructor(iter){super(()=>iter);this.iter_=iter}next(){return this.iter_.next()}}exports={ShimIterable,ShimEs6Iterator,ShimGoogIterator};return exports});goog.provide("goog.structs.Map");goog.require("goog.collections.iters");goog.require("goog.iter");goog.require("goog.iter.Iterator");goog.require("goog.iter.es6");goog.structs.Map=function(opt_map,var_args){this.map_={};this.keys_=[];this.size=0;this.version_=0;var argLength=arguments.length;if(argLength>1){if(argLength%2)throw new Error("Uneven number of arguments");for(var i=0;i<argLength;i+=2)this.set(arguments[i],arguments[i+1])}else if(opt_map)this.addAll(opt_map)};
goog.structs.Map.prototype.getCount=function(){return this.size};goog.structs.Map.prototype.getValues=function(){this.cleanupKeysArray_();var rv=[];for(var i=0;i<this.keys_.length;i++){var key=this.keys_[i];rv.push(this.map_[key])}return rv};goog.structs.Map.prototype.getKeys=function(){this.cleanupKeysArray_();return this.keys_.concat()};goog.structs.Map.prototype.containsKey=function(key){return this.has(key)};
goog.structs.Map.prototype.has=function(key){return goog.structs.Map.hasKey_(this.map_,key)};goog.structs.Map.prototype.containsValue=function(val){for(var i=0;i<this.keys_.length;i++){var key=this.keys_[i];if(goog.structs.Map.hasKey_(this.map_,key)&&this.map_[key]==val)return true}return false};
goog.structs.Map.prototype.equals=function(otherMap,opt_equalityFn){if(this===otherMap)return true;if(this.size!=otherMap.getCount())return false;var equalityFn=opt_equalityFn||goog.structs.Map.defaultEquals;this.cleanupKeysArray_();for(var key,i=0;key=this.keys_[i];i++)if(!equalityFn(this.get(key),otherMap.get(key)))return false;return true};goog.structs.Map.defaultEquals=function(a,b){return a===b};goog.structs.Map.prototype.isEmpty=function(){return this.size==0};
goog.structs.Map.prototype.clear=function(){this.map_={};this.keys_.length=0;this.setSizeInternal_(0);this.version_=0};goog.structs.Map.prototype.remove=function(key){return this.delete(key)};goog.structs.Map.prototype.delete=function(key){if(goog.structs.Map.hasKey_(this.map_,key)){delete this.map_[key];this.setSizeInternal_(this.size-1);this.version_++;if(this.keys_.length>2*this.size)this.cleanupKeysArray_();return true}return false};
goog.structs.Map.prototype.cleanupKeysArray_=function(){if(this.size!=this.keys_.length){var srcIndex=0;var destIndex=0;while(srcIndex<this.keys_.length){var key=this.keys_[srcIndex];if(goog.structs.Map.hasKey_(this.map_,key))this.keys_[destIndex++]=key;srcIndex++}this.keys_.length=destIndex}if(this.size!=this.keys_.length){var seen={};var srcIndex=0;var destIndex=0;while(srcIndex<this.keys_.length){var key=this.keys_[srcIndex];if(!goog.structs.Map.hasKey_(seen,key)){this.keys_[destIndex++]=key;seen[key]=
1}srcIndex++}this.keys_.length=destIndex}};goog.structs.Map.prototype.get=function(key,opt_val){if(goog.structs.Map.hasKey_(this.map_,key))return this.map_[key];return opt_val};goog.structs.Map.prototype.set=function(key,value){if(!goog.structs.Map.hasKey_(this.map_,key)){this.setSizeInternal_(this.size+1);this.keys_.push(key);this.version_++}this.map_[key]=value};
goog.structs.Map.prototype.addAll=function(map){if(map instanceof goog.structs.Map){var keys=map.getKeys();for(var i=0;i<keys.length;i++)this.set(keys[i],map.get(keys[i]))}else for(var key in map)this.set(key,map[key])};goog.structs.Map.prototype.forEach=function(f,opt_obj){var keys=this.getKeys();for(var i=0;i<keys.length;i++){var key=keys[i];var value=this.get(key);f.call(opt_obj,value,key,this)}};goog.structs.Map.prototype.clone=function(){return new goog.structs.Map(this)};
goog.structs.Map.prototype.transpose=function(){var transposed=new goog.structs.Map;for(var i=0;i<this.keys_.length;i++){var key=this.keys_[i];var value=this.map_[key];transposed.set(value,key)}return transposed};goog.structs.Map.prototype.toObject=function(){this.cleanupKeysArray_();var obj={};for(var i=0;i<this.keys_.length;i++){var key=this.keys_[i];obj[key]=this.map_[key]}return obj};goog.structs.Map.prototype.getKeyIterator=function(){return this.__iterator__(true)};
goog.structs.Map.prototype.keys=function(){return goog.iter.es6.ShimIterable.of(this.getKeyIterator()).toEs6()};goog.structs.Map.prototype.getValueIterator=function(){return this.__iterator__(false)};goog.structs.Map.prototype.values=function(){return goog.iter.es6.ShimIterable.of(this.getValueIterator()).toEs6()};goog.structs.Map.prototype.entries=function(){const self=this;return goog.collections.iters.map(this.keys(),function(key){return[key,self.get(key)]})};
goog.structs.Map.prototype.__iterator__=function(opt_keys){this.cleanupKeysArray_();var i=0;var version=this.version_;var selfObj=this;var newIter=new goog.iter.Iterator;newIter.next=function(){if(version!=selfObj.version_)throw new Error("The map has changed since the iterator was created");if(i>=selfObj.keys_.length)return goog.iter.ES6_ITERATOR_DONE;var key=selfObj.keys_[i++];return goog.iter.createEs6IteratorYield(opt_keys?key:selfObj.map_[key])};return newIter};
goog.structs.Map.prototype.setSizeInternal_=function(newSize){this.size=newSize};goog.structs.Map.hasKey_=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)};goog.provide("goog.structs.Set");goog.require("goog.structs");goog.require("goog.structs.Collection");goog.require("goog.structs.Map");goog.requireType("goog.iter.Iterator");goog.structs.Set=function(opt_values){this.map_=new goog.structs.Map;this.size=0;if(opt_values)this.addAll(opt_values)};goog.structs.Set.getUid_=goog.getUid;goog.structs.Set.getKey_=function(val){var type=typeof val;if(type=="object"&&val||type=="function")return"o"+goog.structs.Set.getUid_(val);else return type.slice(0,1)+val};
goog.structs.Set.prototype.getCount=function(){return this.map_.size};goog.structs.Set.prototype.add=function(element){this.map_.set(goog.structs.Set.getKey_(element),element);this.setSizeInternal_(this.map_.size)};goog.structs.Set.prototype.addAll=function(col){var values=goog.structs.getValues(col);var l=values.length;for(var i=0;i<l;i++)this.add(values[i]);this.setSizeInternal_(this.map_.size)};
goog.structs.Set.prototype.removeAll=function(col){var values=goog.structs.getValues(col);var l=values.length;for(var i=0;i<l;i++)this.remove(values[i]);this.setSizeInternal_(this.map_.size)};goog.structs.Set.prototype.delete=function(element){const rv=this.map_.remove(goog.structs.Set.getKey_(element));this.setSizeInternal_(this.map_.size);return rv};goog.structs.Set.prototype.remove=function(element){return this.delete(element)};goog.structs.Set.prototype.clear=function(){this.map_.clear();this.setSizeInternal_(0)};
goog.structs.Set.prototype.isEmpty=function(){return this.map_.size===0};goog.structs.Set.prototype.has=function(element){return this.map_.containsKey(goog.structs.Set.getKey_(element))};goog.structs.Set.prototype.contains=function(element){return this.map_.containsKey(goog.structs.Set.getKey_(element))};goog.structs.Set.prototype.containsAll=function(col){return goog.structs.every(col,this.contains,this)};
goog.structs.Set.prototype.intersection=function(col){var result=new goog.structs.Set;var values=goog.structs.getValues(col);for(var i=0;i<values.length;i++){var value=values[i];if(this.contains(value))result.add(value)}return result};goog.structs.Set.prototype.difference=function(col){var result=this.clone();result.removeAll(col);return result};goog.structs.Set.prototype.getValues=function(){return this.map_.getValues()};goog.structs.Set.prototype.values=function(){return this.map_.values()};
goog.structs.Set.prototype.clone=function(){return new goog.structs.Set(this)};goog.structs.Set.prototype.equals=function(col){return this.getCount()==goog.structs.getCount(col)&&this.isSubsetOf(col)};goog.structs.Set.prototype.isSubsetOf=function(col){var colCount=goog.structs.getCount(col);if(this.getCount()>colCount)return false;if(!(col instanceof goog.structs.Set)&&colCount>5)col=new goog.structs.Set(col);return goog.structs.every(this,function(value){return goog.structs.contains(col,value)})};
goog.structs.Set.prototype.__iterator__=function(opt_keys){return this.map_.__iterator__(false)};goog.structs.Set.prototype[Symbol.iterator]=function(){return this.values()};goog.structs.Set.prototype.setSizeInternal_=function(newSize){this.size=newSize};goog.provide("goog.events.EventHandler");goog.require("goog.Disposable");goog.require("goog.events");goog.require("goog.object");goog.requireType("goog.events.Event");goog.requireType("goog.events.EventId");goog.requireType("goog.events.EventTarget");goog.requireType("goog.events.EventWrapper");goog.events.EventHandler=function(opt_scope){goog.Disposable.call(this);this.handler_=opt_scope;this.keys_={}};goog.inherits(goog.events.EventHandler,goog.Disposable);goog.events.EventHandler.typeArray_=[];
goog.events.EventHandler.prototype.listen=function(src,type,opt_fn,opt_options){var self=this;return self.listen_(src,type,opt_fn,opt_options)};goog.events.EventHandler.prototype.listenWithScope=function(src,type,fn,options,scope){var self=this;return self.listen_(src,type,fn,options,scope)};
goog.events.EventHandler.prototype.listen_=function(src,type,opt_fn,opt_options,opt_scope){var self=this;if(!Array.isArray(type)){if(type)goog.events.EventHandler.typeArray_[0]=type.toString();type=goog.events.EventHandler.typeArray_}for(var i=0;i<type.length;i++){var listenerObj=goog.events.listen(src,type[i],opt_fn||self.handleEvent,opt_options||false,opt_scope||self.handler_||self);if(!listenerObj)return self;var key=listenerObj.key;self.keys_[key]=listenerObj}return self};
goog.events.EventHandler.prototype.listenOnce=function(src,type,opt_fn,opt_options){var self=this;return self.listenOnce_(src,type,opt_fn,opt_options)};goog.events.EventHandler.prototype.listenOnceWithScope=function(src,type,fn,capture,scope){var self=this;return self.listenOnce_(src,type,fn,capture,scope)};
goog.events.EventHandler.prototype.listenOnce_=function(src,type,opt_fn,opt_options,opt_scope){var self=this;if(Array.isArray(type))for(var i=0;i<type.length;i++)self.listenOnce_(src,type[i],opt_fn,opt_options,opt_scope);else{var listenerObj=goog.events.listenOnce(src,type,opt_fn||self.handleEvent,opt_options,opt_scope||self.handler_||self);if(!listenerObj)return self;var key=listenerObj.key;self.keys_[key]=listenerObj}return self};
goog.events.EventHandler.prototype.listenWithWrapper=function(src,wrapper,listener,opt_capt){var self=this;return self.listenWithWrapper_(src,wrapper,listener,opt_capt)};goog.events.EventHandler.prototype.listenWithWrapperAndScope=function(src,wrapper,listener,capture,scope){var self=this;return self.listenWithWrapper_(src,wrapper,listener,capture,scope)};
goog.events.EventHandler.prototype.listenWithWrapper_=function(src,wrapper,listener,opt_capt,opt_scope){var self=this;wrapper.listen(src,listener,opt_capt,opt_scope||self.handler_||self,self);return self};goog.events.EventHandler.prototype.getListenerCount=function(){var count=0;for(var key in this.keys_)if(Object.prototype.hasOwnProperty.call(this.keys_,key))count++;return count};
goog.events.EventHandler.prototype.unlisten=function(src,type,opt_fn,opt_options,opt_scope){var self=this;if(Array.isArray(type))for(var i=0;i<type.length;i++)self.unlisten(src,type[i],opt_fn,opt_options,opt_scope);else{var capture=goog.isObject(opt_options)?!!opt_options.capture:!!opt_options;var listener=goog.events.getListener(src,type,opt_fn||self.handleEvent,capture,opt_scope||self.handler_||self);if(listener){goog.events.unlistenByKey(listener);delete self.keys_[listener.key]}}return self};
goog.events.EventHandler.prototype.unlistenWithWrapper=function(src,wrapper,listener,opt_capt,opt_scope){var self=this;wrapper.unlisten(src,listener,opt_capt,opt_scope||self.handler_||self,self);return self};goog.events.EventHandler.prototype.removeAll=function(){goog.object.forEach(this.keys_,function(listenerObj,key){if(this.keys_.hasOwnProperty(key))goog.events.unlistenByKey(listenerObj)},this);this.keys_={}};
goog.events.EventHandler.prototype.disposeInternal=function(){goog.events.EventHandler.superClass_.disposeInternal.call(this);this.removeAll()};goog.events.EventHandler.prototype.handleEvent=function(e){throw new Error("EventHandler.handleEvent not implemented");};goog.provide("goog.events.KeyCodes");goog.require("goog.userAgent");goog.requireType("goog.events.BrowserEvent");
goog.events.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,FF_HASH:163,FF_JP_QUOTE:58,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,
K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,
COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255};
goog.events.KeyCodes.isTextModifyingKeyEvent=function(e){if(e.altKey&&!e.ctrlKey||e.metaKey||e.keyCode>=goog.events.KeyCodes.F1&&e.keyCode<=goog.events.KeyCodes.F12)return false;if(goog.events.KeyCodes.isCharacterKey(e.keyCode))return true;switch(e.keyCode){case goog.events.KeyCodes.ALT:case goog.events.KeyCodes.CAPS_LOCK:case goog.events.KeyCodes.CONTEXT_MENU:case goog.events.KeyCodes.CTRL:case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.END:case goog.events.KeyCodes.ESC:case goog.events.KeyCodes.HOME:case goog.events.KeyCodes.INSERT:case goog.events.KeyCodes.LEFT:case goog.events.KeyCodes.MAC_FF_META:case goog.events.KeyCodes.META:case goog.events.KeyCodes.NUMLOCK:case goog.events.KeyCodes.NUM_CENTER:case goog.events.KeyCodes.PAGE_DOWN:case goog.events.KeyCodes.PAGE_UP:case goog.events.KeyCodes.PAUSE:case goog.events.KeyCodes.PHANTOM:case goog.events.KeyCodes.PRINT_SCREEN:case goog.events.KeyCodes.RIGHT:case goog.events.KeyCodes.SCROLL_LOCK:case goog.events.KeyCodes.SHIFT:case goog.events.KeyCodes.UP:case goog.events.KeyCodes.VK_NONAME:case goog.events.KeyCodes.WIN_KEY:case goog.events.KeyCodes.WIN_KEY_RIGHT:return false;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return!goog.userAgent.GECKO;
default:return e.keyCode<goog.events.KeyCodes.FIRST_MEDIA_KEY||e.keyCode>goog.events.KeyCodes.LAST_MEDIA_KEY}};
goog.events.KeyCodes.firesKeyPressEvent=function(keyCode,opt_heldKeyCode,opt_shiftKey,opt_ctrlKey,opt_altKey,opt_metaKey){if(goog.userAgent.MAC&&opt_altKey)return goog.events.KeyCodes.isCharacterKey(keyCode);if(opt_altKey&&!opt_ctrlKey)return false;if(!goog.userAgent.GECKO){if(typeof opt_heldKeyCode==="number")opt_heldKeyCode=goog.events.KeyCodes.normalizeKeyCode(opt_heldKeyCode);var heldKeyIsModifier=opt_heldKeyCode==goog.events.KeyCodes.CTRL||opt_heldKeyCode==goog.events.KeyCodes.ALT||goog.userAgent.MAC&&
opt_heldKeyCode==goog.events.KeyCodes.META;var modifiedShiftKey=opt_heldKeyCode==goog.events.KeyCodes.SHIFT&&(opt_ctrlKey||opt_metaKey);if((!opt_shiftKey||goog.userAgent.MAC)&&heldKeyIsModifier||goog.userAgent.MAC&&modifiedShiftKey)return false}if((goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&opt_ctrlKey&&opt_shiftKey)switch(keyCode){case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:case goog.events.KeyCodes.TILDE:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:return false}if(goog.userAgent.IE&&
opt_ctrlKey&&opt_heldKeyCode==keyCode)return false;switch(keyCode){case goog.events.KeyCodes.ENTER:if(goog.userAgent.GECKO){if(opt_metaKey||opt_altKey)return false;return!(opt_shiftKey&&opt_ctrlKey)}else return true;case goog.events.KeyCodes.ESC:return!(goog.userAgent.WEBKIT||goog.userAgent.EDGE||goog.userAgent.GECKO)}if(goog.userAgent.GECKO&&(opt_ctrlKey||opt_altKey||opt_metaKey))return false;else return goog.events.KeyCodes.isCharacterKey(keyCode)};
goog.events.KeyCodes.isCharacterKey=function(keyCode){if(keyCode>=goog.events.KeyCodes.ZERO&&keyCode<=goog.events.KeyCodes.NINE)return true;if(keyCode>=goog.events.KeyCodes.NUM_ZERO&&keyCode<=goog.events.KeyCodes.NUM_MULTIPLY)return true;if(keyCode>=goog.events.KeyCodes.A&&keyCode<=goog.events.KeyCodes.Z)return true;if((goog.userAgent.WEBKIT||goog.userAgent.EDGE)&&keyCode==0)return true;switch(keyCode){case goog.events.KeyCodes.SPACE:case goog.events.KeyCodes.PLUS_SIGN:case goog.events.KeyCodes.QUESTION_MARK:case goog.events.KeyCodes.AT_SIGN:case goog.events.KeyCodes.NUM_PLUS:case goog.events.KeyCodes.NUM_MINUS:case goog.events.KeyCodes.NUM_PERIOD:case goog.events.KeyCodes.NUM_DIVISION:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.FF_SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.FF_EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:case goog.events.KeyCodes.FF_HASH:case goog.events.KeyCodes.FF_JP_QUOTE:return true;
case goog.events.KeyCodes.FF_DASH:return goog.userAgent.GECKO;default:return false}};goog.events.KeyCodes.normalizeKeyCode=function(keyCode){if(goog.userAgent.GECKO)return goog.events.KeyCodes.normalizeGeckoKeyCode(keyCode);else if(goog.userAgent.MAC&&goog.userAgent.WEBKIT)return goog.events.KeyCodes.normalizeMacWebKitKeyCode(keyCode);else return keyCode};
goog.events.KeyCodes.normalizeGeckoKeyCode=function(keyCode){switch(keyCode){case goog.events.KeyCodes.FF_EQUALS:return goog.events.KeyCodes.EQUALS;case goog.events.KeyCodes.FF_SEMICOLON:return goog.events.KeyCodes.SEMICOLON;case goog.events.KeyCodes.FF_DASH:return goog.events.KeyCodes.DASH;case goog.events.KeyCodes.MAC_FF_META:return goog.events.KeyCodes.META;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return goog.events.KeyCodes.WIN_KEY;default:return keyCode}};
goog.events.KeyCodes.normalizeMacWebKitKeyCode=function(keyCode){switch(keyCode){case goog.events.KeyCodes.MAC_WK_CMD_RIGHT:return goog.events.KeyCodes.META;default:return keyCode}};goog.provide("goog.fx.Transition");goog.provide("goog.fx.Transition.EventType");goog.fx.Transition=function(){};goog.fx.Transition.EventType={PLAY:"play",BEGIN:"begin",RESUME:"resume",END:"end",STOP:"stop",FINISH:"finish",PAUSE:"pause"};goog.fx.Transition.prototype.play;goog.fx.Transition.prototype.stop;goog.provide("goog.ui.PopupBase");goog.provide("goog.ui.PopupBase.EventType");goog.provide("goog.ui.PopupBase.Type");goog.require("goog.Timer");goog.require("goog.array");goog.require("goog.dispose");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.events");goog.require("goog.events.EventHandler");goog.require("goog.events.EventTarget");goog.require("goog.events.EventType");goog.require("goog.events.KeyCodes");goog.require("goog.fx.Transition");goog.require("goog.style");
goog.require("goog.userAgent");goog.requireType("goog.events.BrowserEvent");goog.ui.PopupBase=function(opt_element,opt_type){goog.events.EventTarget.call(this);this.handler_=new goog.events.EventHandler(this);this.setElement(opt_element||null);if(opt_type)this.setType(opt_type)};goog.inherits(goog.ui.PopupBase,goog.events.EventTarget);goog.ui.PopupBase.Type={TOGGLE_DISPLAY:"toggle_display",MOVE_OFFSCREEN:"move_offscreen"};goog.ui.PopupBase.prototype.element_=null;
goog.ui.PopupBase.prototype.autoHide_=true;goog.ui.PopupBase.prototype.autoHidePartners_=null;goog.ui.PopupBase.prototype.autoHideRegion_=null;goog.ui.PopupBase.prototype.isVisible_=false;goog.ui.PopupBase.prototype.shouldHideAsync_=false;goog.ui.PopupBase.prototype.lastShowTime_=-1;goog.ui.PopupBase.prototype.lastHideTime_=-1;goog.ui.PopupBase.prototype.hideOnEscape_=false;goog.ui.PopupBase.prototype.enableCrossIframeDismissal_=true;goog.ui.PopupBase.prototype.type_=goog.ui.PopupBase.Type.TOGGLE_DISPLAY;
goog.ui.PopupBase.prototype.showTransition_;goog.ui.PopupBase.prototype.hideTransition_;goog.ui.PopupBase.EventType={BEFORE_SHOW:"beforeshow",SHOW:"show",BEFORE_HIDE:"beforehide",HIDE:"hide"};goog.ui.PopupBase.DEBOUNCE_DELAY_MS=150;goog.ui.PopupBase.prototype.getType=function(){return this.type_};goog.ui.PopupBase.prototype.setType=function(type){this.type_=type};goog.ui.PopupBase.prototype.shouldHideAsync=function(){return this.shouldHideAsync_};
goog.ui.PopupBase.prototype.setShouldHideAsync=function(b){this.shouldHideAsync_=b};goog.ui.PopupBase.prototype.getElement=function(){return this.element_};goog.ui.PopupBase.prototype.setElement=function(elt){this.ensureNotVisible_();this.element_=elt};goog.ui.PopupBase.prototype.getAutoHide=function(){return this.autoHide_};goog.ui.PopupBase.prototype.setAutoHide=function(autoHide){this.ensureNotVisible_();this.autoHide_=autoHide};
goog.ui.PopupBase.prototype.addAutoHidePartner=function(partner){if(!this.autoHidePartners_)this.autoHidePartners_=[];goog.array.insert(this.autoHidePartners_,partner)};goog.ui.PopupBase.prototype.removeAutoHidePartner=function(partner){if(this.autoHidePartners_)goog.array.remove(this.autoHidePartners_,partner)};goog.ui.PopupBase.prototype.getHideOnEscape=function(){return this.hideOnEscape_};
goog.ui.PopupBase.prototype.setHideOnEscape=function(hideOnEscape){this.ensureNotVisible_();this.hideOnEscape_=hideOnEscape};goog.ui.PopupBase.prototype.getEnableCrossIframeDismissal=function(){return this.enableCrossIframeDismissal_};goog.ui.PopupBase.prototype.setEnableCrossIframeDismissal=function(enable){this.enableCrossIframeDismissal_=enable};goog.ui.PopupBase.prototype.getAutoHideRegion=function(){return this.autoHideRegion_};
goog.ui.PopupBase.prototype.setAutoHideRegion=function(element){this.autoHideRegion_=element};goog.ui.PopupBase.prototype.setTransition=function(opt_showTransition,opt_hideTransition){this.showTransition_=opt_showTransition;this.hideTransition_=opt_hideTransition};goog.ui.PopupBase.prototype.getLastShowTime=function(){return this.lastShowTime_};goog.ui.PopupBase.prototype.getLastHideTime=function(){return this.lastHideTime_};goog.ui.PopupBase.prototype.getHandler=function(){var self=this;return self.handler_};
goog.ui.PopupBase.prototype.ensureNotVisible_=function(){if(this.isVisible_)throw new Error("Can not change this state of the popup while showing.");};goog.ui.PopupBase.prototype.isVisible=function(){return this.isVisible_};goog.ui.PopupBase.prototype.isOrWasRecentlyVisible=function(){return this.isVisible_||Date.now()-this.lastHideTime_<goog.ui.PopupBase.DEBOUNCE_DELAY_MS};
goog.ui.PopupBase.prototype.setVisible=function(visible){if(this.showTransition_)this.showTransition_.stop();if(this.hideTransition_)this.hideTransition_.stop();if(visible)this.show_();else this.hide_()};goog.ui.PopupBase.prototype.reposition=function(){};
goog.ui.PopupBase.prototype.show_=function(){if(this.isVisible_)return;if(!this.onBeforeShow())return;if(!this.element_)throw new Error("Caller must call setElement before trying to show the popup");this.reposition();var doc=goog.dom.getOwnerDocument(this.element_);if(this.hideOnEscape_)this.handler_.listen(doc,goog.events.EventType.KEYDOWN,this.onDocumentKeyDown_,true);if(this.autoHide_){this.handler_.listen(doc,goog.events.EventType.MOUSEDOWN,this.onDocumentMouseDown_,true);if(goog.userAgent.IE){var activeElement;
try{activeElement=doc.activeElement}catch(e){}while(activeElement&&activeElement.nodeName==goog.dom.TagName.IFRAME){try{var tempDoc=goog.dom.getFrameContentDocument(activeElement)}catch(e){break}doc=tempDoc;activeElement=doc.activeElement}this.handler_.listen(doc,goog.events.EventType.MOUSEDOWN,this.onDocumentMouseDown_,true);this.handler_.listen(doc,goog.events.EventType.DEACTIVATE,this.onDocumentBlur_)}else this.handler_.listen(doc,goog.events.EventType.BLUR,this.onDocumentBlur_)}if(this.type_==
goog.ui.PopupBase.Type.TOGGLE_DISPLAY)this.showPopupElement();else if(this.type_==goog.ui.PopupBase.Type.MOVE_OFFSCREEN)this.reposition();this.isVisible_=true;this.lastShowTime_=Date.now();this.lastHideTime_=-1;if(this.showTransition_){goog.events.listenOnce(this.showTransition_,goog.fx.Transition.EventType.END,this.onShow,false,this);this.showTransition_.play()}else this.onShow()};
goog.ui.PopupBase.prototype.hide_=function(opt_target){if(!this.isVisible_||!this.onBeforeHide(opt_target))return false;if(this.handler_)this.handler_.removeAll();this.isVisible_=false;this.lastHideTime_=Date.now();if(this.hideTransition_){goog.events.listenOnce(this.hideTransition_,goog.fx.Transition.EventType.END,goog.partial(this.continueHidingPopup_,opt_target),false,this);this.hideTransition_.play()}else this.continueHidingPopup_(opt_target);return true};
goog.ui.PopupBase.prototype.continueHidingPopup_=function(opt_target){if(this.type_==goog.ui.PopupBase.Type.TOGGLE_DISPLAY)if(this.shouldHideAsync_)goog.Timer.callOnce(this.hidePopupElement,0,this);else this.hidePopupElement();else if(this.type_==goog.ui.PopupBase.Type.MOVE_OFFSCREEN)this.moveOffscreen_();this.onHide(opt_target)};goog.ui.PopupBase.prototype.showPopupElement=function(){this.element_.style.visibility="visible";goog.style.setElementShown(this.element_,true)};
goog.ui.PopupBase.prototype.hidePopupElement=function(){this.element_.style.visibility="hidden";goog.style.setElementShown(this.element_,false)};goog.ui.PopupBase.prototype.moveOffscreen_=function(){this.element_.style.top="-10000px"};goog.ui.PopupBase.prototype.onBeforeShow=function(){return this.dispatchEvent(goog.ui.PopupBase.EventType.BEFORE_SHOW)};goog.ui.PopupBase.prototype.onShow=function(){this.dispatchEvent(goog.ui.PopupBase.EventType.SHOW)};
goog.ui.PopupBase.prototype.onBeforeHide=function(opt_target){return this.dispatchEvent({type:goog.ui.PopupBase.EventType.BEFORE_HIDE,target:opt_target})};goog.ui.PopupBase.prototype.onHide=function(opt_target){this.dispatchEvent({type:goog.ui.PopupBase.EventType.HIDE,target:opt_target})};goog.ui.PopupBase.prototype.onDocumentMouseDown_=function(e){var target=e.target;if(!goog.dom.contains(this.element_,target)&&!this.isOrWithinAutoHidePartner_(target)&&this.isWithinAutoHideRegion_(target)&&!this.shouldDebounce_())this.hide_(target)};
goog.ui.PopupBase.prototype.onDocumentKeyDown_=function(e){if(e.keyCode==goog.events.KeyCodes.ESC)if(this.hide_(e.target)){e.preventDefault();e.stopPropagation()}};
goog.ui.PopupBase.prototype.onDocumentBlur_=function(e){if(!this.enableCrossIframeDismissal_)return;var doc=goog.dom.getOwnerDocument(this.element_);if(typeof document.activeElement!="undefined"){var activeElement=doc.activeElement;if(!activeElement||goog.dom.contains(this.element_,activeElement)||activeElement.tagName==goog.dom.TagName.BODY)return;if(this.isOrWithinAutoHidePartner_(activeElement))return}else if(e.target!=doc)return;if(this.shouldDebounce_())return;this.hide_()};
goog.ui.PopupBase.prototype.isOrWithinAutoHidePartner_=function(element){return goog.array.some(this.autoHidePartners_||[],function(partner){return element===partner||goog.dom.contains(partner,element)})};goog.ui.PopupBase.prototype.isWithinAutoHideRegion_=function(element){return this.autoHideRegion_?goog.dom.contains(this.autoHideRegion_,element):true};goog.ui.PopupBase.prototype.shouldDebounce_=function(){return Date.now()-this.lastShowTime_<goog.ui.PopupBase.DEBOUNCE_DELAY_MS};
goog.ui.PopupBase.prototype.disposeInternal=function(){goog.ui.PopupBase.base(this,"disposeInternal");this.handler_.dispose();goog.dispose(this.showTransition_);goog.dispose(this.hideTransition_);delete this.element_;delete this.handler_;delete this.autoHidePartners_};goog.provide("goog.ui.Popup");goog.require("goog.math.Box");goog.require("goog.positioning.AbstractPosition");goog.require("goog.positioning.Corner");goog.require("goog.style");goog.require("goog.ui.PopupBase");goog.ui.Popup=function(opt_element,opt_position){this.popupCorner_=goog.positioning.Corner.TOP_START;this.position_=opt_position||undefined;goog.ui.PopupBase.call(this,opt_element)};goog.inherits(goog.ui.Popup,goog.ui.PopupBase);goog.ui.Popup.prototype.margin_;
goog.ui.Popup.prototype.getPinnedCorner=function(){return this.popupCorner_};goog.ui.Popup.prototype.setPinnedCorner=function(corner){this.popupCorner_=corner;if(this.isVisible())this.reposition()};goog.ui.Popup.prototype.getPosition=function(){return this.position_||null};goog.ui.Popup.prototype.setPosition=function(position){this.position_=position||undefined;if(this.isVisible())this.reposition()};goog.ui.Popup.prototype.getMargin=function(){return this.margin_||null};
goog.ui.Popup.prototype.setMargin=function(arg1,opt_arg2,opt_arg3,opt_arg4){if(arg1==null||arg1 instanceof goog.math.Box)this.margin_=arg1;else this.margin_=new goog.math.Box(arg1,opt_arg2,opt_arg3,opt_arg4);if(this.isVisible())this.reposition()};
goog.ui.Popup.prototype.reposition=function(){if(!this.position_)return;var hideForPositioning=!this.isVisible()&&this.getType()!=goog.ui.PopupBase.Type.MOVE_OFFSCREEN;var el=this.getElement();if(hideForPositioning){el.style.visibility="hidden";goog.style.setElementShown(el,true)}this.position_.reposition(el,this.popupCorner_,this.margin_);if(hideForPositioning)goog.style.setElementShown(el,false)};goog.provide("goog.ui.Tooltip");goog.provide("goog.ui.Tooltip.CursorTooltipPosition");goog.provide("goog.ui.Tooltip.ElementTooltipPosition");goog.provide("goog.ui.Tooltip.State");goog.require("goog.Timer");goog.require("goog.array");goog.require("goog.asserts");goog.require("goog.dispose");goog.require("goog.dom");goog.require("goog.dom.TagName");goog.require("goog.dom.safe");goog.require("goog.events");goog.require("goog.events.EventType");goog.require("goog.events.FocusHandler");goog.require("goog.math.Box");
goog.require("goog.math.Coordinate");goog.require("goog.positioning");goog.require("goog.positioning.AnchoredPosition");goog.require("goog.positioning.Corner");goog.require("goog.positioning.Overflow");goog.require("goog.positioning.OverflowStatus");goog.require("goog.positioning.ViewportPosition");goog.require("goog.structs.Set");goog.require("goog.style");goog.require("goog.ui.Popup");goog.require("goog.ui.PopupBase");goog.requireType("goog.events.BrowserEvent");goog.requireType("goog.html.SafeHtml");
goog.requireType("goog.positioning.AbstractPosition");goog.ui.Tooltip=function(opt_el,opt_str,opt_domHelper){this.dom_=opt_domHelper||(opt_el?goog.dom.getDomHelper(goog.dom.getElement(opt_el)):goog.dom.getDomHelper());goog.ui.Popup.call(this,this.dom_.createDom(goog.dom.TagName.DIV,{"style":"position:absolute;display:none;"}));this.cursorPosition=new goog.math.Coordinate(1,1);this.elements_=new goog.structs.Set;this.tooltipFocusHandler_=null;if(opt_el)this.attach(opt_el);if(opt_str!=null)this.setText(opt_str)};
goog.inherits(goog.ui.Tooltip,goog.ui.Popup);goog.ui.Tooltip.activeInstances_=[];goog.ui.Tooltip.prototype.activeEl_=null;goog.ui.Tooltip.prototype.className=goog.getCssName("goog-tooltip");goog.ui.Tooltip.prototype.showDelayMs_=500;goog.ui.Tooltip.prototype.showTimer;goog.ui.Tooltip.prototype.hideDelayMs_=0;goog.ui.Tooltip.prototype.hideTimer;goog.ui.Tooltip.prototype.anchor;goog.ui.Tooltip.State={INACTIVE:0,WAITING_TO_SHOW:1,SHOWING:2,WAITING_TO_HIDE:3,UPDATING:4};
goog.ui.Tooltip.Activation={CURSOR:0,FOCUS:1};goog.ui.Tooltip.prototype.seenInteraction_;goog.ui.Tooltip.prototype.requireInteraction_;goog.ui.Tooltip.prototype.childTooltip_;goog.ui.Tooltip.prototype.parentTooltip_;goog.ui.Tooltip.prototype.getDomHelper=function(){return this.dom_};goog.ui.Tooltip.prototype.getChildTooltip=function(){return this.childTooltip_};
goog.ui.Tooltip.prototype.attach=function(el){el=goog.dom.getElement(el);this.elements_.add(el);goog.events.listen(el,goog.events.EventType.MOUSEOVER,this.handleMouseOver,false,this);goog.events.listen(el,goog.events.EventType.MOUSEOUT,this.handleMouseOutAndBlur,false,this);goog.events.listen(el,goog.events.EventType.MOUSEMOVE,this.handleMouseMove,false,this);goog.events.listen(el,goog.events.EventType.FOCUS,this.handleFocus,false,this);goog.events.listen(el,goog.events.EventType.BLUR,this.handleMouseOutAndBlur,
false,this)};goog.ui.Tooltip.prototype.detach=function(opt_el){if(opt_el){var el=goog.dom.getElement(opt_el);this.detachElement_(el);this.elements_.remove(el)}else{var a=this.elements_.getValues();for(var el,i=0;el=a[i];i++)this.detachElement_(el);this.elements_.clear()}};
goog.ui.Tooltip.prototype.detachElement_=function(el){goog.events.unlisten(el,goog.events.EventType.MOUSEOVER,this.handleMouseOver,false,this);goog.events.unlisten(el,goog.events.EventType.MOUSEOUT,this.handleMouseOutAndBlur,false,this);goog.events.unlisten(el,goog.events.EventType.MOUSEMOVE,this.handleMouseMove,false,this);goog.events.unlisten(el,goog.events.EventType.FOCUS,this.handleFocus,false,this);goog.events.unlisten(el,goog.events.EventType.BLUR,this.handleMouseOutAndBlur,false,this)};
goog.ui.Tooltip.prototype.setShowDelayMs=function(delay){this.showDelayMs_=delay};goog.ui.Tooltip.prototype.getShowDelayMs=function(){return this.showDelayMs_};goog.ui.Tooltip.prototype.setHideDelayMs=function(delay){this.hideDelayMs_=delay};goog.ui.Tooltip.prototype.getHideDelayMs=function(){return this.hideDelayMs_};goog.ui.Tooltip.prototype.setText=function(str){goog.dom.setTextContent(this.getElement(),str)};
goog.ui.Tooltip.prototype.setSafeHtml=function(html){var element=this.getElement();if(element)goog.dom.safe.setInnerHtml(element,html)};
goog.ui.Tooltip.prototype.setElement=function(el){var oldElement=this.getElement();if(oldElement)goog.dom.removeNode(oldElement);goog.ui.Tooltip.superClass_.setElement.call(this,el);if(el){var body=this.dom_.getDocument().body;body.insertBefore(el,body.lastChild);this.registerContentFocusEvents_()}else{goog.dispose(this.tooltipFocusHandler_);this.tooltipFocusHandler_=null}};
goog.ui.Tooltip.prototype.registerContentFocusEvents_=function(){goog.dispose(this.tooltipFocusHandler_);this.tooltipFocusHandler_=new goog.events.FocusHandler(goog.asserts.assert(this.getElement()));this.registerDisposable(this.tooltipFocusHandler_);goog.events.listen(this.tooltipFocusHandler_,goog.events.FocusHandler.EventType.FOCUSIN,this.clearHideTimer,undefined,this);goog.events.listen(this.tooltipFocusHandler_,goog.events.FocusHandler.EventType.FOCUSOUT,this.startHideTimer,undefined,this)};
goog.ui.Tooltip.prototype.getText=function(){return goog.dom.getTextContent(this.getElement())};goog.ui.Tooltip.prototype.getHtml=function(){return this.getElement().innerHTML};goog.ui.Tooltip.prototype.getState=function(){return this.showTimer?this.isVisible()?goog.ui.Tooltip.State.UPDATING:goog.ui.Tooltip.State.WAITING_TO_SHOW:this.hideTimer?goog.ui.Tooltip.State.WAITING_TO_HIDE:this.isVisible()?goog.ui.Tooltip.State.SHOWING:goog.ui.Tooltip.State.INACTIVE};
goog.ui.Tooltip.prototype.setRequireInteraction=function(requireInteraction){this.requireInteraction_=requireInteraction};goog.ui.Tooltip.prototype.isCoordinateInTooltip=function(coord){if(!this.isVisible())return false;var offset=goog.style.getPageOffset(this.getElement());var size=goog.style.getSize(this.getElement());return offset.x<=coord.x&&coord.x<=offset.x+size.width&&offset.y<=coord.y&&coord.y<=offset.y+size.height};
goog.ui.Tooltip.prototype.onBeforeShow=function(){if(!goog.ui.PopupBase.prototype.onBeforeShow.call(this))return false;if(this.anchor)for(var tt,i=0;tt=goog.ui.Tooltip.activeInstances_[i];i++)if(!goog.dom.contains(tt.getElement(),this.anchor))tt.setVisible(false);goog.array.insert(goog.ui.Tooltip.activeInstances_,this);var element=this.getElement();element.className=this.className;this.clearHideTimer();goog.events.listen(element,goog.events.EventType.MOUSEOVER,this.handleTooltipMouseOver,false,this);
goog.events.listen(element,goog.events.EventType.MOUSEOUT,this.handleTooltipMouseOut,false,this);this.clearShowTimer();return true};
goog.ui.Tooltip.prototype.onHide=function(){goog.array.remove(goog.ui.Tooltip.activeInstances_,this);var element=this.getElement();for(var tt,i=0;tt=goog.ui.Tooltip.activeInstances_[i];i++)if(tt.anchor&&goog.dom.contains(element,tt.anchor))tt.setVisible(false);if(this.parentTooltip_)this.parentTooltip_.startHideTimer();goog.events.unlisten(element,goog.events.EventType.MOUSEOVER,this.handleTooltipMouseOver,false,this);goog.events.unlisten(element,goog.events.EventType.MOUSEOUT,this.handleTooltipMouseOut,
false,this);this.anchor=undefined;if(this.getState()==goog.ui.Tooltip.State.INACTIVE)this.seenInteraction_=false;goog.ui.PopupBase.prototype.onHide.call(this)};goog.ui.Tooltip.prototype.maybeShow=function(el,opt_pos){if(this.anchor==el&&this.elements_.contains(this.anchor))if(this.seenInteraction_||!this.requireInteraction_){this.setVisible(false);if(!this.isVisible())this.positionAndShow_(el,opt_pos)}else this.anchor=undefined;this.showTimer=undefined};goog.ui.Tooltip.prototype.getElements=function(){return this.elements_};
goog.ui.Tooltip.prototype.getActiveElement=function(){return this.activeEl_};goog.ui.Tooltip.prototype.setActiveElement=function(activeEl){this.activeEl_=activeEl};goog.ui.Tooltip.prototype.showForElement=function(el,opt_pos){this.attach(el);this.activeEl_=el;this.positionAndShow_(el,opt_pos)};goog.ui.Tooltip.prototype.positionAndShow_=function(el,opt_pos){this.anchor=el;this.setPosition(opt_pos||this.getPositioningStrategy(goog.ui.Tooltip.Activation.CURSOR));this.setVisible(true)};
goog.ui.Tooltip.prototype.maybeHide=function(el){this.hideTimer=undefined;if(el==this.anchor){var dom=this.getDomHelper();var focusedEl=dom.getActiveElement();var tooltipContentFocused=focusedEl&&this.getElement()&&dom.contains(this.getElement(),focusedEl);if((this.activeEl_==null||this.activeEl_!=this.getElement()&&!this.elements_.contains(this.activeEl_))&&!tooltipContentFocused&&!this.hasActiveChild())this.setVisible(false)}};
goog.ui.Tooltip.prototype.hasActiveChild=function(){return!!(this.childTooltip_&&this.childTooltip_.activeEl_)};goog.ui.Tooltip.prototype.saveCursorPosition_=function(event){var scroll=this.dom_.getDocumentScroll();this.cursorPosition.x=event.clientX+scroll.x;this.cursorPosition.y=event.clientY+scroll.y};
goog.ui.Tooltip.prototype.handleMouseOver=function(event){var el=this.getAnchorFromElement(event.target);this.activeEl_=el;this.clearHideTimer();if(el!=this.anchor){this.anchor=el;this.startShowTimer(el);this.checkForParentTooltip_();this.saveCursorPosition_(event)}};goog.ui.Tooltip.prototype.getAnchorFromElement=function(el){try{while(el&&!this.elements_.contains(el))el=el.parentNode;return el}catch(e){return null}};
goog.ui.Tooltip.prototype.handleMouseMove=function(event){this.saveCursorPosition_(event);this.seenInteraction_=true};goog.ui.Tooltip.prototype.handleFocus=function(event){var el=this.getAnchorFromElement(event.target);this.activeEl_=el;this.seenInteraction_=true;if(this.anchor!=el){this.anchor=el;var pos=this.getPositioningStrategy(goog.ui.Tooltip.Activation.FOCUS);this.clearHideTimer();this.startShowTimer(el,pos);this.checkForParentTooltip_()}};
goog.ui.Tooltip.prototype.getPositioningStrategy=function(activationType){if(activationType==goog.ui.Tooltip.Activation.CURSOR){var coord=this.cursorPosition.clone();return new goog.ui.Tooltip.CursorTooltipPosition(coord)}return new goog.ui.Tooltip.ElementTooltipPosition(this.activeEl_)};
goog.ui.Tooltip.prototype.checkForParentTooltip_=function(){if(this.anchor)for(var tt,i=0;tt=goog.ui.Tooltip.activeInstances_[i];i++)if(goog.dom.contains(tt.getElement(),this.anchor)){tt.childTooltip_=this;this.parentTooltip_=tt}};
goog.ui.Tooltip.prototype.handleMouseOutAndBlur=function(event){var el=this.getAnchorFromElement(event.target);var elTo=this.getAnchorFromElement(event.relatedTarget);if(el==elTo)return;if(el==this.activeEl_)this.activeEl_=null;this.clearShowTimer();this.seenInteraction_=false;if(this.isVisible()&&(!event.relatedTarget||!goog.dom.contains(this.getElement(),event.relatedTarget)))this.startHideTimer();else this.anchor=undefined};
goog.ui.Tooltip.prototype.handleTooltipMouseOver=function(event){var element=this.getElement();if(this.activeEl_!=element){this.clearHideTimer();this.activeEl_=element}};goog.ui.Tooltip.prototype.handleTooltipMouseOut=function(event){var element=this.getElement();if(this.activeEl_==element&&(!event.relatedTarget||!goog.dom.contains(element,event.relatedTarget))){this.activeEl_=null;this.startHideTimer()}};
goog.ui.Tooltip.prototype.startShowTimer=function(el,opt_pos){if(!this.showTimer)this.showTimer=goog.Timer.callOnce(goog.bind(this.maybeShow,this,el,opt_pos),this.showDelayMs_)};goog.ui.Tooltip.prototype.clearShowTimer=function(){if(this.showTimer){goog.Timer.clear(this.showTimer);this.showTimer=undefined}};goog.ui.Tooltip.prototype.startHideTimer=function(){if(this.getState()==goog.ui.Tooltip.State.SHOWING)this.hideTimer=goog.Timer.callOnce(goog.bind(this.maybeHide,this,this.anchor),this.getHideDelayMs())};
goog.ui.Tooltip.prototype.clearHideTimer=function(){if(this.hideTimer){goog.Timer.clear(this.hideTimer);this.hideTimer=undefined}};goog.ui.Tooltip.prototype.disposeInternal=function(){this.setVisible(false);this.clearShowTimer();this.detach();if(this.getElement())goog.dom.removeNode(this.getElement());this.activeEl_=null;delete this.dom_;goog.ui.Tooltip.superClass_.disposeInternal.call(this)};
goog.ui.Tooltip.CursorTooltipPosition=function(arg1,opt_arg2){goog.positioning.ViewportPosition.call(this,arg1,opt_arg2)};goog.inherits(goog.ui.Tooltip.CursorTooltipPosition,goog.positioning.ViewportPosition);
goog.ui.Tooltip.CursorTooltipPosition.prototype.reposition=function(element,popupCorner,opt_margin){var viewportElt=goog.style.getClientViewportElement(element);var viewport=goog.style.getVisibleRectForElement(viewportElt);var margin=opt_margin?new goog.math.Box(opt_margin.top+10,opt_margin.right,opt_margin.bottom,opt_margin.left+10):new goog.math.Box(10,0,0,10);if(goog.positioning.positionAtCoordinate(this.coordinate,element,goog.positioning.Corner.TOP_START,margin,viewport,goog.positioning.Overflow.ADJUST_X|
goog.positioning.Overflow.FAIL_Y)&goog.positioning.OverflowStatus.FAILED)goog.positioning.positionAtCoordinate(this.coordinate,element,goog.positioning.Corner.TOP_START,margin,viewport,goog.positioning.Overflow.ADJUST_X|goog.positioning.Overflow.ADJUST_Y)};goog.ui.Tooltip.ElementTooltipPosition=function(element){goog.positioning.AnchoredPosition.call(this,element,goog.positioning.Corner.BOTTOM_RIGHT)};goog.inherits(goog.ui.Tooltip.ElementTooltipPosition,goog.positioning.AnchoredPosition);
goog.ui.Tooltip.ElementTooltipPosition.prototype.reposition=function(element,popupCorner,opt_margin){var offset=new goog.math.Coordinate(10,0);if(goog.positioning.positionAtAnchor(this.element,this.corner,element,popupCorner,offset,opt_margin,goog.positioning.Overflow.ADJUST_X|goog.positioning.Overflow.FAIL_Y)&goog.positioning.OverflowStatus.FAILED)goog.positioning.positionAtAnchor(this.element,goog.positioning.Corner.TOP_RIGHT,element,goog.positioning.Corner.BOTTOM_LEFT,offset,opt_margin,goog.positioning.Overflow.ADJUST_X|
goog.positioning.Overflow.ADJUST_Y)};goog.provide("goog.ui.AdvancedTooltip");goog.require("goog.events");goog.require("goog.events.EventType");goog.require("goog.math.Box");goog.require("goog.math.Coordinate");goog.require("goog.style");goog.require("goog.ui.Tooltip");goog.require("goog.userAgent");goog.requireType("goog.dom.DomHelper");goog.requireType("goog.events.BrowserEvent");goog.ui.AdvancedTooltip=function(opt_el,opt_str,opt_domHelper){goog.ui.Tooltip.call(this,opt_el,opt_str,opt_domHelper)};
goog.inherits(goog.ui.AdvancedTooltip,goog.ui.Tooltip);goog.ui.AdvancedTooltip.prototype.cursorTracking_=false;goog.ui.AdvancedTooltip.prototype.cursorTrackingHideDelayMs_=100;goog.ui.AdvancedTooltip.prototype.hotSpotPadding_;goog.ui.AdvancedTooltip.prototype.boundingBox_;goog.ui.AdvancedTooltip.prototype.anchorBox_;goog.ui.AdvancedTooltip.prototype.tracking_=false;goog.ui.AdvancedTooltip.prototype.setHotSpotPadding=function(opt_box){this.hotSpotPadding_=opt_box||null};
goog.ui.AdvancedTooltip.prototype.getHotSpotPadding=function(){return this.hotSpotPadding_};goog.ui.AdvancedTooltip.prototype.setCursorTracking=function(b){this.cursorTracking_=b};goog.ui.AdvancedTooltip.prototype.getCursorTracking=function(){return this.cursorTracking_};goog.ui.AdvancedTooltip.prototype.setCursorTrackingHideDelayMs=function(delay){this.cursorTrackingHideDelayMs_=delay};goog.ui.AdvancedTooltip.prototype.getCursorTrackingHideDelayMs=function(){return this.cursorTrackingHideDelayMs_};
goog.ui.AdvancedTooltip.prototype.onShow=function(){goog.ui.AdvancedTooltip.superClass_.onShow.call(this);this.boundingBox_=goog.style.getBounds(this.getElement()).toBox();if(this.anchor)this.anchorBox_=goog.style.getBounds(this.anchor).toBox();this.tracking_=this.cursorTracking_;goog.events.listen(this.getDomHelper().getDocument(),goog.events.EventType.MOUSEMOVE,this.handleMouseMove,false,this)};
goog.ui.AdvancedTooltip.prototype.onHide=function(){goog.events.unlisten(this.getDomHelper().getDocument(),goog.events.EventType.MOUSEMOVE,this.handleMouseMove,false,this);this.boundingBox_=null;this.anchorBox_=null;this.tracking_=false;goog.ui.AdvancedTooltip.superClass_.onHide.call(this)};goog.ui.AdvancedTooltip.prototype.isMouseInTooltip=function(){return this.isCoordinateInTooltip(this.cursorPosition)};
goog.ui.AdvancedTooltip.prototype.isCoordinateInTooltip=function(coord){if(this.hotSpotPadding_){var offset=goog.style.getPageOffset(this.getElement());var size=goog.style.getSize(this.getElement());return offset.x-this.hotSpotPadding_.left<=coord.x&&coord.x<=offset.x+size.width+this.hotSpotPadding_.right&&offset.y-this.hotSpotPadding_.top<=coord.y&&coord.y<=offset.y+size.height+this.hotSpotPadding_.bottom}return goog.ui.AdvancedTooltip.superClass_.isCoordinateInTooltip.call(this,coord)};
goog.ui.AdvancedTooltip.prototype.isCoordinateActive_=function(coord){if(this.anchorBox_&&this.anchorBox_.contains(coord)||this.isCoordinateInTooltip(coord))return true;var childTooltip=this.getChildTooltip();return!!childTooltip&&childTooltip.isCoordinateInTooltip(coord)};
goog.ui.AdvancedTooltip.prototype.maybeHide=function(el){this.hideTimer=undefined;if(el==this.anchor)if(!this.isCoordinateActive_(this.cursorPosition)&&!this.getActiveElement()&&!this.hasActiveChild()){if(goog.userAgent.GECKO&&this.cursorPosition.x==0&&this.cursorPosition.y==0)return;this.setVisible(false)}};
goog.ui.AdvancedTooltip.prototype.handleMouseMove=function(event){var startTimer=this.isVisible();if(this.boundingBox_){var scroll=this.getDomHelper().getDocumentScroll();var c=new goog.math.Coordinate(event.clientX+scroll.x,event.clientY+scroll.y);if(this.isCoordinateActive_(c))startTimer=false;else if(this.tracking_){var prevDist=goog.math.Box.distance(this.boundingBox_,this.cursorPosition);var currDist=goog.math.Box.distance(this.boundingBox_,c);startTimer=currDist>=prevDist}}if(startTimer){this.startHideTimer();
this.setActiveElement(null);var childTooltip=this.getChildTooltip();if(childTooltip)childTooltip.setActiveElement(null)}else if(this.getState()==goog.ui.Tooltip.State.WAITING_TO_HIDE)this.clearHideTimer();goog.ui.AdvancedTooltip.superClass_.handleMouseMove.call(this,event)};goog.ui.AdvancedTooltip.prototype.handleTooltipMouseOver=function(event){if(this.getActiveElement()!=this.getElement()){this.tracking_=false;this.setActiveElement(this.getElement())}};
goog.ui.AdvancedTooltip.prototype.getHideDelayMs=function(){return this.tracking_?this.cursorTrackingHideDelayMs_:goog.ui.AdvancedTooltip.base(this,"getHideDelayMs")};goog.ui.AdvancedTooltip.prototype.resetHotSpot=function(){};goog.provide("plt.wescheme.helpers");
(function(){plt.wescheme.helpers.makeShareUrl=function(publicId){var a=document.createElement("a");a.href="/view?publicId="+encodeURIComponent(publicId);return a.href};plt.wescheme.helpers.urlToAnchor=function(url){var a=document.createElement("a");a.appendChild(document.createTextNode(url));a.href=url;return a};plt.wescheme.helpers.trimWhitespace=function(s){s=s.replace(new RegExp("^\\s+"),"");s=s.replace(new RegExp("\\s+$"),"");return s};plt.wescheme.helpers.generateSocialBookmarks=function(title,
url){var list=document.createElement("ul");list.className="socialBookmarks";var addBookmarklet=function(name,imgSrc,url){var a=document.createElement("a");var img=document.createElement("img");var li=document.createElement("li");a.className="socialBookmarklet";a.title="Share via "+name;img.src=imgSrc;img.alt="Share via "+name;img.className="socialBookmarklet";a.appendChild(img);a.href=url;a.target="_blank";li.appendChild(a);list.appendChild(li)};var encodeKeyPairs=function(attrs){var key,buffer=[];
for(key in attrs)if(Object.hasOwnProperty.call(attrs,key))buffer.push(key+"="+encodeURIComponent(attrs[key]));return buffer.join("&")};addBookmarklet("email","/images/icon_email.png","https://mail.google.com/mail/u/0/?view=cm&fs=1&tf=1"+encodeKeyPairs({su:title,body:url}));addBookmarklet("Facebook","/images/icon_facebook.png","http://www.facebook.com/sharer.php"+"?"+encodeKeyPairs({u:url,t:title}));addBookmarklet("Twitter","/images/icon_twitter.png","http://twitter.com/home?"+encodeKeyPairs({status:url}));
addBookmarklet("Pinterest","/images/icon_pinterest.png","http://pinterest.com/pin/create/button/?"+encodeKeyPairs({url:url,description:title}));addBookmarklet("Reddit","/images/icon_reddit.png","http://www.reddit.com/submit?"+encodeKeyPairs({url:url,title:title}));addBookmarklet("Barcode","/images/icon_qrcode.png","http://qrcode.kaywa.com/img.php"+"?"+encodeKeyPairs({s:8,d:url}));return list};var zpad=function(s){if((s+"").length==1)return"0"+s;else return s};plt.wescheme.helpers.prettyPrintDate=
function(modified){var modifiedDate=new Date;modifiedDate.setTime(parseInt(modified));var day=modifiedDate.getUTCDate();var month=modifiedDate.getUTCMonth()+1;var year=modifiedDate.getFullYear();var time=(modifiedDate.getHours()%12==0?12:modifiedDate.getHours()%12)+":"+zpad(modifiedDate.getMinutes())+(modifiedDate.getHours()>=12?"pm":"am");return day+"/"+month+"/"+year+", "+time}})();goog.provide("plt.wescheme.SharingDialog");goog.require("goog.ui.AdvancedTooltip");goog.require("goog.html.SafeHtml");goog.require("plt.wescheme.AjaxActions");goog.require("plt.wescheme.helpers");goog.require("plt.wescheme.WeSchemeIntentBus");
(function(){plt.wescheme.SharingDialog=function(pid,code){this.pid=pid;this.code=code;this.actions=new plt.wescheme.AjaxActions};plt.wescheme.SharingDialog.prototype.show=function(onShareSuccess,onAbort){var that=this;var dialogWindow=jQuery("<div/>");var shareWithSource=function(){dialogWindow.dialog("close");doTheSharing(true)};var shareWithoutSource=function(){dialogWindow.dialog("close");doTheSharing(false)};var handleClose=function(){document.getElementById("editor").removeAttribute("aria-hidden")};
var doTheSharing=function(isPublic){plt.wescheme.WeSchemeIntentBus.notify("before-publish",that);that.actions.makeAClone(that.pid,that.code,function(newPid){showResultOfSharing(isPublic,newPid,false)},whenCloningFails)};var showResultOfSharing=function(isPublic,newPid,errMessage){function copyShareLink(){var copyText=document.getElementById("sharedLink");copyText.select();copyText.setSelectionRange(0,99999);document.execCommand("copy")}that.actions.share(newPid,isPublic,function(sharedProgram){var newDialog=
jQuery("<div/>");document.getElementById("editor").setAttribute("aria-hidden",true);newDialog.dialog({title:"Sharing your program",bgiframe:true,modal:true,beforeClose:handleClose,width:600,close:function(){if(onShareSuccess)onShareSuccess(sharedProgram)}});plt.wescheme.WeSchemeIntentBus.notify("after-publish",that);newDialog.append(jQuery("<p/>").text("Program has been shared: "));var publicId=sharedProgram.find("publicId").text();url=plt.wescheme.helpers.makeShareUrl(publicId);inpt=document.createElement("input");
inpt.id="sharedLink";inpt.style="width: 515px; padding: 0px 4px; line-height: 25px;";inpt.value=url;inpt.readOnly=true;newDialog.append(inpt);anchor=plt.wescheme.helpers.urlToAnchor(url),title=sharedProgram.find("title").text();copyBtn=document.createElement("button");copyBtn.onclick=copyShareLink;copyBtn.innerHTML="&#10697;";newDialog.append(copyBtn);newDialog.append(jQuery("<p/>"));newDialog.append(jQuery(plt.wescheme.helpers.generateSocialBookmarks(title,anchor.href)));newDialog.dialog("open")},
whenSharingFails)};var whenCloningFails=function(){alert("cloning failed");if(onAbort)onAbort()};var whenSharingFails=function(){alert("Sharing failed.");if(onAbort)onAbort()};document.getElementById("editor").setAttribute("aria-hidden",true);if(this.pid){dialogWindow.append(jQuery("<p/>").text("Publishing will let your friends run this program. Would you like them to be able to see your code, too?"));dialogWindow.dialog({title:"Publish My Program",bgiframe:true,modal:true,beforeClose:handleClose,
overlay:{opacity:.5,background:"black"},buttons:{"Yes":shareWithSource,"No":shareWithoutSource}});dialogWindow.dialog("open")}else{dialogWindow.append(jQuery("<p/>").text("The program needs to be saved before it can be shared."));dialogWindow.dialog({title:"Sharing your program",bgiframe:true,modal:true,beforeClose:handleClose,overlay:{opacity:.5,background:"black"},buttons:{}});dialogWindow.dialog("open")}};plt.wescheme.SharingDialog.makeShareButton=function(aProgramOrDigest,onSuccess,onFailure){var img=
aProgramOrDigest.hasSharingUrls()?jQuery("<img class='button' src='/css/images/share.png'/>"):jQuery("<img class='button' src='/css/images/share-decolored.png'/>");img.click(function(){(new plt.wescheme.SharingDialog(aProgramOrDigest.getId(),null)).show(onSuccess,onFailure)});var shareSpan=jQuery("<span/>").addClass("ProgramPublished").append(img);attachSharingPopupTooltip(shareSpan.get(0),aProgramOrDigest);return shareSpan};var attachSharingPopupTooltip=function(parent,aProgramOrDigest){var tooltip=
new goog.ui.AdvancedTooltip(parent);console.log(parent);console.log(tooltip);tooltip.className="tooltip";if(aProgramOrDigest.hasSharingUrls()){tooltip.setHtml("<h2>Program sharing</h2>"+"This program has been shared.",true);var aList=goog.dom.createElement("ul");var entries=aProgramOrDigest.getSharedAsEntries();var elt=entries[0];var item=goog.dom.createElement("li");aList.appendChild(item);var title=elt.title;var anchor=makeShareAnchor(elt.publicId,elt.title);item.appendChild(anchor);item.appendChild(goog.dom.createTextNode(" ["+
plt.wescheme.helpers.prettyPrintDate(elt.modified)+"]"));item.appendChild(plt.wescheme.helpers.generateSocialBookmarks(title,anchor.href));goog.dom.appendChild(tooltip.getElement(),aList)}else tooltip.setSafeHtml(goog.html.SafeHtml.htmlEscape("<h2>Program sharing</h2>"+"This program has not been shared yet.  Click the share icon to share it."));tooltip.setHotSpotPadding(new goog.math.Box(5,5,5,5));tooltip.setCursorTracking(true);tooltip.setHideDelayMs(250)};var makeShareAnchor=function(publicId,name){if(publicId!=
""){var a=document.createElement("a");a.href=plt.wescheme.helpers.makeShareUrl(publicId);a.target="_blank";a.appendChild(document.createTextNode(name||a.href));return a}else throw new Error;}})();goog.provide("plt.wescheme.NotesDialog");goog.require("goog.ui.AdvancedTooltip");goog.require("plt.wescheme.AjaxActions");goog.require("plt.wescheme.helpers");goog.require("plt.wescheme.WeSchemeIntentBus");
(function(){plt.wescheme.NotesDialog=function(pid){this.pid=pid;this.actions=new plt.wescheme.AjaxActions;this.textArea=jQuery("<textarea class='notesTextarea'></textarea>");this.textArea.css("width","100%");this.textArea.css("height","100%")};plt.wescheme.NotesDialog.prototype.show=function(onSuccess,onAbort){var that=this;var dialogWindow=jQuery("<div/>");var closeDialog=function(){dialogWindow.dialog("close")};var onClose=function(){if(that.pid)that.actions.save({pid:that.pid,notes:that.textArea.val()},
onSuccess,onAbort);else onSuccess()};if(that.pid)that.actions.loadProject(that.pid,null,function(aProgram){if(aProgram.getNotes())that.textArea.val(aProgram.getNotes());else that.textArea.val("Enter your notes here.");dialogWindow.append(jQuery("<div/>").append(that.textArea).css("height","100%"));dialogWindow.dialog({title:"Notes",bgiframe:true,modal:true,overlay:{opacity:.5,background:"black"},buttons:{"Save":closeDialog},width:400,height:500,close:onClose});dialogWindow.dialog("open")},onAbort);
else{dialogWindow.append(jQuery("<span>Please save the program first. You may need to go back and log in, if you haven't already.</span>"));dialogWindow.dialog({title:"Notes",bgiframe:true,modal:true,overlay:{opacity:.5,background:"black"},buttons:{"Close":closeDialog},width:400,height:500,close:onClose});dialogWindow.dialog("open")}}})();goog.provide("plt.wescheme.BrowserDetect");
plt.wescheme.BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersionFloat(navigator.userAgent)||this.searchVersionFloat(navigator.appVersion)||undefined;this.versionString=this.searchVersionString(navigator.userAgent)||this.searchVersionString(navigator.appVersion)||"unknown";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;
var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1)return data[i].identity}else if(dataProp)return data[i].identity}},searchVersionString:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1)return;return dataString.substring(index+this.versionSearchString.length+1)},searchVersionFloat:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==
-1)return;return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},
{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"},{string:navigator.userAgent,subString:"Edge",
identity:"Edge",versionSearch:"Edge"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"},{string:navigator.platform,subString:"android",identity:"Android"}]};plt.wescheme.BrowserDetect.init();goog.provide("plt.wescheme.topKeymap");goog.require("plt.wescheme.BrowserDetect");var F4_KEYCODE=115;var F6_KEYCODE=117;var F7_KEYCODE=118;var F8_KEYCODE=119;var F9_KEYCODE=120;var F11_KEYCODE=122;var BACKSPACE_KEYCODE=8;var ENTER_KEYCODE=13;var SAVE_KEYCODE=83;var ZOOMIN_KEYCODE=187;var ZOOMOUT_KEYCODE=189;var DIM_KEYCODE=113;var BRIGHTEN_KEYCODE=114;var QUESTION_KEYCODE=191;var inMiddleOfSave=false;
function cancelEvent(e){e.cancelBubble=true;if(e.stopPropagation)e.stopPropagation();e.returnValue=false;if(e.preventDefault)e.preventDefault();if(!e.preventDefault)e.keyCode=0}
plt.wescheme.topKeymap=function(e){if(e.keyCode===SAVE_KEYCODE&&(plt.wescheme.BrowserDetect.OS==="Mac"?e.metaKey:e.ctrlKey)){if(!inMiddleOfSave){inMiddleOfSave=true;myEditor.save(function(){inMiddleOfSave=false},function(){inMiddleOfSave=false},function(){inMiddleOfSave=false})}cancelEvent(e);return false}if(e.keyCode===F4_KEYCODE){myEditor.toggleScreenreader();cancelEvent(e);return false}if(e.keyCode===F6_KEYCODE){myEditor.cycleFocus(e.shiftKey);cancelEvent(e);return false}if(e.keyCode===F7_KEYCODE||
e.keyCode===ENTER_KEYCODE&&e.ctrlKey){myEditor.run();cancelEvent(e);return false}if(e.keyCode===F8_KEYCODE){myEditor.requestBreak();cancelEvent(e);return false}if(e.keyCode===F9_KEYCODE){myEditor.share();cancelEvent(e);return false}if(e.keyCode===F11_KEYCODE){myEditor.showPicker(false);cancelEvent(e);return false}if(e.keyCode===DIM_KEYCODE||e.keyCode===BRIGHTEN_KEYCODE){e.codemirrorIgnore=true;return false}if(e.keyCode===ZOOMIN_KEYCODE&&(plt.wescheme.BrowserDetect.OS==="Mac"?e.metaKey:e.ctrlKey)){var size=
parseInt(document.getElementById("middle").style.fontSize)||10;document.getElementById("middle").style.fontSize=size+1+"pt";var cms=document.getElementsByClassName("CodeMirror");for(var i=0;i<cms.length;i++)cms[i].CodeMirror.refresh();return false}if(e.keyCode===ZOOMOUT_KEYCODE&&(plt.wescheme.BrowserDetect.OS==="Mac"?e.metaKey:e.ctrlKey)){var size=parseInt(document.getElementById("middle").style.fontSize)||10;document.getElementById("middle").style.fontSize=size-1+"pt";var cms=document.getElementsByClassName("CodeMirror");
for(var i=0;i<cms.length;i++)cms[i].CodeMirror.refresh();return false}if(e.keyCode===QUESTION_KEYCODE&&e.metaKey){myEditor.toggleHelp();cancelEvent(e);return false}if(e.target===document.body){if(e.keyCode===BACKSPACE_KEYCODE){cancelEvent(e);return false}return true}};goog.provide("plt.wescheme.WeSchemeTextContainer");goog.require("plt.wescheme.topKeymap");goog.require("plt.wescheme.BrowserDetect");var WeSchemeTextContainer;
(function(){var gensym=0;WeSchemeTextContainer=function(aDiv,options,afterInitialization,id){var that=this;this.div=aDiv;this.mode="textarea";this.impl=null;this.options=options;this.keymaps=[];jQuery(this.div).empty();var tc=new CodeMirrorImplementation(this,options,function(anImpl){that.impl=anImpl;afterInitialization(that)});tc.editor.getWrapperElement().id=id||"textContainerID"+gensym;tc.editor.getWrapperElement().impl=tc;gensym++};WeSchemeTextContainer.prototype.refresh=function(){this.impl.refresh()};
WeSchemeTextContainer.prototype.getSourceB=function(){return this.impl.getSourceB()};WeSchemeTextContainer.prototype.getDiv=function(){return this.div};WeSchemeTextContainer.prototype.getCode=function(){return normalizeString(this.impl.getCode.apply(this.impl,arguments))};WeSchemeTextContainer.prototype.setCode=function(code){return this.impl.setCode(normalizeString(code))};WeSchemeTextContainer.prototype.clearHistory=function(){return this.impl.clearHistory()};WeSchemeTextContainer.prototype.highlight=
function(id,offset,line,column,span,color){return this.impl.highlight(id,offset,line,column,span,color)};WeSchemeTextContainer.prototype.unhighlightAll=function(){return this.impl.unhighlightAll()};WeSchemeTextContainer.prototype.moveCursor=function(offset){return this.impl.moveCursor(offset)};WeSchemeTextContainer.prototype.scrollIntoView=function(offset,margin){this.impl.scrollIntoView(offset,margin)};WeSchemeTextContainer.prototype.setSelection=function(id,offset,line,column,span){return this.impl.setSelection(id,
offset,line,column,span)};WeSchemeTextContainer.prototype.focus=function(){this.impl.focus()};WeSchemeTextContainer.prototype.getCursorStartPosition=function(){return this.impl.getCursorStartPosition()};WeSchemeTextContainer.prototype.setCursorToBeginning=function(){this.impl.setCursorToBeginning()};WeSchemeTextContainer.prototype.setCursorToEnd=function(){this.impl.setCursorToEnd()};WeSchemeTextContainer.prototype.getCSS=function(pos){return this.impl.getCSS(pos)};var CodeMirrorImplementation=function(parent,
options,onSuccess){var that=this;this.behaviorE=receiverE();this.behavior=startsWith(this.behaviorE,"");this.highlightedAreas=[];var km={};jQuery.extend(km,options.extraKeys);km["Tab"]="indentAuto";km[plt.wescheme.BrowserDetect.OS==="Mac"?"Cmd-I":"Ctrl-I"]=function(ed){var start=ed.getCursor(true);var end=ed.getCursor(false);CodeMirror.commands.selectAll(ed);CodeMirror.commands.indentAuto(ed);ed.setSelection(start,end)};this.editor=CodeMirror(parent.getDiv(),{theme:options.theme||"scheme",mode:"scheme2",
extraKeys:km,lineNumbers:typeof options.lineNumbers!==undefined?options.lineNumbers:true,lineWrapping:true,matchBrackets:options.matchBrackets||true,autoCloseBrackets:options.autoCloseBrackets||false,value:options.content||"",readOnly:typeof options.readOnly!==undefined?options.readOnly:false,cursorBlinkRate:typeof options.cursorBlinkRate!==undefined?options.cursorBlinkRate:350});this.editor.getGutterElement().setAttribute("aria-hidden","true");this.editor.on("change",function(){that.behaviorE.sendEvent(that.editor.getValue())});
this.editor.getInputField().setAttribute("role","input");this.editor.on("beforeChange",function(cm,changeObj){function replaceQuotes(str){return str.replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"')}if(changeObj.origin==="paste")changeObj.text=changeObj.text.map(replaceQuotes)});try{this.editor.getWrapperElement().style.width=options.width||"100%"}catch(e){}if(!options.dynamicHeight)try{this.editor.getWrapperElement().style.height=options.height||"100%"}catch(e){}try{this.editor.getScrollerElement().style.width=
"100%"}catch(e){}if(options.dynamicHeight){try{this.editor.getScrollerElement().style.height="auto"}catch(e){}try{this.editor.getScrollerElement().style.overflow="visible"}catch(e){}}else try{this.editor.getScrollerElement().style.height="100%"}catch(e){}this.editor.refresh();if(options.clone&&parent.div.id==="definitions"){var dummy=document.createElement("div");document.getElementById("middle").appendChild(dummy);var clone=new CodeMirror(dummy,{value:this.editor.getDoc().linkedDoc(),lineNumbers:this.editor.getOption("lineNumbers"),
viewportMargin:Infinity}),cloneDOM=clone.getWrapperElement();cloneDOM.id="printedCM"}onSuccess.call(that,that)};CodeMirrorImplementation.prototype.getSourceB=function(){return this.behavior};CodeMirrorImplementation.prototype.getCode=function(startOffset,endOffset){var code=this.editor.getValue();if(valueNow(this.behavior)!==code)this.behaviorE.sendEvent(code);if(typeof startOffset!==undefined)if(typeof endOffset!==undefined)return code.substring(startOffset,endOffset);else return code.substring(startOffset);
else return code};CodeMirrorImplementation.prototype.setCode=function(code){this.editor.setValue(code);this.behaviorE.sendEvent(code);this.editor.refresh()};CodeMirrorImplementation.prototype.clearHistory=function(){this.editor.clearHistory();this.editor.refresh()};var currentHighlightNumber=0;CodeMirrorImplementation.prototype.highlight=function(id,offset,line,column,span,color){offset--;var stylesheet=document.querySelectorAll('[href="/css/default.css"]')[0].sheet,name="highlight"+(currentHighlightNumber+
"x");currentHighlightNumber++;if(stylesheet.insertRule)stylesheet.insertRule("."+name+" { background-color: "+color+";}",0);else stylesheet.addRule("."+name,"background-color: "+color+"",0);var start=this.editor.posFromIndex(parseInt(offset)),end=this.editor.posFromIndex(parseInt(offset)+parseInt(span)),highlightedArea=this.editor.markText(start,end,{className:name});this.highlightedAreas.push(highlightedArea);this.scrollIntoView(offset,span);return{clear:function(){return highlightedArea.clear()},
find:function(){return highlightedArea.find()},styleName:name}};CodeMirrorImplementation.prototype.moveCursor=function(offset){var moveTo=this.editor.posFromIndex(offset);var li=moveTo.handle;var col=moveTo.column-1;var currLine=this.editor.getCursor(false).line;if(li!=currLine)this.editor.setCursor({line:li,ch:col});else{this.editor.setCursor({line:li+1,ch:col});this.editor.setCursor({line:li,ch:col})}};CodeMirrorImplementation.prototype.scrollIntoView=function(offset,margin){var moveTo=this.editor.posFromIndex(offset);
moveTo.ch--;this.editor.scrollIntoView(moveTo,margin)};CodeMirrorImplementation.prototype.setSelection=function(id,offset,line,column,span){offset--;var start=this.editor.posFromIndex(parseInt(offset));var end=this.editor.posFromIndex(parseInt(offset)+parseInt(span));this.editor.setSelection(start,end)};CodeMirrorImplementation.prototype.unhighlightAll=function(){this.highlightedAreas.forEach(function(ha){ha.clear()});this.highlightedAreas=[]};CodeMirrorImplementation.prototype.getCursorStartPosition=
function(){return this.editor.indexFromPos(this.editor.getCursor(true))};CodeMirrorImplementation.prototype.setCursorToBeginning=function(){this.editor.setCursor(0,0)};CodeMirrorImplementation.prototype.setCursorToEnd=function(){this.editor.setCursor({line:this.editor.lineCount()})};CodeMirrorImplementation.prototype.shutdown=function(){};CodeMirrorImplementation.prototype.focus=function(){this.editor.focus();this.editor.refresh()};CodeMirrorImplementation.prototype.refresh=function(){this.editor.refresh()};
CodeMirrorImplementation.prototype.getCSS=function(pos){return this.editor.findMarksAt(pos)};var normalizeString=function(s){return s.replace(/\r\n/g,"\n")}})();plt.wescheme.WeSchemeTextContainer=WeSchemeTextContainer;goog.provide("plt.wescheme.tokenizer");
(function(){var StopIteration={toString:function(){return"StopIteration"}};function normalizeString(string){var tab="";var indentUnit=4;for(var i=0;i<indentUnit;i++)tab+=" ";string=string.replace(/\t/g,tab).replace(/\u00a0/g," ").replace(/\r\n?/g,"\n");var pos=0,parts=[],lines=string.split("\n");for(var line=0;line<lines.length;line++){if(line!=0)parts.push("\n");parts.push(lines[line])}return{next:function(){if(pos<parts.length)return parts[pos++];else throw StopIteration;}}}var stringStream=function(source){var current=
"";var pos=0;var accum="";function ensureChars(){while(pos==current.length){accum+=current;current="";pos=0;try{current=source.next()}catch(e){if(e!=StopIteration)throw e;else return false}}return true}return{peek:function(){if(!ensureChars())return null;return current.charAt(pos)},next:function(){if(!ensureChars())if(accum.length>0)throw"End of stringstream reached without emptying buffer ('"+accum+"').";else throw StopIteration;return current.charAt(pos++)},get:function(){var temp=accum;accum="";
if(pos>0){temp+=current.slice(0,pos);current=current.slice(pos);pos=0}return temp},push:function(str){current=current.slice(0,pos)+str+current.slice(pos)},lookAhead:function(str,consume,skipSpaces,caseInsensitive){function cased(str){return caseInsensitive?str.toLowerCase():str}str=cased(str);var found=false;var _accum=accum,_pos=pos;if(skipSpaces)this.nextWhileMatches(/[\s\u00a0]/);while(true){var end=pos+str.length,left=current.length-pos;if(end<=current.length){found=str==cased(current.slice(pos,
end));pos=end;break}else if(str.slice(0,left)==cased(current.slice(pos))){accum+=current;current="";try{current=source.next()}catch(e){break}pos=0;str=str.slice(left)}else break}if(!(found&&consume)){current=accum.slice(_accum.length)+current;pos=_pos;accum=_accum}return found},more:function(){return this.peek()!==null},applies:function(test){var next=this.peek();return next!==null&&test(next)},nextWhile:function(test){var next;while((next=this.peek())!==null&&test(next))this.next()},matches:function(re){var next=
this.peek();return next!==null&&re.test(next)},nextWhileMatches:function(re){var next;while((next=this.peek())!==null&&re.test(next))this.next()},equals:function(ch){return ch===this.peek()},endOfLine:function(){var next=this.peek();return next==null||next=="\n"}}};var tokenizeScheme=function(){var isWhiteSpace=function(ch){return ch!="\n"&&/^[\s\u00a0]*$/.test(ch)};var scanUntilUnescaped=function(source,end){var escaped=false;while(true){if(source.endOfLine())return true;var next=source.next();if(next==
end&&!escaped)return false;escaped=!escaped&&next=="\\"}};var scanUntilEndline=function(source,end){while(!source.endOfLine())source.next()};var isHexDigit=/[0-9A-Fa-f]/;var whitespaceChar=new RegExp("[\\s\\u00a0]");var isDelimiterChar=new RegExp("[\\s\\(\\)\\[\\]\\{\\}\\\"\\,\\'\\`\\;]");var isNotDelimiterChar=new RegExp("[^\\s\\(\\)\\[\\]\\{\\}\\\"\\,\\'\\`\\;]");var numberHeader="(?:(?:\\d+\\/\\d+)|"+"(?:(?:\\d+\\.\\d+|\\d+\\.|\\.\\d+)(?:[eE][+\\-]?\\d+)?)|"+"(?:\\d+(?:[eE][+\\-]?\\d+)?))";var numberPatterns=
[new RegExp("^((?:(?:\\#[ei])?[+\\-]?"+numberHeader+")?"+"(?:[+\\-]"+numberHeader+")i$)"),/^((?:#[ei])?[+-]inf.0)$/,/^((?:#[ei])?[+-]nan.0)$/,new RegExp("^((?:\\#[ei])?[+\\-]?"+numberHeader+"$)"),new RegExp("^0[xX][0-9A-Fa-f]+$")];var looksLikeNumber=function(s){for(var i=0;i<numberPatterns.length;i++)if(numberPatterns[i].test(s))return true;return false};var UNCLOSED_STRING=function(source,setState){var readNewline=function(){var content=source.get();return{type:"whitespace",style:"whitespace",content:content}};
var ch=source.peek();if(ch==="\n"){source.next();return readNewline()}else{var isUnclosedString=scanUntilUnescaped(source,'"');if(isUnclosedString)setState(UNCLOSED_STRING);else setState(START);var content=source.get();return{type:"string",style:"scheme-string",content:content,isUnclosed:isUnclosedString}}};var START=function(source,setState){var readHexNumber=function(){source.next();source.nextWhileMatches(isHexDigit);return{type:"number",style:"scheme-number"}};var readNumber=function(){scanSimpleNumber();
if(source.equals("-")||source.equals("+"))source.next();scanSimpleNumber();if(source.equals("i"))source.next();return{type:"number",style:"scheme-number"}};var readWordOrNumber=function(){source.nextWhileMatches(isNotDelimiterChar);var word=source.get();if(looksLikeNumber(word))return{type:"number",style:"scheme-number",content:word};else return{type:"variable",style:"scheme-symbol",content:word}};var readString=function(quote){var isUnclosedString=scanUntilUnescaped(source,quote);if(isUnclosedString)setState(UNCLOSED_STRING);
var word=source.get();return{type:"string",style:"scheme-string",content:word,isUnclosed:isUnclosedString}};var readPound=function(){var text;if(source.equals(";")){source.next();text=source.get();return{type:"comment",style:"scheme-symbol",content:text}}else if(source.equals("\\")){source.next();source.next();text=source.get();return{type:"char",style:"scheme-symbol",content:text}}else{text=source.get();return{type:"symbol",style:"scheme-symbol",content:text}}};var readLineComment=function(){scanUntilEndline(source);
var text=source.get();return{type:"comment",style:"scheme-comment",content:text}};var readWhitespace=function(){source.nextWhile(isWhiteSpace);var content=source.get();return{type:"whitespace",style:"whitespace",content:content}};var readNewline=function(){var content=source.get();return{type:"whitespace",style:"whitespace",content:content}};var ch=source.next();if(ch==="\n")return readNewline();else if(whitespaceChar.test(ch))return readWhitespace();else if(ch==="#")return readPound();else if(ch===
";")return readLineComment();else if(ch==='"')return readString(ch);else if(isDelimiterChar.test(ch))return{type:ch,style:"scheme-punctuation"};else return readWordOrNumber()};var makeTokenizer=function(source,state){var tokenizer={state:state,take:function(type){if(typeof type=="string")type={style:type,type:type};type.content=(type.content||"")+source.get();type.value=type.content;return type},next:function(){if(!source.more())throw StopIteration;var type;while(!type)type=tokenizer.state(source,
function(s){tokenizer.state=s});var result=this.take(type);return result}};return tokenizer};return function(source,startState){return makeTokenizer(source,startState||START)}}();plt.wescheme.tokenizer.tokenize=function(text){var tokenizer=tokenizeScheme(stringStream(normalizeString(text)));var tokens=[];try{while(true){var nextToken=tokenizer.next();tokens.push(nextToken)}}catch(e){if(e!=StopIteration)throw e;}return tokens};plt.wescheme.tokenizer.hasCompleteExpression=function(text){var tokens=
plt.wescheme.tokenizer.tokenize(text);var waitingOpenParens=[],i;var openParens={"(":true,"[":true,"{":true};var closeParens={")":"(","]":"[","}":"{"};for(i=0;i<tokens.length;i++)if(openParens[tokens[i].type])waitingOpenParens.push(tokens[i].type);else if(closeParens[tokens[i].type]){if(waitingOpenParens.length===0)return false;if(waitingOpenParens.pop()!==closeParens[tokens[i].type])return false}return waitingOpenParens.length===0}})();goog.provide("plt.compiler.throwError");goog.provide("plt.compiler.Program");goog.provide("plt.compiler.comment");goog.provide("plt.compiler.couple");goog.provide("plt.compiler.defFunc");goog.provide("plt.compiler.defVar");goog.provide("plt.compiler.defVars");goog.provide("plt.compiler.defStruct");goog.provide("plt.compiler.beginExpr");goog.provide("plt.compiler.lambdaExpr");goog.provide("plt.compiler.localExpr");goog.provide("plt.compiler.letrecExpr");goog.provide("plt.compiler.letExpr");goog.provide("plt.compiler.letStarExpr");
goog.provide("plt.compiler.condExpr");goog.provide("plt.compiler.caseExpr");goog.provide("plt.compiler.andExpr");goog.provide("plt.compiler.orExpr");goog.provide("plt.compiler.callExpr");goog.provide("plt.compiler.ifExpr");goog.provide("plt.compiler.whenUnlessExpr");goog.provide("plt.compiler.symbolExpr");goog.provide("plt.compiler.literal");goog.provide("plt.compiler.quotedExpr");goog.provide("plt.compiler.unquotedExpr");goog.provide("plt.compiler.quasiquotedExpr");goog.provide("plt.compiler.unquoteSplice");
goog.provide("plt.compiler.requireExpr");goog.provide("plt.compiler.provideStatement");goog.provide("plt.compiler.unsupportedExpr");goog.provide("plt.compiler.pinfo");goog.provide("plt.compiler.getBasePinfo");goog.provide("plt.compiler.isExpression");goog.provide("plt.compiler.isDefinition");goog.provide("plt.compiler.env");goog.provide("plt.compiler.emptyEnv");goog.provide("plt.compiler.localEnv");goog.provide("plt.compiler.globalEnv");goog.provide("plt.compiler.moduleBinding");goog.provide("plt.compiler.functionBinding");
goog.provide("plt.compiler.constantBinding");goog.provide("plt.compiler.structBinding");goog.provide("plt.compiler.unnamedEnv");window.plt=window.plt||{};plt.compiler=plt.compiler||{};
(function(){var unimplementedException=function(str){this.str=str};function throwError(msg,loc,errorClass){loc.source=loc.source||"<unknown>";function rewritePart(part){if(typeof part==="string")return part;else if(part instanceof symbolExpr){return'["span", [["class", "SchemeValue-Symbol"]], '+part.val+"]";return part.val}else if(part.location!==undefined)return{text:part.text,type:"ColoredPart",loc:part.location.toString(),toString:function(){return part.text}};else if(part.locations!==undefined)return{text:part.text,
type:"MultiPart",solid:part.solid,locs:part.locations.map(function(l){return l.toString()}),toString:function(){return part.text}}}msg.args=msg.args.map(rewritePart);var json={type:"moby-failure","dom-message":["span",[["class","Error"]],["span",[["class",errorClass||"Message"]]].concat(errorClass?[["span",[["class","Error.reason"]],msg.toString()],["span",[["class",(errorClass||"message")+(errorClass==="Error-GenericReadError"?".locations":".otherLocations")]]]]:msg.args.map(function(x){return x.toString()})),
["br",[],""],["span",[["class","Error.location"]],["span",[["class","location-reference"],["style","display:none"]],["span",[["class","location-offset"]],(loc.startChar+1).toString()],["span",[["class","location-line"]],loc.startRow.toString()],["span",[["class","location-column"]],loc.startCol.toString()],["span",[["class","location-span"]],loc.span.toString()],["span",[["class","location-id"]],loc.source.toString()]]]],"structured-error":JSON.stringify({message:errorClass?false:msg.args,location:loc.toString()})};
throw JSON.stringify(json);}function couple(first,second){this.first=first;this.second=second;this.toString=function(){return"("+this.first.toString()+" "+this.second.toString()+")"}}var heir=function(p){var f=function(){};f.prototype=p;return new f};var Program=function(){this.toString=function(){return this.val.toString()};this.location=null};function comment(txt){Program.call(this);this.txt=txt;this.toString=function(){return";"+this.txt}}comment.prototype=heir(Program.prototype);function defFunc(name,
args,body,stx){Program.call(this);this.name=name;this.args=args;this.body=body;this.stx=stx;this.toString=function(){return"(define ("+this.name.toString()+" "+this.args.join(" ")+")\n    "+this.body.toString()+")"}}defFunc.prototype=heir(Program.prototype);function defVar(name,expr,stx){Program.call(this);this.name=name;this.expr=expr;this.stx=stx;this.toString=function(){return"(define "+this.name.toString()+" "+this.expr.toString()+")"}}defVar.prototype=heir(Program.prototype);function defVars(names,
expr,stx){Program.call(this);this.names=names;this.expr=expr;this.stx=stx;this.toString=function(){return"(define-values ("+this.names.join(" ")+") "+this.expr.toString()+")"}}defVars.prototype=heir(Program.prototype);function defStruct(name,fields,stx){Program.call(this);this.name=name;this.fields=fields;this.stx=stx;this.toString=function(){return"(define-struct "+this.name.toString()+" ("+this.fields.toString()+"))"}}defStruct.prototype=heir(Program.prototype);function beginExpr(exprs,stx){Program.call(this);
this.exprs=exprs;this.stx=stx;this.toString=function(){return"(begin "+this.exprs.join(" ")+")"}}beginExpr.prototype=heir(Program.prototype);function lambdaExpr(args,body,stx){Program.call(this);this.args=args;this.body=body;this.stx=stx;this.toString=function(){return"(lambda ("+this.args.join(" ")+") "+this.body.toString()+")"}}lambdaExpr.prototype=heir(Program.prototype);function localExpr(defs,body,stx){Program.call(this);this.defs=defs;this.body=body;this.stx=stx;this.toString=function(){return"(local ("+
this.defs.toString()+") "+this.body.toString()+")"}}localExpr.prototype=heir(Program.prototype);function letrecExpr(bindings,body,stx){this.bindings=bindings;this.body=body;this.stx=stx;this.toString=function(){return"(letrec ("+this.bindings.toString()+") ("+this.body.toString()+"))"}}function letExpr(bindings,body,stx){this.bindings=bindings;this.body=body;this.stx=stx;this.toString=function(){return"(let ("+this.bindings.toString()+") ("+this.body.toString()+"))"}}function letStarExpr(bindings,
body,stx){this.bindings=bindings;this.body=body;this.stx=stx;this.toString=function(){return"(let* ("+this.bindings.toString()+") ("+this.body.toString()+"))"}}function condExpr(clauses,stx){this.clauses=clauses;this.stx=stx;this.toString=function(){return"(cond\n    "+this.clauses.join("\n    ")+")"}}function caseExpr(expr,clauses,stx){Program.call(this);this.expr=expr;this.clauses=clauses;this.stx=stx;this.toString=function(){return"(case "+this.expr.toString()+"\n    "+this.clauses.join("\n    ")+
")"}}caseExpr.prototype=heir(Program.prototype);function andExpr(exprs,stx){this.exprs=exprs;this.stx=stx;this.toString=function(){return"(and "+this.exprs.join(" ")+")"}}function orExpr(exprs,stx){this.exprs=exprs;this.stx=stx;this.toString=function(){return"(or "+this.exprs.toString()+")"}}function callExpr(func,args,stx){Program.call(this);this.func=func;this.args=args;this.stx=stx;this.toString=function(){return"("+[this.func].concat(this.args).join(" ")+")"}}callExpr.prototype=heir(Program.prototype);
function ifExpr(predicate,consequence,alternative,stx){Program.call(this);this.predicate=predicate;this.consequence=consequence;this.alternative=alternative;this.stx=stx;this.toString=function(){return"(if "+this.predicate.toString()+" "+this.consequence.toString()+" "+this.alternative.toString()+")"}}ifExpr.prototype=heir(Program.prototype);function whenUnlessExpr(predicate,exprs,stx){Program.call(this);this.predicate=predicate;this.exprs=exprs;this.stx=stx;this.toString=function(){return"("+this.stx[0]+
" "+this.predicate.toString()+" "+this.exprs.toString()+")"}}whenUnlessExpr.prototype=heir(Program.prototype);function symbolExpr(val,stx){Program.call(this);this.val=val;this.stx=stx}symbolExpr.prototype=heir(Program.prototype);function literal(val){Program.call(this);this.val=val;this.toString=function(){if(this.val===true)return"#t";if(this.val===false)return"#f";if(this.val instanceof Char){var c=this.val.val;return c==="\b"?"#\\backspace":c==="\t"?"#\\tab":c==="\n"?"#\\newline":c===" "?"#\\space":
c==="\v"?"#\\vtab":this.val.toWrittenString()}return types.toWrittenString(this.val)}}literal.prototype=heir(Program.prototype);Vector.prototype.toString=Vector.prototype.toWrittenString=function(){var filtered=this.elts.filter(function(e){return e!==undefined}),last=filtered[filtered.length-1];return"#("+this.elts.map(function(elt){return elt===undefined?last:elt})+")"};function quotedExpr(val){Program.call(this);this.val=val;this.toString=function(){function quoteLikePairP(v){return v instanceof
Array&&v.length===2&&v[0]instanceof symbolExpr&&(v[0].val==="quasiquote"||v[0].val==="quote"||v[0].val==="unquote"||v[0].val==="unquote-splicing")}function shortName(lexeme){var s=lexeme.val;return s==="quasiquote"?"`":s==="quote"?"'":s==="unquote"?",":s==="unquote-splicing"?",@":function(){throw"impossible quote-like string";}()}function elementToString(v){if(quoteLikePairP(v))return shortName(v[0]).concat(elementToString(v[1]));else if(v instanceof Array)return v.reduce(function(acc,x){return acc.concat(elementToString(x))},
"(").concat(")");else return v.toString()}return"'"+elementToString(this.val)}}quotedExpr.prototype=heir(Program.prototype);function unquotedExpr(val){Program.call(this);this.val=val;this.toString=function(){return","+this.val.toString()}}unquotedExpr.prototype=heir(Program.prototype);function quasiquotedExpr(val){Program.call(this);this.val=val;this.toString=function(){if(this.val instanceof Array)return"`("+this.val.toString()+")";else return"`"+this.val.toString()}}quasiquotedExpr.prototype=heir(Program.prototype);
function unquoteSplice(val){Program.call(this);this.val=val;this.toString=function(){return",@"+this.val.toString()}}unquoteSplice.prototype=heir(Program.prototype);function requireExpr(spec,stx){Program.call(this);this.spec=spec;this.stx=stx;this.toString=function(){return"(require "+this.spec.toString()+")"}}requireExpr.prototype=heir(Program.prototype);function provideStatement(clauses,stx){Program.call(this);this.clauses=clauses;this.stx=stx;this.toString=function(){return"(provide "+this.clauses.toString()+
")"}}provideStatement.prototype=heir(Program.prototype);function unsupportedExpr(val,errorMsg,errorSpan){Program.call(this);this.val=val;this.errorMsg=errorMsg;this.errorSpan=errorSpan;this.toString=function(){return this.val.toString()}}unsupportedExpr.prototype=heir(Program.prototype);function isExpression(node){return!(node instanceof defVar||node instanceof defVars||node instanceof defStruct||node instanceof defFunc||node instanceof provideStatement||node instanceof unsupportedExpr||node instanceof
requireExpr)}function isDefinition(node){return node instanceof defVar||node instanceof defVars||node instanceof defStruct||node instanceof defFunc}function moduleBinding(name,bindings){this.name=name;this.bindings=bindings}function constantBinding(name,moduleSource,permissions,loc){this.name=name;this.moduleSource=moduleSource;this.permissions=permissions;this.loc=loc;this.toString=function(){return this.name};return this}function functionBinding(name,moduleSource,minArity,isVarArity,permissions,
isCps,loc){this.name=name;this.moduleSource=moduleSource;this.minArity=minArity;this.isVarArity=isVarArity;this.permissions=permissions;this.isCps=isCps;this.loc=loc;this.toString=function(){return this.name};return this}function structBinding(name,moduleSource,fields,constructor,predicate,accessors,mutators,permissions,loc){this.name=name;this.moduleSource=moduleSource;this.fields=fields;this.constructor=constructor;this.predicate=predicate;this.accessors=accessors;this.mutators=mutators;this.permissions=
permissions;this.loc=loc;this.toString=function(){return this.name};return this}var makeHash=types.makeLowLevelEqHash;plt.compiler.keywords=["cond","else","let","case","let*","letrec","quote","quasiquote","unquote","unquote-splicing","local","begin","if","or","and","when","unless","lambda","\u03bb","define","define-struct","define-values"];function env(bindings){var that=this;this.bindings=bindings||makeHash();this.lookup=function(id){return this.bindings.containsKey(id)?this.bindings.get(id):false};
this.peek=function(depth){return depth==0?this:this instanceof emptyEnv?"IMPOSSIBLE - peeked at an emptyEnv!":this.parent.peek(depth-1)};this.contains=function(name){return this.lookup(name)!==false};this.keys=this.bindings.keys;this.extend=function(binding){this.bindings.put(binding.name,binding);return new plt.compiler.env(this.bindings)};this.extendFunction=function(id,moduleSource,minArity,isVarArity,loc){return this.extend(new functionBinding(id,moduleSource,minArity,isVarArity,[],false,loc))};
this.extendConstant=function(id,moduleSource,loc){return this.extend(new constantBinding(id,moduleSource,[],loc))};this.lookup_context=function(id){if(id.context instanceof env)return id.context.contains(id)?id.context.lookup(id):false;else return that.contains(id)?that.lookup(id):false};this.extendEnv_moduleBinding=function(module){return module.bindings.reduceRight(function(env,binding){return env.extend(binding)},this)};this.toString=function(){return this.bindings.values().reduce(function(s,b){return s+
"\n  |---"+b.name},"")}}function emptyEnv(){env.call(this);this.lookup=function(name,depth){return new plt.compiler.unboundStackReference(name)}}emptyEnv.prototype=heir(env.prototype);function unnamedEnv(parent){env.call(this);this.parent=parent;this.lookup=function(name,depth){return this.parent.lookup(name,depth+1)}}unnamedEnv.prototype=heir(env.prototype);function localEnv(name,boxed,parent){env.call(this);this.name=name;this.boxed=boxed;this.parent=parent;this.lookup=function(name,depth){return name===
this.name?new plt.compiler.localStackReference(name,this.boxed,depth):this.parent.lookup(name,depth+1)}}localEnv.prototype=heir(env.prototype);function globalEnv(names,boxed,parent){env.call(this);this.names=names;this.boxed=boxed;this.parent=parent;var that=this;this.lookup=function(name,depth){var pos=this.names.indexOf(name);return pos>-1?new plt.compiler.globalStackReference(name,depth,pos):this.parent.lookup(name,depth+1)}}globalEnv.prototype=heir(env.prototype);var defaultCurrentModulePath=
"";plt.compiler.defaultModuleResolver=function(name){for(var i=0;i<plt.compiler.knownModules.length;i++)if(plt.compiler.knownModules[i].name===name)return plt.compiler.knownModules[i];return false};function levenshteinDistance(a,b){if(a.length===0)return b.length;if(b.length===0)return a.length;var matrix=[];for(var i=0;i<=b.length;i++)matrix[i]=[i];for(var j=0;j<=a.length;j++)matrix[0][j]=j;for(i=1;i<=b.length;i++)for(j=1;j<=a.length;j++)if(b.charAt(i-1)==a.charAt(j-1))matrix[i][j]=matrix[i-1][j-
1];else matrix[i][j]=Math.min(matrix[i-1][j-1]+1,Math.min(matrix[i][j-1]+1,matrix[i-1][j]+1));return matrix[b.length][a.length]}plt.compiler.moduleGuess=function(wrongName){return plt.compiler.knownModules.reduce(function(best,module){var dist=levenshteinDistance(module.name,wrongName);return dist<best.distance?{name:module.name,distance:dist}:best},{name:wrongName,distance:5})};plt.compiler.defaultModulePathResolver=function(path,parentPath){var parts=path.toString().split("/"),collectionName=parts[0],
moduleName=parts.slice(1).join();return plt.compiler.knownCollections.indexOf(collectionName)>-1&&plt.compiler.defaultModuleResolver(path.toString())||/^wescheme\/\w+$/.exec(path)};function pinfo(env,modules,usedBindingsHash,freeVariables,gensymCounter,providedNames,definedNames,sharedExpressions,withLocationEmits,allowRedefinition,moduleResolver,modulePathResolver,currentModulePath,declaredPermissions){this.env=env||new emptyEnv;this.modules=modules||[];this.usedBindingsHash=usedBindingsHash||makeHash();
this.freeVariables=freeVariables||[];this.gensymCounter=gensymCounter||0;this.providedNames=providedNames||makeHash();this.definedNames=definedNames||makeHash();this.sharedExpressions=sharedExpressions||makeHash();this.withLocationEmits=withLocationEmits||true;this.allowRedefinition=allowRedefinition||false;this.moduleResolver=moduleResolver||plt.compiler.defaultModuleResolver;this.modulePathResolver=modulePathResolver||plt.compiler.defaultModulePathResolver;this.currentModulePath=currentModulePath||
defaultCurrentModulePath;this.declaredPermissions=declaredPermissions||[];this.isRedefinition=function(name){return this.env.lookup(name)};this.usedBindings=this.usedBindingsHash.values;this.accumulateDeclaredPermission=function(name,permission){this.declaredPermissions=[[name,permission]].concat(this.declaredPermissions);return this};this.accumulateSharedExpression=function(expression,translation){var labeledTranslation=makeLabeledTranslation(this.gensymCounter,translation);this.sharedExpressions.put(labeledTranslation,
expression);return this};this.accumulateDefinedBinding=function(binding,loc){if(plt.compiler.keywords.indexOf(binding.name)>-1)throwError(new types.Message([new types.ColoredPart(binding.name,binding.loc),": this is a reserved keyword and cannot be used"+" as a variable or function name"]),binding.loc);else if(!this.allowRedefinition&&this.isRedefinition(binding.name)){var prevBinding=this.env.lookup(binding.name);if(prevBinding.loc)throwError(new types.Message([new types.ColoredPart(binding.name,
binding.loc),": this name has a ",new types.ColoredPart("previous definition",prevBinding.loc)," and cannot be re-defined"]),binding.loc);else throwError(new types.Message([new types.ColoredPart(binding.name,binding.loc),": this name has a ","previous definition"," and cannot be re-defined"]),binding.loc)}else{this.env.extend(binding);this.definedNames.put(binding.name,binding);return this}};this.accumulateDefinedBindings=function(bindings,loc){var that=this;bindings.forEach(function(b){that.accumulateDefinedBinding(b,
loc)});return this};this.accumulateModuleBindings=function(bindings){var that=this;bindings.forEach(function(b){that.env.extend(b)});return this};this.accumulateModule=function(module){this.modules=[module].concat(this.modules);return this};this.accumulateBindingUse=function(binding){var alreadyExists=this.usedBindingsHash.get(binding.name);if(!(alreadyExists&&alreadyExists.moduleSource))this.usedBindingsHash.put(binding.name,binding);return this};this.accumulateFreeVariableUse=function(sym){this.freeVariables=
this.freeVariables.indexOf(sym)>-1?this.freeVariables:[sym].concat(this.freeVariables);return this};this.gensym=function(label){return[this,new symbolExpr(label+this.gensymCounter++)]};this.permissions=function(){function onlyUnique(value,index,self){return self.indexOf(value)===index}function reducePermissions(permissions,b){return(b instanceof functionBinding||b instanceof constantBinding)&&b.permissions.length>0?permissions.concat(b.permissions):permissions}return this.usedBindings().reduce(reducePermissions,
[]).filter(onlyUnique)};this.getExposedBindings=function(){var that=this;function lookupProvideBindingInDefinitionBindings(provideBinding){if(!that.definedNames.containsKey(provideBinding.symbl))throwError(new types.Message(["provided-name-not-defined: ",provideBinding.symbl]));var binding=checkBindingCompatibility(binding,that.definedNames.get(provideBinding.symbl));function ref(id){return that.definedNames.get(id)}if(provideBinding instanceof plt.compiler.provideBindingStructId)return[ref(binding.constructor),
ref(binding.predicate)].concat(binding.accessors.map(ref),binding.mutators.map(ref));else return[binding]}function decorateWithPermissions(binding){var bindingEntry=function(entry){return entry[0]===binding.name},filteredPermissions=that.declaredPermissions.filter(bindingEntry);binding.permissions=filteredPermissions.map(function(p){return p[1]});return binding}function checkBindingCompatibility(binding,exportedBinding){if(binding instanceof plt.compiler.provideBindingStructId&&!(exportedBinding instanceof
structBinding))throwError(new types.Message(["provided-structure-not-structure: ",exportedBinding.symbl]));else return exportedBinding}bindings=bindings.reduce(function(acc,b){return acc.concat(lookupProvideBindingInDefinitionBindings(b))},[]);return bindings.map(decorateWithPermissions)};this.toString=function(){var s="pinfo-------------";s+="\n**env****: "+this.env.toString();s+="\n**modules**: "+this.modules.join(",");s+="\n**used bindings**: "+this.usedBindings();s+="\n**free variables**: "+this.freeVariables.join(",");
s+="\n**gensym counter**: "+this.gensymCounter;s+="\n**provided names**: "+this.providedNames.values();s+="\n**defined names**: "+this.definedNames.values();s+="\n**permissions**: "+this.permissions();return s}}function getBasePinfo(language){var baseConstantsEnv=["null","empty","true","false","eof","pi","e","js-undefined","js-null"].reduce(function(env,id){return env.extendConstant(id.toString(),'"moby/toplevel"',false)},new emptyEnv);var pinfo=new plt.compiler.pinfo,topLevelEnv=plt.compiler.topLevelModules.reduceRight(function(env,
mod){return env.extendEnv_moduleBinding(mod)},baseConstantsEnv);if(language==="moby")pinfo.env=topLevelEnv.extendEnv_moduleBinding(mobyModuleBinding);else if(language==="base")pinfo.env=topLevelEnv;return pinfo}plt.compiler.throwError=throwError;plt.compiler.Program=Program;plt.compiler.comment=comment;plt.compiler.couple=couple;plt.compiler.defFunc=defFunc;plt.compiler.defVar=defVar;plt.compiler.defVars=defVars;plt.compiler.defStruct=defStruct;plt.compiler.beginExpr=beginExpr;plt.compiler.lambdaExpr=
lambdaExpr;plt.compiler.localExpr=localExpr;plt.compiler.letrecExpr=letrecExpr;plt.compiler.letExpr=letExpr;plt.compiler.letStarExpr=letStarExpr;plt.compiler.condExpr=condExpr;plt.compiler.caseExpr=caseExpr;plt.compiler.andExpr=andExpr;plt.compiler.orExpr=orExpr;plt.compiler.callExpr=callExpr;plt.compiler.ifExpr=ifExpr;plt.compiler.whenUnlessExpr=whenUnlessExpr;plt.compiler.symbolExpr=symbolExpr;plt.compiler.literal=literal;plt.compiler.quotedExpr=quotedExpr;plt.compiler.unquotedExpr=unquotedExpr;
plt.compiler.quasiquotedExpr=quasiquotedExpr;plt.compiler.unquoteSplice=unquoteSplice;plt.compiler.requireExpr=requireExpr;plt.compiler.provideStatement=provideStatement;plt.compiler.unsupportedExpr=unsupportedExpr;plt.compiler.pinfo=pinfo;plt.compiler.getBasePinfo=getBasePinfo;plt.compiler.isExpression=isExpression;plt.compiler.isDefinition=isDefinition;plt.compiler.env=env;plt.compiler.emptyEnv=emptyEnv;plt.compiler.localEnv=localEnv;plt.compiler.globalEnv=globalEnv;plt.compiler.moduleBinding=moduleBinding;
plt.compiler.functionBinding=functionBinding;plt.compiler.constantBinding=constantBinding;plt.compiler.structBinding=structBinding;plt.compiler.unnamedEnv=unnamedEnv})();goog.provide("plt.compiler.lex");goog.provide("plt.compiler.sexpToString");goog.require("plt.compiler.comment");goog.require("plt.compiler.literal");goog.require("plt.compiler.symbolExpr");goog.require("plt.compiler.unsupportedExpr");goog.require("plt.compiler.throwError");window.plt=window.plt||{};plt.compiler=plt.compiler||{};
(function(){var comment=plt.compiler.comment;var literal=plt.compiler.literal;var symbolExpr=plt.compiler.symbolExpr;var unsupportedExpr=plt.compiler.unsupportedExpr;var throwError=plt.compiler.throwError;var leftListDelims=/[(\u005B\u007B]/,rightListDelims=/[)\u005D\u007D]/,matchUntilDelim=/^[^(\u005B\u007B)\u005D\u007D\s]+/,quotes=/['`,]/,hex2=new RegExp("^([0-9a-f]{1,2})","i"),hex4=new RegExp("^([0-9a-f]{1,4})","i"),hex6=new RegExp("^([0-9a-f]{1,6})","i"),hex8=new RegExp("^([0-9a-f]{1,8})","i"),
oct3=new RegExp("^([0-7]{1,3})","i");var delims,line,column,startCol,startRow,source,caseSensitiveSymbols,i;var endOfError;var Location=function(startCol,startRow,startChar,span,theSource){this.startCol=startCol;this.startRow=startRow;this.startChar=startChar;this.span=span;this.source=theSource||source;this.endCol=column;this.endRow=line;this.endChar=startChar+span;this.start=function(){return new Location("","",this.startChar,1)};this.end=function(){return new Location("","",this.startChar+this.span-
1,1)};this.toString=function(){return"Loc("+this.startCol+", "+this.startRow+", "+(this.startChar+1)+","+this.span+")"};this.toVector=function(){return new types.vector(['"'+this.source+'"',this.startChar+1,this.startRow,this.startCol,this.span])};this.toString=function(){return{line:this.startRow.toString(),id:this.source,span:this.span.toString(),offset:(this.startChar+1).toString(),column:this.startCol.toString()}}};function isWhiteSpace(str){return/\s/.test(str)}function isDelim(x){return x===
"("||x===")"||x==="["||x==="]"||x==="{"||x==="}"}function isValidSymbolCharP(x){return!isDelim(x)&&!isWhiteSpace(x)&&x!=='"'&&x!==","&&x!=="'"&&x!=="`"&&x!==";"}function matchingDelims(x,y){return x==="("&&y===")"||x==="["&&y==="]"||x==="{"&&y==="}"}function otherDelim(x){return x==="("?")":x==="["?"]":x==="{"?"}":x===")"?"(":x==="]"?"[":x==="}"?"{":throwError(new types.Message(["otherDelim: Unknown delimiter: ",x]))}function chewWhiteSpace(str,i){var p;if(i<str.length){p=str.charAt(i);while(isWhiteSpace(p)&&
i<str.length){if(p==="\n"){line++;column=0}else column++;p=str.charAt(++i)}}return i}Array.prototype.toString=function(){return this.join(" ")};function sexpToString(sexp){return sexp instanceof Array?"("+sexp.map(sexpToString).toString()+")":sexp.toString()}function readProg(str,strSource){var i=0;startCol=column=0;startRow=line=1,caseSensitiveSymbols=true;source=strSource||"<definitions>";var sexp,sexps=[];delims=[];i=chewWhiteSpace(str,0);while(i<str.length){sexp=readSExpByIndex(str,i);if(!(sexp instanceof
comment))sexps.push(sexp);i=chewWhiteSpace(str,sexp.location.startChar+sexp.location.span)}sexps.location=new Location(startCol,startRow,0,i,source);return sexps}function readSSFile(str,strSource){var i=0;startCol=column=0;startRow=line=1,caseSensitiveSymbols=true;source=strSource||"<definitions>";var crs=0;while(i<str.length&&crs<3)if(str.charAt(i++)==="\n")crs++;var sexp,sexps=[];delims=[];while(i<str.length){sexp=readSExpByIndex(str,i);if(!(sexp instanceof comment))sexps.push(sexp);i=chewWhiteSpace(str,
sexp.location.startChar+sexp.location.span)}return sexps}function readSExp(str,source){delims=[];var sexp=readSExpByIndex(str,0);return sexp instanceof comment?null:sexp}function readSExpByIndex(str,i){startCol=column;startRow=line;var iStart=i;i=chewWhiteSpace(str,i);var p=str.charAt(i);if(i>=str.length){endOfError=i;throwError(new types.Message([source,":",startRow.toString(),":",(startCol-1).toString(),": read: (found end-of-file)"]),new Location(startCol-1,startRow,i-2,2),"Error-GenericReadError")}var sexp=
rightListDelims.test(p)?throwError(new types.Message(["read: expected an open '",otherDelim(p),"' to open ",new types.ColoredPart(" "+p+" ",new Location(column,startRow,iStart,1))]),new Location(column,startRow,iStart,1)):leftListDelims.test(p)?readList(str,i):p==='"'?readString(str,i):p==="#"?readPoundSExp(str,i):p===";"?readLineComment(str,i):quotes.test(p)?readQuote(str,i):readSymbolOrNumber(str,i);return sexp}function readList(str,i){var startCol=column,startRow=line,iStart=i,innerError=false,
errorLocation=new Location(startCol,startRow,iStart,1),openingDelim=str.charAt(i++),dot1Idx=false,dot2Idx=false;column++;var sexp,list=[];delims.push(openingDelim);i=chewWhiteSpace(str,i);function readListItem(str,i,list){var sexp=readSExpByIndex(str,i);i=sexp.location.end().startChar+1;if(sexp instanceof symbolExpr&&sexp.val=="."){if(dot2Idx){var msg=new types.Message(["A syntax list may have only 2 `.'s"]);throwError(msg,list[dot1Idx].location)}dot2Idx=dot1Idx?list.length:false;dot1Idx=dot1Idx||
list.length}if(!(sexp instanceof comment)){sexp.parent=list;list.push(sexp)}return i}function processDots(list,dot1Idx,dot2Idx){if(dot1Idx===0){var msg=new types.Message(["A `.' cannot be the first element in a syntax list"]);throwError(msg,list[dot1Idx].location)}if(dot1Idx===list.length-1||dot2Idx===list.length-1){var msg=new types.Message(["A `.' cannot be the last element in a syntax list"]);throwError(msg,list[dot2Idx||dot1Idx].location)}if(dot2Idx)if(dot2Idx-dot1Idx!==2){var msg=new types.Message(["Two `.'s may only surround one syntax item"]);
throwError(msg,list[dot2Idx].location)}else return list.slice(dot1Idx+1,dot1Idx+2).concat(list.slice(0,dot1Idx),list.slice(dot2Idx+1));if(!(list[dot1Idx+1]instanceof Array)){var msg=new types.Message(["A `.' must be followed by a syntax list, but found ",new types.ColoredPart("something else",list[dot1Idx+1].location)]);throwError(msg,list[dot1Idx+1].location)}if(list.length>dot1Idx+2){var msg=new types.Message(["A `.' followed by a syntax list must be followed by a closing delimeter, but found ",
new types.ColoredPart("something else",list[dot1Idx+2].location)]);throwError(msg,list[dot1Idx+1].location)}else return list.slice(0,dot1Idx).concat(list[dot1Idx+1],list.slice(dot1Idx+2))}function handleError(e){if(/expected a .+ to (close|open)/.exec(e)||/unexpected/.exec(e)||/syntax list/.exec(e)||/bad syntax/.exec(e)||/bad character constant/.exec(e))throw e;else{var eLoc=JSON.parse(JSON.parse(e)["structured-error"]).location;errorLocation=new Location(Number(eLoc.column),Number(eLoc.line),Number(eLoc.offset)-
1,Number(eLoc.span));i=endOfError;innerError=e}return i}while(i<str.length&&!rightListDelims.test(str.charAt(i))){if(str.charAt(i)==="\n"){line++;column=0}try{i=readListItem(str,i,list)}catch(e){var i=handleError(e)}i=chewWhiteSpace(str,i)}if(i>=str.length){var msg=new types.Message(["read: expected a closing '",otherDelim(openingDelim),"' to close ",new types.ColoredPart(" "+openingDelim.toString()+" ",new Location(startCol,startRow,iStart,1))]);throwError(msg,errorLocation)}if(!matchingDelims(openingDelim,
str.charAt(i))){var msg=new types.Message(["read: expected a closing '",otherDelim(openingDelim),"' to close ",new types.ColoredPart(" "+openingDelim.toString()+" ",new Location(startCol,startRow,iStart,1))," but found a ",new types.ColoredPart(" "+str.charAt(i).toString()+" ",new Location(column,line,i,1))]);throwError(msg,new Location(column,line,i,1))}column++;i++;if(innerError){endOfError=i;throw innerError;}if(dot1Idx||dot2Idx)list=processDots(list,dot1Idx,dot2Idx);list.location=new Location(startCol,
startRow,iStart,i-iStart);return list}function readString(str,i){var startCol=column,startRow=line,iStart=i;var closedString=/^"[^"]*(\\"[^"]*)*[^\\]"|""/.test(str.slice(i)),greedy=/^"[^"]*(\\"[^"]*)*/.exec(str.slice(iStart))[0];i++;column++;var chr,datum="";while(i<str.length&&str.charAt(i)!=='"'){chr=str.charAt(i++);if(chr==="\n"){line++;column=0}else column++;if(chr==="\\"){column++;chr=str.charAt(i++);if(i>=str.length)break;switch(true){case /a/.test(chr):chr="\u0007";break;case /b/.test(chr):chr=
"\b";break;case /t/.test(chr):chr="\t";break;case /n/.test(chr):chr="\n";break;case /v/.test(chr):chr="\v";break;case /f/.test(chr):chr="\f";break;case /r/.test(chr):chr="\r";break;case /e/.test(chr):chr="'";break;case /\n/.test(chr):chr="";break;case /["'\\]/.test(chr):break;case /[xuU]/.test(chr):var regexp=chr==="x"?hex2:chr==="u"?hex4:hex8;if(!regexp.test(str.slice(i))){endOfError=iStart+greedy.length+1;throwError(new types.Message([source,":",startRow.toString(),":",startCol.toString(),": read: no hex digit following \\"+
chr+" in string"]),new Location(startCol,startRow,iStart,i-iStart+1),"Error-GenericReadError")}var match=regexp.exec(str.slice(i))[1];chr=String.fromCharCode(parseInt(match,16));i+=match.length;column+=match.length;break;case oct3.test(str.slice(i-1)):var match=oct3.exec(str.slice(i-1))[1];chr=String.fromCharCode(parseInt(match,8));i+=match.length-1;column+=match.length-1;break;default:endOfError=iStart+greedy.length+1;throwError(new types.Message([source,":",startRow.toString(),":",startCol.toString(),
": read: unknown escape sequence \\"+chr+" in string"]),new Location(startCol,startRow,iStart,i-iStart),"Error-GenericReadError")}}datum+=chr}if(!closedString){endOfError=iStart+greedy.length;throwError(new types.Message([source,":",startRow.toString(),":",startCol.toString(),": read: expected a closing '\"'"]),new Location(startCol,startRow,iStart,1),"Error-GenericReadError")}var strng=new literal(new types.string(datum));i++;column++;strng.location=new Location(startCol,startRow,iStart,i-iStart);
return strng}function readPoundSExp(str,i){var startCol=column,startRow=line,iStart=i,datum;i++;column++;var unsupportedError;function throwUnsupportedError(errorStr,token){var msg=new types.Message([source,":",line.toString(),":",(column-1).toString(),errorStr]);throwError(msg,new Location(startCol,startRow,iStart,token.length+1),"Error-GenericReadError")}if(i<str.length){var p=str.charAt(i).toLowerCase();var unsupportedMatch=new RegExp('^(((fl|fx|s|hash|hasheq)[[({])|((rx|px)#{0,1}"))',"g"),unsupportedTest=
unsupportedMatch.exec(str.slice(i));var badExtensionMatch=/^(!(?!\/)|reader|lang[\s]{0,1})/,badExtensionTest=badExtensionMatch.exec(str.slice(i));var caseSensitiveMatch=new RegExp("^(c|C)(i|I|s|S)"),caseSensitiveTest=caseSensitiveMatch.exec(str.slice(i));var vectorMatch=new RegExp("^([0-9]*)[[({]","g"),vectorTest=vectorMatch.exec(str.slice(i));if(unsupportedTest&&unsupportedTest[0].length>0){var sexp=readSExpByIndex(str,i+unsupportedTest[0].length-1),kind,span=unsupportedTest[0].length,base=unsupportedTest[0].replace(/[\(\[\{"|#"]/g,
"");switch(base){case "fl":kind="flvectors";break;case "fx":kind="fxvectors";break;case "s":kind="structs";break;case "hash":case "hasheq":kind="hashtables";break;case "px":case "rx":kind="regular expressions";break;default:throw"IMPOSSIBLE: unsupportedMatch captured something it shouldn't: "+base;}var error=new types.Message([source,":",line.toString(),":","0",": read-syntax: literal "+kind+" not allowed"]);datum=new unsupportedExpr(sexp,error,span);datum.location=new Location(startCol,startRow,
iStart,unsupportedTest[0].length+sexp.location.span);return datum}else if(badExtensionTest&&badExtensionTest[0].length>0)throwUnsupportedError(": read: #"+badExtensionTest[0].trim()+" not enabled in the current context",badExtensionTest[0]);else if(caseSensitiveTest&&caseSensitiveTest[0].length>0){caseSensitiveSymbols=caseSensitiveTest[0].toLowerCase()==="cs";i+=2;column+=2;return readSExpByIndex(str,i)}else if(vectorTest&&vectorTest[0].length>0){var size=vectorTest[1]?parseInt(vectorTest[1]):"",
sizeChars=size.toString().length;i+=sizeChars;column+=sizeChars;var elts=readList(str,i),len=size===""?elts.length:parseInt(vectorTest[1]);if(elts.length>len){var msg=new types.Message(["read: vector length "+len+" is too small, ",elts.length+" value"+(elts.length>1?"s":"")," provided"]);throwError(msg,new Location(startCol,startRow,iStart,vectorTest[0].length))}i+=elts.location.span;datum=new literal(new Vector(len,elts));datum.location=new Location(startCol,startRow,iStart,i-iStart);return datum}else{var poundChunk=
new RegExp("^(hasheq|hash|fl|fx|\\d+|true|false|[tfeibdox]|\\<\\<|[\\\\\\\"\\%\\:\\&\\|\\;\\!\\`\\,\\']|)","i"),chunk=poundChunk.exec(str.slice(i))[0],nextChar=str.charAt(i+chunk.length);var p=chunk.charAt(0).toLowerCase();switch(p){case "\\":datum=readChar(str,i-1);i+=datum.location.span-1;break;case '"':throwUnsupportedError(": byte strings are not supported in WeScheme",'#"');case "%":datum=readSymbolOrNumber(str,i);datum.val="#"+datum.val;i+=datum.location.span;break;case ":":datum=readSymbolOrNumber(str,
i-1);var error=new types.Message([source,":",line.toString(),":","0",": read-syntax: Keyword internment is not supported in WeScheme"]);datum=new unsupportedExpr(datum.val,error,datum.location.span);i+=datum.val.length-1;break;case "&":column++;sexp=readSExpByIndex(str,i+1);var boxCall=new symbolExpr("box"),datum=[boxCall,sexp];i+=sexp.location.span+1;boxCall.location=new Location(startCol,startRow,iStart,i-iStart);break;case "|":i--;datum=readBlockComment(str,i);i+=datum.location.span+1;break;case ";":datum=
readSExpComment(str,i+1);i+=datum.location.span+1;break;case "!":datum=readLineComment(str,i-1);i+=datum.location.span;break;case "`":case ",":case "'":datum=readQuote(str,i);datum.location.startChar--;datum.location.span++;endOfError=i+datum.location.span;var msg=new types.Message([source,":",startRow.toString(),":",(column-1).toString()," read: WeScheme does not support the '#"+p+"' notation for ",p===","?"unsyntax":p==="'"?"syntax":"quasisyntax"]);throwError(msg,datum.location);break;case "<<":datum=
readString(str,i-1);i+=datum.location.span;break;case "e":case "i":case "b":case "o":case "d":case "x":column--;datum=readSymbolOrNumber(str,i-1);i+=datum.location.span-1;break;case "true":case "false":case "t":case "f":if(!matchUntilDelim.exec(nextChar)){datum=new literal(p==="t"||chunk==="true");i+=chunk.length;column+=chunk.length;break}default:endOfError=i;var msg=new types.Message([source,":",line.toString(),":",(column-1).toString(),": read: bad syntax `#",chunk+nextChar,"'"]);throwError(msg,
new Location(startCol,startRow,iStart,(chunk+nextChar).length+1),"Error-GenericReadError")}}}else{endOfError=i;throwError(new types.Message([source,":",line.toString(),":",(column-1).toString(),": read: bad syntax `#'"]),new Location(startCol,startRow,iStart,i-iStart),"Error-GenericReadError")}datum.location=new Location(startCol,startRow,iStart,i-iStart);return datum}function readChar(str,i){var startCol=column,startRow=line,iStart=i;i+=2;column++;var datum="",isFirstChar=true,regexp;while(i<str.length&&
str.slice(i,i+2)!=="#\\"&&!(!isFirstChar&&(isWhiteSpace(str.charAt(i))||isDelim(str.charAt(i))))){isFirstChar=false;column++;datum+=str.charAt(i++)}var special=new RegExp("(backspace|tab|newline|space|vtab)[^a-zA-Z]*","i"),match=special.exec(datum);if(special.test(datum)){datum=datum==="backspace"?"\b":datum==="tab"?"\t":datum==="newline"?"\n":datum==="space"?" ":datum==="vtab"?"\v":"Impossible: unknown special char was matched by special char!";i=iStart+2+match[1].length}else if(/^[0-9].*/.test(datum)&&
oct3.test(datum)&&oct3.exec(datum)[0]===datum&&parseInt(oct3.exec(datum)[0],8)<256&&parseInt(oct3.exec(datum)[0],8)>31){var match=/[0-7]+/.exec(datum)[0];datum=String.fromCharCode(parseInt(match,8));i=iStart+2+match.length}else if(/[uU]/.test(datum)&&(regexp=datum.charAt(0)==="u"?hex4:hex6)&&regexp.test(datum.slice(1))){var match=regexp.exec(datum.slice(1))[0];column+=match.length-datum.length+1;datum=String.fromCharCode(parseInt(match,16));i=iStart+3+match.length}else if(datum.length===1||/[^\u00C0-\u1FFF\u2C00-\uD7FF\w]$/.test(datum.charAt(1))){datum=
datum.charAt(0);i=iStart+3}else throwError(new types.Message([source,":",startRow.toString(),":",(startCol-1).toString(),": read: bad character constant: #\\",datum]),new Location(startCol-1,startRow,iStart,i-iStart),"Error-GenericReadError");var chr=new literal(new types["char"](datum));chr.location=new Location(startCol,startRow,iStart,i-iStart);return chr}function readBlockComment(str,i){var startCol=column,startRow=line,iStart=i;i+=2;column+=2;var txt="";while(i+1<str.length&&!(str.charAt(i)===
"|"&&str.charAt(i+1)==="#")){if(str.charAt(i)==="\n"){line++;column=0}txt+=str.charAt(i);i++;column++}if(i+1>=str.length)throwError(new types.Message(["read: Unexpected EOF when reading a multiline comment"]),new Location(startCol,startRow,iStart,i-iStart));i++;column++;var cmmt=new comment(txt);cmmt.location=new Location(startCol,startRow,iStart,i-iStart);return cmmt}function readSExpComment(str,i){var startCol=column++,startRow=line,iStart=i,nextSExp;while((i=chewWhiteSpace(str,i))&&i+1<str.length&&
(nextSExp=readSExpByIndex(str,i))&&nextSExp instanceof comment)i=nextSExp.location.endChar;if(i+1>=str.length){endOfError=i;throwError(new types.Message([source,":",startRow.toString(),":",(startCol-1).toString(),": read: expected a commented-out element for `#;' (found end-of-file)"]),new Location(startCol-1,startRow,i-2,2),"Error-GenericReadError")}var atom=new comment("("+nextSExp.toString()+")");i=nextSExp.location.endChar;atom.location=new Location(startCol,startRow,iStart,i-iStart);return atom}
function readLineComment(str,i){var startCol=column,startRow=line,iStart=i;i++;column++;var txt="";while(i<str.length&&str.charAt(i)!=="\n"){txt+=str.charAt(i);column++;i++}if(i>str.length){endOfError=i;throwError(new types.Message(["read: Unexpected EOF when reading a line comment"]),new Location(startCol,startRow,iStart,i-iStart))}var atom=new comment(txt);atom.location=new Location(startCol,startRow,iStart,i+1-iStart);line++;column=0;return atom}function readQuote(str,i){var startCol=column,startRow=
line,iStart=i,nextSExp;var p=str.charAt(i);var symbol=p=="'"?new symbolExpr("quote"):p=="`"?new symbolExpr("quasiquote"):"";function eofError(i){endOfError=i+1;var action=p=="'"?" quoting ":p=="`"?" quasiquoting ":p==","?" unquoting ":p==",@"?" unquoting ":"";throwError(new types.Message([source,":",startRow.toString(),":",startCol.toString(),": read: expected an element for"+action,p," (found end-of-file)"]),new Location(startCol,startRow,iStart,p.length),"Error-GenericReadError")}if(i+1>=str.length)eofError(i);
i++;column++;if(p==",")if(str.charAt(i)=="@"){i++;column++;p+="@";symbol=new symbolExpr("unquote-splicing")}else symbol=new symbolExpr("unquote");symbol.location=new Location(column-1,startRow,iStart,i-iStart);while(!nextSExp||nextSExp instanceof comment){i=chewWhiteSpace(str,i);try{nextSExp=readSExpByIndex(str,i)}catch(e){if(/read: \(found end-of-file\)/.test(e))eofError(i);var unexpected=/expected a .* to open ","(.)"/.exec(e);if(unexpected){endOfError=i+1;throwError(new types.Message([source,":",
line.toString(),":",column.toString(),": read: unexpected `"+unexpected[1]+"'"]),new Location(column,line,i,1),"Error-GenericReadError")}throw e;}i=nextSExp.location.end().startChar+1}var quotedSexp=[symbol,nextSExp],quotedSpan=nextSExp.location.end().startChar+1-iStart;quotedSexp.location=new Location(startCol,startRow,iStart,quotedSpan);return quotedSexp}function readSymbolOrNumber(str,i){var startCol=column,startRow=line,iStart=i;var symOrNum=new RegExp("(\\|(.|\\n)*\\||\\\\(.|\\n)|[^\\(\\)\\{\\}\\[\\]\\,\\'\\`\\s\\\"\\;])+",
"mg");var chunk=symOrNum.exec(str.slice(i))[0];var trailingEscs=/\.*\\+$/.exec(chunk);if(trailingEscs&&trailingEscs[0].length%2>0){i=str.length;endOfError=i;throwError(new types.Message([source,":",line.toString(),":",startCol.toString(),": read: EOF following `\\' in symbol"]),new Location(startCol,startRow,iStart,i-iStart),"Error-GenericReadError")}i+=chunk.length;column+=chunk.length;var unescaped="";for(var j=0;j<chunk.length;j++){if(chunk.charAt(j)=="\\")j++;unescaped+=chunk.charAt(j)}var chunks=
unescaped.split("|");if(chunks.length%2===0){endOfError=str.length;var sizeOfLastChunk=chunks[chunks.length-1].length+1,strBeforeLastChunk=chunk.slice(0,chunk.length-sizeOfLastChunk),lastVerbatimMarkerIndex=iStart+strBeforeLastChunk.length;column=startCol;for(var j=0;j<strBeforeLastChunk.length;j++)if(str.charAt(i)==="\n"){line++;column=0}else column++;throwError(new types.Message([source,":",line.toString(),":",column.toString(),": read: unbalanced `|'"]),new Location(column,line,lastVerbatimMarkerIndex,
str.length-lastVerbatimMarkerIndex),"Error-GenericReadError")}var filtered=chunks.reduce(function(acc,str,i){return acc+=i%2||caseSensitiveSymbols?str:str.toLowerCase()},"");if(filtered==="\n"){line++;column=0}var special_chars=new RegExp("^$|[\\(\\)\\{\\}\\[\\]\\,\\'\\`\\s\\\"\\\\]","g");var escaped_nums=new RegExp("^.*\\\\[\\d]*.*|\\|[\\d]*\\|");filtered=escaped_nums.test(chunk)||special_chars.test(filtered)?"|"+filtered+"|":filtered;var node=new symbolExpr(filtered);if(chunks.length===1&&!/^[a-zA-Z\-\?]+$/.test(filtered))try{var numValue=
jsnums.fromString(filtered,true);if(numValue||numValue===0){if(numValue instanceof Object){numValue.stx=filtered;numValue.location=new Location(startCol,startRow,iStart,i-iStart)}node=new literal(numValue)}}catch(e){endOfError=i;var msg=new types.Message([source,":",startRow.toString(),":",startCol.toString(),": read: "+e.message]);throwError(msg,new Location(startCol,startRow,iStart,i-iStart),"Error-GenericReadError")}node.stx=filtered;node.location=new Location(startCol,startRow,iStart,i-iStart);
return node}plt.compiler.lex=function(str,strSource,debug){var start=(new Date).getTime();try{var sexp=readProg(str,strSource)}catch(e){console.log("LEXING ERROR");throw e;}var end=(new Date).getTime();if(debug){console.log("Lexed in "+Math.floor(end-start)+"ms");console.log(sexp);console.log(sexpToString(sexp))}return sexp};plt.compiler.sexpToString=sexpToString})();goog.provide("plt.compiler.parse");goog.require("plt.compiler.literal");goog.require("plt.compiler.symbolExpr");goog.require("plt.compiler.Program");goog.require("plt.compiler.couple");goog.require("plt.compiler.ifExpr");goog.require("plt.compiler.beginExpr");goog.require("plt.compiler.letExpr");goog.require("plt.compiler.letStarExpr");goog.require("plt.compiler.letrecExpr");goog.require("plt.compiler.localExpr");goog.require("plt.compiler.andExpr");goog.require("plt.compiler.orExpr");goog.require("plt.compiler.condExpr");
goog.require("plt.compiler.caseExpr");goog.require("plt.compiler.lambdaExpr");goog.require("plt.compiler.quotedExpr");goog.require("plt.compiler.unquotedExpr");goog.require("plt.compiler.quasiquotedExpr");goog.require("plt.compiler.unquoteSplice");goog.require("plt.compiler.callExpr");goog.require("plt.compiler.whenUnlessExpr");goog.require("plt.compiler.defFunc");goog.require("plt.compiler.defVar");goog.require("plt.compiler.defVars");goog.require("plt.compiler.defStruct");goog.require("plt.compiler.requireExpr");
goog.require("plt.compiler.provideStatement");goog.require("plt.compiler.unsupportedExpr");goog.require("plt.compiler.throwError");window.plt=window.plt||{};plt.compiler=plt.compiler||{};
(function(){var literal=plt.compiler.literal;var symbolExpr=plt.compiler.symbolExpr;var Program=plt.compiler.Program;var couple=plt.compiler.couple;var ifExpr=plt.compiler.ifExpr;var beginExpr=plt.compiler.beginExpr;var letExpr=plt.compiler.letExpr;var letStarExpr=plt.compiler.letStarExpr;var letrecExpr=plt.compiler.letrecExpr;var localExpr=plt.compiler.localExpr;var andExpr=plt.compiler.andExpr;var orExpr=plt.compiler.orExpr;var condExpr=plt.compiler.condExpr;var caseExpr=plt.compiler.caseExpr;var lambdaExpr=
plt.compiler.lambdaExpr;var quotedExpr=plt.compiler.quotedExpr;var unquotedExpr=plt.compiler.unquotedExpr;var quasiquotedExpr=plt.compiler.quasiquotedExpr;var unquoteSplice=plt.compiler.unquoteSplice;var callExpr=plt.compiler.callExpr;var whenUnlessExpr=plt.compiler.whenUnlessExpr;var defFunc=plt.compiler.defFunc;var defVar=plt.compiler.defVar;var defVars=plt.compiler.defVars;var defStruct=plt.compiler.defStruct;var requireExpr=plt.compiler.requireExpr;var provideStatement=plt.compiler.provideStatement;
var unsupportedExpr=plt.compiler.unsupportedExpr;var throwError=plt.compiler.throwError;function isVector(x){return types.isVector(x.val)}function isString(x){return types.isString(x.val)}function isSymbol(x){return x instanceof symbolExpr}function isLiteral(x){return x instanceof literal}function isUnsupported(x){return x instanceof unsupportedExpr}function isCons(x){return x instanceof Array&&x.length>=1}function rest(ls){return ls.slice(1)}function isSymbolEqualTo(x,y){x=x instanceof symbolExpr?
x.val:x;y=y instanceof symbolExpr?y.val:y;return x===y}function parseStar(sexps){function parseSExp(sexp){return isDefinition(sexp)?parseDefinition(sexp):isExpr(sexp)?parseExpr(sexp):isRequire(sexp)?parseRequire(sexp):isProvide(sexp)?parseProvide(sexp):throwError(new types.Message(["Not a Definition, Expression, Library Require, or Provide"]),sexp.location)}return sexps.map(parseSExp)}function parse(sexp){return sexp.length===0?[]:!isCons(sexp)?throwError(new types.Message(["The sexp is not a list of definitions or expressions: "+
sexp]),sexp.location):parseStar(sexp)}function isStructDefinition(sexp){return isCons(sexp)&&isSymbol(sexp[0])&&isSymbolEqualTo("define-struct",sexp[0])}function isOldDefinition(sexp){return isCons(sexp)&&isSymbol(sexp[0])&&isSymbolEqualTo("define",sexp[0])}function isValueDefinition(sexp){return isCons(sexp)&&isSymbol(sexp[0])&&isSymbolEqualTo("define-val",sexp[0])}function isFunDefinition(sexp){return isCons(sexp)&&isSymbol(sexp[0])&&isSymbolEqualTo("define-fun",sexp[0])}function isMultiValueDefinition(sexp){return isCons(sexp)&&
isSymbol(sexp[0])&&isSymbolEqualTo("define-values",sexp[0])}function isDefinition(sexp){return isStructDefinition(sexp)||isOldDefinition(sexp)||isMultiValueDefinition(sexp)||isValueDefinition(sexp)||isFunDefinition(sexp)}function parseDefinition(sexp){function parseDefStruct(sexp){if(sexp.length<2)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected the structure name after define-struct, but nothing's there"]),sexp.location);if(!(sexp[1]instanceof symbolExpr))throwError(new types.Message([new types.ColoredPart(sexp[0].val,
sexp[0].location),": expected the structure name after define-struct, but found ",new types.ColoredPart("something else",sexp[1].location)]),sexp.location);if(sexp.length<3)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected at least one field name (in parentheses) after the ",new types.ColoredPart("structure name",sexp[1].location),", but nothing's there"]),sexp.location);if(!(sexp[2]instanceof Array))throwError(new types.Message([new types.ColoredPart(sexp[0].val,
sexp[0].location),": expected at least one field name (in parentheses) after the ",new types.ColoredPart("structure name",sexp[1].location),", but found ",new types.ColoredPart("something else",sexp[2].location)]),sexp.location);sexp[2].forEach(function(arg){if(!(arg instanceof symbolExpr))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a field name, but found ",new types.ColoredPart("something else",arg.location)]),sexp.location)});if(sexp.length>3){var extraLocs=
sexp.slice(3).map(function(sexp){return sexp.location}),wording1=sexp[2].length===1?"field name":"field names",wording2=extraLocs.length+" extra "+(extraLocs.length===1?"part":"parts");throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected nothing after the ",new types.ColoredPart(wording1,sexp[2].location),", but found ",new types.MultiPart(wording2,extraLocs,false)]),sexp.location)}return new defStruct(parseIdExpr(sexp[1]),sexp[2].map(parseIdExpr),sexp)}function parseMultiDef(sexp){if(sexp.length<
2)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expects a list of variables and a body, but found neither"]),sexp.location);if(sexp.length<3)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expects a list of variables and a body, but found only ",new types.ColoredPart("one part",sexp[1].location)]),sexp.location);if(!(sexp[1]instanceof Array))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),
": expects a list of variables and a body, but found ",new types.ColoredPart("something else",sexp[1].location)]),sexp.location);if(sexp.length>3){var extraLocs=sexp.slice(3).map(function(sexp){return sexp.location}),wording=extraLocs.length+" extra "+(extraLocs.length===1?"part":"parts"),msg=new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expects a list of variables and a body"+", but found ",new types.MultiPart(wording,extraLocs,false)]);throwError(msg,sexp.location)}return new defVars(sexp[1].map(parseIdExpr),
parseExpr(sexp[2]),sexp)}function parseOldDef(sexp){if(sexp.length!==3){var extraLocs=sexp.slice(1).map(function(sexp){return sexp.location});var wording=sexp.length<4?" fewer than two":new types.MultiPart("more than two parts",extraLocs,false);throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected exactly two parts for the definition: a name"+" (or a function name and its variables) and an expression"+", but found",wording]),sexp.location)}if(sexp.length>3){var extraLocs=
sexp.slice(1).map(function(sexp){return sexp.location}),wording=extraLocs.length+" parts";throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected exactly two parts, but found",new types.MultiPart(wording,extraLocs,false)]),sexp.location)}if(sexp[1]instanceof Array){if(sexp[1].length===0)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected at least a function name within ",new types.ColoredPart("the parentheses",sexp[1].location)]),
sexp.location);if(!(sexp[1][0]instanceof symbolExpr))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a function name after the open parenthesis but found ",new types.ColoredPart("something else",sexp[1][0].location)]),sexp.location);sexp[1].forEach(function(arg){if(!(arg instanceof symbolExpr))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a variable name but found ",new types.ColoredPart("something else",
arg.location)]),sexp.location)});if(sexp.length<3)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected an expression for the function body, but nothing's there"]),sexp.location);var args=rest(sexp[1]).map(parseIdExpr);args.location=sexp[1].location;return new defFunc(parseIdExpr(sexp[1][0]),args,parseExpr(sexp[2]),sexp)}if(sexp[1]instanceof symbolExpr){if(sexp.length<3)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected an expression after the variable ",
new types.ColoredPart(sexp[1].val,sexp[1].location)," but nothing's there"]),sexp.location);return new defVar(parseIdExpr(sexp[1]),parseExpr(sexp[2]),sexp)}throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a name (or a function name and its variables) "," and an expression, but found",new types.ColoredPart("something else",sexp[1].location)]),sexp.location)}function parseValueDef(sexp){if(sexp.length!==3){var extraLocs=sexp.slice(1).map(function(sexp){return sexp.location});
var wording=sexp.length<4?" fewer than two":new types.MultiPart("more than two parts",extraLocs,false);throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected exactly two parts for the value: a name and an expression"+", but found",wording]),sexp.location)}if(sexp[1]instanceof symbolExpr){if(sexp.length<3)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected an expression after the name ",new types.ColoredPart(sexp[1].val,
sexp[1].location)," but nothing's there"]),sexp.location);return new defVar(parseIdExpr(sexp[1]),parseExpr(sexp[2]),sexp)}throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a name but found ",new types.ColoredPart("something else",sexp[1].location)]),sexp.location)}function parseFunDef(sexp){if(sexp.length!==3){var extraLocs=sexp.slice(1).map(function(sexp){return sexp.location});var wording=sexp.length<4?" fewer than two":new types.MultiPart("more than two parts",
extraLocs,false);throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected exactly two parts for the function: a header "+"(function name and variables, in parentheses) and a "+"body (any expression), but found",wording]),sexp.location)}if(sexp[1]instanceof Array){if(sexp[1].length===0)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected at least a function name within ",new types.ColoredPart("the parentheses",sexp[1].location)]),
sexp.location);if(!(sexp[1][0]instanceof symbolExpr))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a function name after the open parenthesis but found ",new types.ColoredPart("something else",sexp[1][0].location)]),sexp.location);sexp[1].forEach(function(arg){if(!(arg instanceof symbolExpr))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a variable name, but found ",new types.ColoredPart("something else",
arg.location)]),sexp.location)});if(sexp.length<3)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected an expression for the function body after ",new types.ColoredPart("the header",sexp[1].location,false),", but nothing's there"]),sexp.location);var args=rest(sexp[1]).map(parseIdExpr);args.location=sexp[1].location;return new defFunc(parseIdExpr(sexp[1][0]),args,parseExpr(sexp[2]),sexp)}throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),
": expected a header (function name and variables, in parentheses)"+" and a body for the function"]),sexp.location)}var def=isStructDefinition(sexp)?parseDefStruct(sexp):isOldDefinition(sexp)?parseOldDef(sexp):isMultiValueDefinition(sexp)?parseMultiDef(sexp):isValueDefinition(sexp)?parseValueDef(sexp):isFunDefinition(sexp)?parseFunDef(sexp):throwError(new types.Message([": expected to find a definition, but found: "+sexp]),sexp.location);def.location=sexp.location;return def}function isExpr(sexp){return!isDefinition(sexp)&&
!isRequire(sexp)&&!isProvide(sexp)}function parseExpr(sexp){return isCons(sexp)?parseExprList(sexp):parseExprSingleton(sexp)}function parseExprList(sexp){function parseFuncCall(sexp){if(isSymbolEqualTo(sexp[0],"unquote"))throwError(new types.Message(["misuse of a comma or 'unquote, not under a quasiquoting backquote"]),sexp.location,"Error-GenericSyntacticError");if(isSymbolEqualTo(sexp[0],"unquote-splicing"))throwError(new types.Message(["misuse of a ,@ or unquote-splicing, not under a quasiquoting backquote"]),
sexp.location,"Error-GenericSyntacticError");if(isSymbolEqualTo(sexp[0],"else"))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp.location),": not allowed ",new types.ColoredPart("here",sexp.location),", because this is not a question in a clause"]),sexp.location);return isCons(sexp)?new callExpr(parseExpr(sexp[0]),rest(sexp).map(parseExpr),sexp[0]):throwError(new types.Message(["function call sexp"]),sexp.location)}function parseLambdaExpr(sexp){if(sexp.length===1)throwError(new types.Message([new types.ColoredPart(sexp[0].val,
sexp[0].location),": expected at least one variable (in parentheses) after lambda, but nothing's there"]),sexp.location);if(!(sexp[1]instanceof Array))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected at least one variable (in parentheses) after lambda, but found ",new types.ColoredPart("something else",sexp[1].location)]),sexp.location);sexp[1].forEach(function(arg){if(!(arg instanceof symbolExpr)){var msg=new types.Message([new types.ColoredPart(sexp[0].val,
sexp[0].location),": expected a list of variables after lambda, but found ",new types.ColoredPart("something else",arg.location)]);throwError(msg,sexp.location)}});if(sexp.length===2)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected an expression for the function body, but nothing's there"]),sexp.location);if(sexp.length>3){var extraLocs=sexp.slice(3).map(function(sexp){return sexp.location}),wording=extraLocs.length+" extra "+(extraLocs.length===1?"part":
"parts"),msg=new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected only one expression for the function body, but found ",new types.MultiPart(wording,extraLocs,false)]);throwError(msg,sexp.location)}var args=sexp[1].map(parseIdExpr);args.location=sexp[1].location;return new lambdaExpr(args,parseExpr(sexp[2]),sexp[0])}function parseLocalExpr(sexp){if(sexp.length===1)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected at least one definition (in square brackets) after local,"+
" but nothing's there"]),sexp.location);if(!(sexp[1]instanceof Array))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a collection of definitions, but given ",new types.ColoredPart("something else",sexp[1].location)]),sexp[1].location);sexp[1].forEach(function(def){if(!isDefinition(def))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a definition, but given ",new types.ColoredPart("something else",def.location)]),
def.location)});if(sexp.length===2)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a single body, but found none"]),sexp.location);if(sexp.length>3){var extraLocs=sexp.slice(3).map(function(sexp){return sexp.location}),wording=extraLocs.length+" extra "+(extraLocs.length===1?"part":"parts");throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a single body, but found ",new types.MultiPart(wording,extraLocs,false)]),
sexp.location)}return new localExpr(sexp[1].map(parseDefinition),parseExpr(sexp[2]),sexp[0])}function parseLetrecExpr(sexp){if(sexp.length<3)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected an expression after the bindings, but nothing's there"]),sexp.location);if(!(sexp[1]instanceof Array))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a key/value pair, but given ",new types.ColoredPart("something else",sexp[1].location)]),
sexp.location);sexp[1].forEach(function(binding){if(!sexpIsCouple(binding))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a key/value pair, but given ",new types.ColoredPart("something else",binding.location)]),binding.location)});if(sexp.length===2)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected an expression after the bindings, but nothing's there"]),sexp.location);if(sexp.length>3){var extraLocs=sexp.slice(3).map(function(sexp){return sexp.location}),
wording=extraLocs.length+" extra "+(extraLocs.length===1?"part":"parts");throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a single body, but found ",new types.MultiPart(wording,extraLocs,false)]),sexp.location)}return new letrecExpr(sexp[1].map(parseBinding),parseExpr(sexp[2]),sexp[0])}function parseLetExpr(sexp){if(sexp.length===1)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected at least one binding (in parentheses) after let, but nothing's there"]),
sexp.location);if(!(sexp[1]instanceof Array))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected sequence of key value pairs, but given ",new types.ColoredPart("something else",sexp[1].location)]),sexp[1].location);sexp[1].forEach(function(binding){if(!sexpIsCouple(binding))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a key/value pair, but given ",new types.ColoredPart("something else",binding.location)]),binding.location)});
if(sexp.length>3){var extraLocs=sexp.slice(3).map(function(sexp){return sexp.location}),wording=extraLocs.length+" extra "+(extraLocs.length===1?"part":"parts");throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a single body, but found ",new types.MultiPart(wording,extraLocs,false)]),sexp.location)}if(sexp.length===2)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a single body, but found none"]),sexp.location);
return new letExpr(sexp[1].map(parseBinding),parseExpr(sexp[2]),sexp)}function parseLetStarExpr(sexp){if(sexp.length===1)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected an expression after the bindings, but nothing's there"]),sexp.location);if(!(sexp[1]instanceof Array)){var msg=new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected sequence of key/value pairs, but given ",new types.ColoredPart("something else",sexp[1].location)]);
throwError(msg,sexp.location)}sexp[1].forEach(function(binding){if(!sexpIsCouple(binding))throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a key/value pair, but given ",new types.ColoredPart("something else",binding.location)]),binding.location)});if(sexp.length===2)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a single body, but found none"]),sexp.location);if(sexp.length>3){var extraLocs=sexp.slice(3).map(function(sexp){return sexp.location}),
wording=extraLocs.length+" extra "+(extraLocs.length===1?"part":"parts");throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a single body, but found ",new types.MultiPart(wording,extraLocs,false)]),sexp.location)}var bindings=sexp[1].map(parseBinding);bindings.location=sexp[1].location;return new letStarExpr(bindings,parseExpr(sexp[2]),sexp[0])}function parseIfExpr(sexp){if(sexp.length<4)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),
": expected a test, a consequence, and an alternative, but all three were not found"]),sexp.location);if(sexp.length>4){var extraLocs=sexp.slice(1).map(function(sexp){return sexp.location});throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected only a test, a consequence, and an alternative, ","but found ",new types.MultiPart("more than three of these",extraLocs,false)]),sexp.location)}return new ifExpr(parseExpr(sexp[1]),parseExpr(sexp[2]),parseExpr(sexp[3]),
sexp[0])}function parseBeginExpr(sexp){if(sexp.length<2){var msg=new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": Inside a begin, expected to find a body, but nothing was found."]);throwError(msg,sexp.location)}return new beginExpr(rest(sexp).map(parseExpr),sexp[0])}function parseAndExpr(sexp){if(sexp.length<3)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected at least 2 arguments, but given ",sexp.length===1?"0":new types.ColoredPart((sexp.length-
1).toString(),sexp[1].location)]),sexp.location);return new andExpr(rest(sexp).map(parseExpr),sexp[0])}function parseOrExpr(sexp){if(sexp.length<3)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected at least 2 arguments, but given ",sexp.length===1?"0":new types.ColoredPart((sexp.length-1).toString(),sexp[1].location)]),sexp.location);var orEx=new orExpr(rest(sexp).map(parseExpr),sexp[0]);return orEx}function parseQuotedExpr(sexp){function parseQuotedItem(sexp){return isCons(sexp)?
sexp.map(parseQuotedItem):sexp instanceof Array&&sexp.length===0?sexp:parseExprSingleton(sexp)}if(sexp.length<2)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a single argument, but did not find one."]),sexp.location);if(sexp.length>2){var extraLocs=sexp.slice(1).map(function(sexp){return sexp.location});throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a single argument, but found ",new types.MultiPart("more than one.",
extraLocs,false)]),sexp.location)}return new quotedExpr(parseQuotedItem(sexp[1]))}return function(){var peek=sexp[0];var expr=!isSymbol(peek)?parseFuncCall(sexp):isSymbolEqualTo("\u03bb",peek)?parseLambdaExpr(sexp):isSymbolEqualTo("lambda",peek)?parseLambdaExpr(sexp):isSymbolEqualTo("local",peek)?parseLocalExpr(sexp):isSymbolEqualTo("letrec",peek)?parseLetrecExpr(sexp):isSymbolEqualTo("let",peek)?parseLetExpr(sexp):isSymbolEqualTo("let*",peek)?parseLetStarExpr(sexp):isSymbolEqualTo("cond",peek)?parseCondExpr(sexp):
isSymbolEqualTo("case",peek)?parseCaseExpr(sexp):isSymbolEqualTo("if",peek)?parseIfExpr(sexp):isSymbolEqualTo("begin",peek)?parseBeginExpr(sexp):isSymbolEqualTo("and",peek)?parseAndExpr(sexp):isSymbolEqualTo("or",peek)?parseOrExpr(sexp):isSymbolEqualTo("when",peek)?parseWhenUnlessExpr(sexp):isSymbolEqualTo("unless",peek)?parseWhenUnlessExpr(sexp):isSymbolEqualTo("quote",peek)?parseQuotedExpr(sexp):isSymbolEqualTo("quasiquote",peek)?parseQuasiQuotedExpr(sexp):isSymbolEqualTo("unquote",peek)?parseUnquoteExpr(sexp):
isSymbolEqualTo("unquote-splicing",peek)?parseUnquoteSplicingExpr(sexp):parseFuncCall(sexp);expr.location=sexp.location;return expr}()}function parseWhenUnlessExpr(sexp){if(sexp.length<3)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected at a test and at least one result after "+sexp[0]+", but nothing's there"]),sexp.location);var exprs=sexp.slice(2),result=new whenUnlessExpr(parseExpr(sexp[1]),parse(exprs),sexp[0]);exprs.location=exprs[0].location;result.location=
sexp.location;return result}function parseCondExpr(sexp){if(sexp.length===1)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected at least one clause after cond, but nothing's there"]),sexp.location);var condLocs=[sexp[0].location,sexp.location.start(),sexp.location.end()];function isElseClause(couple){return isSymbol(couple[0])&&isSymbolEqualTo(couple[0],"else")}function checkCondCouple(clause){var clauseLocations=[clause.location.start(),clause.location.end()];
if(!(clause instanceof Array))throwError(new types.Message([new types.MultiPart(sexp[0].val,condLocs,true),": expected a clause with a question and an answer, but found ",new types.ColoredPart("something else",clause.location)]),clause.location);if(clause.length===0)throwError(new types.Message([new types.MultiPart(sexp[0].val,condLocs,true),": expected a clause with a question and an answer, but found an ",new types.MultiPart("empty part",clauseLocations,true)]),clause.location);if(clause.length===
1)throwError(new types.Message([new types.MultiPart(sexp[0].val,condLocs,true),": expected a clause with a question and an answer, but found a ",new types.MultiPart("clause",clauseLocations,true)," with only ",new types.MultiPart("one part",[clause[0].location],false)]),clause.location);if(clause.length>2){var extraLocs=clause.map(function(sexp){return sexp.location}),wording=extraLocs.length+" parts";throwError(new types.Message([new types.MultiPart(sexp[0].val,condLocs,true),": expected a clause with a question and an answer, but found ",
new types.MultiPart("a clause",clauseLocations,true)," with ",new types.MultiPart(wording,extraLocs,false)]),clause.location)}}function parseCondCouple(clause){var test=parseExpr(clause[0]),result=parseExpr(clause[1]),cpl=new couple(test,result);if(plt.compiler.keywords.indexOf(test.val)>-1&&test.val!=="else")throwError(new types.Message([new types.ColoredPart(test.val,test.location),": expected an open parenthesis before ",test.val,", but found none"]),test.location);test.isClause=true;cpl.location=
clause.location;return cpl}rest(sexp).forEach(checkCondCouple);var numClauses=rest(sexp).length,parsedClauses=rest(sexp).map(parseCondCouple);rest(sexp).forEach(function(couple,idx){if(isElseClause(couple)&&idx<numClauses-1)throwError(new types.Message([new types.MultiPart("cond",condLocs,true),": ","found an ",new types.ColoredPart("else clause",couple.location)," that isn't the last clause in its cond expression; there is ",new types.ColoredPart("another clause",sexp[idx+2].location)," after it"]),
couple.location)});return new condExpr(parsedClauses,sexp[0])}function parseCaseExpr(sexp){if(sexp.length===1){var msg=new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected at least one clause after case, but nothing's there"]);throwError(msg,sexp.location)}var caseLocs=[sexp[0].location,sexp.location.start(),sexp.location.end()];if(sexp.length===2){var msg=new types.Message([new types.MultiPart(sexp[0].val,caseLocs,true),": expected a clause with at least one choice (in parentheses)"+
" and an answer after the expression, but nothing's there"]);throwError(msg,sexp.location)}function checkCaseCouple(clause){var clauseLocations=[clause.location.start(),clause.location.end()];if(!(clause instanceof Array)){var msg=new types.Message([new types.MultiPart(sexp[0].val,caseLocs,true),": expected a clause with at least one choice (in parentheses), but found ",new types.ColoredPart("something else",clause.location)]);throwError(msg,sexp.location)}if(clause.length===0){var msg=new types.Message([new types.MultiPart(sexp[0].val,
caseLocs,true),": expected at least one choice (in parentheses) and an answer, but found an ",new types.ColoredPart("empty part",clause.location)]);throwError(msg,sexp.location)}if(!(clause[0]instanceof Array||clause[0]instanceof symbolExpr&&isSymbolEqualTo(clause[0],"else"))){var msg=new types.Message([new types.MultiPart(sexp[0].val,caseLocs,true),": expected 'else', or at least one choice in parentheses, but found ",new types.ColoredPart("something else",clause.location)]);throwError(msg,sexp.location)}if(clause.length===
1){var msg=new types.Message([new types.MultiPart(sexp[0].val,caseLocs,true),": expected a clause with a question and an answer, but found a ",new types.MultiPart("clause",clauseLocations,true)," with only ",new types.ColoredPart("one part",clause[0].location)]);throwError(msg,sexp.location)}if(clause.length>2){var extraLocs=clause.map(function(sexp){return sexp.location}),wording=extraLocs.length+" parts",msg=new types.Message([new types.MultiPart(sexp[0].val,caseLocs,true),": expected only one expression for the answer in the case clause, but found a ",
new types.MultiPart("clause",clauseLocations,true)," with ",new types.MultiPart(wording,extraLocs,false)]);throwError(msg,sexp.location)}}function isElseClause(sexp){return isSymbol(sexp[0])&&sexp[0].val==="else"}function parseCaseCouple(sexp){var test=isElseClause(sexp)?sexp[0]:new quotedExpr(sexp[0]),result=parseExpr(sexp[1]),cpl=new couple(test,result);test.isClause=true;cpl.location=sexp.location;return cpl}var clauses=sexp.slice(2);clauses.forEach(checkCaseCouple);var numClauses=clauses.length,
parsedClauses=clauses.map(parseCaseCouple);clauses.forEach(function(couple,idx){if(isElseClause(couple)&&idx<numClauses-1){var msg=new types.Message([new types.MultiPart("case",caseLocs,true),": found an ",new types.ColoredPart("else clause",couple.location),"that isn't the last clause in its case expression; there is ",new types.ColoredPart("another clause",sexp[idx+2].location)," after it"]);throwError(msg,sexp.location)}});return new caseExpr(parseExpr(sexp[1]),parsedClauses,sexp[0])}function parseBinding(sexp){if(sexpIsCouple(sexp)){var binding=
new couple(parseIdExpr(sexp[0]),parseExpr(sexp[1]));binding.location=sexp.location;binding.stx=sexp;return binding}else throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a sequence of key/value pairs, but given ",new types.ColoredPart("something else",sexp[0].location)]),sexp.location)}function parseUnquoteExpr(sexp,depth){if(typeof depth==="undefined")throwError(new types.Message(["misuse of a comma or 'unquote, not under a quasiquoting backquote"]),sexp.location,
"Error-GenericSyntacticError");else if(sexp.length!==2)throwError(new types.Message(["Inside an unquote, expected to find a single argument, but found "+(sexp.length-1)]),sexp.location);else if(depth===1){var result=new unquotedExpr(parseExpr(sexp[1]));result.location=sexp[1].location;return result}else if(depth>1){var result=new unquotedExpr(parseQuasiQuotedItem(sexp[1],depth-1));result.location=sexp[1].location;return result}else throwError(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),
sexp.location)}function parseUnquoteSplicingExpr(sexp,depth){if(typeof depth==="undefined")throwError(new types.Message(["misuse of a ,@ or unquote-splicing, not under a quasiquoting backquote"]),sexp.location,"Error-GenericSyntacticError");else if(sexp.length!==2)throwError(new types.Message(["Inside an unquote-splicing, expected to find a single argument, but found "+(sexp.length-1)]),sexp.location);else if(depth===1){var result=new unquoteSplice(parseExpr(sexp[1]));result.location=sexp[1].location;
return result}else if(depth>1){var result=new unquoteSplice(parseQuasiQuotedItem(sexp[1],depth-1));result.location=sexp[1].location;return result}else throwError(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),sexp.location)}function parseQuasiQuotedItem(sexp,depth){if(isCons(sexp)&&sexp[0].val==="unquote")return parseUnquoteExpr(sexp,depth);else if(isCons(sexp)&&sexp[0].val==="unquote-splicing")return parseUnquoteSplicingExpr(sexp,depth);else if(isCons(sexp)&&
sexp[0].val==="quasiquote")return parseQuasiQuotedExpr(sexp,depth);else if(isCons(sexp)){var res=sexp.map(function(x){return parseQuasiQuotedItem(x,depth)});res.location=sexp.location;return res}else if(depth===0)return parseExpr(sexp);else return function(){var res=new quotedExpr(sexp);res.location=sexp.location;return res}()}function parseQuasiQuotedExpr(sexp,depth){depth=typeof depth==="undefined"?0:depth;if(sexp.length<2)throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),
": expected a single argument, but did not find one "]),sexp.location);if(sexp.length>2){var extraLocs=sexp.slice(1).map(function(sexp){return sexp.location});throwError(new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a single argument, but found ",new types.MultiPart("more than one.",extraLocs,false)]),sexp.location)}if(isCons(sexp[1])&&isSymbolEqualTo(sexp[1][0],"unquote-splicing"))throwError(new types.Message(["misuse of ,@ or `unquote-splicing' within a quasiquoting backquote"]),
sexp.location);var quoted=parseQuasiQuotedItem(sexp[1],depth+1);quoted.location=sexp[1].location;var result=new quasiquotedExpr(quoted);result.location=sexp.location;return result}function parseVector(sexp){function buildZero(){var lit=new literal(0);lit.location=sexp.location;return lit}var unParsedVector=sexp.val,vals=parseStar(unParsedVector.elts.filter(function(e){return e!==undefined})),last=vals.length===0?buildZero():vals[vals.length-1],elts=unParsedVector.elts.map(function(v){return v===undefined?
last:parseExpr(v)});var vectorFunc=new symbolExpr("vector"),buildVector=new callExpr(vectorFunc,elts);vectorFunc.location=buildVector.location=sexp.location;return buildVector}function parseExprSingleton(sexp){var singleton=isUnsupported(sexp)?sexp:isVector(sexp)?parseVector(sexp):isSymbol(sexp)?sexp:isLiteral(sexp)?sexp:isSymbolEqualTo("quote",sexp)?new quotedExpr(sexp):isSymbolEqualTo("empty",sexp)?new callExpr(new symbolExpr("list"),[]):new callExpr(null,[]);singleton.location=sexp.location;return singleton}
function parseIdExpr(sexp){return isSymbol(sexp)?sexp:throwError(new types.Message(["ID"]),sexp.location)}function isTupleStartingWithOfLength(sexp,symbol,n){return isCons(sexp)&&sexp.length===n&&isSymbol(sexp[0])&&isSymbolEqualTo(sexp[0],symbol)}function sexpIsCouple(sexp){return isCons(sexp)&&sexp.length===2}function sexpIsCondListP(sexp){return isCons(sexp)&&sexp.length>=2&&isSymbol(sexp[0])&&isSymbolEqualTo(sexp[0],"cond")}function isRequire(sexp){return isCons(sexp)&&isSymbol(sexp[0])&&isSymbolEqualTo(sexp[0],
"require")}function parseRequire(sexp){if(sexp.length<2){var msg=new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a module name after `require', but found nothing"]);throwError(msg,sexp.location)}if(sexp[1]instanceof Array&&isSymbolEqualTo(sexp[1][0],"lib")){if(sexp[1].length<3){var partsNum=sexp[1].slice(1).length,partsStr=partsNum+(partsNum===1?" part":" parts"),msg=new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected at least two strings after ",
new types.ColoredPart("lib",sexp[1][0].location)," but found only ",partsStr]);throwError(msg,sexp.location)}rest(sexp[1]).forEach(function(lit){if(!isString(lit)){var msg=new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a string for a library collection, but found ",new types.ColoredPart("something else",str.location)]);throwError(msg,sexp.location)}})}else if(sexp[1]instanceof Array&&isSymbolEqualTo(sexp[1][0],"planet")){var msg=new types.Message([new types.ColoredPart(sexp[0].val,
sexp[0].location),": Importing PLaneT pacakges is not supported at this time"]);throwError(msg,sexp.location)}else if(!(sexp[1]instanceof symbolExpr||isString(sexp[1]))){var msg=new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": expected a module name as a string or a `(lib ...)' form, but found ",new types.ColoredPart("something else",sexp[1].location)]);throwError(msg,sexp.location)}var req=new requireExpr(sexp[1],sexp[0]);req.location=sexp.location;return req}function isProvide(sexp){return isCons(sexp)&&
isSymbol(sexp[0])&&isSymbolEqualTo(sexp[0],"provide")}function parseProvide(sexp){var clauses=rest(sexp).map(function(p){if(p instanceof symbolExpr)return p;if(p instanceof Array&&p.length==2&&p[0]instanceof symbolExpr&&isSymbolEqualTo(p[0],"struct-out")&&p[1]instanceof symbolExpr)return p;var msg=new types.Message([new types.ColoredPart(sexp[0].val,sexp[0].location),": I don't recognize the syntax of this ",new types.ColoredPart("clause",p.location)]);throwError(msg,sexp.location)});var provide=
new provideStatement(clauses,sexp[0]);provide.location=sexp.location;return provide}plt.compiler.parse=function(sexp,debug){var start=(new Date).getTime();try{var AST=parse(sexp);AST.location=sexp.location}catch(e){console.log("PARSING ERROR");throw e;}var end=(new Date).getTime();if(debug){console.log("Parsed in "+Math.floor(end-start)+"ms");console.log(AST)}return AST}})();goog.provide("plt.compiler.topLevelModules");goog.provide("plt.compiler.knownModules");goog.provide("plt.compiler.knownCollections");goog.require("plt.compiler.moduleBinding");goog.require("plt.compiler.functionBinding");goog.require("plt.compiler.constantBinding");window.plt=window.plt||{};plt.compiler=plt.compiler||{};
(function(){var moduleBinding=plt.compiler.moduleBinding;var functionBinding=plt.compiler.functionBinding;var constantBinding=plt.compiler.constantBinding;function makeFunctionBinding(modulePath){return function(binding){binding[3]=binding[3]||[];binding[4]=binding[4]||false;binding[5]=binding[5]||false;return new functionBinding(binding[0],modulePath,binding[1],binding[2],binding[3],binding[4],binding[5])}}var kernelMiscModule=new moduleBinding("moby/runtime/kernel/misc",[["verify-boolean-branch-value",
2],["throw-cond-exhausted-error",1],["'check-operator-is-function",3],["print-values",0]].map(makeFunctionBinding('"moby/runtime/kernel/misc"')));var foreignModule=new moduleBinding("moby/foreign",[["get-js-object",2,false,["android.permission.FOREIGN-FUNCTION-INTERFACE"]]].map(makeFunctionBinding('"moby/foreign"')));var worldEffectsModule=new moduleBinding("world-effects",[["make-effect:none",0,false],["make-effect:beep",0,false,["android.permission.VIBRATE"]],["make-effect:play-dtmf-tone",2,false],
["make-effect:send-sms",2,false,["android.permission.SEND-SMS"]],["make-effect:play-sound",1,false,["android.permission.INTERNET"]],["make-effect:stop-sound",1,false],["make-effect:pause-sound",1,false],["make-effect:set-sound-volume",1,false],["make-effect:set-beep-volume",1,false],["make-effect:raise-sound-volume",0,false],["make-effect:lower-sound-volume",1,false],["make-effect:set-wake-lock",1,false,["android.permission.WAKE-LOCK"]],["make-effect:release-wake-lock",1,false,["android.permission.WAKE-LOCK"]],
["make-effect:pick-playlist",1,false],["make-effect:pick-random",2,false]].map(makeFunctionBinding('"moby/world-effects"')));var worldHandlersModule=new moduleBinding("world-config",[["on-tick",1,true],["initial-effect",1,false],["on-key",1,false],["on-key!",2,false],["on-mouse",1,false],["on-tap",1,false],["on-tilt",1,false],["on-redraw",1,false],["to-draw",1,false],["on-draw",2,false],["stop-when",1,false]].map(makeFunctionBinding('"moby/world-handlers"')));var bootstrapTeachpackFunctions=[["START",
14,false],["test-frame",1,false],["sine",1,false],["cosine",1,false],["tangent",1,false]];var bootstrapTeachpack=new moduleBinding("bootstrap/bootstrap-teachpack",bootstrapTeachpackFunctions.map(makeFunctionBinding('"bootstrap/bootstrap-teachpack"'))),bootstrapTeachpack2011=new moduleBinding("bootstrap2011/bootstrap-teachpack",bootstrapTeachpackFunctions.map(makeFunctionBinding('"bootstrap2011/bootstrap-teachpack"'))),bootstrapTeachpack2012=new moduleBinding("bootstrap2012/bootstrap-teachpack",bootstrapTeachpackFunctions.map(makeFunctionBinding('"bootstrap2012/bootstrap-teachpack"'))),
bootstrapTiltTeachpack2012=new moduleBinding("bootstrap2012/bootstrap-tilt-teachpack",bootstrapTeachpackFunctions.map(makeFunctionBinding('"bootstrap2012/bootstrap-tilt-teachpack"'))),bootstrapTeachpack2014=new moduleBinding("bootstrap2014/bootstrap-teachpack",bootstrapTeachpackFunctions.map(makeFunctionBinding('"bootstrap2014/bootstrap-teachpack"'))),bootstrapTiltTeachpack2014=new moduleBinding("bootstrap2014/bootstrap-tilt-teachpack",bootstrapTeachpackFunctions.map(makeFunctionBinding('"bootstrap2014/bootstrap-tilt-teachpack"'))),
bootstrapTeachpack2015=new moduleBinding("bootstrap2015/bootstrap-teachpack",bootstrapTeachpackFunctions.map(makeFunctionBinding('"bootstrap2015/bootstrap-teachpack"'))),bootstrapTiltTeachpack2015=new moduleBinding("bootstrap2015/bootstrap-tilt-teachpack",bootstrapTeachpackFunctions.map(makeFunctionBinding('"bootstrap2015/bootstrap-tilt-teachpack"')));var cageTeachpack=new moduleBinding("bootstrap/cage-teachpack",[["start",1,false]].map(makeFunctionBinding('"bootstrap/cage-teachpack"'))),cageTeachpack2011=
new moduleBinding("bootstrap2011/cage-teachpack",[["start",1,false]].map(makeFunctionBinding('"bootstrap2011/cage-teachpack"'))),cageTeachpack2012=new moduleBinding("bootstrap2012/cage-teachpack",[["start",1,false]].map(makeFunctionBinding('"bootstrap2012/cage-teachpack"'))),cageTeachpack2014=new moduleBinding("bootstrap2014/cage-teachpack",[["start",1,false]].map(makeFunctionBinding('"bootstrap2014/cage-teachpack"')));cageTeachpack2015=new moduleBinding("bootstrap2015/cage-teachpack",[["start",1,
false]].map(makeFunctionBinding('"bootstrap2015/cage-teachpack"')));var booleanTeachpackFunctions=[["start",1,false],["continent?",1,false],["primary-color?",1,false],["less-than-one?",1,false]];var booleanTeachpack2020=new moduleBinding("bootstrap2020/boolean-teachpack",[["start",1,false]].map(makeFunctionBinding('"bootstrap2020/boolean-teachpack"')));var functionTeachpack=new moduleBinding("bootstrap/function-teachpack",[["start",1,false]].map(makeFunctionBinding('"bootstrap/function-teachpack"'))),
functionTeachpack2011=new moduleBinding("bootstrap2011/function-teachpack",[["start",1,false]].map(makeFunctionBinding('"bootstrap2011/function-teachpack"'))),functionTeachpack2012=new moduleBinding("bootstrap2012/function-teachpack",[["start",1,false]].map(makeFunctionBinding('"bootstrap2012/function-teachpack"'))),functionTeachpack2014=new moduleBinding("bootstrap2014/function-teachpack",[["start",1,false]].map(makeFunctionBinding('"bootstrap2014/function-teachpack"'))),functionTeachpack2015=new moduleBinding("bootstrap2015/function-teachpack",
[["start",1,false]].map(makeFunctionBinding('"bootstrap2015/function-teachpack"')));var locationModule=new moduleBinding("location",[["get-latitude",0,false,["android.permission.LOCATION"]],["get-longitude",0,false,["android.permission.LOCATION"]],["get-altitude",0,false,["android.permission.LOCATION"]],["get-bearing",0,false,["android.permission.LOCATION"]],["get-speed",0,false,["android.permission.LOCATION"]],["location-distance",0,false,["android.permission.LOCATION"]]].map(makeFunctionBinding('"moby/geolocation"')));
var tiltModule=new moduleBinding("tilt",[["get-x-acceleration",0,false,["android.permission.TILT"]],["get-y-acceleration",0,false,["android.permission.TILT"]],["get-z-acceleration",0,false,["android.permission.TILT"]],["get-azimuth",0,false,["android.permission.TILT"]],["get-pitch",0,false,["android.permission.TILT"]],["get-roll",0,false,["android.permission.TILT"]]].map(makeFunctionBinding('"moby/tilt"')));var telephonyModule=new moduleBinding("telephony",[["get-signal-strength",0,false,["android.permission.TELEPHONY"]]].map(makeFunctionBinding('"moby/net"')));
var netModule=new moduleBinding("net",[["get-url",1,false,["android.permission.INTERNET"]]].map(makeFunctionBinding('"moby/net"')));var parserModule=new moduleBinding("parser",[["xml->s-sexp",1,false]].map(makeFunctionBinding('"moby/parser"')));var jsWorldModule=new moduleBinding("jsworld",[["js-big-bang",1,false],["big-bang",1,false],["js-div",0,false],["js-p",0,false],["js-button",2,false],["js-button!",2,false],["js-node",1,false],["js-text",1,false],["js-select",2,false],["js-img",1,false,["android.permission.INTERNET"]]].map(makeFunctionBinding('"moby/jsworld"')));
var worldModule=new moduleBinding("world",worldHandlersModule.bindings.concat(worldEffectsModule.bindings,["key=?","play-sound","animate","big-bang","make-color","color?","color-red","color-green","color-blue","color-alpha","empty-scene","empty-image","scene+line","put-image", "translate","place-image","place-image/align","circle","star","polygon","radial-star","star-polygon","nw:rectangle","rectangle","regular-polygon","rhombus","square","triangle","triangle/sas","triangle/sss","triangle/ass","triangle/ssa",
"triangle/aas","triangle/asa","triangle/saa","right-triangle","isosceles-triangle","ellipse","line","add-line","add-polygon","overlay","overlay/xy","overlay/align","underlay","underlay/xy","underlay/align","beside","beside/align","above","above/align","rotate","scale","scale/xy","crop","frame","flip-horizontal","flip-vertical","reflect-x","reflect-y","text","text/font","video/url","bitmap/url","image-url","image?","image=?","image-width","image-height","mouse-event?","mouse=?","image->color-list",
"color-list->image","color-list->bitmap","image-baseline","mode?","image-color?","name->color","x-place?","y-place?","angle?","side-count?","step-count?"].map(function(binding){var needsPermission=["video/url","bitmap/url","image-url"];var permissions=needsPermission.indexOf(binding)>-1?["android.permission.INTERNET"]:[];return new constantBinding(binding,'"moby/world"',permissions,false)})));var topLevelModule=new moduleBinding("moby/topLevel",[["<",2,true],["<=",2,true],["=",2,true],[">",2,true],
[">=",2,true],["<>",2,true],["=~",3],["number->string",1],["even?",1],["odd?",1],["positive?",1],["negative?",1],["number?",1],["rational?",1],["quotient",2],["remainder",2],["numerator",1],["denominator",1],["integer?",1],["real?",1],["abs",1],["acos",1],["add1",1],["angle",1],["asin",1],["atan",1,true],["ceiling",1],["complex?",1],["conjugate",1],["cos",1],["cosh",1],["denominator",1],["even?",1],["exact->inexact",1],["exact?",1],["exp",1],["expt",2],["floor",1],["gcd",1,true],["imag-part",1],["inexact->exact",
1],["inexact?",1],["integer->char",1],["integer-sqrt",1],["integer?",1],["lcm",1,true],["log",1],["magnitude",1],["make-polar",2],["make-rectangular",2],["max",1,true],["min",1,true],["modulo",2],["negative?",1],["number?",1],["numerator",1],["odd?",1],["positive?",1],["random",1],["rational?",1],["real-part",1],["real?",1],["round",1],["sgn",1],["sin",1],["sinh",1],["sqr",1],["sqrt",1],["nth-root",2],["sub1",1],["tan",1],["zero?",1],["+",0,true],["-",1,true],["*",0,true],["/",1,true],["not",1],["false?",
1],["boolean?",1],["boolean=?",2],["symbol->string",1],["symbol=?",2],["symbol?",1],["append",0,true],["assq",2],["assv",2],["assoc",2],["caaar",1],["caadr",1],["caar",1],["cadar",1],["cadddr",1],["caddr",1],["cadr",1],["car",1],["cddar",1],["cdddr",1],["cddr",1],["cdr",1],["cdaar",1],["cdadr",1],["cdar",1],["cons?",1],["list?",1],["cons",2],["empty?",1],["length",1],["list",0,true],["list*",1,true],["range",3],["list-ref",2],["remove",2],["remove-all",2],["member",2],["member?",2],["memq",2],["memv",
2],["null?",1],["pair?",1],["rest",1],["reverse",1],["first",1],["second",1],["third",1],["fourth",1],["fifth",1],["sixth",1],["seventh",1],["eighth",1],["make-list",2],["box",1],["unbox",1],["set-box!",2],["box?",1],["make-posn",2],["posn-x",1],["posn-y",1],["posn?",1],["char->integer",1],["char-alphabetic?",1],["char-ci<=?",2,true],["char-ci<?",2,true],["char-ci=?",2,true],["char-ci>=?",2,true],["char-ci>?",2,true],["char-downcase",1],["char-lower-case?",1],["char-numeric?",1],["char-upcase",1],
["char-upper-case?",1],["char-whitespace?",1],["char<=?",2,true],["char<?",2,true],["char=?",2,true],["char>=?",2,true],["char>?",2,true],["char?",1],["format",1,true],["list->string",1],["make-string",2],["replicate",2],["string",0,true],["string->list",1],["string->number",1],["string->symbol",1],["string-alphabetic?",1],["string-append",0,true],["string-contains?",2],["string-ci<=?",2,true],["string-ci<?",2,true],["string-ci=?",2,true],["string-ci<>?",2,true],["string-ci>=?",2,true],["string-ci>?",
2,true],["string-copy",1],["string-length",1],["string-lower-case?",1],["string-numeric?",1],["string-ref",2],["string-upper-case?",1],["string-whitespace?",1],["string<=?",2,true],["string<?",2,true],["string=?",2,true],["string<>?",2,true],["string>=?",2,true],["string>?",2,true],["string?",1],["substring",3],["string-ith",2],["int->string",1],["string->int",1],["explode",1],["implode",1],["eof-object?",1],["=~",3],["eq?",2],["equal?",2],["equal~?",3],["eqv?",2],["error",2],["identity",1],["struct?",
1],["current-seconds",0],["andmap",1,true],["apply",2,true],["argmax",2],["argmin",2],["build-list",2],["build-string",2],["compose",0,true],["filter",2],["foldl",2,true],["foldr",2,true],["map",1,true],["for-each",1,true],["memf",2],["ormap",1,true],["procedure?",1],["quicksort",2],["sort",2],["void",0,true],["xml->s-exp",1],["build-vector",2],["make-vector",1,true],["vector",0,true],["vector-length",1],["vector-ref",2],["vector-set!",3],["vector->list",1],["list->vector",1],["vector?",1],["printf",
1,true],["display",1],["write",1],["newline",0],["call/cc",1],["procedure-arity",1],["check-expect",2],["EXAMPLE",2],["check-within",3],["check-error",2],["make-hasheq",0],["make-hash",0],["hash-set!",3],["hash-ref",3],["hash-remove!",2],["hash-map",2],["hash-for-each",2],["hash?",1],["raise",1],["undefined?",1],["values",0,true],["make-struct-type",4,true],["make-struct-field-accessor",2,true],["make-struct-field-mutator",2,true],["current-continuation-marks",0,false],["continuation-mark-set->list",
2,false],["scheme->prim-js",1,false],["prim-js->scheme",1,false],["procedure->cps-js-fun",1,false],["procedure->void-js-fun",1,false],["js-===",2,false],["js-get-named-object",1,false],["js-get-field",2,true],["js-set-field!",3,false],["js-typeof",1,false],["js-instanceof",2,false],["js-call",2,true],["js-new",1,true],["js-make-hash",0,true],["make-world-config",2,true],["make-bb-info",2,false],["bb-info?",1,false],["bb-info-change-world",1,false],["bb-info-toplevel-node",1,false],["make-effect-type",
4,true],["effect?",1,false],["world-with-effects",2,false],["make-render-effect-type",4,true],["render-effect-type?",1],["render-effect?",1],["make-render-effect-type",4,true],["values",0,true],["sleep",0,true],["current-inexact-milliseconds",0,false],["make-exn",2,false],["exn-message",1,false],["exn-continuation-marks",1,false]].map(makeFunctionBinding('"moby/toplevel"')));plt.compiler.topLevelModules=[topLevelModule,kernelMiscModule,,jsWorldModule,worldModule];plt.compiler.knownCollections=["bootstrap",
"bootstrap2011","bootstrap2012","bootstrap2014","bootstrap2015","bootstrap2020"];plt.compiler.knownModules=[kernelMiscModule,jsWorldModule,foreignModule,worldModule,bootstrapTeachpack,bootstrapTeachpack2011,bootstrapTeachpack2012,bootstrapTeachpack2014,bootstrapTeachpack2015,bootstrapTiltTeachpack2012,bootstrapTiltTeachpack2014,bootstrapTiltTeachpack2015,cageTeachpack,cageTeachpack2011,cageTeachpack2012,cageTeachpack2014,cageTeachpack2015,booleanTeachpack2020,functionTeachpack,functionTeachpack2011,
functionTeachpack2012,functionTeachpack2014,functionTeachpack2015,locationModule,tiltModule,telephonyModule,netModule,parserModule,topLevelModule]})();goog.provide("plt.compiler.desugar");goog.provide("plt.compiler.analyze");goog.require("plt.compiler.literal");goog.require("plt.compiler.symbolExpr");goog.require("plt.compiler.Program");goog.require("plt.compiler.couple");goog.require("plt.compiler.ifExpr");goog.require("plt.compiler.beginExpr");goog.require("plt.compiler.letExpr");goog.require("plt.compiler.letStarExpr");goog.require("plt.compiler.letrecExpr");goog.require("plt.compiler.localExpr");goog.require("plt.compiler.andExpr");goog.require("plt.compiler.orExpr");
goog.require("plt.compiler.condExpr");goog.require("plt.compiler.caseExpr");goog.require("plt.compiler.lambdaExpr");goog.require("plt.compiler.quotedExpr");goog.require("plt.compiler.unquotedExpr");goog.require("plt.compiler.quasiquotedExpr");goog.require("plt.compiler.unquoteSplice");goog.require("plt.compiler.callExpr");goog.require("plt.compiler.whenUnlessExpr");goog.require("plt.compiler.defFunc");goog.require("plt.compiler.defVar");goog.require("plt.compiler.defVars");goog.require("plt.compiler.defStruct");
goog.require("plt.compiler.requireExpr");goog.require("plt.compiler.provideStatement");goog.require("plt.compiler.unsupportedExpr");goog.require("plt.compiler.structBinding");goog.require("plt.compiler.constantBinding");goog.require("plt.compiler.functionBinding");goog.require("plt.compiler.moduleBinding");goog.require("plt.compiler.knownModules");goog.require("plt.compiler.throwError");window.plt=window.plt||{};plt.compiler=plt.compiler||{};
(function(){var literal=plt.compiler.literal;var symbolExpr=plt.compiler.symbolExpr;var Program=plt.compiler.Program;var couple=plt.compiler.couple;var ifExpr=plt.compiler.ifExpr;var beginExpr=plt.compiler.beginExpr;var letExpr=plt.compiler.letExpr;var letStarExpr=plt.compiler.letStarExpr;var letrecExpr=plt.compiler.letrecExpr;var localExpr=plt.compiler.localExpr;var andExpr=plt.compiler.andExpr;var orExpr=plt.compiler.orExpr;var condExpr=plt.compiler.condExpr;var caseExpr=plt.compiler.caseExpr;var lambdaExpr=
plt.compiler.lambdaExpr;var quotedExpr=plt.compiler.quotedExpr;var unquotedExpr=plt.compiler.unquotedExpr;var quasiquotedExpr=plt.compiler.quasiquotedExpr;var unquoteSplice=plt.compiler.unquoteSplice;var callExpr=plt.compiler.callExpr;var whenUnlessExpr=plt.compiler.whenUnlessExpr;var defFunc=plt.compiler.defFunc;var defVar=plt.compiler.defVar;var defVars=plt.compiler.defVars;var defStruct=plt.compiler.defStruct;var requireExpr=plt.compiler.requireExpr;var provideStatement=plt.compiler.provideStatement;
var unsupportedExpr=plt.compiler.unsupportedExpr;var throwError=plt.compiler.throwError;var structBinding=plt.compiler.structBinding;var constantBinding=plt.compiler.constantBinding;var functionBinding=plt.compiler.functionBinding;var moduleBinding=plt.compiler.moduleBinding;var knownModules=plt.compiler.knownModules;function checkDuplicateIdentifiers(lst,stx,loc){var visitedIds={};lst.forEach(function(id){if(!(id instanceof symbolExpr))throwError("expected identifier "+id.val,id.location);else if(visitedIds[id.val])throwError(new types.Message([new types.ColoredPart(stx.toString(),
stx.location),": found ",new types.ColoredPart("a variable",id.location)," that is already used ",new types.ColoredPart("here",visitedIds[id.val].location)]),id.location);else visitedIds[id.val]=id})}function tagApplicationOperator_Module(application,moduleName){var module=plt.compiler.defaultModuleResolver(moduleName),env=(new plt.compiler.emptyEnv).extendEnv_moduleBinding(module);[application.func].concat(application.args).forEach(function(expr){expr.context=env});return application}function forceBooleanContext(stx,
loc,boolExpr){stx=new literal(new types.string(stx.toString()));var verifyCall=new symbolExpr("verify-boolean-branch-value"),stxQuote=new quotedExpr(stx),locQuote=new quotedExpr(new literal(loc.toVector())),boolLocQuote=new quotedExpr(new literal(boolExpr.location.toVector())),runtimeCall=new callExpr(verifyCall,[stxQuote,locQuote,boolExpr,boolLocQuote]);runtimeCall.location=verifyCall.location=boolExpr.location;stxQuote.location=locQuote.location=boolLocQuote.location=boolExpr.location;tagApplicationOperator_Module(runtimeCall,
"moby/runtime/kernel/misc");return runtimeCall}function desugarProgram(programs,pinfo,isTopLevelExpr){var acc=[[],pinfo||new plt.compiler.pinfo];var res=programs.reduce(function(acc,p){var desugaredAndPinfo=p.desugar(acc[1]);if(plt.compiler.isExpression(p)&&isTopLevelExpr){var printValues=new symbolExpr("print-values"),printCall=new callExpr(printValues,[desugaredAndPinfo[0]]);printValues.location=printCall.location=desugaredAndPinfo[0].location;desugaredAndPinfo[0]=printCall;tagApplicationOperator_Module(printCall,
"moby/runtime/kernel/misc")}if(desugaredAndPinfo[0].length)acc[0]=acc[0].concat(desugaredAndPinfo[0]);else acc[0].push(desugaredAndPinfo[0]);return[acc[0],desugaredAndPinfo[1]]},acc);res[0].location=programs.location;return res}Program.prototype.desugar=function(pinfo){return[this,pinfo]};defFunc.prototype.desugar=function(pinfo){checkDuplicateIdentifiers([this.name].concat(this.args),this.stx[0],this.location);this.args.forEach(function(arg){if(!(arg instanceof symbolExpr))throwError(new types.Message([new types.ColoredPart(this.stx.val,
this.stx.location),": expected a variable but found ",new types.ColoredPart("something else",arg.location)]),sexp.location)});var bodyAndPinfo=this.body.desugar(pinfo),newDefFunc=new defFunc(this.name,this.args,bodyAndPinfo[0],this.stx);newDefFunc.location=this.location;return[newDefFunc,bodyAndPinfo[1]]};defVar.prototype.desugar=function(pinfo){if(this.expr instanceof lambdaExpr){var newDefFunc=new defFunc(this.name,this.expr.args,this.expr.body,this.stx);newDefFunc.location=this.location;return newDefFunc.desugar(pinfo)}else{var exprAndPinfo=
this.expr.desugar(pinfo),newDefVar=new defVar(this.name,exprAndPinfo[0],this.stx);newDefVar.location=this.location;return[newDefVar,exprAndPinfo[1]]}};defVars.prototype.desugar=function(pinfo){var exprAndPinfo=this.expr.desugar(pinfo),newDefVars=new defVars(this.names,exprAndPinfo[0],this.stx);newDefVars.location=this.location;return[newDefVars,exprAndPinfo[1]]};defStruct.prototype.desugar=function(pinfo){var that=this,ids=["make-"+this.name.val,this.name.val+"?",this.name.val+"-ref",this.name.val+
"-set!"],idSymbols=ids.map(function(id){return new symbolExpr(id)}),makeStructTypeFunc=new symbolExpr("make-struct-type"),makeStructTypeArgs=[new quotedExpr(new symbolExpr(this.name.val)),new literal(false),new literal(this.fields.length),new literal(0)],makeStructTypeCall=new callExpr(makeStructTypeFunc,makeStructTypeArgs);[makeStructTypeCall,makeStructTypeFunc].concat(idSymbols,makeStructTypeArgs).forEach(function(p){p.location=that.location});var defineValuesStx=new defVars([this.name].concat(idSymbols),
makeStructTypeCall,this.stx),stxs=[defineValuesStx];defineValuesStx.location=this.location;function makeAccessorDefn(f,i){var makeFieldFunc=new symbolExpr("make-struct-field-accessor"),makeFieldArgs=[new symbolExpr(that.name.val+"-ref"),new literal(i),new quotedExpr(new symbolExpr(f.val))],makeFieldCall=new callExpr(makeFieldFunc,makeFieldArgs),accessorSymbol=new symbolExpr(that.name.val+"-"+f.val),defineVar=new defVar(accessorSymbol,makeFieldCall);[defineVar,makeFieldFunc,makeFieldCall,accessorSymbol].concat(makeFieldArgs).forEach(function(p){p.location=
f.location});stxs.push(defineVar)}this.fields.forEach(makeAccessorDefn);return[stxs,pinfo]};beginExpr.prototype.desugar=function(pinfo){var exprsAndPinfo=desugarProgram(this.exprs,pinfo),newBeginExpr=new beginExpr(exprsAndPinfo[0],this.stx);newBeginExpr.location=this.location;return[newBeginExpr,exprsAndPinfo[1]]};lambdaExpr.prototype.desugar=function(pinfo){if(this.stx)checkDuplicateIdentifiers(this.args,this.stx,this.location);var bodyAndPinfo=this.body.desugar(pinfo),newLambdaExpr=new lambdaExpr(this.args,
bodyAndPinfo[0],this.stx);newLambdaExpr.location=this.location;return[newLambdaExpr,bodyAndPinfo[1]]};localExpr.prototype.desugar=function(pinfo){var defnsAndPinfo=desugarProgram(this.defs,pinfo),exprAndPinfo=this.body.desugar(defnsAndPinfo[1]),newLocalExpr=new localExpr(defnsAndPinfo[0],exprAndPinfo[0],this.stx);newLocalExpr.location=this.location;return[newLocalExpr,exprAndPinfo[1]]};callExpr.prototype.desugar=function(pinfo){if(!this.func)throwError(new types.Message([new types.ColoredPart("( )",
this.location),": expected a function, but nothing's there"]),this.location);var exprsAndPinfo=desugarProgram([this.func].concat(this.args),pinfo),newCallExpr=new callExpr(exprsAndPinfo[0][0],exprsAndPinfo[0].slice(1),this.stx);newCallExpr.location=this.location;return[newCallExpr,exprsAndPinfo[1]]};ifExpr.prototype.desugar=function(pinfo){var exprsAndPinfo=desugarProgram([this.predicate,this.consequence,this.alternative],pinfo),predicate=forceBooleanContext(this.stx,this.stx.location,exprsAndPinfo[0][0]),
consequence=exprsAndPinfo[0][1],alternative=exprsAndPinfo[0][2],newIfExpr=new ifExpr(predicate,consequence,alternative,this.stx);newIfExpr.location=this.location;return[newIfExpr,exprsAndPinfo[1]]};whenUnlessExpr.prototype.desugar=function(pinfo){var begin_exp=new beginExpr(this.exprs,this.stx),void_exp=new symbolExpr("void"),call_exp=new callExpr(void_exp,[],this.stx),consequence=this.stx.val==="when"?begin_exp:call_exp,alternative=this.stx.val==="when"?call_exp:begin_exp;begin_exp.location=this.exprs.location;
void_exp.location=call_exp.location=this.location;var exprsAndPinfo=desugarProgram([this.predicate,consequence,alternative],pinfo),if_exp=new ifExpr(exprsAndPinfo[0][0],exprsAndPinfo[0][1],exprsAndPinfo[0][2],this.stx);if_exp.location=this.location;return[if_exp,exprsAndPinfo[1]]};letrecExpr.prototype.desugar=function(pinfo){function bindingToDefn(b){var def=new defVar(b.first,b.second,b.stx);def.location=b.location;return def}var localAndPinfo=(new localExpr(this.bindings.map(bindingToDefn),this.body,
this.stx)).desugar(pinfo);localAndPinfo[0].location=this.location;return localAndPinfo};letExpr.prototype.desugar=function(pinfo){function coupleFirst(x){return x.first}function coupleSecond(x){return x.second}var ids=this.bindings.map(coupleFirst),exprs=this.bindings.map(coupleSecond),lambda=new lambdaExpr(ids,this.body,this.stx),call=new callExpr(lambda,exprs);lambda.location=call.location=this.location;return call.desugar(pinfo)};letStarExpr.prototype.desugar=function(pinfo){function bindingToLet(body,
binding){var let_exp=new letExpr([binding],body,binding.stx);let_exp.location=binding.location;return let_exp}if(this.bindings.length===0)return this.body.desugar(pinfo);else return this.bindings.reduceRight(bindingToLet,this.body).desugar(pinfo)};condExpr.prototype.desugar=function(pinfo){var condExhausted=new symbolExpr("throw-cond-exhausted-error"),exhaustedLoc=new quotedExpr(new literal(this.location.toVector())),expr=tagApplicationOperator_Module(new callExpr(condExhausted,[exhaustedLoc]),"moby/runtime/kernel/misc");
var ifStx=new symbolExpr("if");ifStx.location=this.stx.location;expr.location=condExhausted.location=exhaustedLoc.location=this.location;for(var i=this.clauses.length-1;i>-1;i--){if(this.clauses[i].first instanceof symbolExpr&&this.clauses[i].first.val==="else")this.clauses[i].first.val="true";expr=new ifExpr(this.clauses[i].first,this.clauses[i].second,expr,this.stx);expr.location=this.location}return expr.desugar(pinfo)};caseExpr.prototype.desugar=function(pinfo){var that=this,caseStx=new symbolExpr("if");
caseStx.location=that.location;var pinfoAndValSym=pinfo.gensym("val"),updatedPinfo1=pinfoAndValSym[0],valStx=pinfoAndValSym[1];var pinfoAndXSym=updatedPinfo1.gensym("x"),updatedPinfo2=pinfoAndXSym[0],xStx=pinfoAndXSym[1],voidStx=new symbolExpr("void");var stxs=[valStx,xStx,voidStx];var expr,clauses=this.clauses,lastClause=clauses[this.clauses.length-1];if(lastClause.first instanceof symbolExpr&&lastClause.first.val==="else"){expr=lastClause.second;clauses.pop()}else{expr=new callExpr(voidStx,[],that.stx);
expr.location=that.location}var equalStx=new symbolExpr("equal?"),equalTestStx=new callExpr(equalStx,[xStx,valStx],caseStx),predicateStx=new lambdaExpr([xStx],equalTestStx,caseStx);stxs=stxs.concat([equalStx,equalTestStx,predicateStx]);function processClause(base,clause){var ormapStx=new symbolExpr("ormap"),callStx=new callExpr(ormapStx,[predicateStx,clause.first],that.stx),ifStx=new ifExpr(callStx,clause.second,base,caseStx);stxs=stxs.concat([ormapStx,callStx,clause.first,ifStx]);return ifStx}var binding=
new couple(valStx,this.expr),body=clauses.reduceRight(processClause,expr),letExp=new letExpr([binding],body,caseStx);stxs=stxs.concat([binding,letExp]);stxs.forEach(function(stx){stx.location=that.location});return letExp.desugar(updatedPinfo2)};andExpr.prototype.desugar=function(pinfo){var that=this,ifStx=new symbolExpr("if"),exprsAndPinfo=desugarProgram(this.exprs,pinfo),exprs=exprsAndPinfo[0],pinfo=exprsAndPinfo[1];function desugarAndExprs(exprs){var predicate=forceBooleanContext(that.stx,that.stx.location,
exprs[0]),consequence=exprs.length>2?desugarAndExprs(exprs.slice(1)):forceBooleanContext(that.stx,that.stx.location,exprs[1]),alternative=new literal(false),ifLink=new ifExpr(predicate,consequence,alternative,ifStx),stxs=[alternative,ifStx,ifLink];stxs.forEach(function(stx){return stx.location=that.location});return ifLink}var ifChain=desugarAndExprs(exprs);ifChain.location=that.location;return[ifChain,pinfo]};orExpr.prototype.desugar=function(pinfo){var that=this,orStx=new symbolExpr("or"),exprsAndPinfo=
desugarProgram(this.exprs,pinfo),exprs=exprsAndPinfo[0],pinfo=exprsAndPinfo[1];function desugarOrExprs(exprs,pinfo){var firstExpr=exprs[0],exprLoc=firstExpr.location,pinfoAndTempSym=pinfo.gensym("tmp"),firstExprSym=pinfoAndTempSym[1],ifStx=new symbolExpr("if");firstExprSym.notOriginalSource=true;if(firstExpr.stx&&firstExpr.stx.val!=="if"){ifStx.location=firstExpr.location;firstExpr.stx=ifStx}var pinfo=pinfoAndTempSym[0],tmpBinding=new couple(firstExprSym,forceBooleanContext(that.stx,that.stx.location,
firstExpr)),secondExpr;if(exprs.length==2)secondExpr=forceBooleanContext(orStx,that.stx.location,exprs[1]);else{var secondExprAndPinfo=desugarOrExprs(exprs.slice(1),pinfo);secondExpr=secondExprAndPinfo[0];pinfo=secondExprAndPinfo[1]}var if_exp=new ifExpr(firstExprSym,firstExprSym,secondExpr,new symbolExpr("if")),let_exp=new letExpr([tmpBinding],if_exp,orStx),stxs=[orStx,firstExprSym,tmpBinding,if_exp,if_exp.stx,let_exp];stxs.forEach(function(stx){return stx.location=that.location});return let_exp.desugar(pinfo)}
return desugarOrExprs(exprs,pinfo)};quotedExpr.prototype.desugar=function(pinfo){if(typeof this.location==="undefined")throwError(new types.Message(["ASSERTION ERROR: Every quotedExpr should have a location"]),loc);function desugarQuotedItem(pinfo,loc){return function(x){if(x instanceof callExpr||x instanceof quotedExpr||x instanceof unsupportedExpr)return x.desugar(pinfo);else if(x instanceof symbolExpr||x instanceof literal||x instanceof Array){var res=new quotedExpr(x);res.location=loc;return[res,
pinfo]}else throwError(new types.Message(["ASSERTION ERROR: Found an unexpected item in a quotedExpr"]),loc)}}return desugarQuotedItem(pinfo,this.location)(this.val)};unquotedExpr.prototype.desugar=function(pinfo,depth){if(typeof depth==="undefined")throwError(new types.Message(["misuse of a ', not under a quasiquoting backquote"]),this.location);else if(depth===1)return this.val.desugar(pinfo);else if(depth>1){var rhs=this.val instanceof Array?desugarQuasiQuotedList(this.val,pinfo,depth-1)[0]:this.val.desugar(pinfo,
depth-1)[0];var uSym=new quotedExpr(new symbolExpr("unquote")),listSym=new symbolExpr("list"),listArgs=[uSym,rhs],listCall=new callExpr(listSym,listArgs);uSym.location=this.location;uSym.parent=listArgs;listSym.location=this.location;listSym.parent=listCall;listCall.location=this.location;return[listCall,pinfo]}else throwError(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),this.location)};unquoteSplice.prototype.desugar=function(pinfo,depth){if(typeof depth===
"undefined")throwError(new types.Message(["misuse of a ,@, not under a quasiquoting backquote"]),this.location);else if(depth===1)return this.val.desugar(pinfo);else if(depth>1){var rhs=this.val instanceof Array?desugarQuasiQuotedList(this.val,pinfo,depth-1)[0]:this.val.desugar(pinfo,depth-1)[0];var usSym=new quotedExpr(new symbolExpr("unquote-splicing")),listSym=new symbolExpr("list"),listArgs=[usSym,rhs],listCall=new callExpr(listSym,listArgs);usSym.location=this.location;usSym.parent=listArgs;
listSym.location=this.location;listSym.parent=listCall;listCall.location=this.location;return[listCall,pinfo]}else throwError(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),this.location)};function desugarQuasiQuotedList(qqlist,pinfo,depth){function desugarQuasiQuotedListElement(element,pinfo,depth,loc){if(depth===0&&element instanceof unquoteSplice)return element.desugar(pinfo,depth);else{var argument=element instanceof Array?desugarQuasiQuotedList(element,
depth,depth)[0]:element.desugar(pinfo,depth)[0],listSym=new symbolExpr("list"),listCall=new callExpr(listSym,[argument]);listSym.parent=listCall;listCall.location=listSym.location=loc;return[listCall,pinfo]}}var loc=typeof qqlist.location!="undefined"?qqlist.location:qqlist instanceof Array&&typeof qqlist[0].location!="undefined"?qqlist[0].location:throwError(types.Message(["ASSERTION FAILURE: couldn't find a usable location"]),new Location(0,0,0,0)),appendArgs=qqlist.map(function(x){return desugarQuasiQuotedListElement(x,
pinfo,depth,loc)[0]}),appendSym=new symbolExpr("append");appendSym.location=loc;var appendCall=new callExpr(appendSym,appendArgs);appendCall.location=loc;return[appendCall,pinfo]}quasiquotedExpr.prototype.desugar=function(pinfo,depth){depth=typeof depth==="undefined"?0:depth;if(depth>=0){var result;if(this.val instanceof Array)result=desugarQuasiQuotedList(this.val,pinfo,depth+1)[0];else result=this.val.desugar(pinfo,depth+1)[0]}else throwError(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),
this.location);if(depth==0)return[result,pinfo];else{var qqSym=new quotedExpr(new symbolExpr("quasiquote")),listArgs=[qqSym,result],listSym=new symbolExpr("list"),listCall=new callExpr(listSym,listArgs);qqSym.parent=listArgs;qqSym.location=this.location;result.parent=listArgs;listSym.parent=listCall;listSym.location=this.location;listCall.location=this.location;return[listCall,pinfo]}};symbolExpr.prototype.desugar=function(pinfo){if(!this.isClause&&this.val==="else"){var loc=this.parent&&this.parent[0]===
this?this.parent.location:this.location;throwError(new types.Message([new types.ColoredPart(this.val,loc),": not allowed ",new types.ColoredPart("here",loc),", because this is not a question in a clause"]),loc)}if(this.parent&&this.parent[0]!==this&&this.val==="define"){var msg=new types.Message([new types.ColoredPart(this.val,this.location),": not allowed inside an expression"]);throwError(msg,this.location)}if(!this.parent&&plt.compiler.keywords.indexOf(this.val)>-1&&this.val!=="else")throwError(new types.Message([new types.ColoredPart(this.val,
this.location),": expected an open parenthesis before ",this.val,", but found none"]),this.location);if(this.val==="."){var msg=new types.Message([this.location.source,":",this.location.startRow.toString(),":",this.location.startCol.toString(),": read: '.' is not supported as a symbol in WeScheme"]);throwError(msg,this.location,"Error-GenericReadError")}return[this,pinfo]};unsupportedExpr.prototype.desugar=function(pinfo){this.location.span=this.errorSpan;throwError(this.errorMsg,this.location,"Error-GenericReadError")};
Program.prototype.collectDefinitions=function(pinfo){return pinfo};function bf(name,modulePath,arity,vararity,loc){return new functionBinding(name,modulePath,arity,vararity,[],false,loc)}defFunc.prototype.collectDefinitions=function(pinfo){this.args.forEach(function(arg){if(plt.compiler.keywords.indexOf(arg.val)>-1)throwError(new types.Message([new types.ColoredPart(arg.val,arg.location),": this is a reserved keyword and cannot be used"+" as a variable or function name"]),arg.location)});var binding=
bf(this.name.val,false,this.args.length,false,this.name.location);return pinfo.accumulateDefinedBinding(binding,this.location)};defVar.prototype.collectDefinitions=function(pinfo){var binding=this.expr instanceof lambdaExpr?bf(this.name.val,false,this.expr.args.length,false,this.name.location):new constantBinding(this.name.val,false,[],this.name.location);return pinfo.accumulateDefinedBinding(binding,this.location)};defVars.prototype.collectDefinitions=function(pinfo){var that=this,fieldToAccessor=
function(f){return that.stx[1].val+"-"+f.val},fieldToMutator=function(f){return"set-"+that.stx[1].val+"-"+f.val+"!"};if(that.stx[0].val==="define-struct"){var id=that.stx[1].val,fields=that.stx[2],constructorId="make-"+id,predicateId=id+"?",selectorIds=fields.map(fieldToAccessor),mutatorIds=fields.map(fieldToMutator),structNameLoc=that.stx[1].location,structureBinding=new structBinding(id,false,fields,constructorId,predicateId,selectorIds,mutatorIds,null,that.stx[1].location),constructorBinding=bf(constructorId,
false,fields.length,false,structNameLoc),predicateBinding=bf(predicateId,false,1,false,structNameLoc),mutatorBinding=bf(id+"-set!",false,1,false,structNameLoc),refBinding=bf(id+"-ref",false,1,false,structNameLoc),bindings=[structureBinding,refBinding,constructorBinding,predicateBinding,mutatorBinding];return pinfo.accumulateDefinedBindings(bindings,that.location)}else return this.names.reduce(function(pinfo,id){var binding=new constantBinding(id.val,false,[],id.location);return pinfo.accumulateDefinedBinding(binding,
that.location)},pinfo)};requireExpr.prototype.collectDefinitions=function(pinfo){var moduleName=this.spec instanceof literal?this.spec.val.toString():this.spec.toString(),resolvedModuleName=pinfo.modulePathResolver(moduleName,pinfo.currentModulePath),that=this,newPinfo;function getWeSchemeModule(name){var m=name.match(/^wescheme\/(\w+)$/);return m?m[1]:false}function throwModuleError(moduleName){var bestGuess=plt.compiler.moduleGuess(that.spec.toString());var msg=new types.Message(["Found require of the module ",
new types.ColoredPart(that.spec.toString(),that.spec.location),", but this module is unknown.",bestGuess.name===that.spec.toString()?"":" Did you mean '"+bestGuess.name+"'?"]);throwError(msg,that.spec.location,"Error-UnknownModule")}if(!(resolvedModuleName||getWeSchemeModule(moduleName)))throwModuleError(moduleName);function processModule(moduleName){var provides=window.COLLECTIONS[moduleName].provides;var strToBinding=function(p){var b=new constantBinding(p,new symbolExpr(moduleName),false);b.imported=
true;return b},provideBindings=provides.map(strToBinding),modulebinding=new moduleBinding(moduleName,provideBindings);newPinfo=pinfo.accumulateModule(modulebinding).accumulateModuleBindings(provideBindings)}var url=window.location.protocol+"//"+window.location.host+(getWeSchemeModule(moduleName)?"/loadProject?publicId="+getWeSchemeModule(moduleName):"/js/mzscheme-vm/collects/"+moduleName+".js");console.log(url);if(window.COLLECTIONS&&window.COLLECTIONS[moduleName])processModule(moduleName);else jQuery.ajax({url:url,
success:function(result){try{if(getWeSchemeModule(moduleName)){var program=(0,eval)("("+result+")");if(window.COLLECTIONS===undefined)window.COLLECTIONS=[];var lexemes=plt.compiler.lex(program.source.src,moduleName),AST=plt.compiler.parse(lexemes),desugared=plt.compiler.desugar(AST)[0],pinfo=plt.compiler.analyze(desugared),objectCode=plt.compiler.compile(desugared,pinfo);window.COLLECTIONS[moduleName]={"name":moduleName,"bytecode":(0,eval)("("+objectCode.bytecode+")"),"provides":objectCode.provides}}else eval(result);
if(result)processModule(moduleName);else throwModuleError(moduleName)}catch(e){if(e.type==="moby-failure")throw e;var msg=new types.Message(["A network error occured when trying to load ",new types.ColoredPart(that.spec.toString(),that.spec.location),". Please check your connection and try again."]);throwError(msg,that.spec.location,"Error-NetworkError")}},error:function(error){throwModuleError(moduleName)},async:false});return newPinfo};function provideBindingId(symbl){this.symbl=symbl}function provideBindingStructId(symbl){this.symbl=
symbl}Program.prototype.collectProvides=function(pinfo){return pinfo};provideStatement.prototype.collectProvides=function(pinfo){var that=this;function addProvidedName(id){pinfo.providedNames.put(id,new provideBindingId(id))}function collectProvidesFromClause(pinfo,clause){if(clause instanceof symbolExpr)if(pinfo.definedNames.containsKey(clause.val)){addProvidedName(clause.val);return pinfo}else{var msg=new types.Message(["The name '",new types.ColoredPart(clause.toString(),clause.location),"', is not defined in the program, and cannot be provided."]);
throwError(msg,clause.location)}else if(clause instanceof Array)if(pinfo.definedNames.containsKey(clause[1].val)&&pinfo.definedNames.get(clause[1].val)instanceof structBinding){var b=pinfo.definedNames.get(clause[1].val),fns=[b.name,b.constructor,b.predicate].concat(b.accessors,b.mutators);fns.forEach(addProvidedName);return pinfo}else throwError(new types.Message(["The struct '",new types.ColoredPart(clause[1].toString(),clause[1].location),"', is not defined in the program, and cannot be provided"]),
clause.location);else throw"Impossible: all invalid provide clauses should have been filtered out!";}return this.clauses.reduce(collectProvidesFromClause,pinfo)};Program.prototype.analyzeUses=function(pinfo,env){return pinfo};defVar.prototype.analyzeUses=function(pinfo){pinfo.env.extend(this.expr instanceof lambdaExpr?bf(this.name.val,false,this.expr.args.length,false,this.location):new constantBinding(this.name.val,false,[],this.name.location));return this.expr.analyzeUses(pinfo,pinfo.env)};defVars.prototype.analyzeUses=
function(pinfo){this.names.forEach(function(id){pinfo.env.extend(new constantBinding(id.val,false,[],id.location))});return this.expr.analyzeUses(pinfo,pinfo.env)};function analyzeClosureUses(funcExpr,pinfo){var oldEnv=pinfo.env,oldKeys=oldEnv.bindings.keys(),newBindings=types.makeLowLevelEqHash();oldKeys.forEach(function(k){newBindings.put(k,oldEnv.bindings.get(k))});var newEnv=new plt.compiler.env(newBindings),newEnv=funcExpr.args.reduce(function(env,arg){return env.extend(new constantBinding(arg.val,
false,[],arg.location))},newEnv);pinfo.env=newEnv;pinfo=funcExpr.body.analyzeUses(pinfo,newEnv);pinfo.env=oldEnv;return pinfo}defFunc.prototype.analyzeUses=function(pinfo){pinfo.env=pinfo.env.extend(bf(this.name.val,false,this.args.length,false,this.name.location));return analyzeClosureUses(this,pinfo)};lambdaExpr.prototype.analyzeUses=function(pinfo,env){return analyzeClosureUses(this,pinfo)};beginExpr.prototype.analyzeUses=function(pinfo,env){return this.exprs.reduce(function(p,expr){return expr.analyzeUses(p,
env)},pinfo)};localExpr.prototype.analyzeUses=function(pinfo,env){var pinfoAfterDefs=this.defs.reduce(function(pinfo,d){return d.analyzeUses(pinfo,env)},pinfo);return this.body.analyzeUses(pinfoAfterDefs,pinfoAfterDefs.env)};callExpr.prototype.analyzeUses=function(pinfo,env){return[this.func].concat(this.args).reduce(function(p,arg){return arg instanceof Array?arg.reduce(function(pinfo,p){return p.analyzeUses(pinfo,pinfo.env)},pinfo):arg.analyzeUses(p,env)},pinfo)};ifExpr.prototype.analyzeUses=function(pinfo,
env){var exps=[this.predicate,this.consequence,this.alternative];return exps.reduce(function(p,exp){return exp.analyzeUses(p,env)},pinfo)};symbolExpr.prototype.analyzeUses=function(pinfo,env){if(plt.compiler.keywords.indexOf(this.val)>-1&&(!this.parent||this.parent[0]!==this)||this.parent instanceof couple)throwError(new types.Message([new types.ColoredPart(this.val,this.location),": expected an open parenthesis before ",this.val,", but found none"]),this.location);var binding=env.lookup_context(this.val);
if(binding){this.bindingLoc=binding.loc;return pinfo.accumulateBindingUse(binding,pinfo)}else return pinfo.accumulateFreeVariableUse(this.val,pinfo)};function analyze(programs){return programAnalyzeWithPinfo(programs,plt.compiler.getBasePinfo("base"))}function programAnalyzeWithPinfo(programs,pinfo){function collectDefinitions(programs,pinfo){return programs.reduce(function(pinfo,p){return p.collectDefinitions(pinfo)},pinfo)}function collectProvides(programs,pinfo){return programs.reduce(function(pinfo,
p){return p.collectProvides(pinfo)},pinfo)}function analyzeUses(programs,pinfo){return programs.reduce(function(pinfo,p){return p.analyzeUses(pinfo,pinfo.env)},pinfo)}var pinfo1=collectDefinitions(programs,pinfo);var pinfo2=collectProvides(programs,pinfo1);return analyzeUses(programs,pinfo2)}plt.compiler.desugar=function(p,pinfo,debug){var start=(new Date).getTime();try{var ASTandPinfo=desugarProgram(p,pinfo,true),program=ASTandPinfo[0],pinfo=ASTandPinfo[1]}catch(e){console.log("DESUGARING ERROR");
throw e;}var end=(new Date).getTime();if(debug){console.log("Desugared in "+Math.floor(end-start)+"ms");console.log(program);console.log(program.toString())}return ASTandPinfo};plt.compiler.analyze=function(program,debug){var start=(new Date).getTime();try{var pinfo=analyze(program)}catch(e){console.log("ANALYSIS ERROR");throw e;}var end=(new Date).getTime();if(debug)console.log("Analyzed in "+Math.floor(end-start)+"ms");return pinfo};plt.compiler.provideBindingId=provideBindingId;plt.compiler.provideBindingStructId=
provideBindingStructId})();goog.provide("plt.compiler.compile");goog.provide("plt.compiler.localStackReference");goog.provide("plt.compiler.globalStackReference");goog.provide("plt.compiler.unboundStackReference");goog.require("plt.compiler.literal");goog.require("plt.compiler.symbolExpr");goog.require("plt.compiler.Program");goog.require("plt.compiler.ifExpr");goog.require("plt.compiler.beginExpr");goog.require("plt.compiler.localExpr");goog.require("plt.compiler.andExpr");goog.require("plt.compiler.orExpr");goog.require("plt.compiler.lambdaExpr");
goog.require("plt.compiler.quotedExpr");goog.require("plt.compiler.callExpr");goog.require("plt.compiler.defFunc");goog.require("plt.compiler.defVar");goog.require("plt.compiler.defVars");goog.require("plt.compiler.defStruct");goog.require("plt.compiler.requireExpr");goog.require("plt.compiler.provideStatement");window.plt=window.plt||{};plt.compiler=plt.compiler||{};
(function(){var literal=plt.compiler.literal;var symbolExpr=plt.compiler.symbolExpr;var Program=plt.compiler.Program;var ifExpr=plt.compiler.ifExpr;var beginExpr=plt.compiler.beginExpr;var localExpr=plt.compiler.localExpr;var andExpr=plt.compiler.andExpr;var orExpr=plt.compiler.orExpr;var lambdaExpr=plt.compiler.lambdaExpr;var quotedExpr=plt.compiler.quotedExpr;var callExpr=plt.compiler.callExpr;var defFunc=plt.compiler.defFunc;var defVar=plt.compiler.defVar;var defVars=plt.compiler.defVars;var defStruct=
plt.compiler.defStruct;var requireExpr=plt.compiler.requireExpr;var provideStatement=plt.compiler.provideStatement;var heir=function(p){var f=function(){};f.prototype=p;return new f};literal.prototype.toBytecode=function(){var str=this.val.toBytecode?this.val.toBytecode():this.val===true?"true":this.val===false?"false":this.toString();return'{"$":"constant","value":'+str+"}"};symbolExpr.prototype.toBytecode=function(){return'types.symbol("'+escapeSym(this.val)+'")'};Vector.prototype.toBytecode=function(){return"types.vector(["+
this.elts.join(",")+"])"};Array.prototype.toBytecode=function(quoted){return"types."+(this.length===0?"EMPTY":"list(["+this.map(convertToBytecode).join(",")+"])")};jsnums.Rational.prototype.toBytecode=function(){return"types.rational("+convertToBytecode(this.n)+", "+convertToBytecode(this.d)+")"};jsnums.BigInteger.prototype.toBytecode=function(){return'types.bignum("'+this.toString()+'")'};jsnums.FloatPoint.prototype.toBytecode=function(){var num=this.toString();if(num==="+nan.0")num="NaN";if(num===
"+inf.0")num="Infinity";if(num==="-inf.0")num="-Infinity";return'types["float"]('+num+")"};jsnums.Complex.prototype.toBytecode=function(){return"types.complex("+convertToBytecode(this.r)+", "+convertToBytecode(this.i)+")"};Char.prototype.toBytecode=function(){return"types['char'](String.fromCharCode("+this.val.charCodeAt(0)+"))"};function stackReference(){}function localStackReference(name,isBoxed,depth){stackReference.call(this);this.name=name;this.isBoxed=isBoxed;this.depth=depth}localStackReference.prototype=
heir(stackReference.prototype);function globalStackReference(name,depth,pos){stackReference.call(this);this.name=name;this.pos=pos;this.depth=depth}globalStackReference.prototype=heir(stackReference.prototype);function unboundStackReference(name){stackReference.call(this);this.name=name}unboundStackReference.prototype=heir(stackReference.prototype);var Bytecode=function(){this.toBytecode=function(){console.log(this);throw"IMPOSSIBLE - generic bytecode toBytecode method was called";}};function convertToBytecode(bc){if(types.isString(bc)&&
bc.chars!==undefined)return'"'+bc.toString()+'"';return bc.toBytecode?bc.toBytecode():bc}function escapeSym(symName){var str=symName.toString().replace(/\|/g,""),bcStr="";var escapes=["{","}","[","]",",","'","`"," ","\\",'"'];for(var j=0;j<str.length;j++)bcStr+=(escapes.indexOf(str.charAt(j))>-1?"\\":"")+str.charAt(j);bcStr=bcStr.replace(/\n/g,"\\n");return bcStr}function globalBucket(name){Bytecode.call(this);this.name=name;this.toBytecode=function(){return'{"$":"global-bucket","value":"'+escapeSym(this.name)+
'"}'}}globalBucket.prototype=heir(Bytecode.prototype);function moduleVariable(modidx,sym,pos,phase){Bytecode.call(this);this.$="module-variable";this.modidx=modidx;this.sym=sym;this.pos=pos;this.phase=phase;this.toBytecode=function(){return'{"$":"module-variable","sym":'+this.sym.toBytecode()+',"modidx":'+this.modidx.toBytecode()+',"pos":'+this.pos+',"phase":'+this.phase+"}"}}moduleVariable.prototype=heir(Bytecode.prototype);function wrap(){Bytecode.call(this)}wrap.prototype=heir(Bytecode.prototype);
function wrapped(datum,wraps,certs){Bytecode.call(this);this.datum=datum;this.wraps=wraps;this.certs=certs}wrapped.prototype=heir(Bytecode.prototype);function stx(encoded){this.encoded=encoded;Bytecode.call(this)}stx.prototype=heir(Bytecode.prototype);function prefix(numLifts,topLevels,stxs){Bytecode.call(this);this.numLifts=numLifts;this.topLevels=topLevels;this.stxs=stxs;this.toBytecode=function(){return'{"$":"prefix","num-lifts":'+this.numLifts+',"toplevels":['+this.topLevels.map(function(v){return convertToBytecode(v)}).join(",")+
'],"stxs":['+this.stxs.map(convertToBytecode)+"]}"}}prefix.prototype=heir(Bytecode.prototype);function form(){Bytecode.call(this)}form.prototype=heir(Bytecode.prototype);function expr(form){Bytecode.call(this)}expr.prototype=heir(Bytecode.prototype);function indirect(v){Bytecode.call(this);this.v=v;this.toBytecode=function(){return'{"$":"indirect","v":'+this.v.toBytecode()+"}"}}indirect.prototype=heir(Bytecode.prototype);function compilationTop(maxLetDepth,prefix,code){Bytecode.call(this);this.maxLetDepth=
maxLetDepth;this.prefix=prefix;this.code=code;this.toBytecode=function(){return'{"$":"compilation-top","max-let-depth":'+this.maxLetDepth+',"prefix":'+this.prefix.toBytecode()+',"compiled-indirects":[],"code":'+this.code.toBytecode()+"}"}}compilationTop.prototype=heir(Bytecode.prototype);function provided(name,src,srcName,nomSrc,srcPhase,isProtected,insp){Bytecode.call(this);this.name=name;this.src=src;this.srcName=srcName;this.nomSrc=nomSrc;this.srcPhase=srcPhase;this.insp=insp;this.isProtected=
isProtected}provided.prototype=heir(Bytecode.prototype);function topLevel(depth,pos,constant,ready,loc){Bytecode.call(this);this.depth=depth;this.pos=pos;this.constant=constant;this.ready=ready;this.loc=loc;this.toBytecode=function(){return'{"$":"toplevel","depth":'+this.depth.toString()+',"pos":'+this.pos.toString()+',"const?":'+this.constant+',"ready?":'+this.ready+',"loc":'+(this.loc&&this.loc.toVector().toBytecode())+"}"}}topLevel.prototype=heir(Bytecode.prototype);function seq(forms){Bytecode.call(this);
this.forms=forms;this.toBytecode=function(){return'{"$":"seq","forms":['+this.forms.map(convertToBytecode).join(",")+"]}"}}seq.prototype=heir(Bytecode.prototype);function defValues(ids,rhs){Bytecode.call(this);this.ids=ids;this.rhs=rhs;this.toBytecode=function(){return'{"$":"def-values","ids":['+this.ids.map(convertToBytecode).join(",")+'],"body":'+this.rhs.toBytecode()+"}"}}defValues.prototype=heir(Bytecode.prototype);function defSyntaxes(ids,rhs,prefix,maxLetDepth){Bytecode.call(this);this.$="def-values";
this.ids=ids;this.rhs=rhs;this.prefix=prefix;this.maxLetDepth=maxLetDepth;this.toBytecode=function(){return'{"$":"def-values","ids":['+this.ids.toBytecode().join(",")+'],"rhs":'+this.rhs.toBytecode()+',"prefix":'+this.prefix.toBytecode()+',"max-let-depth":'+this.maxLetDepth.toBytecode()+"}"}}defSyntaxes.prototype=heir(Bytecode.prototype);function defForSyntax(ids,rhs,prefix,maxLetDepth){Bytecode.call(this);this.ids=ids;this.rhs=rhs;this.prefix=prefix;this.maxLetDepth=maxLetDepth}defForSyntax.prototype=
heir(Bytecode.prototype);function mod(name,selfModidx,prefix,provides,requires,body,syntaxBody,unexported,maxLetDepth,dummy,langInfo,internalContext){Bytecode.call(this);this.name=name;this.selfModidx=selfModidx;this.prefix=prefix;this.provides=provides;this.requires=requires;this.body=body;this.syntaxBody=syntaxBody;this.unexported=unexported;this.maxLetDepth=maxLetDepth;this.dummy=dummy;this.langInfo=langInfo;this.internalContext=internalContext;this.toBytecode=function(){return'{"$":"mod","name":'+
this.name.toBytecode()+',"self-modidx":'+this.selfModidx.toBytecode()+',"prefix":'+this.prefix.toBytecode()+',"provides":'+this.provides.toBytecode()+',"requires":'+(this.requires&&this.requires.toVector().toBytecode())+',"body":'+this.body.toBytecode()+',"stx-body":'+this.syntaxBody.toBytecode()+',"max-let-depth":'+this.maxLetDepth.toBytecode()+"}"}}mod.prototype=heir(Bytecode.prototype);function lam(name,operatorAndRandLocs,flags,numParams,paramTypes,rest,closureMap,closureTypes,maxLetDepth,body){Bytecode.call(this);
this.name=name;this.flags=flags;this.numParams=numParams;this.paramTypes=paramTypes;this.rest=rest;this.body=body;this.closureMap=closureMap;this.maxLetDepth=maxLetDepth;this.closureTypes=closureTypes;this.operatorAndRandLocs=operatorAndRandLocs;this.toBytecode=function(){return'{"$":"lam","name":'+this.name.toBytecode()+',"locs":['+this.operatorAndRandLocs.map(convertToBytecode).join(",")+'],"flags":['+this.flags.map(convertToBytecode).join(",")+'],"num-params":'+this.numParams+',"param-types":['+
this.paramTypes.map(convertToBytecode).join(",")+'],"rest?":'+this.rest+',"closure-map":['+this.closureMap.map(convertToBytecode).join(",")+'],"closure-types":['+this.closureTypes.map(convertToBytecode).join(",")+'],"max-let-depth":'+this.maxLetDepth+',"body":'+this.body.toBytecode()+"}"}}lam.prototype=heir(Bytecode.prototype);function closure(code,genId){Bytecode.call(this);this.code=code;this.genId=genId;this.toBytecode=function(){return'{"$":"closure","code":'+this.code.toBytecode()+',"gen-id":'+
this.genId.toBytecode()+"}"}}closure.prototype=heir(Bytecode.prototype);function caseLam(name,clauses){Bytecode.call(this);this.name=name;this.clauses=clauses;this.toBytecode=function(){return'{"$":"case-lam","name":'+this.name.toBytecode()+',"clauses":'+this.clauses.toBytecode()+"}"}}caseLam.prototype=heir(Bytecode.prototype);function letOne(rhs,body,flonum){Bytecode.call(this);this.rhs=rhs;this.body=body;this.flonum=flonum;this.toBytecode=function(){return'{"$": "let-one","rhs":'+this.rhs.toBytecode()+
',"body":'+this.body.toBytecode()+',"flonum":'+this.flonum.toBytecode()+"}"}}letOne.prototype=heir(Bytecode.prototype);function letVoid(count,boxes,body){Bytecode.call(this);this.count=count;this.boxes=boxes;this.body=body;this.toBytecode=function(){return'{"$":"let-void","count":'+convertToBytecode(this.count)+',"boxes?":'+convertToBytecode(this.boxes)+',"body":'+this.body.toBytecode()+"}"}}letVoid.prototype=heir(Bytecode.prototype);function letRec(procs,body){Bytecode.call(this);this.procs=procs;
this.body=body;this.toBytecode=function(){return'{"$":"let-rec","procs":'+this.procs.toBytecode()+',"body":'+this.body.toBytecode()+"}"}}letRec.prototype=heir(Bytecode.prototype);function installValue(count,pos,boxes,rhs,body){Bytecode.call(this);this.count=count;this.pos=pos;this.boxes=boxes;this.rhs=rhs;this.body=body;this.toBytecode=function(){return'{"$":"install-value","count":'+convertToBytecode(this.count)+',"pos":'+convertToBytecode(this.pos)+',"boxes?":'+convertToBytecode(this.boxes)+',"rhs":'+
this.rhs.toBytecode()+',"body":'+this.body.toBytecode()+"}"}}installValue.prototype=heir(Bytecode.prototype);function boxEnv(pos,body){Bytecode.call(this);this.pos=pos;this.body=body;this.toBytecode=function(){return'{"$":"boxenv","pos":'+this.pos.toBytecode()+',"body":'+this.body.toBytecode()+"}"}}boxEnv.prototype=heir(Bytecode.prototype);function localRef(unbox,pos,clear,otherClears,flonum){Bytecode.call(this);this.unbox=unbox||false;this.pos=pos;this.clear=clear;this.flonum=flonum;this.otherClears=
otherClears;this.toBytecode=function(){return'{"$":"localref","unbox?":'+this.unbox+',"pos":'+this.pos+',"clear":'+this.clear+',"other-clears?":'+this.otherClears+',"flonum?":'+this.flonum+"}"}}localRef.prototype=heir(Bytecode.prototype);function topSyntax(depth,pos,midpt){Bytecode.call(this);this.depth=depth;this.pos=pos;this.midpt=midpt}topSyntax.prototype=heir(Bytecode.prototype);function application(rator,rands){Bytecode.call(this);this.rator=rator;this.rands=rands;this.toBytecode=function(){return'{"$":"application","rator":'+
this.rator.toBytecode()+',"rands":['+this.rands.map(convertToBytecode).join(",")+"]}"}}application.prototype=heir(Bytecode.prototype);function branch(testExpr,thenExpr,elseExpr){Bytecode.call(this);this.testExpr=testExpr;this.thenExpr=thenExpr;this.elseExpr=elseExpr;this.toBytecode=function(){return'{"$":"branch","test":'+this.testExpr.toBytecode()+',"then":'+this.thenExpr.toBytecode()+',"else":'+this.elseExpr.toBytecode()+"}"}}branch.prototype=heir(Bytecode.prototype);function withContMark(key,val,
body){Bytecode.call(this);this.$="with-cont-mark";this.key=key;this.val=val;this.body=body;this.toBytecode=function(){return'{"$":"with-cont-mark","key":'+(new literal(new symbolExpr(this.key))).toBytecode()+',"val":'+(new literal(this.val)).toBytecode()+',"body":'+this.body.toBytecode()+"}"}}withContMark.prototype=heir(Bytecode.prototype);function beg0(seq){Bytecode.call(this);this.seq=seq;this.toBytecode=function(){return'{"$":"beg0","seq":'+this.seq.toBytecode()+"}"}}beg0.prototype=heir(Bytecode.prototype);
function splice(forms){Bytecode.call(this);this.forms=forms;this.toBytecode=function(){return'{"$":"splice","forms":'+this.forms.toBytecode()+"}"}}splice.prototype=heir(Bytecode.prototype);function varRef(topLevel){Bytecode.call(this);this.topLevel=topLevel;this.toBytecode=function(){return'{"$":"varref","top-level":'+this.topLevel.toBytecode()+"}"}}varRef.prototype=heir(Bytecode.prototype);function assign(id,rhs,undefOk){Bytecode.call(this);this.id=id;this.rhs=rhs;this.undefOk=undefOk;this.toBytecode=
function(){return'{"$":"assign","id":'+this.id.toBytecode()+',"rhs":'+this.rhs.toBytecode()+',"undef-ok":'+this.undefOk.toBytecode()+"}"}}assign.prototype=heir(Bytecode.prototype);function applyValues(proc,args){Bytecode.call(this);this.proc=proc;this.args=args;this.toBytecode=function(){return'{"$":"apply-values","proc":'+this.proc.toBytecode()+',"args":'+this.args.toBytecode()+"}"}}applyValues.prototype=heir(Bytecode.prototype);function primVal(id){Bytecode.call(this);this.id=id;this.toBytecode=
function(){return'{"$":"primval","id":'+this.id.toBytecode()+"}"}}primVal.prototype=heir(Bytecode.prototype);function req(reqs,dummy){Bytecode.call(this);this.$="req";this.reqs=reqs;this.dummy=dummy;this.toBytecode=function(){var reqBytecode=this.reqs instanceof literal?'"'+this.reqs.val+'"':this.reqs.toBytecode();return'{"$":"req","reqs":'+reqBytecode+',"dummy":'+this.dummy.toBytecode()+"}"}}req.prototype=heir(Bytecode.prototype);function lexicalRename(bool1,bool2,alist){this.bool1=bool1;this.bool2=
bool2;this.alist=alist;Bytecode.call(this)}lexicalRename.prototype=heir(Bytecode.prototype);function phaseShift(amt,src,dest){this.amt=amt;this.src=src;this.dest=dest;Bytecode.call(this)}phaseShift.prototype=heir(Bytecode.prototype);function wrapMark(val){this.val=val;Bytecode.call(this)}wrapMark.prototype=heir(Bytecode.prototype);function prune(sym){this.sym=sym;Bytecode.call(this)}prune.prototype=heir(Bytecode.prototype);function allFromModule(path,phase,srcPhase,exceptions,prefix){this.path=path;
this.phase=phase;this.srcPhase=srcPhase;this.prefix=prefix;this.exceptions=exceptions;Bytecode.call(this)}allFromModule.prototype=heir(Bytecode.prototype);function nominalPath(){Bytecode.call(this)}nominalPath.prototype=heir(Bytecode.prototype);function simpleNominalPath(value){this.value=value;Bytecode.call(this)}simpleNominalPath.prototype=heir(Bytecode.prototype);function phasedModuleBinding(path,phase,exportName,nominalPath,nominalExportName){this.path=path;this.phase=phase;this.exportName=nominalPath;
this.nominalExportName=nominalExportName;Bytecode.call(this)}phasedModuleBinding.prototype=heir(Bytecode.prototype);function exportedNominalModuleBinding(path,exportName,nominalPath,nominalExportName){this.path=path;this.exportName=exportName;this.nominalPath=nominalPath;this.nominalExportName=nominalExportName;Bytecode.call(this)}exportedNominalModuleBinding.prototype=heir(Bytecode.prototype);function nominalModuleBinding(path,nominalPath){this.path=path;this.nominalPath=nominalPath;Bytecode.call(this)}
nominalModuleBinding.prototype=heir(Bytecode.prototype);function exportedModuleBinding(path,exportName){this.path=path;this.exportName=exportName;Bytecode.call(this)}exportedModuleBinding.prototype=heir(Bytecode.prototype);function simpleModuleBinding(path){this.path=path;Bytecode.call(this)}simpleModuleBinding.prototype=heir(Bytecode.prototype);function ModuleRename(phase,kind,setId,unmarshals,renames,markRenames,plusKern){this.phase=phase;this.kind=kind;this.unmarshals=unmarshals;this.renames=renames;
this.markRenames=markRenames;this.plusKern=plusKern;Bytecode.call(this)}ModuleRename.prototype=heir(Bytecode.prototype);function modulePath(path,base){this.path=path;this.base=base;Bytecode.call(this);this.toBytecode=function(){return'{"$":"module-path","path":'+convertToBytecode(this.path)+',"base":'+convertToBytecode(this.base)+"}"}}modulePath.prototype=heir(Bytecode.prototype);Program.prototype.freeVariables=function(acc,env){return acc};ifExpr.prototype.freeVariables=function(acc,env){return this.alternative.freeVariables(this.consequence.freeVariables(this.predicate.freeVariables(acc,
env),env),env)};beginExpr.prototype.freeVariables=function(acc,env){return this.exprs.reduceRight(function(acc,expr){return expr.freeVariables(acc,env)},acc)};symbolExpr.prototype.freeVariables=function(acc,env){return env.lookup(this.val,0)instanceof unboundStackReference&&acc.indexOf(this)==-1?acc.concat([this]):acc};localExpr.prototype.freeVariables=function(acc,env){var pushLocalBoxedFromSym=function(env,sym){return new plt.compiler.localEnv(sym.val,true,env)},pushLocalFromSym=function(env,sym){return new plt.compiler.localEnv(sym.val,
false,env)};var definedNames=this.defs.reduce(function(names,d){return(d instanceof defVars?d.names:[d.name]).concat(names)},[]),updatedEnv=definedNames.reduce(pushLocalBoxedFromSym,env),freeVarsInBody=this.body.freeVariables(acc,updatedEnv),addFreeVarsInDef=function(acc,d){if(d instanceof defFunc){var envWithArgs=d.args.reduce(function(env,arg){return pushLocalFromSym(env,arg)},updatedEnv);return d.body.freeVariables(acc,envWithArgs)}if(d instanceof defStruct)return acc;else return d.expr.freeVariables(acc,
updatedEnv)};return this.defs.reduce(addFreeVarsInDef,freeVarsInBody)};andExpr.prototype.freeVariables=function(acc,env){return this.exprs.reduceRight(function(acc,expr){return expr.freeVariables(acc,env)},acc)};orExpr.prototype.freeVariables=function(acc,env){return this.exprs.reduceRight(function(acc,expr){return expr.freeVariables(acc,env)},acc)};lambdaExpr.prototype.freeVariables=function(acc,env){var pushLocalFromSym=function(env,sym){return new plt.compiler.localEnv(sym.val,false,env)},envWithArgs=
this.args.slice(0).reverse().reduce(pushLocalFromSym,env);return this.body.freeVariables(acc,envWithArgs)};quotedExpr.prototype.freeVariables=function(acc,env){return acc};callExpr.prototype.freeVariables=function(acc,env){return this.func.freeVariables(acc,env).concat(this.args).reduceRight(function(acc,expr){return expr.freeVariables(acc,env)},acc)};function sortAndUnique(elts,lessThan,equalTo){function unique(elts){return elts.length<=1?elts:equalTo(elts[0],elts[1])?unique(elts.slice(1)):[elts[0]].concat(unique(elts.slice(1)))}
var convertedSortFn=function(x,y){return lessThan(x,y)?-1:lessThan(y,x)};return unique(elts.sort(convertedSortFn))}function compilePrograms(acc,p){var bytecodes=acc[0],pinfo=acc[1],env=acc[2],compiledProgramAndPinfo=p.compile(env,pinfo),compiledProgram=compiledProgramAndPinfo[0],pinfo=compiledProgramAndPinfo[1];return[[compiledProgram].concat(bytecodes),pinfo,env]}Program.prototype.compile=function(env,pinfo){return[this,pinfo]};defFunc.prototype.compile=function(env,pinfo){var compiledFunNameAndPinfo=
this.name.compile(env,pinfo),compiledFunName=compiledFunNameAndPinfo[0],pinfo=compiledFunNameAndPinfo[1];var lambda=new lambdaExpr(this.args,this.body),compiledLambdaAndPinfo=lambda.compile(env,pinfo,false,this.name),compiledLambda=compiledLambdaAndPinfo[0],pinfo=compiledLambdaAndPinfo[1];var bytecode=new defValues([compiledFunName],compiledLambda);return[bytecode,pinfo]};defVar.prototype.compile=function(env,pinfo){var compiledIdAndPinfo=this.name.compile(env,pinfo),compiledId=compiledIdAndPinfo[0],
pinfo=compiledIdAndPinfo[1];var compiledExprAndPinfo=this.expr.compile(env,pinfo),compiledExpr=compiledExprAndPinfo[0],pinfo=compiledExprAndPinfo[1];var bytecode=new defValues([compiledId],compiledExpr);return[bytecode,pinfo]};defVars.prototype.compile=function(env,pinfo){var compiledIdsAndPinfo=this.names.reduceRight(compilePrograms,[[],pinfo,env]),compiledIds=compiledIdsAndPinfo[0],pinfo=compiledIdsAndPinfo[1];var compiledBodyAndPinfo=this.expr.compile(env,pinfo),compiledBody=compiledBodyAndPinfo[0],
pinfo=compiledBodyAndPinfo[1];var bytecode=new defValues(compiledIds,compiledBody);return[bytecode,pinfo]};beginExpr.prototype.compile=function(env,pinfo){var compiledExpressionsAndPinfo=this.exprs.reduceRight(compilePrograms,[[],pinfo,env]),compiledExpressions=compiledExpressionsAndPinfo[0],pinfo1=compiledExpressionsAndPinfo[1];var bytecode=new seq(compiledExpressions);return[bytecode,pinfo1]};lambdaExpr.prototype.compile=function(env,pinfo,isUnnamedLambda,name){if(isUnnamedLambda===undefined)isUnnamedLambda=
true;function maskUnusedGlobals(listOfNames,namesToKeep){return listOfNames.map(function(n){return namesToKeep.indexOf(n)>-1?n:false})}function pushLocal(env,n){return new plt.compiler.localEnv(n,false,env)}function pushLocalBoxed(env,n){return new plt.compiler.localEnv(n,true,env)}function pushGlobals(names,env){return new plt.compiler.globalEnv(names,false,env)}function getClosureVectorAndEnv(args,freeVariables,originalEnv){var freeVariableRefs=freeVariables.map(function(v){return originalEnv.lookup(v.val,
0)}),ormap=function(f,l){return l.length===0?false:f(l[0])?l[0]:ormap(f,l.slice(1))},isLocalStackRef=function(r){return r instanceof localStackReference},isGlobalStackRef=function(r){return r instanceof globalStackReference},isUnboundStackRef=function(r){return r instanceof unboundStackReference},getDepthFromRef=function(r){return r.depth},anyUnboundStackRefs=ormap(isUnboundStackRef,freeVariableRefs);if(anyUnboundStackRefs)throw"Can't produce closure; I don't know where "+anyUnboundStackRefs.name+
" is bound.";else{var lexicalFreeRefs=sortAndUnique(freeVariableRefs.filter(isLocalStackRef),function(x,y){return x.depth<y.depth},function(x,y){return x.depth===y.depth}),lexicalFreeDepths=lexicalFreeRefs.map(getDepthFromRef),globalRefs=freeVariableRefs.filter(isGlobalStackRef),globalDepths=sortAndUnique(globalRefs.map(getDepthFromRef),function(x,y){return x<y},function(x,y){return x===y});var env1=args.reverse().map(function(s){return s.val}).reduce(pushLocal,originalEnv);var env2=lexicalFreeRefs.reverse().reduce(function(env,
ref){return ref.isBoxed?pushLocalBoxed(env,ref.name):pushLocal(env,ref.name)},env1);var env3=globalDepths.reverse().reduce(function(env,depth){var refsAtDepth=globalRefs.filter(function(ref){return ref.depth===depth}),usedGlobals=refsAtDepth.map(function(ref){return ref.name}),newGlobals=maskUnusedGlobals(originalEnv.peek(depth).names,usedGlobals);return pushGlobals(newGlobals,env)},env2);return[globalDepths.concat(lexicalFreeDepths),env3]}}var envWithArgs=this.args.map(function(s){return s.val}).reduce(pushLocal,
new plt.compiler.emptyEnv);freeVarsInBody=this.body.freeVariables([],envWithArgs);var closureVectorAndEnv=getClosureVectorAndEnv(this.args.slice(0),freeVarsInBody,env),closureVector=closureVectorAndEnv[0],extendedEnv=closureVectorAndEnv[1];var compiledBodyAndPinfo=this.body.compile(extendedEnv,pinfo),compiledBody=compiledBodyAndPinfo[0],pinfo1=compiledBodyAndPinfo[1];var getLocs=function(id){return id.location.toVector()},bytecode=new lam(isUnnamedLambda?[]:new symbolExpr(name),[isUnnamedLambda?this.stx:
name].concat(this.args).map(getLocs),[],this.args.length,this.args.map(function(){return new symbolExpr("val")}),false,closureVector,closureVector.map(function(){return new symbolExpr("val/ref")}),0,compiledBody);return[bytecode,pinfo1]};localExpr.prototype.compile=function(env,pinfo){if(this.defs.length===0)return this.body.compile(env,pinfo);var that=this,definedNames=this.defs.reduce(getDefinedNames,[]),pushLocalBoxedFromSym=function(env,sym){return new plt.compiler.localEnv(sym.val,true,env)},
envWithBoxedNames=definedNames.reverse().reduce(pushLocalBoxedFromSym,env);var letVoidBodyAndPinfo=processDefns(this.defs,pinfo,envWithBoxedNames,0),letVoidBody=letVoidBodyAndPinfo[0],pinfo=letVoidBodyAndPinfo[1];return[new letVoid(definedNames.length,true,letVoidBody),pinfo];function getDefinedNames(names,def){return names.concat(def instanceof defVars?def.names:def.name)}function processDefns(defs,pinfo,env,numInstalled){if(defs.length===0)return that.body.compile(envWithBoxedNames,pinfo);var compiledDefAndPInfo=
defs[0].compile(env,pinfo),compiledRhs=compiledDefAndPInfo[0].rhs,pinfo=compiledDefAndPInfo[1];var numToInstall=defs[0]instanceof defVars?defs[0].names.length:1,newBodyAndPinfo=processDefns(defs.slice(1),pinfo,env,numInstalled+numToInstall);newBody=newBodyAndPinfo[0],pinfo=newBodyAndPinfo[1];var bytecode=new installValue(numToInstall,numInstalled,true,compiledRhs,newBody);return[bytecode,pinfo]}};callExpr.prototype.compile=function(env,pinfo){var makeSpace=function(env,operand){return new plt.compiler.unnamedEnv(env)},
extendedEnv=this.args.reduce(makeSpace,env);var compiledOperatorAndPinfo=this.func.compile(extendedEnv,pinfo),compiledOperator=compiledOperatorAndPinfo[0],pinfo1=compiledOperatorAndPinfo[1];var compiledOperandsAndPinfo=this.args.reduceRight(compilePrograms,[[],pinfo,extendedEnv]),compiledOperands=compiledOperandsAndPinfo[0],pinfo2=compiledOperatorAndPinfo[1],app=new application(compiledOperator,compiledOperands);var extractLoc=function(e){return e.location},locs=[this.func.location].concat(this.args.map(extractLoc)),
locVectors=locs.concat(this.location).map(function(loc){return loc.toVector()}),appWithcontMark=new withContMark(new symbolExpr("moby-application-position-key"),locVectors,new withContMark(new symbolExpr("moby-stack-record-continuation-mark-key"),this.location.toVector(),app));return[appWithcontMark,pinfo2]};ifExpr.prototype.compile=function(env,pinfo){var compiledPredicateAndPinfo=this.predicate.compile(env,pinfo),compiledPredicate=compiledPredicateAndPinfo[0],pinfo1=compiledPredicateAndPinfo[1];
var compiledConsequenceAndPinfo=this.consequence.compile(env,pinfo),compiledConsequence=compiledConsequenceAndPinfo[0],pinfo2=compiledConsequenceAndPinfo[1];var compiledAlternateAndPinfo=this.alternative.compile(env,pinfo),compiledAlternate=compiledAlternateAndPinfo[0],pinfo3=compiledAlternateAndPinfo[1];var bytecode=new branch(compiledPredicate,compiledConsequence,compiledAlternate);return[bytecode,pinfo3]};symbolExpr.prototype.compile=function(env,pinfo){var stackReference=env.lookup(this.val,0),
bytecode;if(stackReference instanceof localStackReference)bytecode=new localRef(stackReference.isBoxed,stackReference.depth,false,false,false);else if(stackReference instanceof globalStackReference)bytecode=new topLevel(stackReference.depth,stackReference.pos,false,false,this.location);else if(stackReference instanceof unboundStackReference)throw"Couldn't find '"+this.val+"' in the environment";else throw"IMPOSSIBLE: env.lookup failed for '"+this.val+"'! A reference should be added to the environment!";
return[bytecode,pinfo]};quotedExpr.prototype.compile=function(env,pinfo){function unwrapLiterals(v){return v instanceof literal?unwrapLiterals(v.val):v instanceof Array?v.map(unwrapLiterals):v}result=new literal(unwrapLiterals(this.val));return[result,pinfo]};provideStatement.prototype.compile=function(env,pinfo){};requireExpr.prototype.compile=function(env,pinfo){return[new req(this.spec,new topLevel(0,0,false,false,false)),pinfo]};function compileCompilationTop(program,pinfo){function makeModulePrefixAndEnv(pinfo){var requiredModuleBindings=
pinfo.modules.reduce(function(acc,m){return acc.concat(m.bindings)},[]),isNotRequiredModuleBinding=function(b){return b.moduleSource&&requiredModuleBindings.indexOf(b)===-1},moduleOrTopLevelDefinedBindings=pinfo.usedBindingsHash.values().filter(isNotRequiredModuleBinding),allModuleBindings=requiredModuleBindings.concat(moduleOrTopLevelDefinedBindings),makeGlobalBucket=function(name){return new globalBucket(name)},modulePathIndexJoin=function(path,base){return new modulePath(path,base)},makeModuleVariablefromBinding=
function(b){return new moduleVariable(modulePathIndexJoin(b.moduleSource,b.imported?false:modulePathIndexJoin(false,false)),new symbolExpr(b.name),-1,0)};var globalNames=pinfo.freeVariables.concat(pinfo.definedNames.keys()),uniqueGlobalNames=sortAndUnique(globalNames,function(a,b){return a<b},function(a,b){return a==b}),topLevels=[false].concat(uniqueGlobalNames.map(makeGlobalBucket),allModuleBindings.map(makeModuleVariablefromBinding)),globals=[false].concat(uniqueGlobalNames,allModuleBindings.map(function(b){return b.name}));
return[new prefix(0,topLevels,[]),new plt.compiler.globalEnv(globals,false,new plt.compiler.emptyEnv)]}var toplevelPrefixAndEnv=makeModulePrefixAndEnv(pinfo),toplevelPrefix=toplevelPrefixAndEnv[0],env=toplevelPrefixAndEnv[1];var defns=program.filter(plt.compiler.isDefinition),requires=program.filter(function(p){return p instanceof requireExpr}),exprs=program.filter(plt.compiler.isExpression);var compiledRequiresAndPinfo=requires.reduceRight(compilePrograms,[[],pinfo,env]),compiledRequires=compiledRequiresAndPinfo[0],
pinfo=compiledRequiresAndPinfo[1];var compiledDefinitionsAndPinfo=defns.reduceRight(compilePrograms,[[],pinfo,env]),compiledDefinitions=compiledDefinitionsAndPinfo[0],pinfo=compiledDefinitionsAndPinfo[1];var compiledExpressionsAndPinfo=exprs.reduceRight(compilePrograms,[[],pinfo,env]),compiledExpressions=compiledExpressionsAndPinfo[0],pinfo=compiledExpressionsAndPinfo[1];var forms=new seq([].concat(compiledRequires,compiledDefinitions,compiledExpressions)),zo_bytecode=new compilationTop(0,toplevelPrefix,
forms),response={"bytecode":"/* runtime-version: local-compiler-summer2014 */\n"+zo_bytecode.toBytecode(),"permissions":pinfo.permissions(),"provides":pinfo.providedNames.keys()};return response}plt.compiler.localStackReference=localStackReference;plt.compiler.globalStackReference=globalStackReference;plt.compiler.unboundStackReference=unboundStackReference;plt.compiler.compile=function(program,pinfo,debug){var start=(new Date).getTime();try{var response=compileCompilationTop(program,pinfo)}catch(e){console.log("COMPILATION ERROR");
throw e;}var end=(new Date).getTime();if(debug){console.log("Compiled in "+Math.floor(end-start)+"ms");console.log(JSON.stringify(response))}return response}})();goog.provide("plt.wescheme.RoundRobin");goog.require("plt.compiler.lex");goog.require("plt.compiler.parse");goog.require("plt.compiler.desugar");goog.require("plt.compiler.analyze");goog.require("plt.compiler.compile");
(function(){if(!console){console={};console.log=function(){}}var initialize=function(compilation_servers,afterInitialize,onFailure){afterInitialize()};var onCompilationFail=function(onDoneError){onDoneError(JSON.stringify(onDoneError("The local compiler has failed to run properly. "+"You may want to confirm that you are running "+"a modern web browser (IE9+, Safari 6+, FF 20+, "+"Chrome 20+).")))};function getError(e){try{var err=JSON.parse(e),structuredErr=JSON.parse(err["structured-error"]);return e}catch(JSONerror){return"!! FATAL ERROR !!\n"+
e.stack}}function logResults(code,local,server){try{console.log("Logging anonymized error message to GDocs");document.getElementById("expr").value=code;document.getElementById("local").value=plt.wescheme.BrowserDetect.versionString+" "+local.replace(/\s+/g,"").toLowerCase();document.getElementById("server").value=server.replace(/\s+/g,"").toLowerCase();document.getElementById("errorLogForm").submit()}catch(e){console.log("LOGGING FAILED.")}}function compile(programName,code,onDone,onDoneError){code=
code.replace(/[\uFEFF\u2060\u200B]/,"");function getHigherThanAsciiChars(str){var nonASCII=str.split("").filter(function(c){return c.charCodeAt(0)>127});return nonASCII.map(function(c){return c.charCodeAt(0)})}try{var start=(new Date).getTime();var lexemes=plt.compiler.lex(code,programName);var AST=plt.compiler.parse(lexemes);var desugared=plt.compiler.desugar(AST)[0];var pinfo=plt.compiler.analyze(desugared);var local_bytecode=plt.compiler.compile(desugared,pinfo);onDone(JSON.stringify(local_bytecode))}catch(e){var local_error=
getError(e).toString();if(/FATAL ERROR/.test(local_error.toString())){logResults(code,JSON.stringify(local_error),"FATAL ERROR");onCompilationFail(onDoneError)}else onDoneError(local_error)}var end=(new Date).getTime(),localTime=Math.floor(end-start);console.log("Compiled in: "+Math.floor(end-start)+"ms")}var lastCompiledName=null;var lastCompiledCode=null;var lastCompiledResult=null;function cachedCompilation(programName,code,onDone,onDoneError){var onDoneWithCache=function(){var result=[].slice.call(arguments,
0);lastCompiledName=programName;lastCompiledCode=code;lastCompiledResult=result;return onDone.apply(null,arguments)};if(programName===lastCompiledName&&code===lastCompiledCode)return onDone.apply(null,lastCompiledResult);compile(programName,code,onDoneWithCache,onDoneError)}plt.wescheme.RoundRobin.initialize=initialize;plt.wescheme.RoundRobin.roundRobinCompiler=cachedCompilation})();goog.provide("plt.wescheme.makeDynamicModuleLoader");goog.require("plt.wescheme.AjaxActions");
(function(){plt.wescheme.makeDynamicModuleLoader=function(rootLibraryPath){var actions=new plt.wescheme.AjaxActions;var handleBuiltInCollection=function(aName,onSuccess,onFail){loadScript(rootLibraryPath+"/"+aName+"-min.js?__gensym="+encodeURIComponent(""+Math.random()),onSuccess,onFail)};var handleWeschemeModule=function(aName,onSuccess,onFail){var m=aName.match(/wescheme\/(\w+)/);var publicId=m[1];actions.loadProject(null,publicId,function(aProgram){try{window.COLLECTIONS[aName]={"name":aName,"bytecode":(0,eval)("("+
aProgram.getObjectCode()+")"),"provides":aProgram.getProvides()}}catch(e){onFail();return}onSuccess()},onFail)};var isWeschemeModule=function(aName){var m=aName.match(/^wescheme\/(\w+)$/);if(m)return true;return false};return function(aName,onSuccess,onFail){window.COLLECTIONS=window.COLLECTIONS||{};if(isWeschemeModule(aName))handleWeschemeModule(aName,onSuccess,onFail);else handleBuiltInCollection(aName,onSuccess,onFail)}}})();goog.provide("plt.wescheme.WeSchemeInteractions");goog.require("plt.wescheme.topKeymap");goog.require("plt.wescheme.WeSchemeTextContainer");goog.require("plt.wescheme.tokenizer");goog.require("plt.wescheme.WeSchemeProperties");goog.require("plt.wescheme.RoundRobin");goog.require("plt.wescheme.makeDynamicModuleLoader");var WeSchemeInteractions;
WeSchemeInteractions=function(){var Prompt,makeFreshId;var ISMAC=navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)?true:false;var MODKEY=ISMAC?"Alt":"Ctrl";var WeSchemeInteractions=function(interactionsDiv,afterInit){var that=this;this.interactionsDiv=jQuery(interactionsDiv);this.interactionsDiv.empty();this.resetters=[];this.previousInteractionsDiv=document.createElement("div");this.previousInteractionsTextContainers={};this.interactionsDiv.append(this.previousInteractionsDiv);this.withColoredErrorMessages=
true;setTimeout(function(){that.sayAndForget("Press F4 to toggle extra accessibility features")},1E3);new Prompt(this,this.interactionsDiv,function(prompt){that.prompt=prompt;makeFreshEvaluator(that,function(e){that.evaluator=e;that.highlighter=function(id,offset,line,column,span,color){};prompt.historyArray=[{code:"",output:false}];prompt.historyIndex=0;prompt.maxSavedHistory=100;if(afterInit)afterInit(that)})})};WeSchemeInteractions.prototype.reset=function(){var that=this;this.notifyBus("before-reset",
this);var i;for(i=that.resetters.length-1;i>=0;i--)that.resetters[i]();silenceCurrentEvaluator(that);makeFreshEvaluator(that,function(e){that.evaluator=e;jQuery(that.previousInteractionsDiv).empty();that.notifyBus("after-reset",that);that.prompt.clear()})};var withCancellingOnReset=function(that,f){var cancelled=false;var onReset=function(){cancelled=true;that.removeOnReset(onReset)};that.addOnReset(onReset);return function(){if(cancelled)return;f.apply(null,arguments)}};WeSchemeInteractions.prototype.disableColoredErrorMessages=
function(){this.withColoredErrorMessages=false};WeSchemeInteractions.prototype.setPromptText=function(t){this.prompt.setText(t)};WeSchemeInteractions.prototype.say=function(msg,forget){if(msg==="")return;console.log(msg);var announcements=document.getElementById("announcementlist");var li=document.createElement("LI");li.appendChild(document.createTextNode(msg));announcements.insertBefore(li,announcements.firstChild);if(forget)setTimeout(function(){announcements.removeChild(li)},1E3)};WeSchemeInteractions.prototype.sayAndForget=
function(msg){this.say(msg,true)};WeSchemeInteractions.prototype.speakChar=function(cm){var pos=cm.getCursor(),ln=pos.line,ch=pos.ch;var c=cm.getRange({line:ln,ch:ch},{line:ln,ch:ch+1});this.sayAndForget(c)};WeSchemeInteractions.prototype.speakHistory=function(n){if(n===0)n=10;var historySize=this.prompt.historyArray.length-1;if(n>historySize)return false;var history=this.prompt.historyArray[historySize-n];this.sayAndForget(history.code+(history.output?" evaluates to "+(history.output.ariaText||history.output.textContent):
" did not produce any value"));return true};Prompt=function(interactions,parentDiv,K){var that=this;this.interactions=interactions;this.div=jQuery("<div style='clear: left;'><span class='top-aligned-inline-block' aria-hidden='true'>&gt;&nbsp;</span><span class='top-aligned-inline-block' style='position: absolute; left: 20px; right: 5px;'/></div>");parentDiv.append(this.div);var innerDivElt=this.div.find("span").get(1);new plt.wescheme.WeSchemeTextContainer(innerDivElt,{dynamicHeight:true,lineNumbers:false,
autoCloseBrackets:true,makeTransparentIframe:true,extraKeys:{"Enter":function(ed){if(that.hasCompleteExpression())that.onEvaluation();else CodeMirror.commands.newlineAndIndent(ed)},"Shift-Enter":function(ed){CodeMirror.commands.newlineAndIndent(ed)},"Alt-Down":function(ed){that.onHistoryNext()},"Alt-Up":function(ed){that.onHistoryPrevious()},"PageDown":function(ed){that.onHistoryNext()},"PageUp":function(ed){that.onHistoryPrevious()},"Left":function(cm){cm.moveH(-1,"char");interactions.speakChar(cm)},
"Right":function(cm){cm.moveH(1,"char");interactions.speakChar(cm)},"Alt-1":function(ed){interactions.speakHistory(1)},"Alt-2":function(ed){interactions.speakHistory(2)},"Alt-3":function(ed){interactions.speakHistory(3)},"Alt-4":function(ed){interactions.speakHistory(4)},"Alt-5":function(ed){interactions.speakHistory(5)},"Alt-6":function(ed){interactions.speakHistory(6)},"Alt-7":function(ed){interactions.speakHistory(7)},"Alt-8":function(ed){interactions.speakHistory(8)},"Alt-9":function(ed){interactions.speakHistory(9)},
"Alt-0":function(ed){interactions.speakHistory(0)}}},function(container){that.textContainer=container;if(K)K(that)})};Prompt.prototype.onEvaluation=function(){this.saveHistoryWithCleanup();var that=this;var nextCode=that.textContainer.getCode();that.textContainer.setCode("");var parentDiv=document.createElement("div");var promptSpan=document.createElement("span");promptSpan.className="top-aligned-inline-block";promptSpan.appendChild(document.createTextNode(">"));var textareaSpan=document.createElement("span");
textareaSpan.className="top-aligned-inline-block";textareaSpan.style.width="90%";parentDiv.appendChild(promptSpan);parentDiv.appendChild(document.createTextNode(" "));parentDiv.appendChild(textareaSpan);that.interactions.addToInteractions(parentDiv);promptSpan.setAttribute("aria-hidden","true");var n=new plt.wescheme.WeSchemeTextContainer(textareaSpan,{dynamicHeight:true,lineNumbers:false,content:nextCode,makeTransparentIframe:true,readOnly:true,cursorBlinkRate:0,inputStyle:"contenteditable",matchBrackets:true,
autoCloseBrackets:true},function(container){var newId=makeFreshId();that.interactions.previousInteractionsTextContainers[newId]=container;that.interactions.runCode(nextCode,newId,function(){})});that.focus()};function historyPreviousIsOk(index,length){return index>0}function historyNextIsOk(index,length){return length-index>1}Prompt.prototype.onHistoryPrevious=function(){this.doHistory(-1,historyPreviousIsOk)};Prompt.prototype.onHistoryNext=function(){this.doHistory(1,historyNextIsOk)};Prompt.prototype.doHistory=
function(increment,incrementIsOk){if(this.historyArray.length>1){var code=jQuery.trim(this.textContainer.getCode());if(code===this.historyArray[this.historyIndex].code){if(incrementIsOk(this.historyIndex,this.historyArray.length))this.doHistoryPart2(increment)}else{var tentativeIndex=this.historyArray.length-1;if(incrementIsOk(tentativeIndex,this.historyArray.length)){this.historyIndex=tentativeIndex;this.historyArray[this.historyIndex].code=code;this.doHistoryPart2(increment)}}}};Prompt.prototype.doHistoryPart2=
function(increment){this.historyIndex+=increment;var dom=this.textContainer.getDiv();this.interactions.say(this.historyArray[this.historyIndex].code);this.textContainer.setCode(this.historyArray[this.historyIndex].code);this.textContainer.setCursorToEnd()};Prompt.prototype.saveHistoryWithCleanup=function(){var newEntry=jQuery.trim(this.textContainer.getCode());var lastIndex=this.historyArray.length-1;this.historyArray[lastIndex].code=newEntry;var prevEntry=lastIndex<1?null:this.historyArray[lastIndex-
1].code;if(prevEntry&&prevEntry===newEntry);else if(newEntry==="");else{var shiftCount=Math.max(0,this.historyArray.length-this.maxSavedHistory);while(shiftCount>0){this.historyArray.shift();shiftCount--}lastIndex=this.historyArray.length}this.historyArray[lastIndex]={code:"",output:false};this.historyIndex=lastIndex};Prompt.prototype.setRecentOutput=function(dom){if(this.historyIndex>0&&this.historyIndex<this.historyArray.length)this.historyArray[this.historyIndex-1].output=dom};Prompt.prototype.hasCompleteExpression=
function(){return plt.wescheme.tokenizer.hasCompleteExpression(this.textContainer.getCode())};Prompt.prototype.setText=function(t){this.textContainer.setCode(t)};Prompt.prototype.clear=function(){this.textContainer.setCode("")};Prompt.prototype.getDiv=function(){return this.div};Prompt.prototype.hide=function(){this.div.hide()};Prompt.prototype.show=function(){this.div.show()};Prompt.prototype.focus=function(){this.interactions._scrollToBottom();this.textContainer.focus()};var compilation_servers=
[];WeSchemeInteractions.prototype.initializeRoundRobinCompilation=function(evaluator,after){var that=this;plt.wescheme.RoundRobin.initialize(compilation_servers,function(){evaluator.setCompileProgram(plt.wescheme.RoundRobin.roundRobinCompiler);after()},function(){evaluator.setCompileProgram(plt.wescheme.RoundRobin.roundRobinCompiler);alert("WeScheme appears to be busy or unavailable at this time."+"  Please try again later.");after()})};function calculateWidth(node){node.cachedWidth=1;for(var i=0;i<
node.children.length;i++)node.cachedWidth+=node.children[i].cachedWidth||calculateWidth(node.children[i]);node.cachedWidth=Math.max(node.cachedWidth,node.offsetWidth);return node.cachedWidth}var rewrapOutput=function(node){var oldWrap=node.className.indexOf("wrapped")>-1,width=node.cachedWidth||calculateWidth(node),maxWidth=document.getElementById("inter").offsetWidth,newWrap=width>maxWidth;if(!oldWrap&&newWrap||oldWrap&&!newWrap){node.className=newWrap?node.className+" wrapped":node.className.replace(/ wrapped/g,
"");for(var i=0;i<node.children.length;i++)rewrapOutput(node.children[i])}};var rewrapThrottle=null;var rewrapPreviousInteractions=function(){clearTimeout(rewrapThrottle);rewrapThrottle=setTimeout(function(){var repls=document.getElementsByClassName("replOutput");for(var i=0;i<repls.length;i++)rewrapOutput(repls[i])},250)};jQuery(window).bind("resize",rewrapPreviousInteractions);var silenceCurrentEvaluator=function(that){that.evaluator.write=function(thing){};that.evaluator.transformDom=function(thing){};
that.evaluator.requestBreak()};var makeFreshEvaluator=function(that,afterInit){var evaluator=new Evaluator({write:function(thing){var ariaText=thing.ariaText||thing.innerText;if(thing.nodeName==="CANVAS"&&window.Blob!==undefined){thing.ondblclick=function(){var dataURL=thing.toDataURL(),parts=dataURL.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/),binStr=atob(parts[3]),buf=new ArrayBuffer(binStr.length),view=new Uint8Array(buf);for(var i=0;i<view.length;i++)view[i]=binStr.charCodeAt(i);var blob=
new Blob([view],{"type":parts[1]});if(window.navigator.msSaveBlob!=undefined)window.navigator.msSaveBlob(blob,"WeScheme Image");else{var link=document.createElement("a");link.href=(URL||webkitURL).createObjectURL(blob);link.target=link.download="WeScheme Image";document.body.appendChild(link);link.click();document.body.removeChild(link)}};thing.style.cursor="url(css/images/dblclick.png), pointer"}thing.className+=" replOutput";thing.setAttribute("aria-label",ariaText);that.addToInteractions(thing);
that.sayAndForget(ariaText);if(ariaText!=="")that.prompt.setRecentOutput(thing);rewrapOutput(thing)},transformDom:function(dom){var result=that._transformDom(dom);return result}});var dialog=jQuery("<div/>");that.initializeRoundRobinCompilation(evaluator,function(){evaluator.makeToplevelNode=function(){document.getElementById("editor").setAttribute("aria-hidden",true);var handleClose=function(event,ui){document.getElementById("editor").removeAttribute("aria-hidden");that.evaluator.requestBreak();
dialog.dialog("destroy")};dialog.dialog({bgiframe:true,position:{my:"left top",at:"left top"},modal:true,width:"auto",height:"auto",beforeClose:handleClose,resizable:false,closeOnEscape:true});dialog.get(0).parentNode.style.position="absolute";var supportsFullScreen=function(){var elem=document.createElement("div");return(elem.webkitRequestFullscreen||elem.mozRequestFullScreen||elem.msRequestFullscreen||elem.requestFullscreen)!==undefined};var toggleFullScreen=function(evt){var elem;if(evt){evt.stopPropagation();
evt.preventDefault()}elem=innerArea.get(0);elem.requestFullscreen=elem.requestFullscreen||elem.mozRequestFullScreen||elem.webkitRequestFullscreen||elem.msRequestFullscreen;document.exitFullscreen=document.exitFullscreen||document.webkitExitFullscreen||document.msExitFullscreen||document.mozCancelFullScreen;function getFullscreenElement(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}var closeOnEscape=getFullscreenElement();
dialog.dialog("option","closeOnEscape",closeOnEscape);if(!getFullscreenElement())elem.requestFullscreen(Element.ALLOW_KEYBOARD_INPUT);else document.exitFullscreen()};if(supportsFullScreen()){jQuery("<span><img src='/images/fullscreen.png' style='position: absolute;'></span>").css("margin-top","5px").css("background-image","none").css("position","absolute").css("cursor","pointer").css("left","2em").click(toggleFullScreen).appendTo(dialog.parent().find(".ui-dialog-titlebar"));dialog.dblclick(toggleFullScreen)}var innerArea=
jQuery("<div class='evaluatorToplevelNode' role='log' aria-live='polite'></div>");innerArea.css("background-color","white");while(dialog[0].firstChild)dialog[0].removeChild(dialog[0].firstChild);dialog.append(innerArea);dialog.dialog("open");return innerArea.get(0)};evaluator.setImageProxy("/imageProxy");evaluator.setRootLibraryPath("/js/mzscheme-vm/collects");evaluator.setDynamicModuleLoader(plt.wescheme.makeDynamicModuleLoader("/js/mzscheme-vm/collects"));afterInit(evaluator)})};WeSchemeInteractions.prototype.focusOnPrompt=
function(){this.prompt.focus()};WeSchemeInteractions.prototype.notifyBus=function(action,data){if(typeof plt.wescheme.WeSchemeIntentBus!="undefined")plt.wescheme.WeSchemeIntentBus.notify("after-reset",this)};WeSchemeInteractions.prototype.setSourceHighlighter=function(highlighter){this.highlighter=highlighter};WeSchemeInteractions.prototype.setAddToCurrentHighlighter=function(addToCurrentHighlighter){this.addToCurrentHighlighter=addToCurrentHighlighter};WeSchemeInteractions.prototype.setMoveCursor=
function(moveCursor){this.moveCursor=moveCursor};WeSchemeInteractions.prototype.setScrollIntoView=function(scrollIntoView){this.scrollIntoView=scrollIntoView};WeSchemeInteractions.prototype.addSetSelection=function(setSelection){this.setSelection=setSelection};WeSchemeInteractions.prototype.setFocus=function(focus){this.focus=focus};WeSchemeInteractions.prototype.focus=function(){this.prompt.focus()};WeSchemeInteractions.prototype.addOnReset=function(onReset){this.resetters.push(onReset)};WeSchemeInteractions.prototype.removeOnReset=
function(onReset){var i;for(i=0;i<this.resetters.length;i++)if(onReset===this.resetters[i]){this.resetters.splice(i,1);return}};function isDomNode(x){return x.nodeType!=undefined}WeSchemeInteractions.prototype.addToInteractions=function(interactionVal){var that=this;var domNode;this.notifyBus("before-add-to-interactions",this);if(isDomNode(interactionVal)){domNode=jQuery(interactionVal);domNode.click(function(e){e.stopPropagation()});jQuery(this.previousInteractionsDiv).append(domNode)}else{domNode=
jQuery("<div style='width: 100%'></div>");domNode.text(interactionVal);domNode.click(function(e){e.stopPropagation()});jQuery(this.previousInteractionsDiv).append(domNode)}this._scrollToBottom();this.notifyBus("after-add-to-interactions",this)};WeSchemeInteractions.prototype._scrollToBottom=function(){this.interactionsDiv.attr("scrollTop",this.interactionsDiv.attr("scrollHeight"))};WeSchemeInteractions.prototype._transformDom=function(dom){if(helpers.isLocationDom(dom))return this._rewriteLocationDom(dom);
else return dom};WeSchemeInteractions.prototype._rewriteLocationDom=function(dom){var newDom=document.createElement("span");var children=dom.children;var offset,id,span,line,column,color;for(var i=0;i<children.length;i++){var textBody=children[i].textContent||children[i].innerText;if(children[i]["className"]==="location-id")id=textBody;if(children[i]["className"]==="location-offset")offset=textBody;if(children[i]["className"]==="location-span")span=textBody;if(children[i]["className"]==="location-line")line=
textBody;if(children[i]["className"]==="location-column")column=textBody;if(children[i]["className"]==="location-color")color=textBody}if(!color)color="red";return this.createLocationHyperlink({id:id,offset:parseInt(offset),line:parseInt(line),column:parseInt(column),span:parseInt(span),color:color})};WeSchemeInteractions.prototype.runCode=function(aSource,sourceName,contK){var that=this;function putFocus(){var defInFocus=plt.wescheme.WeSchemeEditor.defnInFocus;if(defInFocus)jQuery("#definitions").click();
else that.focusOnPrompt()}if(sourceName=="<definitions>")that.compileTimeError=false;setTimeout(withCancellingOnReset(that,function(){that.notifyBus("before-run",that);that.disableInput();that.evaluator.executeProgram(sourceName,aSource,withCancellingOnReset(that,function(){that.enableInput();putFocus();contK()}),withCancellingOnReset(that,function(err){that.handleError(err);that.enableInput();if(sourceName=="<definitions>")that.compileTimeError=true;putFocus();contK()}))}),0)};WeSchemeInteractions.prototype.handleError=
function(err){var dom=renderErrorAsDomNode(this,err);this.addToInteractions(dom);this.say(dom.textContent);this.prompt.setRecentOutput(dom);this.addToInteractions("\n")};var nextColor=function(color,percentage){return Math.floor(percentage*color+255*(1-percentage))};var nextTint=function(red,green,blue,percentage){return"rgb("+nextColor(red,percentage)+","+nextColor(green,percentage)+","+nextColor(blue,percentage)+")"};var Color=function(red,green,blue){this.red=red;this.green=green;this.blue=blue};
Color.prototype.toString=function(){return"rgb("+this.red+","+this.green+","+this.blue+")"};var locObjToVector=function(badLocs){return types.vector([badLocs.id,parseInt(badLocs.offset),parseInt(badLocs.line),parseInt(badLocs.column),parseInt(badLocs.span)])};var fixLocList=function(badLocList){var toReturn=[];var i;for(i=0;i<badLocList.length;i++)toReturn.push(locObjToVector(badLocList[i]));return toReturn};var structuredErrorToMessage=function(se){var msg=[];var i;for(i=0;i<se.length;i++)if(typeof se[i]===
"string")msg.push(se[i]);else if(se[i].type==="ColoredPart")msg.push(new types.ColoredPart(se[i].text,locObjToVector(se[i].loc)));else if(se[i].type==="GradientPart"){var j;var parts=[];for(j=0;j<se[i].parts.length;j++){var coloredPart=se[i].parts[j];parts.push(new types.ColoredPart(coloredPart.text,locObjToVector(coloredPart.loc)))}msg.push(new types.GradientPart(parts))}else if(se[i].type==="MultiPart")msg.push(new types.MultiPart(se[i].text,fixLocList(se[i].locs),se[i].solid));else msg.push(se[i]+
"");return new types.Message(msg)};var formatColoredMessage=function(that,msgDom,msg){var args=msg.args;var colors=[[new Color(135,206,235),new Color(176,196,222),new Color(176,224,230),new Color(173,216,230)],[new Color(238,130,238),new Color(216,191,216),new Color(221,160,221),new Color(218,112,214)],[new Color(255,228,181),new Color(238,232,170),new Color(255,218,185)],[new Color(222,184,135),new Color(255,228,196),new Color(255,222,173),new Color(245,222,179)]];var colorIndex=0;var currColor=
colors[colorIndex][0];var i;var foreachTint=function(elts,f){var currTint;var altIndex=0;var j;var percentage=1;var change=2/(elts.length+1);for(j=0;j<elts.length;j++){if(altIndex>=colors[colorIndex].length){altIndex=0;percentage=percentage-change}currColor=colors[colorIndex][altIndex];currTint=nextTint(currColor.red,currColor.green,currColor.blue,percentage);f(elts[j],currTint);altIndex++}};var doColoredPart=function(part){colorAndLink(that,msgDom,currColor,part.text,[currColor],[part.location]);
colorIndex=(colorIndex+1)%colors.length};var doGradientPart=function(part){var parts=part.coloredParts;foreachTint(parts,function(subpart,currTint){colorAndLink(that,msgDom,currTint,subpart.text,[currTint],[subpart.location])});colorIndex=(colorIndex+1)%colors.length};var doMultiPart=function(part){var locTints=[];var i;var baseColor=currColor;var box;if(part.locations.length>0)if(part.solid||part.locations.length===1){for(i=0;i<part.locations.length;i++)locTints.push(baseColor);colorAndLink(that,
msgDom,baseColor,part.text,locTints,part.locations);colorIndex=(colorIndex+1)%colors.length}else{foreachTint([undefined].concat(part.locations),function(loc,tint){locTints.push(tint)});colorAndLink(that,msgDom,baseColor,part.text,locTints.slice(1),part.locations);jQuery(msgDom).append("\u00ab");for(i=0;i<part.locations.length;i++){box=jQuery("<tt/>");box.text("\u2b1c");colorAndLink(that,msgDom,locTints.slice(1)[i],box,[locTints.slice(1)[i]],[part.locations[i]])}jQuery(msgDom).append("\u00bb");colorIndex=
(colorIndex+1)%colors.length}else msgDom.appendChild(document.createTextNode(part.text+""))};var doPlainPart=function(part){msgDom.appendChild(document.createTextNode(part+""))};for(i=0;i<args.length;i++){currColor=colors[colorIndex][0];if(types.isColoredPart(args[i]))doColoredPart(args[i]);else if(types.isGradientPart(args[i]))doGradientPart(args[i]);else if(types.isMultiPart(args[i]))doMultiPart(args[i]);else doPlainPart(args[i])}};var formatUncoloredMessage=function(that,msgDom,msg,errorLoc){var args=
msg.args;var i;var pinkColor=new Color(240,181,194);var doColoredPart=function(part){msgDom.appendChild(document.createTextNode(part.text))};var doGradientPart=function(part){var parts=part.coloredParts;var i;for(i=0;i<parts.length;i++)msgDom.appendChild(document.createTextNode(parts[i].text+""))};var doMultiPart=function(part){msgDom.appendChild(document.createTextNode(part.text+""))};var doPlainPart=function(part){msgDom.appendChild(document.createTextNode(part+""))};for(i=0;i<args.length;i++)if(types.isColoredPart(args[i]))doColoredPart(args[i]);
else if(types.isGradientPart(args[i]))doGradientPart(args[i]);else if(types.isMultiPart(args[i]))doMultiPart(args[i]);else doPlainPart(args[i]);that.addToCurrentHighlighter(errorLoc.id,errorLoc.offset,errorLoc.line,errorLoc.column,errorLoc.span,pinkColor+"")};var colorAndLink=function(that,msgDom,errorColor,text,locColors,locs){var i;var x;var pieces=[];if(typeof text==="string")text=jQuery("<span/>").text(text);for(i=0;i<locs.length;i++)pieces.push(that.addToCurrentHighlighter(locs[i].ref(0),locs[i].ref(1),
locs[i].ref(2),locs[i].ref(3),locs[i].ref(4),locColors[i]+""));if(locs[0].ref(0)==="<no-location>")jQuery(msgDom).append(text);else{var clickFunction=makeCursorLink(that,locs,pieces,errorColor);var aChunk=jQuery("<span/>").css("background-color",errorColor+"").addClass("colored-link").click(clickFunction);var aLink=jQuery("<a/>").append(text).attr("href","#").click(clickFunction);jQuery(aChunk).append(aLink);jQuery(msgDom).append(aChunk)}};var makeCursorLink=function(that,locs,pieces,color){var currItem=
locs[0];return function(e){var i;e.stopPropagation();e.preventDefault();that.scrollIntoView(currItem.ref(0),parseInt(currItem.ref(1)));that.focusOnPrompt();for(i=0;i<pieces.length;i++)catchAttention(pieces[i].styleName)}};var catchAttention=function(styleName){var opacity=0;var intervalId=setInterval(function(){jQuery("."+styleName).css("opacity",opacity);opacity=opacity+.02;if(opacity>=1)clearInterval(intervalId)},15)};var renderErrorAsDomNode=function(that,err){var msg;var i;var dom=document.createElement("div");
if(types.isSchemeError(err)&&types.isExnBreak(err.val)){dom["className"]="moby-break-error";msg="The program has stopped."}else{dom["className"]="moby-error";if(err.structuredError&&err.structuredError.message)msg=structuredErrorToMessage(err.structuredError.message);else msg=that.evaluator.getMessageFromExn(err)}var msgDom=document.createElement("div");msgDom["className"]="moby-error:message";if(types.isMessage(msg))if(that.withColoredErrorMessages)formatColoredMessage(that,msgDom,msg);else formatUncoloredMessage(that,
msgDom,msg,getPrimaryErrorLocation(that,err));else if(err.domMessage)dom.appendChild(err.domMessage);else msgDom.appendChild(document.createTextNode(msg));dom.appendChild(msgDom);if(err.structuredError&&err.structuredError.message){var link=that.createLocationHyperlink(err.structuredError.location);dom.appendChild(link)}var stacktrace=that.evaluator.getTraceFromExn(err);var stacktraceDiv=document.createElement("div");stacktraceDiv["className"]="error-stack-trace";for(i=0;i<stacktrace.length;i++){var anchor=
that.createLocationHyperlink(stacktrace[i]);stacktraceDiv.appendChild(anchor)}if(!(types.isSchemeError(err)&&types.isExnBreak(err.val)))dom.appendChild(stacktraceDiv);if(that.compileTimeError){var msg="An error occured the last time Run was clicked. ";msg+="This may be causing the error you see here. ";msg+="Make sure you fix the first error you see in the Interactions Area!";var span=document.createElement("span");span.className="compileTimeError";console.log(msg);span.appendChild(document.createTextNode(msg));
console.log(span);dom.appendChild(span)}console.log(dom);return dom};var getPrimaryErrorLocation=function(that,err){var i;if(err.structuredError&&err.structuredError.message)return err.structuredError.location;var stacktrace=that.evaluator.getTraceFromExn(err);for(i=0;i<stacktrace.length;i++)return stacktrace[i];return false};WeSchemeInteractions.prototype.createLocationHyperlink=function(aLocation,anchorBodyDom){if(!anchorBodyDom)anchorBodyDom=document.createTextNode("at: line "+aLocation.line+", column "+
aLocation.column+", in "+aLocation.id);var para=document.createElement("p");para.className="location-paragraph";var anchor=document.createElement("a");anchor["href"]="#";anchor["onclick"]=makeHighlighterLinkFunction(this,aLocation);anchor.appendChild(anchorBodyDom);para.appendChild(anchor);return para};var makeHighlighterLinkFunction=function(that,elt){return function(){that.highlighter(elt.id,elt.offset,elt.line,elt.column,elt.span,"rgb(255, 200, 200)")}};WeSchemeInteractions.prototype.disableInput=
function(){this.prompt.hide()};WeSchemeInteractions.prototype.enableInput=function(){this.prompt.show()};WeSchemeInteractions.prototype.requestBreak=function(){this.evaluator.requestBreak()};WeSchemeInteractions.prototype.toString=function(){return"WeSchemeInteractions()"};var _idNum=0;makeFreshId=function(){return"<interactions"+_idNum++ +">"};return WeSchemeInteractions}();plt.wescheme.WeSchemeInteractions=WeSchemeInteractions;goog.provide("plt.wescheme.WeSchemeEditor");goog.require("plt.wescheme.AjaxActions");goog.require("plt.config");goog.require("plt.wescheme.WeSchemeIntentBus");goog.require("plt.wescheme.SharingDialog");goog.require("plt.wescheme.NotesDialog");goog.require("plt.wescheme.WeSchemeInteractions");goog.require("plt.wescheme.helpers");goog.require("plt.wescheme.tokenizer");var WeSchemeEditor;
(function(){var AUTOSAVE_TIMEOUT=1E4;var FAILED_SAVES=0;var delayedErrorTimer;WeSchemeEditor=function(attrs,afterInit){var that=this;this.userName=attrs.userName;this.actions=new plt.wescheme.AjaxActions;this.onResize=undefined;this.defn=attrs.defn;this.isOwner=false;this.screenreader=false;this.suppressWarningBeforeUnloadE=receiverE();this.suppressWarningBeforeUnloadB=startsWith(this.suppressWarningBeforeUnloadE,false);new plt.wescheme.WeSchemeInteractions(attrs.interactions,function(interactions){that.interactions=
interactions;that.interactions.setSourceHighlighter(function(id,offset,line,column,span,color){that.unhighlightAll();return that.highlight(id,offset,line,column,span,color)});that.interactions.setAddToCurrentHighlighter(function(id,offset,line,column,span,color){return that.highlight(id,offset,line,column,span,color)});that.interactions.addOnReset(function(){that.defn.unhighlightAll()});that.interactions.setMoveCursor(function(id,offset){that.moveCursor(id,offset)});that.interactions.setScrollIntoView(function(id,
offset,margin){that.scrollIntoView(id,offset,margin)});that.interactions.setFocus(function(id){that.focus(id)});that.interactions.addSetSelection(function(id,offset,line,column,span){that.setSelection(id,offset,line,column,span)});that.pid=false;that.filenameEntry=new FlapjaxValueHandler(attrs.filenameInput.get(0));that.filenameEntry.node.type="text";that.filenameEntry.setValue("");that.filenameEntry.behavior.changes().mapE(function(v){document.title=plt.wescheme.helpers.trimWhitespace(v)||"<< Unnamed Program >>";
plt.wescheme.WeSchemeIntentBus.notify("filename-changed",that)});that.defn.getSourceB().changes().mapE(function(){that.unhighlightAll();plt.wescheme.WeSchemeIntentBus.notify("definitions-changed",that)});that.savedE=receiverE();that.loadedE=receiverE();that.isPublishedE=receiverE();that.contentChangedE=mergeE(constantE(changes(that.defn.getSourceB()),true),constantE(changes(that.filenameEntry.behavior),true));that.isOwnerE=receiverE();that.isLoggedInB=constantB(that._getIsLoggedIn());that.pidB=startsWith(that.loadedE.mapE(function(v){return that.pid}),
that.pid);that.isNewFileB=startsWith(changes(that.pidB).mapE(function(v){return that.pid==false}),that.pid==false);that.isPublishedB=startsWith(that.isPublishedE,false);that.isOwnerB=startsWith(that.isOwnerE,that.isOwner);that.isDirtyB=startsWith(mergeE(constantE(that.loadedE,false),constantE(that.savedE,false),constantE(that.contentChangedE,true)),false);that.isAutosaveEnabledB=andB(that.isDirtyB,notB(that.isPublishedB),that.isOwnerB,that.isLoggedInB);that.autosaveRequestedE=calmE(andE(that.contentChangedE,
changes(that.isAutosaveEnabledB)),constantB(AUTOSAVE_TIMEOUT));that.autosaveRequestedE.mapE(function(v){if(v)that._autosave()});if(afterInit)afterInit(that)});this.focusCarousel=[document.getElementById("Tools"),that.defn.div.getElementsByClassName("CodeMirror-scroll")[0],that.interactions.prompt.div[0],document.getElementById("announcements")]};function insertEnabledB(aBooleanBehavior,jQueryNode){function f(v){if(v)jQueryNode.removeAttr("disabled");else jQueryNode.attr("disabled","true")}f(valueNow(aBooleanBehavior));
aBooleanBehavior.changes().mapE(f)}WeSchemeEditor.prototype.setOnResize=function(onResize){this.onResize=onResize};WeSchemeEditor.prototype.forceOnResize=function(){this.onResize()};WeSchemeEditor.prototype.disableColoredErrorMessages=function(){this.interactions.disableColoredErrorMessages()};WeSchemeEditor.prototype.highlight=function(id,offset,line,column,span,color){if(id==="<no-location>");else if(id==="<definitions>")return this.defn.highlight(id,offset,line,column,span,color);else if(this.interactions.previousInteractionsTextContainers[id])return this.interactions.previousInteractionsTextContainers[id].highlight(id,
offset,line,column,span,color)};WeSchemeEditor.prototype.setSelection=function(id,offset,line,column,span,color){if(id==="<definitions>")this.defn.setSelection(id,offset,line,column,span);else if(this.interactions.previousInteractionsTextContainers[id])this.interactions.previousInteractionsTextContainers[id].setSelection(id,offset,line,column,span)};WeSchemeEditor.prototype.unhighlightAll=function(){var key;for(key in this.interactions.previousInteractionsTextContainers)if(this.interactions.previousInteractionsTextContainers.hasOwnProperty(key))this.interactions.previousInteractionsTextContainers[key].unhighlightAll();
this.defn.unhighlightAll()};WeSchemeEditor.prototype.moveCursor=function(id,offset){if(id==="<definitions>")this.defn.moveCursor(offset);else if(this.interactions.previousInteractionsTextContainers[id])this.interactions.previousInteractionsTextContainers[id].moveCursor(offset)};WeSchemeEditor.prototype.scrollIntoView=function(id,offset,margin){if(id==="<definitions>")this.defn.scrollIntoView(offset,margin);else if(this.interactions.previousInteractionsTextContainers[id])this.interactions.previousInteractionsTextContainers[id].scrollIntoView(offset,
margin)};WeSchemeEditor.prototype.focus=function(id){if(id==="<definitions>")this.defn.focus();else if(this.interactions.previousInteractionsTextContainers[id])this.interactions.previousInteractionsTextContainers[id].focus()};WeSchemeEditor.prototype._getIsLoggedIn=function(){return this.userName&&this.userName!="null"};WeSchemeEditor.prototype._autosave=function(){plt.wescheme.WeSchemeIntentBus.notify("autosave",this);this.save()};WeSchemeEditor.prototype.save=function(success,fail,cancel){var that=
this;var resetSaveDelay=function(){FAILED_SAVES=0;clearTimeout(delayedErrorTimer)};var afterSave=function(pid){that.pid=pid;that.savedE.sendEvent(true);resetSaveDelay();plt.wescheme.WeSchemeIntentBus.notify("after-save",that);if(success)success()};var whenSaveBreaks=function(){FAILED_SAVES=Math.min(FAILED_SAVES+1,8);delayedErrorTimer=setTimeout(function(){alert("Unable to save!\n\nYou may have been logged out of Google Services."+"\nRefresh the Program List to log back in.")},Math.pow(2,FAILED_SAVES)*
1E3);if(fail)fail()};var onFirstSave=function(){that.actions.save({pid:false,title:that.filenameEntry.attr("value"),code:that.defn.getCode()},doPageReload,whenSaveBreaks)};var onUpdate=function(){that.actions.save({pid:that.pid,title:that.filenameEntry.attr("value"),code:that.defn.getCode()},afterSave,whenSaveBreaks)};var afterFileNameChosen=function(){plt.wescheme.WeSchemeIntentBus.notify("before-save",that);if(that.pid==false)onFirstSave();else if(valueNow(that.isPublishedB))that.actions.makeAClone(that.pid,
that.defn.getCode(),function(newPid){that.actions.save({pid:newPid,title:that.filenameEntry.attr("value"),code:that.defn.getCode()},function(){afterSave(newPid);doPageReload(newPid)},whenSaveBreaks)},whenSaveBreaks);else onUpdate()};var doPageReload=function(pid){that.suppressWarningBeforeUnloadE.sendEvent(true);plt.wescheme.WeSchemeIntentBus.notify("before-editor-reload-on-save",that);window.location="/openEditor?pid="+encodeURIComponent(pid)};that.filenameEntry.attr("value",plt.wescheme.helpers.trimWhitespace(that.filenameEntry.attr("value")));
that._enforceNonemptyName(afterFileNameChosen,function(){if(cancel)cancel()},true)};WeSchemeEditor.prototype._enforceNonemptyName=function(afterK,abortK,isFirstEntry){var that=this;var title=plt.wescheme.helpers.trimWhitespace(that.filenameEntry.attr("value"));if(title===""){var dialogWindow=jQuery("<div/>");var buttonPressed=false;var onSaveButton=function(){buttonPressed=true;dialogWindow.dialog("close");that.filenameEntry.attr("value",plt.wescheme.helpers.trimWhitespace(inputField.attr("value")));
that._enforceNonemptyName(afterK,abortK,false)};var onCancelButton=function(){buttonPressed=true;dialogWindow.dialog("close");abortK()};var inputField=jQuery("<input type='text' style='border: solid'/>");dialogWindow.append(jQuery("<p/>").text("Please provide a name for your program: "));dialogWindow.append(jQuery("<p/>").text("(The name cannot be left blank.)"));dialogWindow.append(inputField);dialogWindow.dialog({title:"Saving your program",bgiframe:true,modal:true,overlay:{opacity:.5,background:"black"},
buttons:{"Save":onSaveButton,"Don't Save":onCancelButton}});dialogWindow.bind("dialogclose",function(event,ui){if(!buttonPressed)abortK()});var saveButton;dialogWindow.dialog("widget").parent().find(":button").each(function(index){if(jQuery(this).text()==="Save")saveButton=this});var maintainSaveButtonStatus=function(){setTimeout(function(){var name=plt.wescheme.helpers.trimWhitespace(inputField.val());if(name===""){saveButton.disabled=true;jQuery(saveButton).hide("fast")}else{saveButton.disabled=
false;jQuery(saveButton).show("fast")}},0)};maintainSaveButtonStatus();inputField.keydown(maintainSaveButtonStatus);inputField.change(maintainSaveButtonStatus)}else afterK()};WeSchemeEditor.prototype.load=function(attrs,onSuccess,onFail){var that=this;var whenLoadSucceeds=function(aProgram){that.pid=aProgram.getId();var publicUrl=getAbsoluteUrl("/openEditor?publicId="+encodeURIComponent(aProgram.getPublicId()));that.filenameEntry.attr("value",aProgram.getTitle());if(attrs.pid)that.defn.setCode(aProgram.getSourceCode());
else if(attrs.publicId&&aProgram.isSourcePublic())that.defn.setCode(aProgram.getSourceCode());else that.defn.setCode(";;  << Source code has not been shared >>");if(that.userName===aProgram.getOwner())that._setIsOwner(true);else that._setIsOwner(false);that.loadedE.sendEvent(true);that.isPublishedE.sendEvent(aProgram.isPublished());plt.wescheme.WeSchemeIntentBus.notify("after-load",that);if(onSuccess)onSuccess(aProgram.getSourceCode())};var whenLoadFails=function(){alert("The load failed.");if(onFail)onFail()};
if(attrs.pid){plt.wescheme.WeSchemeIntentBus.notify("before-load",this);that.actions.loadProject(attrs.pid,undefined,whenLoadSucceeds,whenLoadFails)}else if(attrs.publicId){plt.wescheme.WeSchemeIntentBus.notify("before-load",this);that.actions.loadProject(undefined,attrs.publicId,whenLoadSucceeds,whenLoadFails)}else throw new Error("pid or publicId required");};function getAbsoluteUrl(relativeUrl){var anchor=document.createElement("a");anchor.href=relativeUrl;return anchor.href}WeSchemeEditor.prototype.share=
function(){var dialog=new plt.wescheme.SharingDialog(this.pid,this.defn.getCode());dialog.show()};WeSchemeEditor.prototype.showNotesDialog=function(){var dialog=new plt.wescheme.NotesDialog(this.pid);var onSuccess=function(){};var onFail=function(){};dialog.show(onSuccess,onFail)};WeSchemeEditor.prototype.toggleHelp=function(){var help=document.getElementById("helpDialog");function showHelp(){help.style.top="25%";help.focus();document.getElementById("editor").setAttribute("aria-activedescendant",
help.id)}function hideHelp(e){help.style.top="100%";help.blur()}if(help.style.top=="25%")hideHelp();else showHelp();help.onclick=hideHelp};WeSchemeEditor.prototype.showPicker=function(defnInFocus){var editor=defnInFocus?this.defn:this.interactions.prompt.textContainer;var developerKey="AIzaSyCP00M0rthRxOPCcaVHS54iO5WfNmNA2PU";var clientId=plt.config.CLIENT_ID;var appId=plt.config.APP_ID;var scope=["https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/drive.file"];var pickerApiLoaded=
false;var oauthToken;function loadPicker(){gapi.load("auth",{"callback":onAuthApiLoad});gapi.load("picker",{"callback":onPickerApiLoad})}function onAuthApiLoad(){window.gapi.auth.authorize({"client_id":clientId,"scope":scope,"immediate":false},handleAuthResult)}function onPickerApiLoad(){pickerApiLoaded=true;createPicker()}function handleAuthResult(authResult){if(authResult&&!authResult.error){oauthToken=authResult.access_token;createPicker()}else alert("There was an error authenticating.  Please make sure you're still logged in to Google.")}
function createPicker(){if(pickerApiLoaded&&oauthToken){var view=new google.picker.View(google.picker.ViewId.DOCS);view.setMimeTypes("image/png,image/jpeg,image/jpg,image/webp");var picker=(new google.picker.PickerBuilder).enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).setAppId(appId).setOAuthToken(oauthToken).addView(view).addView(new google.picker.DocsUploadView).setDeveloperKey(developerKey).setCallback(pickerCallback).build();picker.setVisible(true)}}
function pickerCallback(data){if(data.action==google.picker.Action.PICKED){var doc=data[google.picker.Response.DOCUMENTS][0];var url=doc[google.picker.Document.URL];var permissions_body={"role":"reader","type":"anyone","value":"default","withLink":true};gapi.client.load("drive","v2",setPermissionsAndInsertCode.bind(this,doc.id,permissions_body))}}function setPermissionsAndInsertCode(fileId,body){var request=gapi.client.drive.permissions.insert({"fileId":fileId,"resource":body});request.execute(function(resp){});
var code=editor.getCode();var curPos=editor.getCursorStartPosition();var preCursorCode=code.slice(0,curPos);var postCursorCode=code.slice(curPos,code.length);var pathToImg='"https://drive.google.com/uc?export=download&id='+fileId+'"';editor.setCode(preCursorCode+"(image-url "+pathToImg+")"+postCursorCode)}if(oauthToken)createPicker();else loadPicker()};WeSchemeEditor.prototype.toggleScreenreader=function(){this.screenreader=!this.screenreader;this.interactions.say("screenreader features "+(this.screenreader?
"on":"off"),true)};WeSchemeEditor.prototype.getScreenreader=function(){return this.screenreader};WeSchemeEditor.prototype.cycleFocus=function(goBackwards){var nextFocusIndex,that=this,maxIndex=that.focusCarousel.length;var currentFocusedElt=that.focusCarousel.find(function(node){return node.contains(document.activeElement)});var currentFocusIndex=that.focusCarousel.indexOf(currentFocusedElt);nextFocusIndex=currentFocusIndex+(goBackwards?-1:1);nextFocusIndex=(nextFocusIndex%maxIndex+maxIndex)%maxIndex;
var focusElt=that.focusCarousel[nextFocusIndex];document.activeElement.blur();document.getElementById("editor").setAttribute("aria-activedescendant",focusElt.id);focusElt.click();focusElt.focus()};WeSchemeEditor.prototype.run=function(after){var that=this;if(that.isRunning===true)return false;that.isRunning=true;plt.wescheme.WeSchemeIntentBus.notify("before-run",this);this.interactions.reset();this.interactions.runCode(this.defn.getCode(),"<definitions>",function(){that.isRunning=false;plt.wescheme.WeSchemeIntentBus.notify("after-run",
that);if(after)after()})};WeSchemeEditor.prototype.getDefinitionsText=function(){return this.defn.getCode()};WeSchemeEditor.prototype.setDefinitionsText=function(v){this.defn.setCode(v)};WeSchemeEditor.prototype.requestBreak=function(){this.interactions.requestBreak()};WeSchemeEditor.prototype._setIsOwner=function(v){this.isOwner=v;this.isOwnerE.sendEvent(v)};WeSchemeEditor.prototype.toString=function(){return"WeSchemeEditor()"};function makeShareUrl(publicId){if(publicId!=""){var a=document.createElement("a");
a.href="/view?publicId="+encodeURIComponent(publicId);a.appendChild(document.createTextNode(a.href));return jQuery(a)}}WeSchemeEditor.prototype.getTokenizer=function(){return plt.wescheme.tokenizer}})();plt.wescheme.WeSchemeEditor=WeSchemeEditor;goog.provide("goog.debug.ErrorHandler");goog.provide("goog.debug.ErrorHandler.ProtectedFunctionError");goog.require("goog.Disposable");goog.require("goog.asserts");goog.require("goog.debug.EntryPointMonitor");goog.require("goog.debug.Error");goog.debug.ErrorHandler=function(handler){goog.debug.ErrorHandler.base(this,"constructor");this.errorHandlerFn_=handler;this.wrapErrors_=true;this.prefixErrorMessages_=false};goog.inherits(goog.debug.ErrorHandler,goog.Disposable);
goog.debug.ErrorHandler.prototype.wrap=function(fn){return this.protectEntryPoint(goog.asserts.assertFunction(fn))};goog.debug.ErrorHandler.prototype.unwrap=function(fn){goog.asserts.assertFunction(fn);return fn[this.getFunctionIndex_(false)]||fn};goog.debug.ErrorHandler.prototype.getFunctionIndex_=function(wrapper){return(wrapper?"__wrapper_":"__protected_")+goog.getUid(this)+"__"};
goog.debug.ErrorHandler.prototype.protectEntryPoint=function(fn){var protectedFnName=this.getFunctionIndex_(true);if(!fn[protectedFnName]){var wrapper=fn[protectedFnName]=this.getProtectedFunction(fn);wrapper[this.getFunctionIndex_(false)]=fn}return fn[protectedFnName]};
goog.debug.ErrorHandler.prototype.getProtectedFunction=function(fn){var that=this;var googDebugErrorHandlerProtectedFunction=function(){var self=this;if(that.isDisposed())return fn.apply(self,arguments);try{return fn.apply(self,arguments)}catch(e){that.handleError_(e)}};googDebugErrorHandlerProtectedFunction[this.getFunctionIndex_(false)]=fn;return googDebugErrorHandlerProtectedFunction};
goog.debug.ErrorHandler.prototype.handleError_=function(e){var MESSAGE_PREFIX=goog.debug.ErrorHandler.ProtectedFunctionError.MESSAGE_PREFIX;if(e&&typeof e==="object"&&typeof e.message==="string"&&e.message.indexOf(MESSAGE_PREFIX)==0||typeof e==="string"&&e.indexOf(MESSAGE_PREFIX)==0)return;this.errorHandlerFn_(e);if(!this.wrapErrors_){if(this.prefixErrorMessages_)if(typeof e==="object"&&e&&typeof e.message==="string")e.message=MESSAGE_PREFIX+e.message;else e=MESSAGE_PREFIX+e;if(goog.DEBUG)if(e&&typeof e.stack===
"string"&&Error.captureStackTrace&&goog.global["console"])goog.global["console"]["error"](e.message,e.stack);throw e;}throw new goog.debug.ErrorHandler.ProtectedFunctionError(e);};goog.debug.ErrorHandler.prototype.protectWindowSetTimeout=function(){this.protectWindowFunctionsHelper_("setTimeout")};goog.debug.ErrorHandler.prototype.protectWindowSetInterval=function(){this.protectWindowFunctionsHelper_("setInterval")};
goog.debug.ErrorHandler.prototype.catchUnhandledRejections=function(win){win=win||goog.global["window"]||goog.global["globalThis"];if("onunhandledrejection"in win)win.onunhandledrejection=event=>{const e=event&&event.reason?event.reason:new Error("uncaught error");this.handleError_(e)}};
goog.debug.ErrorHandler.prototype.protectWindowRequestAnimationFrame=function(){const win=goog.global["window"]||goog.global["globalThis"];var fnNames=["requestAnimationFrame","mozRequestAnimationFrame","webkitAnimationFrame","msRequestAnimationFrame"];for(var i=0;i<fnNames.length;i++){var fnName=fnNames[i];if(fnNames[i]in win)this.protectWindowFunctionsHelper_(fnName)}};
goog.debug.ErrorHandler.prototype.protectWindowFunctionsHelper_=function(fnName){const win=goog.global["window"]||goog.global["globalThis"];var originalFn=win[fnName];if(!originalFn)throw new Error(fnName+" not on global?");var that=this;win[fnName]=function(fn,time){if(typeof fn==="string")fn=goog.partial(goog.globalEval,fn);if(fn)arguments[0]=fn=that.protectEntryPoint(fn);if(originalFn.apply)return originalFn.apply(this,arguments);else{var callback=fn;if(arguments.length>2){var args=Array.prototype.slice.call(arguments,
2);callback=function(){fn.apply(this,args)}}return originalFn(callback,time)}};win[fnName][this.getFunctionIndex_(false)]=originalFn};goog.debug.ErrorHandler.prototype.setWrapErrors=function(wrapErrors){this.wrapErrors_=wrapErrors};goog.debug.ErrorHandler.prototype.setPrefixErrorMessages=function(prefixErrorMessages){this.prefixErrorMessages_=prefixErrorMessages};
goog.debug.ErrorHandler.prototype.disposeInternal=function(){const win=goog.global["window"]||goog.global["globalThis"];win.setTimeout=this.unwrap(win.setTimeout);win.setInterval=this.unwrap(win.setInterval);goog.debug.ErrorHandler.base(this,"disposeInternal")};
goog.debug.ErrorHandler.ProtectedFunctionError=function(cause){var message=goog.debug.ErrorHandler.ProtectedFunctionError.MESSAGE_PREFIX+(cause&&cause.message?String(cause.message):String(cause));goog.debug.ErrorHandler.ProtectedFunctionError.base(this,"constructor",message,cause);var stack=cause&&cause.stack;if(stack&&typeof stack==="string")this.stack=stack};goog.inherits(goog.debug.ErrorHandler.ProtectedFunctionError,goog.debug.Error);
goog.debug.ErrorHandler.ProtectedFunctionError.MESSAGE_PREFIX="Error in protected function: ";goog.provide("goog.events.EventWrapper");goog.requireType("goog.events.EventHandler");goog.requireType("goog.events.ListenableType");goog.events.EventWrapper=function(){};goog.events.EventWrapper.prototype.listen=function(src,listener,opt_capt,opt_scope,opt_eventHandler){};goog.events.EventWrapper.prototype.unlisten=function(src,listener,opt_capt,opt_scope,opt_eventHandler){};goog.provide("goog.events.EventLike");goog.requireType("goog.events.Event");goog.requireType("goog.events.EventId");goog.events.EventLike;
